{"ast":null,"code":"// utils/excelParser.js\nimport * as XLSX from 'xlsx';\n\n/**\r\n * Parse Excel file and extract student data & metadata\r\n */\nexport const parseExcelFile = async file => {\n  try {\n    const buf = await file.arrayBuffer();\n    const wb = XLSX.read(buf, {\n      type: 'array'\n    });\n    const ws = wb.Sheets[wb.SheetNames[0]];\n    const raw = XLSX.utils.sheet_to_json(ws, {\n      header: 1,\n      defval: '',\n      blankrows: false\n    });\n\n    // Locate student header row\n    const tableInfo = findStudentDataTable(raw);\n    if (!tableInfo.found) {\n      throw new Error('Could not detect student table headers.');\n    }\n\n    // Extract students\n    const headers = raw[tableInfo.headerRow];\n    const rows = raw.slice(tableInfo.dataStartRow, tableInfo.dataEndRow + 1);\n    const students = parseStudentData(headers, rows);\n\n    // Extract course metadata\n    const courseMetadata = extractCourseMetadata(raw, students);\n    return {\n      success: true,\n      students,\n      courseMetadata,\n      totalRows: raw.length,\n      dataRows: rows.length,\n      headers,\n      tableInfo,\n      message: `Parsed ${students.length} students.`\n    };\n  } catch (err) {\n    return {\n      success: false,\n      error: err.message,\n      students: []\n    };\n  }\n};\n\n/**\r\n * Validate an array of student objects for completeness\r\n */\nexport const validateStudentData = students => {\n  const validation = {\n    totalStudents: students.length,\n    validStudents: 0,\n    issues: [],\n    completeness: {\n      withId: 0,\n      withName: 0,\n      withEmail: 0,\n      withProgram: 0,\n      withLevel: 0,\n      withCampus: 0,\n      withStatus: 0\n    },\n    duplicateIds: [],\n    invalidEmails: [],\n    missingRequired: [],\n    validationScore: 0\n  };\n  const seen = new Set();\n  students.forEach((s, i) => {\n    let ok = true;\n    // ID\n    if (!s.id) {\n      validation.issues.push(`Row ${i + 1}: Missing ID`);\n      ok = false;\n    } else {\n      validation.completeness.withId++;\n      if (seen.has(s.id)) {\n        validation.duplicateIds.push(s.id);\n        validation.issues.push(`Row ${i + 1}: Duplicate ID ${s.id}`);\n        ok = false;\n      }\n      seen.add(s.id);\n    }\n\n    // Name\n    if (!s.name) {\n      validation.issues.push(`Row ${i + 1}: Missing Name`);\n      ok = false;\n    } else {\n      validation.completeness.withName++;\n    }\n\n    // Email (optional but track completeness + basic format)\n    if (s.email) {\n      validation.completeness.withEmail++;\n      const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n      if (!re.test(s.email)) {\n        validation.invalidEmails.push(s.email);\n        validation.issues.push(`Row ${i + 1}: Bad Email ${s.email}`);\n      }\n    }\n\n    // Other fields\n    if (s.program) validation.completeness.withProgram++;\n    if (s.level) validation.completeness.withLevel++;\n    if (s.campus) validation.completeness.withCampus++;\n    if (s.status) validation.completeness.withStatus++;\n    if (ok) validation.validStudents++;\n  });\n\n  // Compute a 0–100 score\n  validation.validationScore = students.length ? Math.round(validation.validStudents / students.length * 100) : 0;\n  return validation;\n};\n\n/*–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––*/\n/*                              Internal                                    */\n/*–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––*/\n\nconst findStudentDataTable = data => {\n  const isHeader = r => {\n    const txt = r.join(' ').toLowerCase();\n    return ['id', 'name', 'email', 'program', 'level', 'campus', 'status'].filter(t => txt.includes(t)).length >= 4;\n  };\n  for (let i = 0; i < data.length; i++) {\n    if (isHeader(data[i])) {\n      const start = i + 1;\n      const end = findDataEndRow(data, start);\n      return {\n        found: true,\n        headerRow: i,\n        dataStartRow: start,\n        dataEndRow: end\n      };\n    }\n  }\n  return {\n    found: false\n  };\n};\nconst findDataEndRow = (data, start) => {\n  let last = start;\n  for (let i = start; i < data.length; i++) {\n    const nonBlank = data[i].filter(c => String(c).trim() !== '').length;\n    if (nonBlank < 3) break;\n    last = i;\n  }\n  return last;\n};\nconst parseStudentData = (hdrs, rows) => {\n  const idx = {};\n  hdrs.forEach((h, i) => {\n    const t = String(h).toLowerCase();\n    if (t.includes('component')) idx.component = i;\n    if (t.includes('id')) idx.id = i;\n    if (t.includes('name')) idx.name = i;\n    if (t.includes('email')) idx.email = i;\n    if (t.includes('program')) idx.program = i;\n    if (t.includes('level')) idx.level = i;\n    if (t.includes('campus')) idx.campus = i;\n    if (t.includes('status')) idx.status = i;\n  });\n  return rows.map(r => ({\n    component: String(r[idx.component] || '').trim(),\n    id: String(r[idx.id] || '').trim(),\n    name: String(r[idx.name] || '').trim(),\n    email: String(r[idx.email] || '').trim(),\n    program: String(r[idx.program] || '').trim(),\n    level: String(r[idx.level] || '').trim(),\n    campus: String(r[idx.campus] || '').trim(),\n    status: String(r[idx.status] || '').trim()\n  })).filter(s => s.id && s.name);\n};\nconst extractCourseMetadata = (raw, students) => {\n  const md = {\n    courseCode: '',\n    courseName: '',\n    section: '',\n    campus: '',\n    professors: '',\n    term: '',\n    hours: '',\n    gradeScale: '',\n    department: '',\n    totalStudents: students.length\n  };\n  for (let i = 0; i < Math.min(raw.length, 15); i++) {\n    const row = raw[i].map(c => String(c).trim());\n    const line = row.join(' ');\n\n    // Term\n    const tm = line.match(/\\b(Fall|Winter|Spring|Summer)\\s+(\\d{4})\\b/);\n    if (tm) md.term = `${tm[1]} ${tm[2]}`;\n\n    // Code & Name\n    if (!md.courseCode && row[0].match(/^([A-Z0-9]+)\\s*[-–]/)) {\n      const parts = row[0].split(/[-–]/).map(p => p.trim());\n      md.courseCode = parts[0];\n      let rest = parts.slice(1).join(' - ').replace(/\\(.*?\\)/g, '').trim();\n      const S = rest.match(/Section\\s+(\\w+)/i);\n      if (S) md.section = `Section ${S[1]}`;\n      const C = rest.match(/(\\w+)\\s*Campus$/i);\n      if (C) md.campus = `${C[1]} Campus`;\n      md.courseName = rest.split(/Section/i)[0].trim();\n    }\n\n    // Professors:\n    const pi = row.findIndex(c => /Professors?:/i.test(c));\n    if (pi > -1) md.professors = row[pi + 1] || '';\n\n    // Hours:\n    const hi = row.findIndex(c => /Hours:/i.test(c));\n    if (hi > -1) md.hours = row[hi + 1] || '';\n\n    // Grade Scale:\n    const gi = row.findIndex(c => /Grade Scale:/i.test(c));\n    if (gi > -1) md.gradeScale = row[gi + 1] || '';\n\n    // Department:\n    const di = row.findIndex(c => /(Delivery\\s+)?Dept:/i.test(c));\n    if (di > -1) md.department = row[di + 1] || '';\n  }\n  return md;\n};","map":{"version":3,"names":["XLSX","parseExcelFile","file","buf","arrayBuffer","wb","read","type","ws","Sheets","SheetNames","raw","utils","sheet_to_json","header","defval","blankrows","tableInfo","findStudentDataTable","found","Error","headers","headerRow","rows","slice","dataStartRow","dataEndRow","students","parseStudentData","courseMetadata","extractCourseMetadata","success","totalRows","length","dataRows","message","err","error","validateStudentData","validation","totalStudents","validStudents","issues","completeness","withId","withName","withEmail","withProgram","withLevel","withCampus","withStatus","duplicateIds","invalidEmails","missingRequired","validationScore","seen","Set","forEach","s","i","ok","id","push","has","add","name","email","re","test","program","level","campus","status","Math","round","data","isHeader","r","txt","join","toLowerCase","filter","t","includes","start","end","findDataEndRow","last","nonBlank","c","String","trim","hdrs","idx","h","component","map","md","courseCode","courseName","section","professors","term","hours","gradeScale","department","min","row","line","tm","match","parts","split","p","rest","replace","S","C","pi","findIndex","hi","gi","di"],"sources":["C:/local clones/rubric-creation-app/src/utils/excelParser.js"],"sourcesContent":["// utils/excelParser.js\r\nimport * as XLSX from 'xlsx';\r\n\r\n/**\r\n * Parse Excel file and extract student data & metadata\r\n */\r\nexport const parseExcelFile = async (file) => {\r\n    try {\r\n        const buf = await file.arrayBuffer();\r\n        const wb = XLSX.read(buf, { type: 'array' });\r\n        const ws = wb.Sheets[wb.SheetNames[0]];\r\n        const raw = XLSX.utils.sheet_to_json(ws, { header: 1, defval: '', blankrows: false });\r\n\r\n        // Locate student header row\r\n        const tableInfo = findStudentDataTable(raw);\r\n        if (!tableInfo.found) {\r\n            throw new Error('Could not detect student table headers.');\r\n        }\r\n\r\n        // Extract students\r\n        const headers = raw[tableInfo.headerRow];\r\n        const rows = raw.slice(tableInfo.dataStartRow, tableInfo.dataEndRow + 1);\r\n        const students = parseStudentData(headers, rows);\r\n\r\n        // Extract course metadata\r\n        const courseMetadata = extractCourseMetadata(raw, students);\r\n\r\n        return {\r\n            success: true,\r\n            students,\r\n            courseMetadata,\r\n            totalRows: raw.length,\r\n            dataRows: rows.length,\r\n            headers,\r\n            tableInfo,\r\n            message: `Parsed ${students.length} students.`\r\n        };\r\n\r\n    } catch (err) {\r\n        return { success: false, error: err.message, students: [] };\r\n    }\r\n};\r\n\r\n/**\r\n * Validate an array of student objects for completeness\r\n */\r\nexport const validateStudentData = (students) => {\r\n    const validation = {\r\n        totalStudents: students.length,\r\n        validStudents: 0,\r\n        issues: [],\r\n        completeness: { withId: 0, withName: 0, withEmail: 0, withProgram: 0, withLevel: 0, withCampus: 0, withStatus: 0 },\r\n        duplicateIds: [],\r\n        invalidEmails: [],\r\n        missingRequired: [],\r\n        validationScore: 0\r\n    };\r\n\r\n    const seen = new Set();\r\n\r\n    students.forEach((s, i) => {\r\n        let ok = true;\r\n        // ID\r\n        if (!s.id) {\r\n            validation.issues.push(`Row ${i + 1}: Missing ID`);\r\n            ok = false;\r\n        } else {\r\n            validation.completeness.withId++;\r\n            if (seen.has(s.id)) {\r\n                validation.duplicateIds.push(s.id);\r\n                validation.issues.push(`Row ${i + 1}: Duplicate ID ${s.id}`);\r\n                ok = false;\r\n            }\r\n            seen.add(s.id);\r\n        }\r\n\r\n        // Name\r\n        if (!s.name) {\r\n            validation.issues.push(`Row ${i + 1}: Missing Name`);\r\n            ok = false;\r\n        } else {\r\n            validation.completeness.withName++;\r\n        }\r\n\r\n        // Email (optional but track completeness + basic format)\r\n        if (s.email) {\r\n            validation.completeness.withEmail++;\r\n            const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n            if (!re.test(s.email)) {\r\n                validation.invalidEmails.push(s.email);\r\n                validation.issues.push(`Row ${i + 1}: Bad Email ${s.email}`);\r\n            }\r\n        }\r\n\r\n        // Other fields\r\n        if (s.program) validation.completeness.withProgram++;\r\n        if (s.level) validation.completeness.withLevel++;\r\n        if (s.campus) validation.completeness.withCampus++;\r\n        if (s.status) validation.completeness.withStatus++;\r\n\r\n        if (ok) validation.validStudents++;\r\n    });\r\n\r\n    // Compute a 0–100 score\r\n    validation.validationScore = students.length\r\n        ? Math.round((validation.validStudents / students.length) * 100)\r\n        : 0;\r\n\r\n    return validation;\r\n};\r\n\r\n\r\n/*–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––*/\r\n/*                              Internal                                    */\r\n/*–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––*/\r\n\r\nconst findStudentDataTable = (data) => {\r\n    const isHeader = (r) => {\r\n        const txt = r.join(' ').toLowerCase();\r\n        return ['id', 'name', 'email', 'program', 'level', 'campus', 'status']\r\n            .filter(t => txt.includes(t)).length >= 4;\r\n    };\r\n    for (let i = 0; i < data.length; i++) {\r\n        if (isHeader(data[i])) {\r\n            const start = i + 1;\r\n            const end = findDataEndRow(data, start);\r\n            return { found: true, headerRow: i, dataStartRow: start, dataEndRow: end };\r\n        }\r\n    }\r\n    return { found: false };\r\n};\r\n\r\nconst findDataEndRow = (data, start) => {\r\n    let last = start;\r\n    for (let i = start; i < data.length; i++) {\r\n        const nonBlank = data[i].filter(c => String(c).trim() !== '').length;\r\n        if (nonBlank < 3) break;\r\n        last = i;\r\n    }\r\n    return last;\r\n};\r\n\r\nconst parseStudentData = (hdrs, rows) => {\r\n    const idx = {};\r\n    hdrs.forEach((h, i) => {\r\n        const t = String(h).toLowerCase();\r\n        if (t.includes('component')) idx.component = i;\r\n        if (t.includes('id')) idx.id = i;\r\n        if (t.includes('name')) idx.name = i;\r\n        if (t.includes('email')) idx.email = i;\r\n        if (t.includes('program')) idx.program = i;\r\n        if (t.includes('level')) idx.level = i;\r\n        if (t.includes('campus')) idx.campus = i;\r\n        if (t.includes('status')) idx.status = i;\r\n    });\r\n\r\n    return rows\r\n        .map(r => ({\r\n            component: String(r[idx.component] || '').trim(),\r\n            id: String(r[idx.id] || '').trim(),\r\n            name: String(r[idx.name] || '').trim(),\r\n            email: String(r[idx.email] || '').trim(),\r\n            program: String(r[idx.program] || '').trim(),\r\n            level: String(r[idx.level] || '').trim(),\r\n            campus: String(r[idx.campus] || '').trim(),\r\n            status: String(r[idx.status] || '').trim()\r\n        }))\r\n        .filter(s => s.id && s.name);\r\n};\r\n\r\nconst extractCourseMetadata = (raw, students) => {\r\n    const md = {\r\n        courseCode: '',\r\n        courseName: '',\r\n        section: '',\r\n        campus: '',\r\n        professors: '',\r\n        term: '',\r\n        hours: '',\r\n        gradeScale: '',\r\n        department: '',\r\n        totalStudents: students.length\r\n    };\r\n\r\n    for (let i = 0; i < Math.min(raw.length, 15); i++) {\r\n        const row = raw[i].map(c => String(c).trim());\r\n        const line = row.join(' ');\r\n\r\n        // Term\r\n        const tm = line.match(/\\b(Fall|Winter|Spring|Summer)\\s+(\\d{4})\\b/);\r\n        if (tm) md.term = `${tm[1]} ${tm[2]}`;\r\n\r\n        // Code & Name\r\n        if (!md.courseCode && row[0].match(/^([A-Z0-9]+)\\s*[-–]/)) {\r\n            const parts = row[0].split(/[-–]/).map(p => p.trim());\r\n            md.courseCode = parts[0];\r\n            let rest = parts.slice(1).join(' - ').replace(/\\(.*?\\)/g, '').trim();\r\n            const S = rest.match(/Section\\s+(\\w+)/i);\r\n            if (S) md.section = `Section ${S[1]}`;\r\n            const C = rest.match(/(\\w+)\\s*Campus$/i);\r\n            if (C) md.campus = `${C[1]} Campus`;\r\n            md.courseName = rest.split(/Section/i)[0].trim();\r\n        }\r\n\r\n        // Professors:\r\n        const pi = row.findIndex(c => /Professors?:/i.test(c));\r\n        if (pi > -1) md.professors = row[pi + 1] || '';\r\n\r\n        // Hours:\r\n        const hi = row.findIndex(c => /Hours:/i.test(c));\r\n        if (hi > -1) md.hours = row[hi + 1] || '';\r\n\r\n        // Grade Scale:\r\n        const gi = row.findIndex(c => /Grade Scale:/i.test(c));\r\n        if (gi > -1) md.gradeScale = row[gi + 1] || '';\r\n\r\n        // Department:\r\n        const di = row.findIndex(c => /(Delivery\\s+)?Dept:/i.test(c));\r\n        if (di > -1) md.department = row[di + 1] || '';\r\n    }\r\n\r\n    return md;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}