{"ast":null,"code":"var _jsxFileName = \"C:\\\\local clones\\\\rubric-creation-app\\\\src\\\\components\\\\SharedContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// Updated SharedContext.js with Enhanced Draft/Final Grade Management + AI Prompt Generator + Assignment Prompt Generator\nimport React, { createContext, useContext, useState, useCallback } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AssessmentContext = /*#__PURE__*/createContext();\nexport const useAssessment = () => {\n  _s();\n  const context = useContext(AssessmentContext);\n  if (!context) {\n    throw new Error('useAssessment must be used within AssessmentProvider');\n  }\n  return context;\n};\n_s(useAssessment, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AssessmentProvider = ({\n  children\n}) => {\n  _s2();\n  // Shared rubric state\n  const [sharedRubric, setSharedRubric] = useState(null);\n  const [sharedCourseDetails, setSharedCourseDetails] = useState(null);\n  const [activeTab, setActiveTab] = useState('assignment-prompt-generator'); // Updated to start with assignment prompt generator\n\n  // AI Prompt Generator state (for rubrics) - UPDATED with weight percentage\n  const [aiPromptFormData, setAIPromptFormData] = useState(null);\n\n  // NEW: Assignment Prompt Generator state\n  const [assignmentPromptFormData, setAssignmentPromptFormData] = useState(null);\n\n  // Class list and student management\n  const [classList, setClassList] = useState(null);\n  const [currentStudent, setCurrentStudent] = useState(null);\n\n  // ENHANCED: Separate storage for draft and final grades\n  const [drafts, setDrafts] = useState({});\n  const [finalGrades, setFinalGrades] = useState({});\n\n  // Batch grading session state\n  const [gradingSession, setGradingSession] = useState({\n    active: false,\n    startTime: null,\n    gradedStudents: [],\n    totalStudents: 0,\n    currentStudent: null,\n    currentStudentIndex: 0\n  });\n\n  // Form data states\n  const [gradingFormData, setGradingFormData] = useState({\n    student: {\n      name: '',\n      id: '',\n      email: ''\n    },\n    course: {\n      code: '',\n      name: '',\n      instructor: '',\n      term: ''\n    },\n    assignment: {\n      name: '',\n      dueDate: '',\n      maxPoints: 100\n    },\n    feedback: {\n      general: '',\n      strengths: '',\n      improvements: ''\n    },\n    attachments: [],\n    videoLinks: [],\n    latePolicy: {\n      level: 'none',\n      penaltyApplied: false\n    },\n    rubricGrading: {},\n    metadata: {\n      gradedBy: '',\n      gradedDate: '',\n      aiAssisted: false,\n      rubricIntegrated: false\n    }\n  });\n  const [rubricFormData, setRubricFormData] = useState({\n    assignmentInfo: {\n      title: '',\n      description: '',\n      weight: 25,\n      passingThreshold: 60,\n      totalPoints: 100\n    },\n    rubricLevels: [{\n      level: 'incomplete',\n      name: 'Incomplete',\n      description: 'No submission or unusable',\n      color: '#95a5a6',\n      multiplier: 0\n    }, {\n      level: 'unacceptable',\n      name: 'Unacceptable',\n      description: 'Below minimum standards',\n      color: '#e74c3c',\n      multiplier: 0.3\n    }, {\n      level: 'developing',\n      name: 'Developing',\n      description: 'Approaching standards',\n      color: '#f39c12',\n      multiplier: 0.55\n    }, {\n      level: 'acceptable',\n      name: 'Acceptable (PASS)',\n      description: 'Meets minimum standards',\n      color: '#27ae60',\n      multiplier: 0.7\n    }, {\n      level: 'emerging',\n      name: 'Emerging',\n      description: 'Above standard expectations',\n      color: '#2980b9',\n      multiplier: 0.82\n    }, {\n      level: 'accomplished',\n      name: 'Accomplished',\n      description: 'Strong professional quality',\n      color: '#16a085',\n      multiplier: 0.92\n    }, {\n      level: 'exceptional',\n      name: 'Exceptional',\n      description: 'Outstanding professional quality',\n      color: '#8e44ad',\n      multiplier: 1.0\n    }],\n    criteria: [{\n      id: 'criterion-1',\n      name: '',\n      description: '',\n      maxPoints: 20,\n      weight: 20,\n      levels: {},\n      feedbackLibrary: {\n        strengths: [],\n        improvements: [],\n        general: []\n      }\n    }],\n    pointingSystem: 'multiplier',\n    reversedOrder: false,\n    expandedFeedback: {},\n    modalEdit: {\n      show: false,\n      content: '',\n      field: null,\n      onSave: null\n    }\n  });\n\n  // AI Prompt Generator functions (for rubrics) - UPDATED with weight percentage\n  const initializeAIPromptFormData = useCallback(() => {\n    setAIPromptFormData({\n      assignmentType: '',\n      programType: '',\n      programLevel: '',\n      subjectArea: '',\n      assignmentDescription: '',\n      totalPoints: '100',\n      weightPercentage: '',\n      // NEW: Add weight percentage field\n      numCriteria: '4',\n      criteriaType: 'ai-suggested',\n      userCriteria: '',\n      learningObjectives: '',\n      studentPopulation: '',\n      timeFrameNumber: '',\n      timeFrameUnit: 'weeks',\n      specialConsiderations: ''\n    });\n  }, []);\n  const updateAIPromptFormData = useCallback((field, value) => {\n    setAIPromptFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  }, []);\n  const clearAIPromptFormData = useCallback(() => {\n    setAIPromptFormData(null);\n  }, []);\n\n  // NEW: Assignment Prompt Generator functions\n  const initializeAssignmentPromptFormData = useCallback(() => {\n    setAssignmentPromptFormData({\n      assignmentTitle: '',\n      assignmentNumber: '',\n      weightPercentage: '',\n      courseCode: '',\n      programLevel: '',\n      subjectArea: '',\n      assignmentDescription: '',\n      rationale: 'This assignment will evaluate the following Course Learning Outcomes:',\n      clos: [{\n        id: 1,\n        number: '1',\n        text: '',\n        type: 'CLO'\n      }, {\n        id: 2,\n        number: '2',\n        text: '',\n        type: 'CLO'\n      }, {\n        id: 3,\n        number: '3',\n        text: '',\n        type: 'CLO'\n      }, {\n        id: 4,\n        number: '4',\n        text: '',\n        type: 'CLO'\n      }],\n      directions: '',\n      gradingMethod: 'rubric',\n      gradingDetails: '',\n      dueDate: '',\n      submissionFolder: 'Assignment X',\n      specialInstructions: ''\n    });\n  }, []);\n  const updateAssignmentPromptFormData = useCallback((field, value) => {\n    setAssignmentPromptFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  }, []);\n  const clearAssignmentPromptFormData = useCallback(() => {\n    setAssignmentPromptFormData(null);\n  }, []);\n\n  // Form update functions\n  const updateStudentInfo = useCallback(studentInfo => {\n    setGradingFormData(prev => ({\n      ...prev,\n      student: {\n        ...prev.student,\n        ...studentInfo\n      }\n    }));\n  }, []);\n  const updateCourseInfo = useCallback(courseInfo => {\n    console.log('ðŸ“ Updating course info:', courseInfo);\n    setGradingFormData(prev => ({\n      ...prev,\n      course: {\n        ...prev.course,\n        ...courseInfo\n      }\n    }));\n  }, []);\n  const updateAssignmentInfo = useCallback(assignmentInfo => {\n    setGradingFormData(prev => ({\n      ...prev,\n      assignment: {\n        ...prev.assignment,\n        ...assignmentInfo\n      }\n    }));\n  }, []);\n  const updateFeedbackInfo = useCallback(feedbackInfo => {\n    setGradingFormData(prev => ({\n      ...prev,\n      feedback: {\n        ...prev.feedback,\n        ...feedbackInfo\n      }\n    }));\n  }, []);\n  const updateAttachments = useCallback(attachments => {\n    setGradingFormData(prev => ({\n      ...prev,\n      attachments\n    }));\n  }, []);\n  const updateVideoLinks = useCallback(videoLinks => {\n    setGradingFormData(prev => ({\n      ...prev,\n      videoLinks\n    }));\n  }, []);\n  const updateLatePolicyInfo = useCallback(latePolicyInfo => {\n    setGradingFormData(prev => ({\n      ...prev,\n      latePolicy: {\n        ...prev.latePolicy,\n        ...latePolicyInfo\n      }\n    }));\n  }, []);\n  const updateRubricGrading = useCallback(rubricGrading => {\n    setGradingFormData(prev => ({\n      ...prev,\n      rubricGrading\n    }));\n  }, []);\n  const updateMetadata = useCallback(metadata => {\n    setGradingFormData(prev => ({\n      ...prev,\n      metadata: {\n        ...prev.metadata,\n        ...metadata\n      }\n    }));\n  }, []);\n\n  // ENHANCED: Draft and Final Grade Management\n  const saveDraft = useCallback((studentId, gradingData) => {\n    const draftData = {\n      ...gradingData,\n      metadata: {\n        ...gradingData.metadata,\n        savedAt: new Date().toISOString(),\n        status: 'draft'\n      }\n    };\n    setDrafts(prev => ({\n      ...prev,\n      [studentId]: draftData\n    }));\n    console.log('âœ… Draft saved for student:', studentId);\n    return true;\n  }, []);\n  const hasDraft = useCallback(studentId => {\n    return drafts[studentId] !== undefined;\n  }, [drafts]);\n  const loadDraft = useCallback(studentId => {\n    const draft = drafts[studentId];\n    if (draft) {\n      console.log('ðŸ“ Draft loaded for student:', studentId);\n      return draft;\n    }\n    console.log('âš ï¸ No draft found for student:', studentId);\n    return null;\n  }, [drafts]);\n  const saveFinalGrade = useCallback((studentId, data) => {\n    console.log('âœ… Saving final grade for student:', studentId);\n    setFinalGrades(prev => ({\n      ...prev,\n      [studentId]: data\n    }));\n\n    // Remove from drafts once finalized\n    setDrafts(prev => {\n      const updated = {\n        ...prev\n      };\n      delete updated[studentId];\n      return updated;\n    });\n\n    // Update class list progress\n    if (classList) {\n      const studentIndex = classList.students.findIndex(s => s.id === studentId);\n      if (studentIndex >= 0) {\n        const updatedProgress = [...classList.gradingProgress];\n        updatedProgress[studentIndex] = {\n          ...updatedProgress[studentIndex],\n          status: 'completed_final',\n          lastModified: new Date().toISOString(),\n          gradeType: 'final'\n        };\n        setClassList(prev => ({\n          ...prev,\n          gradingProgress: updatedProgress\n        }));\n      }\n    }\n  }, [classList]);\n  const loadFinalGrade = useCallback(studentId => {\n    return finalGrades[studentId] || null;\n  }, [finalGrades]);\n  const getGradeStatus = useCallback(studentId => {\n    if (finalGrades[studentId]) return 'final';\n    if (drafts[studentId]) return 'draft';\n    return 'not_started';\n  }, [finalGrades, drafts]);\n\n  // Navigation helpers for grading sessions\n  const nextStudentInSession = useCallback((saveType = 'draft') => {\n    if (!(gradingSession !== null && gradingSession !== void 0 && gradingSession.active) || !classList) return false;\n    const currentIndex = gradingSession.currentStudentIndex;\n    const students = classList.students;\n    if (currentIndex < students.length - 1) {\n      const nextIndex = currentIndex + 1;\n      const nextStudent = students[nextIndex];\n      setGradingSession(prev => ({\n        ...prev,\n        currentStudentIndex: nextIndex,\n        currentStudent: nextStudent,\n        gradedStudents: [...prev.gradedStudents, currentStudent.id]\n      }));\n      setCurrentStudent(nextStudent);\n      return true;\n    }\n\n    // End of session\n    setGradingSession(prev => ({\n      ...prev,\n      active: false,\n      gradedStudents: [...prev.gradedStudents, currentStudent.id]\n    }));\n    return false;\n  }, [gradingSession, classList, currentStudent]);\n  const previousStudentInSession = useCallback(() => {\n    if (!(gradingSession !== null && gradingSession !== void 0 && gradingSession.active) || !classList) return false;\n    const currentIndex = gradingSession.currentStudentIndex;\n    if (currentIndex > 0) {\n      const prevIndex = currentIndex - 1;\n      const prevStudent = classList.students[prevIndex];\n      setGradingSession(prev => ({\n        ...prev,\n        currentStudentIndex: prevIndex,\n        currentStudent: prevStudent\n      }));\n      setCurrentStudent(prevStudent);\n      return true;\n    }\n    return false;\n  }, [gradingSession, classList]);\n\n  // **FIXED: Enhanced initializeGradingSession function**\n  const initializeGradingSession = useCallback(classListData => {\n    var _classListData$studen;\n    // 1. Guard against missing or empty class list\n    if (!classListData || !((_classListData$studen = classListData.students) !== null && _classListData$studen !== void 0 && _classListData$studen.length)) {\n      console.warn('âš ï¸ Cannot initialize grading session: No students found');\n      return false;\n    }\n\n    // 2. Extract the students array and the imported course metadata\n    const {\n      students,\n      courseMetadata\n    } = classListData;\n\n    // 3. Pick the first student to start the session\n    const firstStudent = students[0];\n\n    // 4. Build and set the grading session state\n    const session = {\n      active: true,\n      startTime: new Date().toISOString(),\n      gradedStudents: [],\n      totalStudents: students.length,\n      currentStudent: firstStudent,\n      currentStudentIndex: 0\n    };\n    setGradingSession(session);\n    setCurrentStudent(firstStudent);\n\n    // 5. ENHANCED: Prefill the grading form with comprehensive fallback logic\n    setGradingFormData(prev => {\n      var _sharedCourseDetails$;\n      const courseInfo = {\n        code: (courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.courseCode) || prev.course.code || '',\n        name: (courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.courseName) || prev.course.name || '',\n        // FIXED: Handle both instructor and professors fields with fallbacks\n        instructor: (courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.instructor) || (courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.professors) || prev.course.instructor || '',\n        term: (courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.term) || prev.course.term || ''\n      };\n      console.log('ðŸ”„ Course metadata mapping:', {\n        original: courseMetadata,\n        mapped: courseInfo\n      });\n      return {\n        ...prev,\n        student: {\n          name: firstStudent.name,\n          id: firstStudent.id,\n          email: firstStudent.email\n        },\n        course: courseInfo,\n        assignment: (_sharedCourseDetails$ = sharedCourseDetails === null || sharedCourseDetails === void 0 ? void 0 : sharedCourseDetails.assignment) !== null && _sharedCourseDetails$ !== void 0 ? _sharedCourseDetails$ : prev.assignment\n      };\n    });\n    console.log(`ðŸš€ Grading session started for ${students.length} students with course info:`, {\n      code: courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.courseCode,\n      name: courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.courseName,\n      instructor: (courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.instructor) || (courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.professors),\n      term: courseMetadata === null || courseMetadata === void 0 ? void 0 : courseMetadata.term\n    });\n    return true;\n  }, [sharedCourseDetails]);\n  const clearGradingFormData = useCallback(() => {\n    setGradingFormData({\n      student: {\n        name: '',\n        id: '',\n        email: ''\n      },\n      course: {\n        code: '',\n        name: '',\n        instructor: '',\n        term: ''\n      },\n      assignment: {\n        name: '',\n        dueDate: '',\n        maxPoints: 100\n      },\n      feedback: {\n        general: '',\n        strengths: '',\n        improvements: ''\n      },\n      attachments: [],\n      videoLinks: [],\n      latePolicy: {\n        level: 'none',\n        penaltyApplied: false\n      },\n      rubricGrading: {},\n      metadata: {\n        gradedBy: '',\n        gradedDate: '',\n        aiAssisted: false,\n        rubricIntegrated: false\n      }\n    });\n  }, []);\n\n  // FIXED: The two console.log statements that were here have been removed.\n  // They were out of scope and causing \"not defined\" errors.\n\n  const clearRubricFormData = useCallback(() => {\n    setRubricFormData({\n      assignmentInfo: {\n        title: '',\n        description: '',\n        weight: 25,\n        passingThreshold: 60,\n        totalPoints: 100\n      },\n      rubricLevels: [{\n        level: 'incomplete',\n        name: 'Incomplete',\n        description: 'No submission or unusable',\n        color: '#95a5a6',\n        multiplier: 0\n      }, {\n        level: 'unacceptable',\n        name: 'Unacceptable',\n        description: 'Below minimum standards',\n        color: '#e74c3c',\n        multiplier: 0.3\n      }, {\n        level: 'developing',\n        name: 'Developing',\n        description: 'Approaching standards',\n        color: '#f39c12',\n        multiplier: 0.55\n      }, {\n        level: 'acceptable',\n        name: 'Acceptable (PASS)',\n        description: 'Meets minimum standards',\n        color: '#27ae60',\n        multiplier: 0.7\n      }, {\n        level: 'emerging',\n        name: 'Emerging',\n        description: 'Above standard expectations',\n        color: '#2980b9',\n        multiplier: 0.82\n      }, {\n        level: 'accomplished',\n        name: 'Accomplished',\n        description: 'Strong professional quality',\n        color: '#16a085',\n        multiplier: 0.92\n      }, {\n        level: 'exceptional',\n        name: 'Exceptional',\n        description: 'Outstanding professional quality',\n        color: '#8e44ad',\n        multiplier: 1.0\n      }],\n      criteria: [{\n        id: 'criterion-1',\n        name: '',\n        description: '',\n        maxPoints: 20,\n        weight: 20,\n        levels: {},\n        feedbackLibrary: {\n          strengths: [],\n          improvements: [],\n          general: []\n        }\n      }],\n      pointingSystem: 'multiplier',\n      reversedOrder: false,\n      expandedFeedback: {},\n      modalEdit: {\n        show: false,\n        content: '',\n        field: null,\n        onSave: null\n      }\n    });\n  }, []);\n\n  // Finalize a draft grade\n  const finalizeGrade = useCallback(studentId => {\n    const draftData = drafts[studentId];\n    if (draftData) {\n      saveFinalGrade(studentId, draftData);\n      console.log('ðŸŽ¯ Finalized draft for student:', studentId);\n    }\n  }, [drafts, saveFinalGrade]);\n\n  // Unlock a final grade (convert back to draft)\n  const unlockGrade = useCallback(studentId => {\n    const finalData = finalGrades[studentId];\n    if (finalData) {\n      // Move from final back to draft\n      setDrafts(prev => ({\n        ...prev,\n        [studentId]: finalData\n      }));\n      setFinalGrades(prev => {\n        const updated = {\n          ...prev\n        };\n        delete updated[studentId];\n        return updated;\n      });\n\n      // Update class list progress\n      if (classList) {\n        const studentIndex = classList.students.findIndex(s => s.id === studentId);\n        if (studentIndex >= 0) {\n          const updatedProgress = [...classList.gradingProgress];\n          updatedProgress[studentIndex] = {\n            ...updatedProgress[studentIndex],\n            status: 'completed_draft',\n            lastModified: new Date().toISOString(),\n            gradeType: 'draft'\n          };\n          setClassList(prev => ({\n            ...prev,\n            gradingProgress: updatedProgress\n          }));\n        }\n      }\n      console.log('ðŸ”“ Unlocked final grade for student:', studentId);\n    }\n  }, [finalGrades, classList]);\n\n  // FIXED: Added definition for updateGradingSession\n  const updateGradingSession = useCallback(sessionUpdate => {\n    setGradingSession(prev => ({\n      ...prev,\n      ...sessionUpdate\n    }));\n  }, []);\n\n  // FIXED: Added definition for clearSharedRubric\n  const clearSharedRubric = useCallback(() => {\n    setSharedRubric(null);\n  }, []);\n\n  // FIXED: Added definition for transferRubricToGrading\n  const transferRubricToGrading = useCallback(() => {\n    if (!sharedRubric) return;\n    setGradingFormData(prev => ({\n      ...prev,\n      metadata: {\n        ...prev.metadata,\n        rubricIntegrated: true\n      }\n    }));\n  }, [sharedRubric]);\n\n  // FIXED: Added definition for transferRubricToGradingWithDetails\n  const transferRubricToGradingWithDetails = useCallback(() => {\n    if (!sharedRubric) return;\n    // This is a placeholder for more complex logic.\n    // For now, it copies the assignment title and marks rubric as integrated.\n    setGradingFormData(prev => ({\n      ...prev,\n      assignment: {\n        ...prev.assignment,\n        name: sharedRubric.assignmentInfo.title || prev.assignment.name\n      },\n      metadata: {\n        ...prev.metadata,\n        rubricIntegrated: true\n      }\n    }));\n  }, [sharedRubric]);\n\n  // UPDATED: Export Session Function with AI Prompt Data and Assignment Prompt Data\n  const exportSession = useCallback(() => {\n    const sessionData = {\n      sharedRubric,\n      classList,\n      drafts,\n      finalGrades,\n      activeTab,\n      currentStudent,\n      gradingSession,\n      sharedCourseDetails,\n      aiPromptFormData,\n      // AI Rubric prompt data\n      assignmentPromptFormData // NEW: Assignment prompt data\n    };\n    const dataStr = JSON.stringify(sessionData, null, 2);\n    const dataBlob = new Blob([dataStr], {\n      type: 'application/json'\n    });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    const timestamp = new Date().toISOString().replace(/:/g, '-').slice(0, 19);\n    link.download = `grading-session-${timestamp}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  }, [sharedRubric, classList, drafts, finalGrades, activeTab, currentStudent, gradingSession, sharedCourseDetails, aiPromptFormData, assignmentPromptFormData]);\n\n  // UPDATED: Import Session Function with AI Prompt Data and Assignment Prompt Data\n  const importSession = useCallback(jsonContent => {\n    try {\n      const sessionData = JSON.parse(jsonContent);\n      if (sessionData && typeof sessionData === 'object') {\n        setSharedRubric(sessionData.sharedRubric || null);\n        setClassList(sessionData.classList || null);\n        setDrafts(sessionData.drafts || {});\n        setFinalGrades(sessionData.finalGrades || {});\n        setActiveTab(sessionData.activeTab || 'assignment-prompt-generator');\n        setCurrentStudent(sessionData.currentStudent || null);\n        setGradingSession(sessionData.gradingSession || {\n          active: false\n        });\n        setSharedCourseDetails(sessionData.sharedCourseDetails || null);\n        setAIPromptFormData(sessionData.aiPromptFormData || null); // AI Rubric prompt data\n        setAssignmentPromptFormData(sessionData.assignmentPromptFormData || null); // NEW: Assignment prompt data\n        alert('Session loaded successfully!');\n      } else {\n        throw new Error('Invalid file format.');\n      }\n    } catch (error) {\n      console.error(\"Failed to import session:\", error);\n      alert(\"Error: Could not load the session file. Please ensure it's a valid session file.\");\n    }\n  }, []);\n  const clearAllData = useCallback(() => {\n    setSharedRubric(null);\n    clearGradingFormData();\n    clearRubricFormData();\n    clearAIPromptFormData(); // Clear AI Rubric prompt data\n    clearAssignmentPromptFormData(); // NEW: Clear assignment prompt data\n  }, [clearGradingFormData, clearRubricFormData, clearAIPromptFormData, clearAssignmentPromptFormData]);\n  const persistentFormData = gradingFormData;\n  const updatePersistentFormData = setGradingFormData;\n  const value = {\n    // Shared state\n    sharedRubric,\n    setSharedRubric,\n    sharedCourseDetails,\n    setSharedCourseDetails,\n    // Navigation\n    activeTab,\n    setActiveTab,\n    // AI Prompt Generator (for rubrics)\n    aiPromptFormData,\n    updateAIPromptFormData,\n    initializeAIPromptFormData,\n    clearAIPromptFormData,\n    // NEW: Assignment Prompt Generator\n    assignmentPromptFormData,\n    updateAssignmentPromptFormData,\n    initializeAssignmentPromptFormData,\n    clearAssignmentPromptFormData,\n    // Grading form data\n    gradingData: gradingFormData,\n    setGradingData: setGradingFormData,\n    clearGradingFormData,\n    persistentFormData,\n    updatePersistentFormData,\n    // Form update functions\n    updateStudentInfo,\n    updateCourseInfo,\n    updateAssignmentInfo,\n    updateFeedbackInfo,\n    updateAttachments,\n    updateVideoLinks,\n    updateLatePolicyInfo,\n    updateRubricGrading,\n    updateMetadata,\n    // Draft and Final Grade Management - ENHANCED\n    drafts,\n    finalGrades,\n    saveDraft,\n    loadDraft,\n    saveFinalGrade,\n    loadFinalGrade,\n    getGradeStatus,\n    hasDraft,\n    finalizeGrade,\n    unlockGrade,\n    // Class management\n    classList,\n    setClassList,\n    currentStudent,\n    setCurrentStudent,\n    // Grading session\n    gradingSession,\n    setGradingSession,\n    nextStudentInSession,\n    previousStudentInSession,\n    updateGradingSession,\n    // Now defined\n    initializeGradingSession,\n    // Rubric form data\n    rubricFormData,\n    setRubricFormData,\n    // Utility functions\n    transferRubricToGrading,\n    // Now defined\n    transferRubricToGradingWithDetails,\n    // Now defined\n    clearSharedRubric,\n    // Now defined\n    clearRubricFormData,\n    clearAllData,\n    // Session management\n    exportSession,\n    importSession\n  };\n  return /*#__PURE__*/_jsxDEV(AssessmentContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 721,\n    columnNumber: 9\n  }, this);\n};\n_s2(AssessmentProvider, \"+TR1IL/s++96YqMwuv4wPHXCLAE=\");\n_c = AssessmentProvider;\nexport default AssessmentProvider;\nvar _c;\n$RefreshReg$(_c, \"AssessmentProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useCallback","jsxDEV","_jsxDEV","AssessmentContext","useAssessment","_s","context","Error","AssessmentProvider","children","_s2","sharedRubric","setSharedRubric","sharedCourseDetails","setSharedCourseDetails","activeTab","setActiveTab","aiPromptFormData","setAIPromptFormData","assignmentPromptFormData","setAssignmentPromptFormData","classList","setClassList","currentStudent","setCurrentStudent","drafts","setDrafts","finalGrades","setFinalGrades","gradingSession","setGradingSession","active","startTime","gradedStudents","totalStudents","currentStudentIndex","gradingFormData","setGradingFormData","student","name","id","email","course","code","instructor","term","assignment","dueDate","maxPoints","feedback","general","strengths","improvements","attachments","videoLinks","latePolicy","level","penaltyApplied","rubricGrading","metadata","gradedBy","gradedDate","aiAssisted","rubricIntegrated","rubricFormData","setRubricFormData","assignmentInfo","title","description","weight","passingThreshold","totalPoints","rubricLevels","color","multiplier","criteria","levels","feedbackLibrary","pointingSystem","reversedOrder","expandedFeedback","modalEdit","show","content","field","onSave","initializeAIPromptFormData","assignmentType","programType","programLevel","subjectArea","assignmentDescription","weightPercentage","numCriteria","criteriaType","userCriteria","learningObjectives","studentPopulation","timeFrameNumber","timeFrameUnit","specialConsiderations","updateAIPromptFormData","value","prev","clearAIPromptFormData","initializeAssignmentPromptFormData","assignmentTitle","assignmentNumber","courseCode","rationale","clos","number","text","type","directions","gradingMethod","gradingDetails","submissionFolder","specialInstructions","updateAssignmentPromptFormData","clearAssignmentPromptFormData","updateStudentInfo","studentInfo","updateCourseInfo","courseInfo","console","log","updateAssignmentInfo","updateFeedbackInfo","feedbackInfo","updateAttachments","updateVideoLinks","updateLatePolicyInfo","latePolicyInfo","updateRubricGrading","updateMetadata","saveDraft","studentId","gradingData","draftData","savedAt","Date","toISOString","status","hasDraft","undefined","loadDraft","draft","saveFinalGrade","data","updated","studentIndex","students","findIndex","s","updatedProgress","gradingProgress","lastModified","gradeType","loadFinalGrade","getGradeStatus","nextStudentInSession","saveType","currentIndex","length","nextIndex","nextStudent","previousStudentInSession","prevIndex","prevStudent","initializeGradingSession","classListData","_classListData$studen","warn","courseMetadata","firstStudent","session","_sharedCourseDetails$","courseName","professors","original","mapped","clearGradingFormData","clearRubricFormData","finalizeGrade","unlockGrade","finalData","updateGradingSession","sessionUpdate","clearSharedRubric","transferRubricToGrading","transferRubricToGradingWithDetails","exportSession","sessionData","dataStr","JSON","stringify","dataBlob","Blob","url","URL","createObjectURL","link","document","createElement","href","timestamp","replace","slice","download","body","appendChild","click","removeChild","revokeObjectURL","importSession","jsonContent","parse","alert","error","clearAllData","persistentFormData","updatePersistentFormData","setGradingData","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/local clones/rubric-creation-app/src/components/SharedContext.js"],"sourcesContent":["// Updated SharedContext.js with Enhanced Draft/Final Grade Management + AI Prompt Generator + Assignment Prompt Generator\r\nimport React, { createContext, useContext, useState, useCallback } from 'react';\r\n\r\nconst AssessmentContext = createContext();\r\n\r\nexport const useAssessment = () => {\r\n    const context = useContext(AssessmentContext);\r\n    if (!context) {\r\n        throw new Error('useAssessment must be used within AssessmentProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\nexport const AssessmentProvider = ({ children }) => {\r\n    // Shared rubric state\r\n    const [sharedRubric, setSharedRubric] = useState(null);\r\n    const [sharedCourseDetails, setSharedCourseDetails] = useState(null);\r\n    const [activeTab, setActiveTab] = useState('assignment-prompt-generator'); // Updated to start with assignment prompt generator\r\n\r\n    // AI Prompt Generator state (for rubrics) - UPDATED with weight percentage\r\n    const [aiPromptFormData, setAIPromptFormData] = useState(null);\r\n\r\n    // NEW: Assignment Prompt Generator state\r\n    const [assignmentPromptFormData, setAssignmentPromptFormData] = useState(null);\r\n\r\n    // Class list and student management\r\n    const [classList, setClassList] = useState(null);\r\n    const [currentStudent, setCurrentStudent] = useState(null);\r\n\r\n    // ENHANCED: Separate storage for draft and final grades\r\n    const [drafts, setDrafts] = useState({});\r\n    const [finalGrades, setFinalGrades] = useState({});\r\n\r\n    // Batch grading session state\r\n    const [gradingSession, setGradingSession] = useState({\r\n        active: false,\r\n        startTime: null,\r\n        gradedStudents: [],\r\n        totalStudents: 0,\r\n        currentStudent: null,\r\n        currentStudentIndex: 0\r\n    });\r\n\r\n    // Form data states\r\n    const [gradingFormData, setGradingFormData] = useState({\r\n        student: { name: '', id: '', email: '' },\r\n        course: { code: '', name: '', instructor: '', term: '' },\r\n        assignment: { name: '', dueDate: '', maxPoints: 100 },\r\n        feedback: { general: '', strengths: '', improvements: '' },\r\n        attachments: [],\r\n        videoLinks: [],\r\n        latePolicy: { level: 'none', penaltyApplied: false },\r\n        rubricGrading: {},\r\n        metadata: {\r\n            gradedBy: '',\r\n            gradedDate: '',\r\n            aiAssisted: false,\r\n            rubricIntegrated: false\r\n        }\r\n    });\r\n\r\n    const [rubricFormData, setRubricFormData] = useState({\r\n        assignmentInfo: {\r\n            title: '',\r\n            description: '',\r\n            weight: 25,\r\n            passingThreshold: 60,\r\n            totalPoints: 100\r\n        },\r\n        rubricLevels: [\r\n            { level: 'incomplete', name: 'Incomplete', description: 'No submission or unusable', color: '#95a5a6', multiplier: 0 },\r\n            { level: 'unacceptable', name: 'Unacceptable', description: 'Below minimum standards', color: '#e74c3c', multiplier: 0.3 },\r\n            { level: 'developing', name: 'Developing', description: 'Approaching standards', color: '#f39c12', multiplier: 0.55 },\r\n            { level: 'acceptable', name: 'Acceptable (PASS)', description: 'Meets minimum standards', color: '#27ae60', multiplier: 0.7 },\r\n            { level: 'emerging', name: 'Emerging', description: 'Above standard expectations', color: '#2980b9', multiplier: 0.82 },\r\n            { level: 'accomplished', name: 'Accomplished', description: 'Strong professional quality', color: '#16a085', multiplier: 0.92 },\r\n            { level: 'exceptional', name: 'Exceptional', description: 'Outstanding professional quality', color: '#8e44ad', multiplier: 1.0 }\r\n        ],\r\n        criteria: [\r\n            {\r\n                id: 'criterion-1',\r\n                name: '',\r\n                description: '',\r\n                maxPoints: 20,\r\n                weight: 20,\r\n                levels: {},\r\n                feedbackLibrary: {\r\n                    strengths: [],\r\n                    improvements: [],\r\n                    general: []\r\n                }\r\n            }\r\n        ],\r\n        pointingSystem: 'multiplier',\r\n        reversedOrder: false,\r\n        expandedFeedback: {},\r\n        modalEdit: { show: false, content: '', field: null, onSave: null }\r\n    });\r\n\r\n    // AI Prompt Generator functions (for rubrics) - UPDATED with weight percentage\r\n    const initializeAIPromptFormData = useCallback(() => {\r\n        setAIPromptFormData({\r\n            assignmentType: '',\r\n            programType: '',\r\n            programLevel: '',\r\n            subjectArea: '',\r\n            assignmentDescription: '',\r\n            totalPoints: '100',\r\n            weightPercentage: '', // NEW: Add weight percentage field\r\n            numCriteria: '4',\r\n            criteriaType: 'ai-suggested',\r\n            userCriteria: '',\r\n            learningObjectives: '',\r\n            studentPopulation: '',\r\n            timeFrameNumber: '',\r\n            timeFrameUnit: 'weeks',\r\n            specialConsiderations: ''\r\n        });\r\n    }, []);\r\n\r\n    const updateAIPromptFormData = useCallback((field, value) => {\r\n        setAIPromptFormData(prev => ({\r\n            ...prev,\r\n            [field]: value\r\n        }));\r\n    }, []);\r\n\r\n    const clearAIPromptFormData = useCallback(() => {\r\n        setAIPromptFormData(null);\r\n    }, []);\r\n\r\n    // NEW: Assignment Prompt Generator functions\r\n    const initializeAssignmentPromptFormData = useCallback(() => {\r\n        setAssignmentPromptFormData({\r\n            assignmentTitle: '',\r\n            assignmentNumber: '',\r\n            weightPercentage: '',\r\n            courseCode: '',\r\n            programLevel: '',\r\n            subjectArea: '',\r\n            assignmentDescription: '',\r\n            rationale: 'This assignment will evaluate the following Course Learning Outcomes:',\r\n            clos: [\r\n                { id: 1, number: '1', text: '', type: 'CLO' },\r\n                { id: 2, number: '2', text: '', type: 'CLO' },\r\n                { id: 3, number: '3', text: '', type: 'CLO' },\r\n                { id: 4, number: '4', text: '', type: 'CLO' }\r\n            ],\r\n            directions: '',\r\n            gradingMethod: 'rubric',\r\n            gradingDetails: '',\r\n            dueDate: '',\r\n            submissionFolder: 'Assignment X',\r\n            specialInstructions: ''\r\n        });\r\n    }, []);\r\n\r\n    const updateAssignmentPromptFormData = useCallback((field, value) => {\r\n        setAssignmentPromptFormData(prev => ({\r\n            ...prev,\r\n            [field]: value\r\n        }));\r\n    }, []);\r\n\r\n    const clearAssignmentPromptFormData = useCallback(() => {\r\n        setAssignmentPromptFormData(null);\r\n    }, []);\r\n\r\n    // Form update functions\r\n    const updateStudentInfo = useCallback((studentInfo) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            student: { ...prev.student, ...studentInfo }\r\n        }));\r\n    }, []);\r\n\r\n    const updateCourseInfo = useCallback((courseInfo) => {\r\n        console.log('ðŸ“ Updating course info:', courseInfo);\r\n\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            course: {\r\n                ...prev.course,\r\n                ...courseInfo\r\n            }\r\n        }));\r\n    }, []);\r\n\r\n    const updateAssignmentInfo = useCallback((assignmentInfo) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            assignment: { ...prev.assignment, ...assignmentInfo }\r\n        }));\r\n    }, []);\r\n\r\n    const updateFeedbackInfo = useCallback((feedbackInfo) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            feedback: { ...prev.feedback, ...feedbackInfo }\r\n        }));\r\n    }, []);\r\n\r\n    const updateAttachments = useCallback((attachments) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            attachments\r\n        }));\r\n    }, []);\r\n\r\n    const updateVideoLinks = useCallback((videoLinks) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            videoLinks\r\n        }));\r\n    }, []);\r\n\r\n    const updateLatePolicyInfo = useCallback((latePolicyInfo) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            latePolicy: { ...prev.latePolicy, ...latePolicyInfo }\r\n        }));\r\n    }, []);\r\n\r\n    const updateRubricGrading = useCallback((rubricGrading) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            rubricGrading\r\n        }));\r\n    }, []);\r\n\r\n    const updateMetadata = useCallback((metadata) => {\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            metadata: { ...prev.metadata, ...metadata }\r\n        }));\r\n    }, []);\r\n\r\n    // ENHANCED: Draft and Final Grade Management\r\n    const saveDraft = useCallback((studentId, gradingData) => {\r\n        const draftData = {\r\n            ...gradingData,\r\n            metadata: {\r\n                ...gradingData.metadata,\r\n                savedAt: new Date().toISOString(),\r\n                status: 'draft'\r\n            }\r\n        };\r\n\r\n        setDrafts(prev => ({\r\n            ...prev,\r\n            [studentId]: draftData\r\n        }));\r\n\r\n        console.log('âœ… Draft saved for student:', studentId);\r\n        return true;\r\n    }, []);\r\n\r\n    const hasDraft = useCallback((studentId) => {\r\n        return drafts[studentId] !== undefined;\r\n    }, [drafts]);\r\n\r\n    const loadDraft = useCallback((studentId) => {\r\n        const draft = drafts[studentId];\r\n        if (draft) {\r\n            console.log('ðŸ“ Draft loaded for student:', studentId);\r\n            return draft;\r\n        }\r\n        console.log('âš ï¸ No draft found for student:', studentId);\r\n        return null;\r\n    }, [drafts]);\r\n\r\n    const saveFinalGrade = useCallback((studentId, data) => {\r\n        console.log('âœ… Saving final grade for student:', studentId);\r\n        setFinalGrades(prev => ({ ...prev, [studentId]: data }));\r\n\r\n        // Remove from drafts once finalized\r\n        setDrafts(prev => {\r\n            const updated = { ...prev };\r\n            delete updated[studentId];\r\n            return updated;\r\n        });\r\n\r\n        // Update class list progress\r\n        if (classList) {\r\n            const studentIndex = classList.students.findIndex(s => s.id === studentId);\r\n            if (studentIndex >= 0) {\r\n                const updatedProgress = [...classList.gradingProgress];\r\n                updatedProgress[studentIndex] = {\r\n                    ...updatedProgress[studentIndex],\r\n                    status: 'completed_final',\r\n                    lastModified: new Date().toISOString(),\r\n                    gradeType: 'final'\r\n                };\r\n                setClassList(prev => ({\r\n                    ...prev,\r\n                    gradingProgress: updatedProgress\r\n                }));\r\n            }\r\n        }\r\n    }, [classList]);\r\n\r\n    const loadFinalGrade = useCallback((studentId) => {\r\n        return finalGrades[studentId] || null;\r\n    }, [finalGrades]);\r\n\r\n    const getGradeStatus = useCallback((studentId) => {\r\n        if (finalGrades[studentId]) return 'final';\r\n        if (drafts[studentId]) return 'draft';\r\n        return 'not_started';\r\n    }, [finalGrades, drafts]);\r\n\r\n    // Navigation helpers for grading sessions\r\n    const nextStudentInSession = useCallback((saveType = 'draft') => {\r\n        if (!gradingSession?.active || !classList) return false;\r\n\r\n        const currentIndex = gradingSession.currentStudentIndex;\r\n        const students = classList.students;\r\n\r\n        if (currentIndex < students.length - 1) {\r\n            const nextIndex = currentIndex + 1;\r\n            const nextStudent = students[nextIndex];\r\n\r\n            setGradingSession(prev => ({\r\n                ...prev,\r\n                currentStudentIndex: nextIndex,\r\n                currentStudent: nextStudent,\r\n                gradedStudents: [...prev.gradedStudents, currentStudent.id]\r\n            }));\r\n\r\n            setCurrentStudent(nextStudent);\r\n            return true;\r\n        }\r\n\r\n        // End of session\r\n        setGradingSession(prev => ({\r\n            ...prev,\r\n            active: false,\r\n            gradedStudents: [...prev.gradedStudents, currentStudent.id]\r\n        }));\r\n        return false;\r\n    }, [gradingSession, classList, currentStudent]);\r\n\r\n    const previousStudentInSession = useCallback(() => {\r\n        if (!gradingSession?.active || !classList) return false;\r\n\r\n        const currentIndex = gradingSession.currentStudentIndex;\r\n        if (currentIndex > 0) {\r\n            const prevIndex = currentIndex - 1;\r\n            const prevStudent = classList.students[prevIndex];\r\n\r\n            setGradingSession(prev => ({\r\n                ...prev,\r\n                currentStudentIndex: prevIndex,\r\n                currentStudent: prevStudent\r\n            }));\r\n\r\n            setCurrentStudent(prevStudent);\r\n            return true;\r\n        }\r\n        return false;\r\n    }, [gradingSession, classList]);\r\n\r\n    // **FIXED: Enhanced initializeGradingSession function**\r\n    const initializeGradingSession = useCallback((classListData) => {\r\n        // 1. Guard against missing or empty class list\r\n        if (!classListData || !classListData.students?.length) {\r\n            console.warn('âš ï¸ Cannot initialize grading session: No students found');\r\n            return false;\r\n        }\r\n\r\n        // 2. Extract the students array and the imported course metadata\r\n        const { students, courseMetadata } = classListData;\r\n\r\n        // 3. Pick the first student to start the session\r\n        const firstStudent = students[0];\r\n\r\n        // 4. Build and set the grading session state\r\n        const session = {\r\n            active: true,\r\n            startTime: new Date().toISOString(),\r\n            gradedStudents: [],\r\n            totalStudents: students.length,\r\n            currentStudent: firstStudent,\r\n            currentStudentIndex: 0\r\n        };\r\n        setGradingSession(session);\r\n        setCurrentStudent(firstStudent);\r\n\r\n        // 5. ENHANCED: Prefill the grading form with comprehensive fallback logic\r\n        setGradingFormData(prev => {\r\n            const courseInfo = {\r\n                code: courseMetadata?.courseCode || prev.course.code || '',\r\n                name: courseMetadata?.courseName || prev.course.name || '',\r\n                // FIXED: Handle both instructor and professors fields with fallbacks\r\n                instructor: courseMetadata?.instructor ||\r\n                    courseMetadata?.professors ||\r\n                    prev.course.instructor || '',\r\n                term: courseMetadata?.term || prev.course.term || ''\r\n            };\r\n\r\n            console.log('ðŸ”„ Course metadata mapping:', {\r\n                original: courseMetadata,\r\n                mapped: courseInfo\r\n            });\r\n\r\n            return {\r\n                ...prev,\r\n                student: {\r\n                    name: firstStudent.name,\r\n                    id: firstStudent.id,\r\n                    email: firstStudent.email\r\n                },\r\n                course: courseInfo,\r\n                assignment: sharedCourseDetails?.assignment ?? prev.assignment\r\n            };\r\n        });\r\n\r\n        console.log(`ðŸš€ Grading session started for ${students.length} students with course info:`, {\r\n            code: courseMetadata?.courseCode,\r\n            name: courseMetadata?.courseName,\r\n            instructor: courseMetadata?.instructor || courseMetadata?.professors,\r\n            term: courseMetadata?.term\r\n        });\r\n\r\n        return true;\r\n    }, [sharedCourseDetails]);\r\n\r\n    const clearGradingFormData = useCallback(() => {\r\n        setGradingFormData({\r\n            student: { name: '', id: '', email: '' },\r\n            course: { code: '', name: '', instructor: '', term: '' },\r\n            assignment: { name: '', dueDate: '', maxPoints: 100 },\r\n            feedback: { general: '', strengths: '', improvements: '' },\r\n            attachments: [],\r\n            videoLinks: [],\r\n            latePolicy: { level: 'none', penaltyApplied: false },\r\n            rubricGrading: {},\r\n            metadata: {\r\n                gradedBy: '',\r\n                gradedDate: '',\r\n                aiAssisted: false,\r\n                rubricIntegrated: false\r\n            }\r\n        });\r\n    }, []);\r\n\r\n    // FIXED: The two console.log statements that were here have been removed.\r\n    // They were out of scope and causing \"not defined\" errors.\r\n\r\n    const clearRubricFormData = useCallback(() => {\r\n        setRubricFormData({\r\n            assignmentInfo: {\r\n                title: '',\r\n                description: '',\r\n                weight: 25,\r\n                passingThreshold: 60,\r\n                totalPoints: 100\r\n            },\r\n            rubricLevels: [\r\n                { level: 'incomplete', name: 'Incomplete', description: 'No submission or unusable', color: '#95a5a6', multiplier: 0 },\r\n                { level: 'unacceptable', name: 'Unacceptable', description: 'Below minimum standards', color: '#e74c3c', multiplier: 0.3 },\r\n                { level: 'developing', name: 'Developing', description: 'Approaching standards', color: '#f39c12', multiplier: 0.55 },\r\n                { level: 'acceptable', name: 'Acceptable (PASS)', description: 'Meets minimum standards', color: '#27ae60', multiplier: 0.7 },\r\n                { level: 'emerging', name: 'Emerging', description: 'Above standard expectations', color: '#2980b9', multiplier: 0.82 },\r\n                { level: 'accomplished', name: 'Accomplished', description: 'Strong professional quality', color: '#16a085', multiplier: 0.92 },\r\n                { level: 'exceptional', name: 'Exceptional', description: 'Outstanding professional quality', color: '#8e44ad', multiplier: 1.0 }\r\n            ],\r\n            criteria: [\r\n                {\r\n                    id: 'criterion-1',\r\n                    name: '',\r\n                    description: '',\r\n                    maxPoints: 20,\r\n                    weight: 20,\r\n                    levels: {},\r\n                    feedbackLibrary: {\r\n                        strengths: [],\r\n                        improvements: [],\r\n                        general: []\r\n                    }\r\n                }\r\n            ],\r\n            pointingSystem: 'multiplier',\r\n            reversedOrder: false,\r\n            expandedFeedback: {},\r\n            modalEdit: { show: false, content: '', field: null, onSave: null }\r\n        });\r\n    }, []);\r\n\r\n    // Finalize a draft grade\r\n    const finalizeGrade = useCallback((studentId) => {\r\n        const draftData = drafts[studentId];\r\n        if (draftData) {\r\n            saveFinalGrade(studentId, draftData);\r\n            console.log('ðŸŽ¯ Finalized draft for student:', studentId);\r\n        }\r\n    }, [drafts, saveFinalGrade]);\r\n\r\n    // Unlock a final grade (convert back to draft)\r\n    const unlockGrade = useCallback((studentId) => {\r\n        const finalData = finalGrades[studentId];\r\n        if (finalData) {\r\n            // Move from final back to draft\r\n            setDrafts(prev => ({ ...prev, [studentId]: finalData }));\r\n            setFinalGrades(prev => {\r\n                const updated = { ...prev };\r\n                delete updated[studentId];\r\n                return updated;\r\n            });\r\n\r\n            // Update class list progress\r\n            if (classList) {\r\n                const studentIndex = classList.students.findIndex(s => s.id === studentId);\r\n                if (studentIndex >= 0) {\r\n                    const updatedProgress = [...classList.gradingProgress];\r\n                    updatedProgress[studentIndex] = {\r\n                        ...updatedProgress[studentIndex],\r\n                        status: 'completed_draft',\r\n                        lastModified: new Date().toISOString(),\r\n                        gradeType: 'draft'\r\n                    };\r\n                    setClassList(prev => ({\r\n                        ...prev,\r\n                        gradingProgress: updatedProgress\r\n                    }));\r\n                }\r\n            }\r\n\r\n            console.log('ðŸ”“ Unlocked final grade for student:', studentId);\r\n        }\r\n    }, [finalGrades, classList]);\r\n\r\n    // FIXED: Added definition for updateGradingSession\r\n    const updateGradingSession = useCallback((sessionUpdate) => {\r\n        setGradingSession(prev => ({ ...prev, ...sessionUpdate }));\r\n    }, []);\r\n\r\n    // FIXED: Added definition for clearSharedRubric\r\n    const clearSharedRubric = useCallback(() => {\r\n        setSharedRubric(null);\r\n    }, []);\r\n\r\n    // FIXED: Added definition for transferRubricToGrading\r\n    const transferRubricToGrading = useCallback(() => {\r\n        if (!sharedRubric) return;\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            metadata: {\r\n                ...prev.metadata,\r\n                rubricIntegrated: true\r\n            }\r\n        }));\r\n    }, [sharedRubric]);\r\n\r\n    // FIXED: Added definition for transferRubricToGradingWithDetails\r\n    const transferRubricToGradingWithDetails = useCallback(() => {\r\n        if (!sharedRubric) return;\r\n        // This is a placeholder for more complex logic.\r\n        // For now, it copies the assignment title and marks rubric as integrated.\r\n        setGradingFormData(prev => ({\r\n            ...prev,\r\n            assignment: {\r\n                ...prev.assignment,\r\n                name: sharedRubric.assignmentInfo.title || prev.assignment.name\r\n            },\r\n            metadata: {\r\n                ...prev.metadata,\r\n                rubricIntegrated: true\r\n            }\r\n        }));\r\n    }, [sharedRubric]);\r\n\r\n\r\n    // UPDATED: Export Session Function with AI Prompt Data and Assignment Prompt Data\r\n    const exportSession = useCallback(() => {\r\n        const sessionData = {\r\n            sharedRubric,\r\n            classList,\r\n            drafts,\r\n            finalGrades,\r\n            activeTab,\r\n            currentStudent,\r\n            gradingSession,\r\n            sharedCourseDetails,\r\n            aiPromptFormData, // AI Rubric prompt data\r\n            assignmentPromptFormData, // NEW: Assignment prompt data\r\n        };\r\n        const dataStr = JSON.stringify(sessionData, null, 2);\r\n        const dataBlob = new Blob([dataStr], { type: 'application/json' });\r\n        const url = URL.createObjectURL(dataBlob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        const timestamp = new Date().toISOString().replace(/:/g, '-').slice(0, 19);\r\n        link.download = `grading-session-${timestamp}.json`;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        URL.revokeObjectURL(url);\r\n    }, [sharedRubric, classList, drafts, finalGrades, activeTab, currentStudent, gradingSession, sharedCourseDetails, aiPromptFormData, assignmentPromptFormData]);\r\n\r\n    // UPDATED: Import Session Function with AI Prompt Data and Assignment Prompt Data\r\n    const importSession = useCallback((jsonContent) => {\r\n        try {\r\n            const sessionData = JSON.parse(jsonContent);\r\n            if (sessionData && typeof sessionData === 'object') {\r\n                setSharedRubric(sessionData.sharedRubric || null);\r\n                setClassList(sessionData.classList || null);\r\n                setDrafts(sessionData.drafts || {});\r\n                setFinalGrades(sessionData.finalGrades || {});\r\n                setActiveTab(sessionData.activeTab || 'assignment-prompt-generator');\r\n                setCurrentStudent(sessionData.currentStudent || null);\r\n                setGradingSession(sessionData.gradingSession || { active: false });\r\n                setSharedCourseDetails(sessionData.sharedCourseDetails || null);\r\n                setAIPromptFormData(sessionData.aiPromptFormData || null); // AI Rubric prompt data\r\n                setAssignmentPromptFormData(sessionData.assignmentPromptFormData || null); // NEW: Assignment prompt data\r\n                alert('Session loaded successfully!');\r\n            } else {\r\n                throw new Error('Invalid file format.');\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to import session:\", error);\r\n            alert(\"Error: Could not load the session file. Please ensure it's a valid session file.\");\r\n        }\r\n    }, []);\r\n\r\n    const clearAllData = useCallback(() => {\r\n        setSharedRubric(null);\r\n        clearGradingFormData();\r\n        clearRubricFormData();\r\n        clearAIPromptFormData(); // Clear AI Rubric prompt data\r\n        clearAssignmentPromptFormData(); // NEW: Clear assignment prompt data\r\n    }, [clearGradingFormData, clearRubricFormData, clearAIPromptFormData, clearAssignmentPromptFormData]);\r\n\r\n    const persistentFormData = gradingFormData;\r\n    const updatePersistentFormData = setGradingFormData;\r\n\r\n    const value = {\r\n        // Shared state\r\n        sharedRubric,\r\n        setSharedRubric,\r\n        sharedCourseDetails,\r\n        setSharedCourseDetails,\r\n\r\n        // Navigation\r\n        activeTab,\r\n        setActiveTab,\r\n\r\n        // AI Prompt Generator (for rubrics)\r\n        aiPromptFormData,\r\n        updateAIPromptFormData,\r\n        initializeAIPromptFormData,\r\n        clearAIPromptFormData,\r\n\r\n        // NEW: Assignment Prompt Generator\r\n        assignmentPromptFormData,\r\n        updateAssignmentPromptFormData,\r\n        initializeAssignmentPromptFormData,\r\n        clearAssignmentPromptFormData,\r\n\r\n        // Grading form data\r\n        gradingData: gradingFormData,\r\n        setGradingData: setGradingFormData,\r\n        clearGradingFormData,\r\n        persistentFormData,\r\n        updatePersistentFormData,\r\n\r\n        // Form update functions\r\n        updateStudentInfo,\r\n        updateCourseInfo,\r\n        updateAssignmentInfo,\r\n        updateFeedbackInfo,\r\n        updateAttachments,\r\n        updateVideoLinks,\r\n        updateLatePolicyInfo,\r\n        updateRubricGrading,\r\n        updateMetadata,\r\n\r\n        // Draft and Final Grade Management - ENHANCED\r\n        drafts,\r\n        finalGrades,\r\n        saveDraft,\r\n        loadDraft,\r\n        saveFinalGrade,\r\n        loadFinalGrade,\r\n        getGradeStatus,\r\n        hasDraft,\r\n        finalizeGrade,\r\n        unlockGrade,\r\n\r\n        // Class management\r\n        classList,\r\n        setClassList,\r\n        currentStudent,\r\n        setCurrentStudent,\r\n\r\n        // Grading session\r\n        gradingSession,\r\n        setGradingSession,\r\n        nextStudentInSession,\r\n        previousStudentInSession,\r\n        updateGradingSession, // Now defined\r\n        initializeGradingSession,\r\n\r\n        // Rubric form data\r\n        rubricFormData,\r\n        setRubricFormData,\r\n\r\n        // Utility functions\r\n        transferRubricToGrading, // Now defined\r\n        transferRubricToGradingWithDetails, // Now defined\r\n        clearSharedRubric, // Now defined\r\n        clearRubricFormData,\r\n        clearAllData,\r\n\r\n        // Session management\r\n        exportSession,\r\n        importSession\r\n    };\r\n\r\n    return (\r\n        <AssessmentContext.Provider value={value}>\r\n            {children}\r\n        </AssessmentContext.Provider>\r\n    );\r\n};\r\n\r\nexport default AssessmentProvider;"],"mappings":";;;AAAA;AACA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEhF,MAAMC,iBAAiB,gBAAGN,aAAa,CAAC,CAAC;AAEzC,OAAO,MAAMO,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC/B,MAAMC,OAAO,GAAGR,UAAU,CAACK,iBAAiB,CAAC;EAC7C,IAAI,CAACG,OAAO,EAAE;IACV,MAAM,IAAIC,KAAK,CAAC,sDAAsD,CAAC;EAC3E;EACA,OAAOD,OAAO;AAClB,CAAC;AAACD,EAAA,CANWD,aAAa;AAQ1B,OAAO,MAAMI,kBAAkB,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAChD;EACA,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACc,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EACpE,MAAM,CAACgB,SAAS,EAAEC,YAAY,CAAC,GAAGjB,QAAQ,CAAC,6BAA6B,CAAC,CAAC,CAAC;;EAE3E;EACA,MAAM,CAACkB,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;;EAE9D;EACA,MAAM,CAACoB,wBAAwB,EAAEC,2BAA2B,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;;EAE9E;EACA,MAAM,CAACsB,SAAS,EAAEC,YAAY,CAAC,GAAGvB,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACwB,cAAc,EAAEC,iBAAiB,CAAC,GAAGzB,QAAQ,CAAC,IAAI,CAAC;;EAE1D;EACA,MAAM,CAAC0B,MAAM,EAAEC,SAAS,CAAC,GAAG3B,QAAQ,CAAC,CAAC,CAAC,CAAC;EACxC,MAAM,CAAC4B,WAAW,EAAEC,cAAc,CAAC,GAAG7B,QAAQ,CAAC,CAAC,CAAC,CAAC;;EAElD;EACA,MAAM,CAAC8B,cAAc,EAAEC,iBAAiB,CAAC,GAAG/B,QAAQ,CAAC;IACjDgC,MAAM,EAAE,KAAK;IACbC,SAAS,EAAE,IAAI;IACfC,cAAc,EAAE,EAAE;IAClBC,aAAa,EAAE,CAAC;IAChBX,cAAc,EAAE,IAAI;IACpBY,mBAAmB,EAAE;EACzB,CAAC,CAAC;;EAEF;EACA,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGtC,QAAQ,CAAC;IACnDuC,OAAO,EAAE;MAAEC,IAAI,EAAE,EAAE;MAAEC,EAAE,EAAE,EAAE;MAAEC,KAAK,EAAE;IAAG,CAAC;IACxCC,MAAM,EAAE;MAAEC,IAAI,EAAE,EAAE;MAAEJ,IAAI,EAAE,EAAE;MAAEK,UAAU,EAAE,EAAE;MAAEC,IAAI,EAAE;IAAG,CAAC;IACxDC,UAAU,EAAE;MAAEP,IAAI,EAAE,EAAE;MAAEQ,OAAO,EAAE,EAAE;MAAEC,SAAS,EAAE;IAAI,CAAC;IACrDC,QAAQ,EAAE;MAAEC,OAAO,EAAE,EAAE;MAAEC,SAAS,EAAE,EAAE;MAAEC,YAAY,EAAE;IAAG,CAAC;IAC1DC,WAAW,EAAE,EAAE;IACfC,UAAU,EAAE,EAAE;IACdC,UAAU,EAAE;MAAEC,KAAK,EAAE,MAAM;MAAEC,cAAc,EAAE;IAAM,CAAC;IACpDC,aAAa,EAAE,CAAC,CAAC;IACjBC,QAAQ,EAAE;MACNC,QAAQ,EAAE,EAAE;MACZC,UAAU,EAAE,EAAE;MACdC,UAAU,EAAE,KAAK;MACjBC,gBAAgB,EAAE;IACtB;EACJ,CAAC,CAAC;EAEF,MAAM,CAACC,cAAc,EAAEC,iBAAiB,CAAC,GAAGlE,QAAQ,CAAC;IACjDmE,cAAc,EAAE;MACZC,KAAK,EAAE,EAAE;MACTC,WAAW,EAAE,EAAE;MACfC,MAAM,EAAE,EAAE;MACVC,gBAAgB,EAAE,EAAE;MACpBC,WAAW,EAAE;IACjB,CAAC;IACDC,YAAY,EAAE,CACV;MAAEhB,KAAK,EAAE,YAAY;MAAEjB,IAAI,EAAE,YAAY;MAAE6B,WAAW,EAAE,2BAA2B;MAAEK,KAAK,EAAE,SAAS;MAAEC,UAAU,EAAE;IAAE,CAAC,EACtH;MAAElB,KAAK,EAAE,cAAc;MAAEjB,IAAI,EAAE,cAAc;MAAE6B,WAAW,EAAE,yBAAyB;MAAEK,KAAK,EAAE,SAAS;MAAEC,UAAU,EAAE;IAAI,CAAC,EAC1H;MAAElB,KAAK,EAAE,YAAY;MAAEjB,IAAI,EAAE,YAAY;MAAE6B,WAAW,EAAE,uBAAuB;MAAEK,KAAK,EAAE,SAAS;MAAEC,UAAU,EAAE;IAAK,CAAC,EACrH;MAAElB,KAAK,EAAE,YAAY;MAAEjB,IAAI,EAAE,mBAAmB;MAAE6B,WAAW,EAAE,yBAAyB;MAAEK,KAAK,EAAE,SAAS;MAAEC,UAAU,EAAE;IAAI,CAAC,EAC7H;MAAElB,KAAK,EAAE,UAAU;MAAEjB,IAAI,EAAE,UAAU;MAAE6B,WAAW,EAAE,6BAA6B;MAAEK,KAAK,EAAE,SAAS;MAAEC,UAAU,EAAE;IAAK,CAAC,EACvH;MAAElB,KAAK,EAAE,cAAc;MAAEjB,IAAI,EAAE,cAAc;MAAE6B,WAAW,EAAE,6BAA6B;MAAEK,KAAK,EAAE,SAAS;MAAEC,UAAU,EAAE;IAAK,CAAC,EAC/H;MAAElB,KAAK,EAAE,aAAa;MAAEjB,IAAI,EAAE,aAAa;MAAE6B,WAAW,EAAE,kCAAkC;MAAEK,KAAK,EAAE,SAAS;MAAEC,UAAU,EAAE;IAAI,CAAC,CACpI;IACDC,QAAQ,EAAE,CACN;MACInC,EAAE,EAAE,aAAa;MACjBD,IAAI,EAAE,EAAE;MACR6B,WAAW,EAAE,EAAE;MACfpB,SAAS,EAAE,EAAE;MACbqB,MAAM,EAAE,EAAE;MACVO,MAAM,EAAE,CAAC,CAAC;MACVC,eAAe,EAAE;QACb1B,SAAS,EAAE,EAAE;QACbC,YAAY,EAAE,EAAE;QAChBF,OAAO,EAAE;MACb;IACJ,CAAC,CACJ;IACD4B,cAAc,EAAE,YAAY;IAC5BC,aAAa,EAAE,KAAK;IACpBC,gBAAgB,EAAE,CAAC,CAAC;IACpBC,SAAS,EAAE;MAAEC,IAAI,EAAE,KAAK;MAAEC,OAAO,EAAE,EAAE;MAAEC,KAAK,EAAE,IAAI;MAAEC,MAAM,EAAE;IAAK;EACrE,CAAC,CAAC;;EAEF;EACA,MAAMC,0BAA0B,GAAGtF,WAAW,CAAC,MAAM;IACjDkB,mBAAmB,CAAC;MAChBqE,cAAc,EAAE,EAAE;MAClBC,WAAW,EAAE,EAAE;MACfC,YAAY,EAAE,EAAE;MAChBC,WAAW,EAAE,EAAE;MACfC,qBAAqB,EAAE,EAAE;MACzBpB,WAAW,EAAE,KAAK;MAClBqB,gBAAgB,EAAE,EAAE;MAAE;MACtBC,WAAW,EAAE,GAAG;MAChBC,YAAY,EAAE,cAAc;MAC5BC,YAAY,EAAE,EAAE;MAChBC,kBAAkB,EAAE,EAAE;MACtBC,iBAAiB,EAAE,EAAE;MACrBC,eAAe,EAAE,EAAE;MACnBC,aAAa,EAAE,OAAO;MACtBC,qBAAqB,EAAE;IAC3B,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,sBAAsB,GAAGrG,WAAW,CAAC,CAACoF,KAAK,EAAEkB,KAAK,KAAK;IACzDpF,mBAAmB,CAACqF,IAAI,KAAK;MACzB,GAAGA,IAAI;MACP,CAACnB,KAAK,GAAGkB;IACb,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAME,qBAAqB,GAAGxG,WAAW,CAAC,MAAM;IAC5CkB,mBAAmB,CAAC,IAAI,CAAC;EAC7B,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMuF,kCAAkC,GAAGzG,WAAW,CAAC,MAAM;IACzDoB,2BAA2B,CAAC;MACxBsF,eAAe,EAAE,EAAE;MACnBC,gBAAgB,EAAE,EAAE;MACpBf,gBAAgB,EAAE,EAAE;MACpBgB,UAAU,EAAE,EAAE;MACdnB,YAAY,EAAE,EAAE;MAChBC,WAAW,EAAE,EAAE;MACfC,qBAAqB,EAAE,EAAE;MACzBkB,SAAS,EAAE,uEAAuE;MAClFC,IAAI,EAAE,CACF;QAAEtE,EAAE,EAAE,CAAC;QAAEuE,MAAM,EAAE,GAAG;QAAEC,IAAI,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAM,CAAC,EAC7C;QAAEzE,EAAE,EAAE,CAAC;QAAEuE,MAAM,EAAE,GAAG;QAAEC,IAAI,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAM,CAAC,EAC7C;QAAEzE,EAAE,EAAE,CAAC;QAAEuE,MAAM,EAAE,GAAG;QAAEC,IAAI,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAM,CAAC,EAC7C;QAAEzE,EAAE,EAAE,CAAC;QAAEuE,MAAM,EAAE,GAAG;QAAEC,IAAI,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAM,CAAC,CAChD;MACDC,UAAU,EAAE,EAAE;MACdC,aAAa,EAAE,QAAQ;MACvBC,cAAc,EAAE,EAAE;MAClBrE,OAAO,EAAE,EAAE;MACXsE,gBAAgB,EAAE,cAAc;MAChCC,mBAAmB,EAAE;IACzB,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,8BAA8B,GAAGvH,WAAW,CAAC,CAACoF,KAAK,EAAEkB,KAAK,KAAK;IACjElF,2BAA2B,CAACmF,IAAI,KAAK;MACjC,GAAGA,IAAI;MACP,CAACnB,KAAK,GAAGkB;IACb,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMkB,6BAA6B,GAAGxH,WAAW,CAAC,MAAM;IACpDoB,2BAA2B,CAAC,IAAI,CAAC;EACrC,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMqG,iBAAiB,GAAGzH,WAAW,CAAE0H,WAAW,IAAK;IACnDrF,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACPjE,OAAO,EAAE;QAAE,GAAGiE,IAAI,CAACjE,OAAO;QAAE,GAAGoF;MAAY;IAC/C,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,gBAAgB,GAAG3H,WAAW,CAAE4H,UAAU,IAAK;IACjDC,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEF,UAAU,CAAC;IAEnDvF,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACP7D,MAAM,EAAE;QACJ,GAAG6D,IAAI,CAAC7D,MAAM;QACd,GAAGkF;MACP;IACJ,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMG,oBAAoB,GAAG/H,WAAW,CAAEkE,cAAc,IAAK;IACzD7B,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACPzD,UAAU,EAAE;QAAE,GAAGyD,IAAI,CAACzD,UAAU;QAAE,GAAGoB;MAAe;IACxD,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM8D,kBAAkB,GAAGhI,WAAW,CAAEiI,YAAY,IAAK;IACrD5F,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACPtD,QAAQ,EAAE;QAAE,GAAGsD,IAAI,CAACtD,QAAQ;QAAE,GAAGgF;MAAa;IAClD,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,iBAAiB,GAAGlI,WAAW,CAAEqD,WAAW,IAAK;IACnDhB,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACPlD;IACJ,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM8E,gBAAgB,GAAGnI,WAAW,CAAEsD,UAAU,IAAK;IACjDjB,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACPjD;IACJ,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM8E,oBAAoB,GAAGpI,WAAW,CAAEqI,cAAc,IAAK;IACzDhG,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACPhD,UAAU,EAAE;QAAE,GAAGgD,IAAI,CAAChD,UAAU;QAAE,GAAG8E;MAAe;IACxD,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,mBAAmB,GAAGtI,WAAW,CAAE0D,aAAa,IAAK;IACvDrB,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACP7C;IACJ,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM6E,cAAc,GAAGvI,WAAW,CAAE2D,QAAQ,IAAK;IAC7CtB,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACP5C,QAAQ,EAAE;QAAE,GAAG4C,IAAI,CAAC5C,QAAQ;QAAE,GAAGA;MAAS;IAC9C,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAM6E,SAAS,GAAGxI,WAAW,CAAC,CAACyI,SAAS,EAAEC,WAAW,KAAK;IACtD,MAAMC,SAAS,GAAG;MACd,GAAGD,WAAW;MACd/E,QAAQ,EAAE;QACN,GAAG+E,WAAW,CAAC/E,QAAQ;QACvBiF,OAAO,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;QACjCC,MAAM,EAAE;MACZ;IACJ,CAAC;IAEDrH,SAAS,CAAC6E,IAAI,KAAK;MACf,GAAGA,IAAI;MACP,CAACkC,SAAS,GAAGE;IACjB,CAAC,CAAC,CAAC;IAEHd,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEW,SAAS,CAAC;IACpD,OAAO,IAAI;EACf,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMO,QAAQ,GAAGhJ,WAAW,CAAEyI,SAAS,IAAK;IACxC,OAAOhH,MAAM,CAACgH,SAAS,CAAC,KAAKQ,SAAS;EAC1C,CAAC,EAAE,CAACxH,MAAM,CAAC,CAAC;EAEZ,MAAMyH,SAAS,GAAGlJ,WAAW,CAAEyI,SAAS,IAAK;IACzC,MAAMU,KAAK,GAAG1H,MAAM,CAACgH,SAAS,CAAC;IAC/B,IAAIU,KAAK,EAAE;MACPtB,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEW,SAAS,CAAC;MACtD,OAAOU,KAAK;IAChB;IACAtB,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEW,SAAS,CAAC;IACxD,OAAO,IAAI;EACf,CAAC,EAAE,CAAChH,MAAM,CAAC,CAAC;EAEZ,MAAM2H,cAAc,GAAGpJ,WAAW,CAAC,CAACyI,SAAS,EAAEY,IAAI,KAAK;IACpDxB,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAEW,SAAS,CAAC;IAC3D7G,cAAc,CAAC2E,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,CAACkC,SAAS,GAAGY;IAAK,CAAC,CAAC,CAAC;;IAExD;IACA3H,SAAS,CAAC6E,IAAI,IAAI;MACd,MAAM+C,OAAO,GAAG;QAAE,GAAG/C;MAAK,CAAC;MAC3B,OAAO+C,OAAO,CAACb,SAAS,CAAC;MACzB,OAAOa,OAAO;IAClB,CAAC,CAAC;;IAEF;IACA,IAAIjI,SAAS,EAAE;MACX,MAAMkI,YAAY,GAAGlI,SAAS,CAACmI,QAAQ,CAACC,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAClH,EAAE,KAAKiG,SAAS,CAAC;MAC1E,IAAIc,YAAY,IAAI,CAAC,EAAE;QACnB,MAAMI,eAAe,GAAG,CAAC,GAAGtI,SAAS,CAACuI,eAAe,CAAC;QACtDD,eAAe,CAACJ,YAAY,CAAC,GAAG;UAC5B,GAAGI,eAAe,CAACJ,YAAY,CAAC;UAChCR,MAAM,EAAE,iBAAiB;UACzBc,YAAY,EAAE,IAAIhB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;UACtCgB,SAAS,EAAE;QACf,CAAC;QACDxI,YAAY,CAACiF,IAAI,KAAK;UAClB,GAAGA,IAAI;UACPqD,eAAe,EAAED;QACrB,CAAC,CAAC,CAAC;MACP;IACJ;EACJ,CAAC,EAAE,CAACtI,SAAS,CAAC,CAAC;EAEf,MAAM0I,cAAc,GAAG/J,WAAW,CAAEyI,SAAS,IAAK;IAC9C,OAAO9G,WAAW,CAAC8G,SAAS,CAAC,IAAI,IAAI;EACzC,CAAC,EAAE,CAAC9G,WAAW,CAAC,CAAC;EAEjB,MAAMqI,cAAc,GAAGhK,WAAW,CAAEyI,SAAS,IAAK;IAC9C,IAAI9G,WAAW,CAAC8G,SAAS,CAAC,EAAE,OAAO,OAAO;IAC1C,IAAIhH,MAAM,CAACgH,SAAS,CAAC,EAAE,OAAO,OAAO;IACrC,OAAO,aAAa;EACxB,CAAC,EAAE,CAAC9G,WAAW,EAAEF,MAAM,CAAC,CAAC;;EAEzB;EACA,MAAMwI,oBAAoB,GAAGjK,WAAW,CAAC,CAACkK,QAAQ,GAAG,OAAO,KAAK;IAC7D,IAAI,EAACrI,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEE,MAAM,KAAI,CAACV,SAAS,EAAE,OAAO,KAAK;IAEvD,MAAM8I,YAAY,GAAGtI,cAAc,CAACM,mBAAmB;IACvD,MAAMqH,QAAQ,GAAGnI,SAAS,CAACmI,QAAQ;IAEnC,IAAIW,YAAY,GAAGX,QAAQ,CAACY,MAAM,GAAG,CAAC,EAAE;MACpC,MAAMC,SAAS,GAAGF,YAAY,GAAG,CAAC;MAClC,MAAMG,WAAW,GAAGd,QAAQ,CAACa,SAAS,CAAC;MAEvCvI,iBAAiB,CAACyE,IAAI,KAAK;QACvB,GAAGA,IAAI;QACPpE,mBAAmB,EAAEkI,SAAS;QAC9B9I,cAAc,EAAE+I,WAAW;QAC3BrI,cAAc,EAAE,CAAC,GAAGsE,IAAI,CAACtE,cAAc,EAAEV,cAAc,CAACiB,EAAE;MAC9D,CAAC,CAAC,CAAC;MAEHhB,iBAAiB,CAAC8I,WAAW,CAAC;MAC9B,OAAO,IAAI;IACf;;IAEA;IACAxI,iBAAiB,CAACyE,IAAI,KAAK;MACvB,GAAGA,IAAI;MACPxE,MAAM,EAAE,KAAK;MACbE,cAAc,EAAE,CAAC,GAAGsE,IAAI,CAACtE,cAAc,EAAEV,cAAc,CAACiB,EAAE;IAC9D,CAAC,CAAC,CAAC;IACH,OAAO,KAAK;EAChB,CAAC,EAAE,CAACX,cAAc,EAAER,SAAS,EAAEE,cAAc,CAAC,CAAC;EAE/C,MAAMgJ,wBAAwB,GAAGvK,WAAW,CAAC,MAAM;IAC/C,IAAI,EAAC6B,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEE,MAAM,KAAI,CAACV,SAAS,EAAE,OAAO,KAAK;IAEvD,MAAM8I,YAAY,GAAGtI,cAAc,CAACM,mBAAmB;IACvD,IAAIgI,YAAY,GAAG,CAAC,EAAE;MAClB,MAAMK,SAAS,GAAGL,YAAY,GAAG,CAAC;MAClC,MAAMM,WAAW,GAAGpJ,SAAS,CAACmI,QAAQ,CAACgB,SAAS,CAAC;MAEjD1I,iBAAiB,CAACyE,IAAI,KAAK;QACvB,GAAGA,IAAI;QACPpE,mBAAmB,EAAEqI,SAAS;QAC9BjJ,cAAc,EAAEkJ;MACpB,CAAC,CAAC,CAAC;MAEHjJ,iBAAiB,CAACiJ,WAAW,CAAC;MAC9B,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB,CAAC,EAAE,CAAC5I,cAAc,EAAER,SAAS,CAAC,CAAC;;EAE/B;EACA,MAAMqJ,wBAAwB,GAAG1K,WAAW,CAAE2K,aAAa,IAAK;IAAA,IAAAC,qBAAA;IAC5D;IACA,IAAI,CAACD,aAAa,IAAI,GAAAC,qBAAA,GAACD,aAAa,CAACnB,QAAQ,cAAAoB,qBAAA,eAAtBA,qBAAA,CAAwBR,MAAM,GAAE;MACnDvC,OAAO,CAACgD,IAAI,CAAC,yDAAyD,CAAC;MACvE,OAAO,KAAK;IAChB;;IAEA;IACA,MAAM;MAAErB,QAAQ;MAAEsB;IAAe,CAAC,GAAGH,aAAa;;IAElD;IACA,MAAMI,YAAY,GAAGvB,QAAQ,CAAC,CAAC,CAAC;;IAEhC;IACA,MAAMwB,OAAO,GAAG;MACZjJ,MAAM,EAAE,IAAI;MACZC,SAAS,EAAE,IAAI6G,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MACnC7G,cAAc,EAAE,EAAE;MAClBC,aAAa,EAAEsH,QAAQ,CAACY,MAAM;MAC9B7I,cAAc,EAAEwJ,YAAY;MAC5B5I,mBAAmB,EAAE;IACzB,CAAC;IACDL,iBAAiB,CAACkJ,OAAO,CAAC;IAC1BxJ,iBAAiB,CAACuJ,YAAY,CAAC;;IAE/B;IACA1I,kBAAkB,CAACkE,IAAI,IAAI;MAAA,IAAA0E,qBAAA;MACvB,MAAMrD,UAAU,GAAG;QACfjF,IAAI,EAAE,CAAAmI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAElE,UAAU,KAAIL,IAAI,CAAC7D,MAAM,CAACC,IAAI,IAAI,EAAE;QAC1DJ,IAAI,EAAE,CAAAuI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEI,UAAU,KAAI3E,IAAI,CAAC7D,MAAM,CAACH,IAAI,IAAI,EAAE;QAC1D;QACAK,UAAU,EAAE,CAAAkI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAElI,UAAU,MAClCkI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEK,UAAU,KAC1B5E,IAAI,CAAC7D,MAAM,CAACE,UAAU,IAAI,EAAE;QAChCC,IAAI,EAAE,CAAAiI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEjI,IAAI,KAAI0D,IAAI,CAAC7D,MAAM,CAACG,IAAI,IAAI;MACtD,CAAC;MAEDgF,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAE;QACvCsD,QAAQ,EAAEN,cAAc;QACxBO,MAAM,EAAEzD;MACZ,CAAC,CAAC;MAEF,OAAO;QACH,GAAGrB,IAAI;QACPjE,OAAO,EAAE;UACLC,IAAI,EAAEwI,YAAY,CAACxI,IAAI;UACvBC,EAAE,EAAEuI,YAAY,CAACvI,EAAE;UACnBC,KAAK,EAAEsI,YAAY,CAACtI;QACxB,CAAC;QACDC,MAAM,EAAEkF,UAAU;QAClB9E,UAAU,GAAAmI,qBAAA,GAAEpK,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEiC,UAAU,cAAAmI,qBAAA,cAAAA,qBAAA,GAAI1E,IAAI,CAACzD;MACxD,CAAC;IACL,CAAC,CAAC;IAEF+E,OAAO,CAACC,GAAG,CAAC,kCAAkC0B,QAAQ,CAACY,MAAM,6BAA6B,EAAE;MACxFzH,IAAI,EAAEmI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAElE,UAAU;MAChCrE,IAAI,EAAEuI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEI,UAAU;MAChCtI,UAAU,EAAE,CAAAkI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAElI,UAAU,MAAIkI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEK,UAAU;MACpEtI,IAAI,EAAEiI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEjI;IAC1B,CAAC,CAAC;IAEF,OAAO,IAAI;EACf,CAAC,EAAE,CAAChC,mBAAmB,CAAC,CAAC;EAEzB,MAAMyK,oBAAoB,GAAGtL,WAAW,CAAC,MAAM;IAC3CqC,kBAAkB,CAAC;MACfC,OAAO,EAAE;QAAEC,IAAI,EAAE,EAAE;QAAEC,EAAE,EAAE,EAAE;QAAEC,KAAK,EAAE;MAAG,CAAC;MACxCC,MAAM,EAAE;QAAEC,IAAI,EAAE,EAAE;QAAEJ,IAAI,EAAE,EAAE;QAAEK,UAAU,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAG,CAAC;MACxDC,UAAU,EAAE;QAAEP,IAAI,EAAE,EAAE;QAAEQ,OAAO,EAAE,EAAE;QAAEC,SAAS,EAAE;MAAI,CAAC;MACrDC,QAAQ,EAAE;QAAEC,OAAO,EAAE,EAAE;QAAEC,SAAS,EAAE,EAAE;QAAEC,YAAY,EAAE;MAAG,CAAC;MAC1DC,WAAW,EAAE,EAAE;MACfC,UAAU,EAAE,EAAE;MACdC,UAAU,EAAE;QAAEC,KAAK,EAAE,MAAM;QAAEC,cAAc,EAAE;MAAM,CAAC;MACpDC,aAAa,EAAE,CAAC,CAAC;MACjBC,QAAQ,EAAE;QACNC,QAAQ,EAAE,EAAE;QACZC,UAAU,EAAE,EAAE;QACdC,UAAU,EAAE,KAAK;QACjBC,gBAAgB,EAAE;MACtB;IACJ,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA;;EAEA,MAAMwH,mBAAmB,GAAGvL,WAAW,CAAC,MAAM;IAC1CiE,iBAAiB,CAAC;MACdC,cAAc,EAAE;QACZC,KAAK,EAAE,EAAE;QACTC,WAAW,EAAE,EAAE;QACfC,MAAM,EAAE,EAAE;QACVC,gBAAgB,EAAE,EAAE;QACpBC,WAAW,EAAE;MACjB,CAAC;MACDC,YAAY,EAAE,CACV;QAAEhB,KAAK,EAAE,YAAY;QAAEjB,IAAI,EAAE,YAAY;QAAE6B,WAAW,EAAE,2BAA2B;QAAEK,KAAK,EAAE,SAAS;QAAEC,UAAU,EAAE;MAAE,CAAC,EACtH;QAAElB,KAAK,EAAE,cAAc;QAAEjB,IAAI,EAAE,cAAc;QAAE6B,WAAW,EAAE,yBAAyB;QAAEK,KAAK,EAAE,SAAS;QAAEC,UAAU,EAAE;MAAI,CAAC,EAC1H;QAAElB,KAAK,EAAE,YAAY;QAAEjB,IAAI,EAAE,YAAY;QAAE6B,WAAW,EAAE,uBAAuB;QAAEK,KAAK,EAAE,SAAS;QAAEC,UAAU,EAAE;MAAK,CAAC,EACrH;QAAElB,KAAK,EAAE,YAAY;QAAEjB,IAAI,EAAE,mBAAmB;QAAE6B,WAAW,EAAE,yBAAyB;QAAEK,KAAK,EAAE,SAAS;QAAEC,UAAU,EAAE;MAAI,CAAC,EAC7H;QAAElB,KAAK,EAAE,UAAU;QAAEjB,IAAI,EAAE,UAAU;QAAE6B,WAAW,EAAE,6BAA6B;QAAEK,KAAK,EAAE,SAAS;QAAEC,UAAU,EAAE;MAAK,CAAC,EACvH;QAAElB,KAAK,EAAE,cAAc;QAAEjB,IAAI,EAAE,cAAc;QAAE6B,WAAW,EAAE,6BAA6B;QAAEK,KAAK,EAAE,SAAS;QAAEC,UAAU,EAAE;MAAK,CAAC,EAC/H;QAAElB,KAAK,EAAE,aAAa;QAAEjB,IAAI,EAAE,aAAa;QAAE6B,WAAW,EAAE,kCAAkC;QAAEK,KAAK,EAAE,SAAS;QAAEC,UAAU,EAAE;MAAI,CAAC,CACpI;MACDC,QAAQ,EAAE,CACN;QACInC,EAAE,EAAE,aAAa;QACjBD,IAAI,EAAE,EAAE;QACR6B,WAAW,EAAE,EAAE;QACfpB,SAAS,EAAE,EAAE;QACbqB,MAAM,EAAE,EAAE;QACVO,MAAM,EAAE,CAAC,CAAC;QACVC,eAAe,EAAE;UACb1B,SAAS,EAAE,EAAE;UACbC,YAAY,EAAE,EAAE;UAChBF,OAAO,EAAE;QACb;MACJ,CAAC,CACJ;MACD4B,cAAc,EAAE,YAAY;MAC5BC,aAAa,EAAE,KAAK;MACpBC,gBAAgB,EAAE,CAAC,CAAC;MACpBC,SAAS,EAAE;QAAEC,IAAI,EAAE,KAAK;QAAEC,OAAO,EAAE,EAAE;QAAEC,KAAK,EAAE,IAAI;QAAEC,MAAM,EAAE;MAAK;IACrE,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMmG,aAAa,GAAGxL,WAAW,CAAEyI,SAAS,IAAK;IAC7C,MAAME,SAAS,GAAGlH,MAAM,CAACgH,SAAS,CAAC;IACnC,IAAIE,SAAS,EAAE;MACXS,cAAc,CAACX,SAAS,EAAEE,SAAS,CAAC;MACpCd,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEW,SAAS,CAAC;IAC7D;EACJ,CAAC,EAAE,CAAChH,MAAM,EAAE2H,cAAc,CAAC,CAAC;;EAE5B;EACA,MAAMqC,WAAW,GAAGzL,WAAW,CAAEyI,SAAS,IAAK;IAC3C,MAAMiD,SAAS,GAAG/J,WAAW,CAAC8G,SAAS,CAAC;IACxC,IAAIiD,SAAS,EAAE;MACX;MACAhK,SAAS,CAAC6E,IAAI,KAAK;QAAE,GAAGA,IAAI;QAAE,CAACkC,SAAS,GAAGiD;MAAU,CAAC,CAAC,CAAC;MACxD9J,cAAc,CAAC2E,IAAI,IAAI;QACnB,MAAM+C,OAAO,GAAG;UAAE,GAAG/C;QAAK,CAAC;QAC3B,OAAO+C,OAAO,CAACb,SAAS,CAAC;QACzB,OAAOa,OAAO;MAClB,CAAC,CAAC;;MAEF;MACA,IAAIjI,SAAS,EAAE;QACX,MAAMkI,YAAY,GAAGlI,SAAS,CAACmI,QAAQ,CAACC,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAClH,EAAE,KAAKiG,SAAS,CAAC;QAC1E,IAAIc,YAAY,IAAI,CAAC,EAAE;UACnB,MAAMI,eAAe,GAAG,CAAC,GAAGtI,SAAS,CAACuI,eAAe,CAAC;UACtDD,eAAe,CAACJ,YAAY,CAAC,GAAG;YAC5B,GAAGI,eAAe,CAACJ,YAAY,CAAC;YAChCR,MAAM,EAAE,iBAAiB;YACzBc,YAAY,EAAE,IAAIhB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;YACtCgB,SAAS,EAAE;UACf,CAAC;UACDxI,YAAY,CAACiF,IAAI,KAAK;YAClB,GAAGA,IAAI;YACPqD,eAAe,EAAED;UACrB,CAAC,CAAC,CAAC;QACP;MACJ;MAEA9B,OAAO,CAACC,GAAG,CAAC,sCAAsC,EAAEW,SAAS,CAAC;IAClE;EACJ,CAAC,EAAE,CAAC9G,WAAW,EAAEN,SAAS,CAAC,CAAC;;EAE5B;EACA,MAAMsK,oBAAoB,GAAG3L,WAAW,CAAE4L,aAAa,IAAK;IACxD9J,iBAAiB,CAACyE,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,GAAGqF;IAAc,CAAC,CAAC,CAAC;EAC9D,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMC,iBAAiB,GAAG7L,WAAW,CAAC,MAAM;IACxCY,eAAe,CAAC,IAAI,CAAC;EACzB,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMkL,uBAAuB,GAAG9L,WAAW,CAAC,MAAM;IAC9C,IAAI,CAACW,YAAY,EAAE;IACnB0B,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACP5C,QAAQ,EAAE;QACN,GAAG4C,IAAI,CAAC5C,QAAQ;QAChBI,gBAAgB,EAAE;MACtB;IACJ,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,CAACpD,YAAY,CAAC,CAAC;;EAElB;EACA,MAAMoL,kCAAkC,GAAG/L,WAAW,CAAC,MAAM;IACzD,IAAI,CAACW,YAAY,EAAE;IACnB;IACA;IACA0B,kBAAkB,CAACkE,IAAI,KAAK;MACxB,GAAGA,IAAI;MACPzD,UAAU,EAAE;QACR,GAAGyD,IAAI,CAACzD,UAAU;QAClBP,IAAI,EAAE5B,YAAY,CAACuD,cAAc,CAACC,KAAK,IAAIoC,IAAI,CAACzD,UAAU,CAACP;MAC/D,CAAC;MACDoB,QAAQ,EAAE;QACN,GAAG4C,IAAI,CAAC5C,QAAQ;QAChBI,gBAAgB,EAAE;MACtB;IACJ,CAAC,CAAC,CAAC;EACP,CAAC,EAAE,CAACpD,YAAY,CAAC,CAAC;;EAGlB;EACA,MAAMqL,aAAa,GAAGhM,WAAW,CAAC,MAAM;IACpC,MAAMiM,WAAW,GAAG;MAChBtL,YAAY;MACZU,SAAS;MACTI,MAAM;MACNE,WAAW;MACXZ,SAAS;MACTQ,cAAc;MACdM,cAAc;MACdhB,mBAAmB;MACnBI,gBAAgB;MAAE;MAClBE,wBAAwB,CAAE;IAC9B,CAAC;IACD,MAAM+K,OAAO,GAAGC,IAAI,CAACC,SAAS,CAACH,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;IACpD,MAAMI,QAAQ,GAAG,IAAIC,IAAI,CAAC,CAACJ,OAAO,CAAC,EAAE;MAAEjF,IAAI,EAAE;IAAmB,CAAC,CAAC;IAClE,MAAMsF,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACJ,QAAQ,CAAC;IACzC,MAAMK,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACxCF,IAAI,CAACG,IAAI,GAAGN,GAAG;IACf,MAAMO,SAAS,GAAG,IAAIjE,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACiE,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;IAC1EN,IAAI,CAACO,QAAQ,GAAG,mBAAmBH,SAAS,OAAO;IACnDH,QAAQ,CAACO,IAAI,CAACC,WAAW,CAACT,IAAI,CAAC;IAC/BA,IAAI,CAACU,KAAK,CAAC,CAAC;IACZT,QAAQ,CAACO,IAAI,CAACG,WAAW,CAACX,IAAI,CAAC;IAC/BF,GAAG,CAACc,eAAe,CAACf,GAAG,CAAC;EAC5B,CAAC,EAAE,CAAC5L,YAAY,EAAEU,SAAS,EAAEI,MAAM,EAAEE,WAAW,EAAEZ,SAAS,EAAEQ,cAAc,EAAEM,cAAc,EAAEhB,mBAAmB,EAAEI,gBAAgB,EAAEE,wBAAwB,CAAC,CAAC;;EAE9J;EACA,MAAMoM,aAAa,GAAGvN,WAAW,CAAEwN,WAAW,IAAK;IAC/C,IAAI;MACA,MAAMvB,WAAW,GAAGE,IAAI,CAACsB,KAAK,CAACD,WAAW,CAAC;MAC3C,IAAIvB,WAAW,IAAI,OAAOA,WAAW,KAAK,QAAQ,EAAE;QAChDrL,eAAe,CAACqL,WAAW,CAACtL,YAAY,IAAI,IAAI,CAAC;QACjDW,YAAY,CAAC2K,WAAW,CAAC5K,SAAS,IAAI,IAAI,CAAC;QAC3CK,SAAS,CAACuK,WAAW,CAACxK,MAAM,IAAI,CAAC,CAAC,CAAC;QACnCG,cAAc,CAACqK,WAAW,CAACtK,WAAW,IAAI,CAAC,CAAC,CAAC;QAC7CX,YAAY,CAACiL,WAAW,CAAClL,SAAS,IAAI,6BAA6B,CAAC;QACpES,iBAAiB,CAACyK,WAAW,CAAC1K,cAAc,IAAI,IAAI,CAAC;QACrDO,iBAAiB,CAACmK,WAAW,CAACpK,cAAc,IAAI;UAAEE,MAAM,EAAE;QAAM,CAAC,CAAC;QAClEjB,sBAAsB,CAACmL,WAAW,CAACpL,mBAAmB,IAAI,IAAI,CAAC;QAC/DK,mBAAmB,CAAC+K,WAAW,CAAChL,gBAAgB,IAAI,IAAI,CAAC,CAAC,CAAC;QAC3DG,2BAA2B,CAAC6K,WAAW,CAAC9K,wBAAwB,IAAI,IAAI,CAAC,CAAC,CAAC;QAC3EuM,KAAK,CAAC,8BAA8B,CAAC;MACzC,CAAC,MAAM;QACH,MAAM,IAAInN,KAAK,CAAC,sBAAsB,CAAC;MAC3C;IACJ,CAAC,CAAC,OAAOoN,KAAK,EAAE;MACZ9F,OAAO,CAAC8F,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACjDD,KAAK,CAAC,kFAAkF,CAAC;IAC7F;EACJ,CAAC,EAAE,EAAE,CAAC;EAEN,MAAME,YAAY,GAAG5N,WAAW,CAAC,MAAM;IACnCY,eAAe,CAAC,IAAI,CAAC;IACrB0K,oBAAoB,CAAC,CAAC;IACtBC,mBAAmB,CAAC,CAAC;IACrB/E,qBAAqB,CAAC,CAAC,CAAC,CAAC;IACzBgB,6BAA6B,CAAC,CAAC,CAAC,CAAC;EACrC,CAAC,EAAE,CAAC8D,oBAAoB,EAAEC,mBAAmB,EAAE/E,qBAAqB,EAAEgB,6BAA6B,CAAC,CAAC;EAErG,MAAMqG,kBAAkB,GAAGzL,eAAe;EAC1C,MAAM0L,wBAAwB,GAAGzL,kBAAkB;EAEnD,MAAMiE,KAAK,GAAG;IACV;IACA3F,YAAY;IACZC,eAAe;IACfC,mBAAmB;IACnBC,sBAAsB;IAEtB;IACAC,SAAS;IACTC,YAAY;IAEZ;IACAC,gBAAgB;IAChBoF,sBAAsB;IACtBf,0BAA0B;IAC1BkB,qBAAqB;IAErB;IACArF,wBAAwB;IACxBoG,8BAA8B;IAC9Bd,kCAAkC;IAClCe,6BAA6B;IAE7B;IACAkB,WAAW,EAAEtG,eAAe;IAC5B2L,cAAc,EAAE1L,kBAAkB;IAClCiJ,oBAAoB;IACpBuC,kBAAkB;IAClBC,wBAAwB;IAExB;IACArG,iBAAiB;IACjBE,gBAAgB;IAChBI,oBAAoB;IACpBC,kBAAkB;IAClBE,iBAAiB;IACjBC,gBAAgB;IAChBC,oBAAoB;IACpBE,mBAAmB;IACnBC,cAAc;IAEd;IACA9G,MAAM;IACNE,WAAW;IACX6G,SAAS;IACTU,SAAS;IACTE,cAAc;IACdW,cAAc;IACdC,cAAc;IACdhB,QAAQ;IACRwC,aAAa;IACbC,WAAW;IAEX;IACApK,SAAS;IACTC,YAAY;IACZC,cAAc;IACdC,iBAAiB;IAEjB;IACAK,cAAc;IACdC,iBAAiB;IACjBmI,oBAAoB;IACpBM,wBAAwB;IACxBoB,oBAAoB;IAAE;IACtBjB,wBAAwB;IAExB;IACA1G,cAAc;IACdC,iBAAiB;IAEjB;IACA6H,uBAAuB;IAAE;IACzBC,kCAAkC;IAAE;IACpCF,iBAAiB;IAAE;IACnBN,mBAAmB;IACnBqC,YAAY;IAEZ;IACA5B,aAAa;IACbuB;EACJ,CAAC;EAED,oBACIrN,OAAA,CAACC,iBAAiB,CAAC6N,QAAQ;IAAC1H,KAAK,EAAEA,KAAM;IAAA7F,QAAA,EACpCA;EAAQ;IAAAwN,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACe,CAAC;AAErC,CAAC;AAAC1N,GAAA,CAvsBWF,kBAAkB;AAAA6N,EAAA,GAAlB7N,kBAAkB;AAysB/B,eAAeA,kBAAkB;AAAC,IAAA6N,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}