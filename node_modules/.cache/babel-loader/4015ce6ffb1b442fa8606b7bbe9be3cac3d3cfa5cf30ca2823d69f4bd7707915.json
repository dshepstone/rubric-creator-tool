{"ast":null,"code":"var _jsxFileName = \"C:\\\\local clones\\\\rubric-creation-app\\\\src\\\\components\\\\RubricCreator.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Plus, X, Upload, Download, Save, FileText, RotateCcw, ChevronDown, ChevronUp, Maximize2, ArrowRight, Minimize2, Edit3 } from 'lucide-react';\nimport { useAssessment } from './SharedContext';\n\n/**\r\n * ===================================================================================\r\n * MARKDOWN PASTE UTILITY\r\n * ===================================================================================\r\n * This function converts plain text (with markdown-like lists) into clean HTML.\r\n * It's used as a fallback when the clipboard doesn't contain rich HTML content.\r\n *\r\n * @param {string} text - The plain text from the clipboard.\r\n * @returns {string} - A clean HTML string.\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst pasteAsMarkdown = text => {\n  if (!text) return '';\n  const lines = text.split('\\n');\n  let html = '';\n  let inList = false;\n  let listType = null; // 'ol' or 'ul'\n\n  const closeList = () => {\n    if (inList) {\n      html += `</${listType}>`;\n      inList = false;\n      listType = null;\n    }\n  };\n  lines.forEach(line => {\n    const trimmedLine = line.trim();\n    const isNumberedList = /^\\d+\\.\\s/.test(trimmedLine);\n    const isBulletedList = /^(\\*|-)\\s/.test(trimmedLine);\n    if (isNumberedList || isBulletedList) {\n      const currentListType = isNumberedList ? 'ol' : 'ul';\n      if (!inList || currentListType !== listType) {\n        closeList();\n        html += `<${currentListType}>`;\n        inList = true;\n        listType = currentListType;\n      }\n      html += `<li>${trimmedLine.replace(/^(\\d+\\.|\\*|-)\\s/, '')}</li>`;\n    } else {\n      closeList();\n      if (trimmedLine) {\n        html += `<p>${trimmedLine}</p>`;\n      }\n    }\n  });\n  closeList();\n  return html;\n};\nconst RubricCreator = () => {\n  _s();\n  const {\n    sharedRubric,\n    setSharedRubric,\n    transferRubricToGradingWithDetails,\n    activeTab\n  } = useAssessment();\n  const defaultLevels = [{\n    level: 'incomplete',\n    name: 'Incomplete',\n    description: 'No submission or unusable',\n    color: '#95a5a6',\n    multiplier: 0\n  }, {\n    level: 'unacceptable',\n    name: 'Unacceptable',\n    description: 'Below minimum standards',\n    color: '#e74c3c',\n    multiplier: 0.3\n  }, {\n    level: 'developing',\n    name: 'Developing',\n    description: 'Approaching standards',\n    color: '#f39c12',\n    multiplier: 0.55\n  }, {\n    level: 'acceptable',\n    name: 'Acceptable (PASS)',\n    description: 'Meets minimum standards',\n    color: '#27ae60',\n    multiplier: 0.7\n  }, {\n    level: 'emerging',\n    name: 'Emerging',\n    description: 'Above standard expectations',\n    color: '#2980b9',\n    multiplier: 0.82\n  }, {\n    level: 'accomplished',\n    name: 'Accomplished',\n    description: 'Strong professional quality',\n    color: '#16a085',\n    multiplier: 0.92\n  }, {\n    level: 'exceptional',\n    name: 'Exceptional',\n    description: 'Outstanding professional quality',\n    color: '#8e44ad',\n    multiplier: 1.0\n  }];\n  const [rubricData, setRubricData] = useState(() => {\n    return sharedRubric || {\n      assignmentInfo: {\n        title: '',\n        description: '',\n        weight: 25,\n        passingThreshold: 60,\n        totalPoints: 100\n      },\n      rubricLevels: [...defaultLevels],\n      criteria: [{\n        id: 'criterion-1',\n        name: '',\n        description: '',\n        maxPoints: 20,\n        weight: 20,\n        levels: {},\n        feedbackLibrary: {\n          strengths: [],\n          improvements: [],\n          general: []\n        }\n      }]\n    };\n  });\n  const [pointingSystem, setPointingSystem] = useState('multiplier');\n  const [reversedOrder, setReversedOrder] = useState(false);\n  const [showGuide, setShowGuide] = useState(false);\n  const [expandedFeedback, setExpandedFeedback] = useState({});\n  const [inlineEditor, setInlineEditor] = useState({\n    show: false,\n    content: '',\n    field: null,\n    onSave: null,\n    criterionId: null,\n    level: null,\n    type: null\n  });\n  const [autoSaveTimeout, setAutoSaveTimeout] = useState(null);\n  const richTextContentRef = useRef('');\n  const editorRef = useRef(null);\n  const importInputRef = useRef(null);\n  const containsHtml = content => /<[^>]*>/.test(content);\n  const stripHtml = html => {\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = html;\n    return tempDiv.textContent || tempDiv.innerText || '';\n  };\n\n  /**\r\n   * ===================================================================================\r\n   * NEW, ROBUST HTML SANITIZER\r\n   * ===================================================================================\r\n   * This function is adapted from the `editor.js` logic. It safely cleans\r\n   * pasted HTML by parsing it and allowing only a specific list of tags and attributes.\r\n   * This preserves rich text formatting while removing unwanted styles and scripts.\r\n   *\r\n   * @param {string} html - The potentially dirty HTML string from the clipboard.\r\n   * @returns {string} - Sanitized HTML ready for insertion.\r\n   */\n  const sanitizeHtml = html => {\n    // Define tags and attributes allowed from pasted content, matching the Rich Text Editor's capabilities.\n    const ALLOWED_TAGS = ['h1', 'h2', 'h3', 'p', 'blockquote', 'pre', 'b', 'strong', 'i', 'em', 'u', 'strike', 's', 'ul', 'ol', 'li', 'a', 'br', 'hr', 'sup', 'sub', 'div', 'span', 'font'];\n    const ALLOWED_ATTRS = ['href', 'title', 'style', 'color', 'size', 'face'];\n    const doc = new DOMParser().parseFromString(html, 'text/html');\n    const frag = document.createDocumentFragment();\n    function cleanNode(node) {\n      if (node.nodeType === Node.TEXT_NODE) {\n        // Keep text nodes\n        return document.createTextNode(node.textContent);\n      }\n      if (node.nodeType === Node.ELEMENT_NODE) {\n        const tag = node.tagName.toLowerCase();\n        if (ALLOWED_TAGS.includes(tag)) {\n          const el = document.createElement(tag);\n\n          // Copy allowed attributes from the original node to the new element\n          for (const attr of node.attributes) {\n            if (ALLOWED_ATTRS.includes(attr.name.toLowerCase())) {\n              el.setAttribute(attr.name, attr.value);\n            }\n          }\n\n          // Recursively clean and append child nodes\n          node.childNodes.forEach(child => {\n            const cleanedChild = cleanNode(child);\n            if (cleanedChild) el.appendChild(cleanedChild);\n          });\n          return el;\n        } else {\n          // If the tag is not allowed, flatten it by processing its children directly\n          const container = document.createDocumentFragment();\n          node.childNodes.forEach(child => {\n            const cleanedChild = cleanNode(child);\n            if (cleanedChild) container.appendChild(cleanedChild);\n          });\n          return container;\n        }\n      }\n      return null; // Ignore other node types (comments, etc.)\n    }\n    Array.from(doc.body.childNodes).forEach(n => {\n      const cleaned = cleanNode(n);\n      if (cleaned) frag.appendChild(cleaned);\n    });\n    const wrapper = document.createElement('div');\n    wrapper.appendChild(frag);\n    return wrapper.innerHTML;\n  };\n  const saveCursorPosition = () => {\n    const selection = window.getSelection();\n    if (selection.rangeCount === 0) return null;\n    return selection.getRangeAt(0);\n  };\n  const restoreCursorPosition = range => {\n    if (!range) return;\n    const selection = window.getSelection();\n    selection.removeAllRanges();\n    selection.addRange(range);\n  };\n  useEffect(() => {\n    if (autoSaveTimeout) clearTimeout(autoSaveTimeout);\n    const id = setTimeout(() => setSharedRubric(rubricData), 1000);\n    setAutoSaveTimeout(id);\n    return () => clearTimeout(id);\n  }, [rubricData, setSharedRubric]);\n  useEffect(() => {\n    if (sharedRubric && activeTab === 'rubric-creator') {\n      setRubricData(sharedRubric);\n    }\n  }, [sharedRubric, activeTab]);\n  const toggleFeedbackExpansion = id => setExpandedFeedback(p => ({\n    ...p,\n    [id]: !p[id]\n  }));\n  const openInlineEditor = (content, field, onSave, criterionId = null, level = null, type = 'assignment') => {\n    richTextContentRef.current = content || '';\n    setInlineEditor({\n      show: true,\n      content: content || '',\n      field,\n      onSave,\n      criterionId,\n      level,\n      type\n    });\n    setTimeout(() => {\n      if (editorRef.current) {\n        editorRef.current.innerHTML = content || '';\n        editorRef.current.focus();\n        const range = document.createRange();\n        const selection = window.getSelection();\n        range.selectNodeContents(editorRef.current);\n        range.collapse(false);\n        selection.removeAllRanges();\n        selection.addRange(range);\n      }\n    }, 100);\n  };\n  const handleRichTextCommand = (command, value = null) => {\n    if (editorRef.current) {\n      editorRef.current.focus();\n      document.execCommand(command, false, value);\n      richTextContentRef.current = editorRef.current.innerHTML;\n    }\n  };\n  const handleRichTextChange = () => {\n    if (editorRef.current) richTextContentRef.current = editorRef.current.innerHTML;\n  };\n\n  /**\r\n   * ===================================================================================\r\n   * NEW, IMPROVED PASTE HANDLER\r\n   * ===================================================================================\r\n   * This function now correctly handles pasted content by prioritizing HTML and\r\n   * cleaning it with the robust `sanitizeHtml` function.\r\n   */\n  const handlePaste = e => {\n    e.preventDefault();\n    const clipboardData = e.clipboardData || window.clipboardData;\n    let pasteData = '';\n\n    // Prioritize HTML content if available, as it contains rich formatting.\n    if (clipboardData.types.includes('text/html')) {\n      const dirtyHtml = clipboardData.getData('text/html');\n      // Use the new robust sanitize function to clean the HTML.\n      pasteData = sanitizeHtml(dirtyHtml);\n    } else {\n      // Fallback for plain text: use the markdown converter for lists.\n      const plainText = clipboardData.getData('text/plain');\n      pasteData = pasteAsMarkdown(plainText);\n    }\n\n    // Insert the final cleaned HTML into the editor.\n    document.execCommand('insertHTML', false, pasteData);\n  };\n  const handleKeyDown = e => {\n    if (!editorRef.current) return;\n    if (e.key === 'Tab') {\n      e.preventDefault();\n      document.execCommand('insertHTML', false, '&nbsp;&nbsp;&nbsp;&nbsp;');\n    }\n    if (e.ctrlKey || e.metaKey) {\n      switch (e.key) {\n        case 'b':\n          e.preventDefault();\n          handleRichTextCommand('bold');\n          break;\n        case 'i':\n          e.preventDefault();\n          handleRichTextCommand('italic');\n          break;\n        case 'u':\n          e.preventDefault();\n          handleRichTextCommand('underline');\n          break;\n        default:\n          break;\n      }\n    }\n    setTimeout(() => handleRichTextChange(), 0);\n  };\n  const closeInlineEditor = (save = false) => {\n    if (save && inlineEditor.onSave) {\n      // The ref has the most up-to-date HTML content.\n      inlineEditor.onSave(richTextContentRef.current);\n    }\n    setInlineEditor({\n      show: false,\n      content: '',\n      field: null,\n      onSave: null,\n      criterionId: null,\n      level: null,\n      type: null\n    });\n    richTextContentRef.current = '';\n  };\n  const calculateTotalPoints = () => rubricData.criteria.reduce((total, c) => total + c.maxPoints, 0);\n  const updateAssignmentInfo = (field, value) => {\n    setRubricData(prev => {\n      const updated = {\n        ...prev,\n        assignmentInfo: {\n          ...prev.assignmentInfo,\n          [field]: value\n        }\n      };\n      if (field !== 'totalPoints') updated.assignmentInfo.totalPoints = calculateTotalPoints();\n      return updated;\n    });\n  };\n  const addCriterion = () => {\n    const newCriterion = {\n      id: `criterion-${Date.now()}`,\n      name: '',\n      description: '',\n      maxPoints: 20,\n      weight: 20,\n      levels: {},\n      feedbackLibrary: {\n        strengths: [],\n        improvements: [],\n        general: []\n      }\n    };\n    setRubricData(prev => ({\n      ...prev,\n      criteria: [...prev.criteria, newCriterion]\n    }));\n  };\n  const removeCriterion = id => setRubricData(prev => ({\n    ...prev,\n    criteria: prev.criteria.filter(c => c.id !== id)\n  }));\n  const updateCriterion = (id, field, value) => setRubricData(prev => ({\n    ...prev,\n    criteria: prev.criteria.map(c => c.id === id ? {\n      ...c,\n      [field]: value\n    } : c)\n  }));\n  const updateCriterionLevel = (id, level, field, value) => {\n    setRubricData(prev => ({\n      ...prev,\n      criteria: prev.criteria.map(c => c.id === id ? {\n        ...c,\n        levels: {\n          ...c.levels,\n          [level]: {\n            ...c.levels[level],\n            [field]: value\n          }\n        }\n      } : c)\n    }));\n  };\n  const addFeedbackItem = (id, cat, item) => {\n    if (!(item !== null && item !== void 0 && item.trim())) return;\n    setRubricData(prev => ({\n      ...prev,\n      criteria: prev.criteria.map(c => c.id === id ? {\n        ...c,\n        feedbackLibrary: {\n          ...c.feedbackLibrary,\n          [cat]: [...c.feedbackLibrary[cat], item.trim()]\n        }\n      } : c)\n    }));\n  };\n  const removeFeedbackItem = (id, cat, index) => {\n    setRubricData(prev => ({\n      ...prev,\n      criteria: prev.criteria.map(c => c.id === id ? {\n        ...c,\n        feedbackLibrary: {\n          ...c.feedbackLibrary,\n          [cat]: c.feedbackLibrary[cat].filter((_, i) => i !== index)\n        }\n      } : c)\n    }));\n  };\n  const calculatePointRange = (criterion, level) => {\n    var _criterion$levels$lev;\n    const rubricLevel = rubricData.rubricLevels.find(l => l.level === level);\n    if (!rubricLevel) return '0';\n    return pointingSystem === 'multiplier' ? level === 'incomplete' ? '0' : Math.round(criterion.maxPoints * rubricLevel.multiplier).toString() : ((_criterion$levels$lev = criterion.levels[level]) === null || _criterion$levels$lev === void 0 ? void 0 : _criterion$levels$lev.pointRange) || '0';\n  };\n  const getDisplayLevels = () => reversedOrder ? [...rubricData.rubricLevels].reverse() : rubricData.rubricLevels;\n  const prepareRubricForExport = () => {\n    const exportData = {\n      ...rubricData,\n      assignmentInfo: {\n        ...rubricData.assignmentInfo,\n        totalPoints: calculateTotalPoints()\n      }\n    };\n    exportData.criteria = exportData.criteria.map(c => ({\n      ...c,\n      levels: Object.fromEntries(rubricData.rubricLevels.map(l => {\n        var _c$levels$l$level;\n        return [l.level, {\n          pointRange: calculatePointRange(c, l.level),\n          description: ((_c$levels$l$level = c.levels[l.level]) === null || _c$levels$l$level === void 0 ? void 0 : _c$levels$l$level.description) || ''\n        }];\n      }))\n    }));\n    return exportData;\n  };\n  const downloadJson = (data, fileName) => {\n    const blob = new Blob([JSON.stringify(data, null, 2)], {\n      type: 'application/json'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = fileName;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n  const saveRubric = () => downloadJson(rubricData, `rubric_${rubricData.assignmentInfo.title.replace(/\\s+/g, '_') || 'draft'}_${new Date().toISOString().split('T')[0]}.json`);\n  const exportForGrading = () => downloadJson(prepareRubricForExport(), `rubric_${rubricData.assignmentInfo.title.replace(/\\s+/g, '_') || 'export'}_final.json`);\n  const transferToGrading = () => transferRubricToGradingWithDetails(prepareRubricForExport());\n  const importRubric = e => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onload = ev => {\n        try {\n          const imported = JSON.parse(ev.target.result);\n          if (imported.assignmentInfo && imported.criteria && imported.rubricLevels) setRubricData(imported);else alert('Invalid rubric format.');\n        } catch (err) {\n          alert('Error loading rubric: ' + err.message);\n        }\n      };\n      reader.readAsText(file);\n    }\n    e.target.value = '';\n  };\n  const resetRubric = () => {\n    if (window.confirm('Reset to a blank rubric? All current work will be lost.')) {\n      setRubricData({\n        assignmentInfo: {\n          title: '',\n          description: '',\n          weight: 25,\n          passingThreshold: 60,\n          totalPoints: 100\n        },\n        rubricLevels: [...defaultLevels],\n        criteria: [{\n          id: 'criterion-1',\n          name: '',\n          description: '',\n          maxPoints: 20,\n          weight: 20,\n          levels: {},\n          feedbackLibrary: {\n            strengths: [],\n            improvements: [],\n            general: []\n          }\n        }]\n      });\n    }\n  };\n\n  // ... The rest of the component's render logic, including JSX, remains the same.\n  // The ContentDisplay, RichTextToolbar, and all table rendering logic are unchanged.\n  // I am omitting the large JSX block for brevity as no changes were made to it.\n  // The key changes are the new `sanitizeHtml` function and the updated `handlePaste` function shown above.\n\n  const exportToHTML = () => {\n    const displayLevels = getDisplayLevels();\n    const totalPoints = calculateTotalPoints();\n    const htmlContent = `\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>${rubricData.assignmentInfo.title || 'Assessment Rubric'} - Rubric</title>\n    <style>\n        body { font-family: 'Arial', sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; line-height: 1.4; }\n        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 3px solid #1e40af; }\n        .header h1 { color: #1e40af; margin-bottom: 10px; }\n        .assignment-info { background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #e2e8f0; }\n        .rubric-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 0.85rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }\n        .rubric-table th, .rubric-table td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }\n        .rubric-table th { background: #1e40af; color: white; text-align: center; font-weight: 600; }\n        .criterion-name { font-weight: bold; background: #f8fafc; padding: 15px; }\n        .point-range { text-align: center; font-weight: bold; color: #1e40af; font-size: 1.1em; }\n        .level-description { font-size: 0.9rem; line-height: 1.4; }\n        .overall-score { background: #eff6ff; padding: 25px; border-radius: 8px; margin-top: 30px; border: 2px solid #bfdbfe; }\n        .footer { margin-top: 40px; text-align: center; font-size: 0.9rem; color: #666; border-top: 1px solid #e2e8f0; padding-top: 20px; }\n        .level-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-top: 20px; }\n        .level-card { text-align: center; padding: 15px; border-radius: 8px; border: 2px solid; }\n        @media print { body { margin: 0; padding: 15px; } .level-grid { break-inside: avoid; } }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>${rubricData.assignmentInfo.title || 'Assessment Rubric'}</h1>\n        <p style=\"color: #64748b; font-size: 1.1em;\">${stripHtml(rubricData.assignmentInfo.description) || 'No description provided'}</p>\n    </div>\n    \n    <div class=\"assignment-info\">\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\n            <p><strong>Assignment Weight:</strong> ${rubricData.assignmentInfo.weight}% of Final Grade</p>\n            <p><strong>Passing Threshold:</strong> ${rubricData.assignmentInfo.passingThreshold}%</p>\n            <p><strong>Total Points:</strong> ${totalPoints}</p>\n            <p><strong>Number of Criteria:</strong> ${rubricData.criteria.length}</p>\n        </div>\n    </div>\n    \n    <table class=\"rubric-table\">\n        <thead>\n            <tr>\n                <th style=\"width: 20%\">Criterion</th>\n                ${displayLevels.map(level => `<th style=\"width: ${80 / displayLevels.length}%; background-color: ${level.color};\">${level.name}</th>`).join('')}\n            </tr>\n        </thead>\n        <tbody>\n            ${rubricData.criteria.map(criterion => `\n                <tr>\n                    <td class=\"criterion-name\">\n                        <strong style=\"color: #1e40af; font-size: 1.1em;\">${criterion.name || 'Unnamed Criterion'}</strong>\n                        <div style=\"font-weight: normal; color: #475569; margin-top: 8px; font-style: italic;\">\n                            ${criterion.description || 'No description provided'}\n                        </div>\n                        <div style=\"background: #1e40af; color: white; padding: 5px 10px; border-radius: 4px; margin-top: 10px; text-align: center; font-weight: bold;\">\n                            ${criterion.maxPoints} points\n                        </div>\n                    </td>\n                    ${displayLevels.map(level => {\n      var _criterion$levels$lev2;\n      return `\n                        <td style=\"background-color: ${level.color}08;\">\n                            <div class=\"point-range\" style=\"color: ${level.color}; margin-bottom: 10px;\">\n                                ${calculatePointRange(criterion, level.level)} pts\n                            </div>\n                            <div class=\"level-description\">\n                                ${((_criterion$levels$lev2 = criterion.levels[level.level]) === null || _criterion$levels$lev2 === void 0 ? void 0 : _criterion$levels$lev2.description) || '<em>Not defined</em>'}\n                            </div>\n                        </td>\n                    `;\n    }).join('')}\n                </tr>\n            `).join('')}\n        </tbody>\n    </table>\n    \n    <div class=\"overall-score\">\n        <h3 style=\"color: #1e40af; margin-bottom: 15px;\">Overall Achievement Levels</h3>\n        <p style=\"color: #475569; margin-bottom: 20px;\">Each submission receives an overall achievement level based on total rubric score.</p>\n        <div class=\"level-grid\">\n            ${displayLevels.map(level => `\n                <div class=\"level-card\" style=\"border-color: ${level.color}; background-color: ${level.color}15;\">\n                    <div style=\"font-weight: bold; color: ${level.color}; margin-bottom: 5px;\">${level.name}</div>\n                    <div style=\"font-size: 1.2em; font-weight: bold; margin: 8px 0; color: ${level.color};\">\n                        ${Math.round(totalPoints * level.multiplier)}+ pts\n                    </div>\n                    <div style=\"font-size: 0.8em; color: #64748b;\">${(level.multiplier * 100).toFixed(0)}% or higher</div>\n                </div>\n            `).join('')}\n        </div>\n    </div>\n    \n    <div class=\"footer\">\n        <p><strong>Rubric Generated:</strong> ${new Date().toLocaleDateString('en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    })}</p>\n        <p>Total Possible Points: <strong>${totalPoints}</strong> | Criteria: <strong>${rubricData.criteria.length}</strong> | Levels: <strong>${rubricData.rubricLevels.length}</strong></p>\n    </div>\n</body>\n</html>`;\n    const htmlBlob = new Blob([htmlContent], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(htmlBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `rubric_${rubricData.assignmentInfo.title.replace(/\\s+/g, '_') || 'display'}_${new Date().toISOString().split('T')[0]}.html`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n  const ContentDisplay = ({\n    content,\n    onEdit,\n    placeholder,\n    isTextarea = false,\n    className = \"\"\n  }) => {\n    const hasHtml = containsHtml(content);\n    if (hasHtml && !isTextarea) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `relative group ${className}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-2 border rounded text-xs bg-white min-h-[80px] max-h-[300px] overflow-y-auto\",\n          style: {\n            wordWrap: 'break-word',\n            overflowWrap: 'break-word',\n            whiteSpace: 'pre-wrap',\n            maxWidth: '100%'\n          },\n          dangerouslySetInnerHTML: {\n            __html: content\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: onEdit,\n          className: \"absolute top-1 right-1 opacity-70 group-hover:opacity-100 transition-opacity bg-blue-500 text-white rounded p-1 hover:bg-blue-600 cursor-pointer\",\n          title: \"Open rich text editor\",\n          children: /*#__PURE__*/_jsxDEV(Edit3, {\n            size: 12\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 17\n      }, this);\n    }\n    if (isTextarea) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: stripHtml(content),\n          onChange: e => onEdit(e.target.value),\n          className: `w-full p-3 border rounded-lg resize-both hover:border-blue-400 transition-all duration-200 pr-12 ${className}`,\n          rows: \"3\",\n          placeholder: placeholder,\n          title: \"Type here for quick editing, or click the expand button for rich text editor\",\n          style: {\n            minHeight: '80px',\n            maxHeight: '200px',\n            resize: 'both',\n            wordWrap: 'break-word',\n            overflowWrap: 'break-word'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => onEdit(null, true),\n          className: \"absolute top-2 right-2 z-10 opacity-70 hover:opacity-100 transition-opacity bg-blue-500 text-white rounded p-1 hover:bg-blue-600 cursor-pointer\",\n          title: \"Open rich text editor\",\n          children: /*#__PURE__*/_jsxDEV(Maximize2, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 550,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 528,\n        columnNumber: 17\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: stripHtml(content),\n        onChange: e => onEdit(e.target.value),\n        className: `w-full p-2 border rounded text-xs resize-both hover:border-blue-400 transition-all duration-200 pr-8 ${className}`,\n        rows: \"2\",\n        placeholder: placeholder,\n        title: \"Type here for quick editing, or click the expand button for rich text editor\",\n        style: {\n          minHeight: '48px',\n          maxHeight: '200px',\n          resize: 'both',\n          wordWrap: 'break-word',\n          overflowWrap: 'break-word'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 558,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: () => onEdit(null, true),\n        className: \"absolute top-1 right-1 z-10 opacity-70 hover:opacity-100 transition-opacity bg-blue-500 text-white rounded p-1 hover:bg-blue-600 cursor-pointer\",\n        title: \"Open rich text editor\",\n        children: /*#__PURE__*/_jsxDEV(Maximize2, {\n          size: 12\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 573,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 557,\n      columnNumber: 13\n    }, this);\n  };\n  const RichTextToolbar = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"border-b bg-gray-50 p-3\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap gap-1 mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex border-r border-gray-300 pr-2 mr-2\",\n        children: /*#__PURE__*/_jsxDEV(\"select\", {\n          onChange: e => {\n            if (e.target.value) {\n              handleRichTextCommand('formatBlock', e.target.value);\n              e.target.value = '';\n            }\n          },\n          className: \"p-1 text-xs border rounded\",\n          title: \"Text Format\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Format\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 594,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"h1\",\n            children: \"Heading 1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 595,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"h2\",\n            children: \"Heading 2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 596,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"h3\",\n            children: \"Heading 3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"p\",\n            children: \"Paragraph\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 598,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"blockquote\",\n            children: \"Quote\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"pre\",\n            children: \"Code Block\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 600,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 588,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex border-r border-gray-300 pr-2 mr-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => handleRichTextCommand('bold'),\n          className: \"p-2 hover:bg-gray-200 rounded\",\n          title: \"Bold (Ctrl+B)\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-bold\",\n            children: \"B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 605,\n            columnNumber: 153\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 605,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => handleRichTextCommand('italic'),\n          className: \"p-2 hover:bg-gray-200 rounded\",\n          title: \"Italic (Ctrl+I)\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"italic\",\n            children: \"I\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 606,\n            columnNumber: 157\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 606,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => handleRichTextCommand('underline'),\n          className: \"p-2 hover:bg-gray-200 rounded\",\n          title: \"Underline (Ctrl+U)\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"underline\",\n            children: \"U\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 163\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 607,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => handleRichTextCommand('strikeThrough'),\n          className: \"p-2 hover:bg-gray-200 rounded\",\n          title: \"Strikethrough\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"line-through\",\n            children: \"S\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 608,\n            columnNumber: 162\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 608,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 604,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex border-r border-gray-300 pr-2 mr-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"color\",\n          onChange: e => handleRichTextCommand('foreColor', e.target.value),\n          className: \"w-8 h-8 border rounded cursor-pointer\",\n          title: \"Text Color\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 612,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"color\",\n          onChange: e => handleRichTextCommand('hiliteColor', e.target.value),\n          className: \"w-8 h-8 border rounded cursor-pointer ml-1\",\n          title: \"Highlight Color\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 613,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 611,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex border-r border-gray-300 pr-2 mr-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => handleRichTextCommand('insertUnorderedList'),\n          className: \"p-2 hover:bg-gray-200 rounded\",\n          title: \"Bullet List\",\n          children: \"\\u2022 List\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => handleRichTextCommand('insertOrderedList'),\n          className: \"p-2 hover:bg-gray-200 rounded\",\n          title: \"Numbered List\",\n          children: \"1. List\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 616,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => handleRichTextCommand('removeFormat'),\n          className: \"p-2 hover:bg-gray-200 rounded\",\n          title: \"Clear Formatting\",\n          children: \"Clear\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 622,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 621,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 586,\n    columnNumber: 9\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-50 p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n                .rubric-table-container table { table-layout: fixed; width: 100%; }\n                .rubric-table-container td { max-width: 0; word-wrap: break-word; overflow-wrap: break-word; white-space: pre-wrap; vertical-align: top; }\n                .rich-text-editor li { margin: 0.2em 0; line-height: 1.4; }\n                .rich-text-editor li p { margin: 0; }\n                .rich-text-editor ul, .rich-text-editor ol { margin: 0.5em 0; padding-left: 1.5em; line-height: 1.5; }\n            `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 630,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-7xl mx-auto bg-white rounded-lg shadow-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-900 text-white p-6 rounded-t-lg\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-2xl font-bold\",\n              children: \"Professional Rubric Builder\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 641,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-blue-200\",\n              children: \"Create comprehensive assessment rubrics with detailed criteria and feedback\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 642,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 640,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex gap-2 flex-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: resetRubric,\n              className: \"bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(RotateCcw, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 645,\n                columnNumber: 151\n              }, this), \" Reset\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 645,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                var _importInputRef$curre;\n                return (_importInputRef$curre = importInputRef.current) === null || _importInputRef$curre === void 0 ? void 0 : _importInputRef$curre.click();\n              },\n              className: \"bg-purple-700 hover:bg-purple-600 px-3 py-2 rounded flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(Upload, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 646,\n                columnNumber: 181\n              }, this), \" Import\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 646,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: transferToGrading,\n              className: \"bg-blue-700 hover:bg-blue-600 px-3 py-2 rounded flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(ArrowRight, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 647,\n                columnNumber: 157\n              }, this), \" Use for Grading\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 647,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: saveRubric,\n              className: \"bg-teal-700 hover:bg-teal-600 px-3 py-2 rounded flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(Save, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 648,\n                columnNumber: 150\n              }, this), \" Save Draft\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 648,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportForGrading,\n              className: \"bg-green-700 hover:bg-green-600 px-3 py-2 rounded flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(Download, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 649,\n                columnNumber: 158\n              }, this), \" Export JSON\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 649,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportToHTML,\n              className: \"bg-orange-700 hover:bg-orange-600 px-3 py-2 rounded flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(FileText, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 650,\n                columnNumber: 156\n              }, this), \" Export HTML\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 650,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 644,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 639,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 638,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"assignment-info bg-blue-50 border border-blue-200 p-6 rounded-lg mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold text-blue-800 mb-4\",\n            children: \"Assignment Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 657,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-1\",\n                children: \"Assignment Title *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 660,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: rubricData.assignmentInfo.title,\n                onChange: e => updateAssignmentInfo('title', e.target.value),\n                className: \"w-full p-3 border rounded-lg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 661,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 659,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-1\",\n                children: \"Weight (% of Final Grade)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 664,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                value: rubricData.assignmentInfo.weight,\n                onChange: e => updateAssignmentInfo('weight', parseInt(e.target.value) || 0),\n                className: \"w-full p-3 border rounded-lg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 665,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 663,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"md:col-span-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-1\",\n                children: \"Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 668,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(ContentDisplay, {\n                content: rubricData.assignmentInfo.description,\n                onEdit: (value, openRichEditor) => {\n                  if (openRichEditor) openInlineEditor(rubricData.assignmentInfo.description, 'Assignment Description', newContent => updateAssignmentInfo('description', newContent), null, null, 'assignment');else updateAssignmentInfo('description', value);\n                },\n                isTextarea: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 667,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 656,\n          columnNumber: 21\n        }, this), inlineEditor.show && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-lg shadow-2xl w-full max-w-3xl flex flex-col\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between items-center p-4 border-b\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-lg font-semibold\",\n                children: inlineEditor.field\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 686,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => closeInlineEditor(true),\n                  className: \"bg-blue-600 text-white px-4 py-2 rounded mr-2\",\n                  children: \"Save\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 688,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => closeInlineEditor(false),\n                  className: \"bg-gray-600 text-white px-4 py-2 rounded\",\n                  children: \"Cancel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 689,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 687,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 685,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(RichTextToolbar, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 692,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-4 flex-grow\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: editorRef,\n                contentEditable: true,\n                onInput: handleRichTextChange,\n                onKeyDown: handleKeyDown,\n                onPaste: handlePaste,\n                className: \"w-full h-full p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 rich-text-editor\",\n                style: {\n                  minHeight: '300px'\n                },\n                suppressContentEditableWarning: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 694,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 693,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 684,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 683,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white border rounded-lg overflow-hidden mb-6 rubric-table-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-50 p-4 border-b flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-semibold text-gray-800\",\n              children: \"Assessment Criteria Matrix\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 712,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: addCriterion,\n              className: \"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(Plus, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 713,\n                columnNumber: 155\n              }, this), \" Add Criterion\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 713,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 711,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"overflow-x-auto\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"w-full border-collapse\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"bg-gray-100\",\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"border p-3 text-left font-semibold\",\n                    children: \"Criterion\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 719,\n                    columnNumber: 41\n                  }, this), getDisplayLevels().map(level => /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"border p-3 text-center font-semibold\",\n                    style: {\n                      backgroundColor: level.color + '20',\n                      color: level.color\n                    },\n                    children: level.name\n                  }, level.level, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 721,\n                    columnNumber: 45\n                  }, this)), /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"border p-3 text-center font-semibold\",\n                    children: \"Actions\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 723,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 718,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 717,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: rubricData.criteria.map((criterion, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"border p-3 bg-gray-50\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"text\",\n                      value: criterion.name,\n                      onChange: e => updateCriterion(criterion.id, 'name', e.target.value),\n                      className: \"w-full p-2 border rounded mb-2\",\n                      placeholder: `Criterion ${index + 1}`\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 730,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(ContentDisplay, {\n                      content: criterion.description,\n                      onEdit: (value, openRichEditor) => {\n                        if (openRichEditor) openInlineEditor(criterion.description, `Criterion Description`, newContent => updateCriterion(criterion.id, 'description', newContent), criterion.id, null, 'criterion');else updateCriterion(criterion.id, 'description', value);\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 731,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      value: criterion.maxPoints,\n                      onChange: e => updateCriterion(criterion.id, 'maxPoints', parseInt(e.target.value) || 0),\n                      className: \"w-full p-1 border rounded text-sm mt-2\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 738,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 729,\n                    columnNumber: 45\n                  }, this), getDisplayLevels().map(level => {\n                    var _criterion$levels$lev3;\n                    return /*#__PURE__*/_jsxDEV(\"td\", {\n                      className: \"border p-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"font-bold text-center text-sm\",\n                        style: {\n                          color: level.color\n                        },\n                        children: [calculatePointRange(criterion, level.level), \" pts\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 742,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(ContentDisplay, {\n                        content: ((_criterion$levels$lev3 = criterion.levels[level.level]) === null || _criterion$levels$lev3 === void 0 ? void 0 : _criterion$levels$lev3.description) || '',\n                        onEdit: (value, openRichEditor) => {\n                          var _criterion$levels$lev4;\n                          if (openRichEditor) openInlineEditor((_criterion$levels$lev4 = criterion.levels[level.level]) === null || _criterion$levels$lev4 === void 0 ? void 0 : _criterion$levels$lev4.description, `${level.name} Description`, newContent => updateCriterionLevel(criterion.id, level.level, 'description', newContent), criterion.id, level.level, 'level');else updateCriterionLevel(criterion.id, level.level, 'description', value);\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 743,\n                        columnNumber: 53\n                      }, this)]\n                    }, level.level, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 741,\n                      columnNumber: 49\n                    }, this);\n                  }), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"border p-3 text-center\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => removeCriterion(criterion.id),\n                      className: \"text-red-600 hover:text-red-800\",\n                      disabled: rubricData.criteria.length <= 1,\n                      children: /*#__PURE__*/_jsxDEV(X, {\n                        size: 16\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 753,\n                        columnNumber: 190\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 753,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 752,\n                    columnNumber: 45\n                  }, this)]\n                }, criterion.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 728,\n                  columnNumber: 41\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 726,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 716,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 715,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 710,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 654,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: importInputRef,\n        type: \"file\",\n        accept: \".json\",\n        onChange: importRubric,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 762,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 637,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 629,\n    columnNumber: 9\n  }, this);\n};\n_s(RubricCreator, \"7CD80XQM+wGRCQUpDORzu/od28E=\", false, function () {\n  return [useAssessment];\n});\n_c = RubricCreator;\nexport default RubricCreator;\nvar _c;\n$RefreshReg$(_c, \"RubricCreator\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Plus","X","Upload","Download","Save","FileText","RotateCcw","ChevronDown","ChevronUp","Maximize2","ArrowRight","Minimize2","Edit3","useAssessment","jsxDEV","_jsxDEV","pasteAsMarkdown","text","lines","split","html","inList","listType","closeList","forEach","line","trimmedLine","trim","isNumberedList","test","isBulletedList","currentListType","replace","RubricCreator","_s","sharedRubric","setSharedRubric","transferRubricToGradingWithDetails","activeTab","defaultLevels","level","name","description","color","multiplier","rubricData","setRubricData","assignmentInfo","title","weight","passingThreshold","totalPoints","rubricLevels","criteria","id","maxPoints","levels","feedbackLibrary","strengths","improvements","general","pointingSystem","setPointingSystem","reversedOrder","setReversedOrder","showGuide","setShowGuide","expandedFeedback","setExpandedFeedback","inlineEditor","setInlineEditor","show","content","field","onSave","criterionId","type","autoSaveTimeout","setAutoSaveTimeout","richTextContentRef","editorRef","importInputRef","containsHtml","stripHtml","tempDiv","document","createElement","innerHTML","textContent","innerText","sanitizeHtml","ALLOWED_TAGS","ALLOWED_ATTRS","doc","DOMParser","parseFromString","frag","createDocumentFragment","cleanNode","node","nodeType","Node","TEXT_NODE","createTextNode","ELEMENT_NODE","tag","tagName","toLowerCase","includes","el","attr","attributes","setAttribute","value","childNodes","child","cleanedChild","appendChild","container","Array","from","body","n","cleaned","wrapper","saveCursorPosition","selection","window","getSelection","rangeCount","getRangeAt","restoreCursorPosition","range","removeAllRanges","addRange","clearTimeout","setTimeout","toggleFeedbackExpansion","p","openInlineEditor","current","focus","createRange","selectNodeContents","collapse","handleRichTextCommand","command","execCommand","handleRichTextChange","handlePaste","e","preventDefault","clipboardData","pasteData","types","dirtyHtml","getData","plainText","handleKeyDown","key","ctrlKey","metaKey","closeInlineEditor","save","calculateTotalPoints","reduce","total","c","updateAssignmentInfo","prev","updated","addCriterion","newCriterion","Date","now","removeCriterion","filter","updateCriterion","map","updateCriterionLevel","addFeedbackItem","cat","item","removeFeedbackItem","index","_","i","calculatePointRange","criterion","_criterion$levels$lev","rubricLevel","find","l","Math","round","toString","pointRange","getDisplayLevels","reverse","prepareRubricForExport","exportData","Object","fromEntries","_c$levels$l$level","downloadJson","data","fileName","blob","Blob","JSON","stringify","url","URL","createObjectURL","link","href","download","click","revokeObjectURL","saveRubric","toISOString","exportForGrading","transferToGrading","importRubric","file","target","files","reader","FileReader","onload","ev","imported","parse","result","alert","err","message","readAsText","resetRubric","confirm","exportToHTML","displayLevels","htmlContent","length","join","_criterion$levels$lev2","toFixed","toLocaleDateString","weekday","year","month","day","hour","minute","htmlBlob","ContentDisplay","onEdit","placeholder","isTextarea","className","hasHtml","children","style","wordWrap","overflowWrap","whiteSpace","maxWidth","dangerouslySetInnerHTML","__html","_jsxFileName","lineNumber","columnNumber","onClick","size","onChange","rows","minHeight","maxHeight","resize","RichTextToolbar","_importInputRef$curre","parseInt","openRichEditor","newContent","ref","contentEditable","onInput","onKeyDown","onPaste","suppressContentEditableWarning","backgroundColor","_criterion$levels$lev3","_criterion$levels$lev4","disabled","accept","_c","$RefreshReg$"],"sources":["C:/local clones/rubric-creation-app/src/components/RubricCreator.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { Plus, X, Upload, Download, Save, FileText, RotateCcw, ChevronDown, ChevronUp, Maximize2, ArrowRight, Minimize2, Edit3 } from 'lucide-react';\r\nimport { useAssessment } from './SharedContext';\r\n\r\n/**\r\n * ===================================================================================\r\n * MARKDOWN PASTE UTILITY\r\n * ===================================================================================\r\n * This function converts plain text (with markdown-like lists) into clean HTML.\r\n * It's used as a fallback when the clipboard doesn't contain rich HTML content.\r\n *\r\n * @param {string} text - The plain text from the clipboard.\r\n * @returns {string} - A clean HTML string.\r\n */\r\nconst pasteAsMarkdown = (text) => {\r\n    if (!text) return '';\r\n\r\n    const lines = text.split('\\n');\r\n    let html = '';\r\n    let inList = false;\r\n    let listType = null; // 'ol' or 'ul'\r\n\r\n    const closeList = () => {\r\n        if (inList) {\r\n            html += `</${listType}>`;\r\n            inList = false;\r\n            listType = null;\r\n        }\r\n    };\r\n\r\n    lines.forEach(line => {\r\n        const trimmedLine = line.trim();\r\n        const isNumberedList = /^\\d+\\.\\s/.test(trimmedLine);\r\n        const isBulletedList = /^(\\*|-)\\s/.test(trimmedLine);\r\n\r\n        if (isNumberedList || isBulletedList) {\r\n            const currentListType = isNumberedList ? 'ol' : 'ul';\r\n            if (!inList || currentListType !== listType) {\r\n                closeList();\r\n                html += `<${currentListType}>`;\r\n                inList = true;\r\n                listType = currentListType;\r\n            }\r\n            html += `<li>${trimmedLine.replace(/^(\\d+\\.|\\*|-)\\s/, '')}</li>`;\r\n        } else {\r\n            closeList();\r\n            if (trimmedLine) {\r\n                html += `<p>${trimmedLine}</p>`;\r\n            }\r\n        }\r\n    });\r\n\r\n    closeList();\r\n    return html;\r\n};\r\n\r\n\r\nconst RubricCreator = () => {\r\n    const {\r\n        sharedRubric,\r\n        setSharedRubric,\r\n        transferRubricToGradingWithDetails,\r\n        activeTab\r\n    } = useAssessment();\r\n\r\n    const defaultLevels = [\r\n        { level: 'incomplete', name: 'Incomplete', description: 'No submission or unusable', color: '#95a5a6', multiplier: 0 },\r\n        { level: 'unacceptable', name: 'Unacceptable', description: 'Below minimum standards', color: '#e74c3c', multiplier: 0.3 },\r\n        { level: 'developing', name: 'Developing', description: 'Approaching standards', color: '#f39c12', multiplier: 0.55 },\r\n        { level: 'acceptable', name: 'Acceptable (PASS)', description: 'Meets minimum standards', color: '#27ae60', multiplier: 0.7 },\r\n        { level: 'emerging', name: 'Emerging', description: 'Above standard expectations', color: '#2980b9', multiplier: 0.82 },\r\n        { level: 'accomplished', name: 'Accomplished', description: 'Strong professional quality', color: '#16a085', multiplier: 0.92 },\r\n        { level: 'exceptional', name: 'Exceptional', description: 'Outstanding professional quality', color: '#8e44ad', multiplier: 1.0 }\r\n    ];\r\n\r\n    const [rubricData, setRubricData] = useState(() => {\r\n        return sharedRubric || {\r\n            assignmentInfo: { title: '', description: '', weight: 25, passingThreshold: 60, totalPoints: 100 },\r\n            rubricLevels: [...defaultLevels],\r\n            criteria: [{ id: 'criterion-1', name: '', description: '', maxPoints: 20, weight: 20, levels: {}, feedbackLibrary: { strengths: [], improvements: [], general: [] } }]\r\n        };\r\n    });\r\n\r\n    const [pointingSystem, setPointingSystem] = useState('multiplier');\r\n    const [reversedOrder, setReversedOrder] = useState(false);\r\n    const [showGuide, setShowGuide] = useState(false);\r\n    const [expandedFeedback, setExpandedFeedback] = useState({});\r\n    const [inlineEditor, setInlineEditor] = useState({ show: false, content: '', field: null, onSave: null, criterionId: null, level: null, type: null });\r\n    const [autoSaveTimeout, setAutoSaveTimeout] = useState(null);\r\n    const richTextContentRef = useRef('');\r\n    const editorRef = useRef(null);\r\n    const importInputRef = useRef(null);\r\n\r\n    const containsHtml = (content) => /<[^>]*>/.test(content);\r\n    const stripHtml = (html) => {\r\n        const tempDiv = document.createElement('div');\r\n        tempDiv.innerHTML = html;\r\n        return tempDiv.textContent || tempDiv.innerText || '';\r\n    };\r\n\r\n    /**\r\n     * ===================================================================================\r\n     * NEW, ROBUST HTML SANITIZER\r\n     * ===================================================================================\r\n     * This function is adapted from the `editor.js` logic. It safely cleans\r\n     * pasted HTML by parsing it and allowing only a specific list of tags and attributes.\r\n     * This preserves rich text formatting while removing unwanted styles and scripts.\r\n     *\r\n     * @param {string} html - The potentially dirty HTML string from the clipboard.\r\n     * @returns {string} - Sanitized HTML ready for insertion.\r\n     */\r\n    const sanitizeHtml = (html) => {\r\n        // Define tags and attributes allowed from pasted content, matching the Rich Text Editor's capabilities.\r\n        const ALLOWED_TAGS = [\r\n            'h1', 'h2', 'h3', 'p', 'blockquote', 'pre', 'b', 'strong', 'i', 'em', 'u', 'strike', 's',\r\n            'ul', 'ol', 'li', 'a', 'br', 'hr', 'sup', 'sub', 'div', 'span', 'font'\r\n        ];\r\n        const ALLOWED_ATTRS = ['href', 'title', 'style', 'color', 'size', 'face'];\r\n\r\n        const doc = new DOMParser().parseFromString(html, 'text/html');\r\n        const frag = document.createDocumentFragment();\r\n\r\n        function cleanNode(node) {\r\n            if (node.nodeType === Node.TEXT_NODE) {\r\n                // Keep text nodes\r\n                return document.createTextNode(node.textContent);\r\n            }\r\n\r\n            if (node.nodeType === Node.ELEMENT_NODE) {\r\n                const tag = node.tagName.toLowerCase();\r\n\r\n                if (ALLOWED_TAGS.includes(tag)) {\r\n                    const el = document.createElement(tag);\r\n\r\n                    // Copy allowed attributes from the original node to the new element\r\n                    for (const attr of node.attributes) {\r\n                        if (ALLOWED_ATTRS.includes(attr.name.toLowerCase())) {\r\n                            el.setAttribute(attr.name, attr.value);\r\n                        }\r\n                    }\r\n\r\n                    // Recursively clean and append child nodes\r\n                    node.childNodes.forEach(child => {\r\n                        const cleanedChild = cleanNode(child);\r\n                        if (cleanedChild) el.appendChild(cleanedChild);\r\n                    });\r\n                    return el;\r\n\r\n                } else {\r\n                    // If the tag is not allowed, flatten it by processing its children directly\r\n                    const container = document.createDocumentFragment();\r\n                    node.childNodes.forEach(child => {\r\n                        const cleanedChild = cleanNode(child);\r\n                        if (cleanedChild) container.appendChild(cleanedChild);\r\n                    });\r\n                    return container;\r\n                }\r\n            }\r\n            return null; // Ignore other node types (comments, etc.)\r\n        }\r\n\r\n        Array.from(doc.body.childNodes).forEach(n => {\r\n            const cleaned = cleanNode(n);\r\n            if (cleaned) frag.appendChild(cleaned);\r\n        });\r\n\r\n        const wrapper = document.createElement('div');\r\n        wrapper.appendChild(frag);\r\n        return wrapper.innerHTML;\r\n    };\r\n\r\n    const saveCursorPosition = () => {\r\n        const selection = window.getSelection();\r\n        if (selection.rangeCount === 0) return null;\r\n        return selection.getRangeAt(0);\r\n    };\r\n\r\n    const restoreCursorPosition = (range) => {\r\n        if (!range) return;\r\n        const selection = window.getSelection();\r\n        selection.removeAllRanges();\r\n        selection.addRange(range);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (autoSaveTimeout) clearTimeout(autoSaveTimeout);\r\n        const id = setTimeout(() => setSharedRubric(rubricData), 1000);\r\n        setAutoSaveTimeout(id);\r\n        return () => clearTimeout(id);\r\n    }, [rubricData, setSharedRubric]);\r\n\r\n    useEffect(() => {\r\n        if (sharedRubric && activeTab === 'rubric-creator') {\r\n            setRubricData(sharedRubric);\r\n        }\r\n    }, [sharedRubric, activeTab]);\r\n\r\n    const toggleFeedbackExpansion = (id) => setExpandedFeedback(p => ({ ...p, [id]: !p[id] }));\r\n\r\n    const openInlineEditor = (content, field, onSave, criterionId = null, level = null, type = 'assignment') => {\r\n        richTextContentRef.current = content || '';\r\n        setInlineEditor({ show: true, content: content || '', field, onSave, criterionId, level, type });\r\n        setTimeout(() => {\r\n            if (editorRef.current) {\r\n                editorRef.current.innerHTML = content || '';\r\n                editorRef.current.focus();\r\n                const range = document.createRange();\r\n                const selection = window.getSelection();\r\n                range.selectNodeContents(editorRef.current);\r\n                range.collapse(false);\r\n                selection.removeAllRanges();\r\n                selection.addRange(range);\r\n            }\r\n        }, 100);\r\n    };\r\n\r\n    const handleRichTextCommand = (command, value = null) => {\r\n        if (editorRef.current) {\r\n            editorRef.current.focus();\r\n            document.execCommand(command, false, value);\r\n            richTextContentRef.current = editorRef.current.innerHTML;\r\n        }\r\n    };\r\n\r\n    const handleRichTextChange = () => {\r\n        if (editorRef.current) richTextContentRef.current = editorRef.current.innerHTML;\r\n    };\r\n\r\n    /**\r\n     * ===================================================================================\r\n     * NEW, IMPROVED PASTE HANDLER\r\n     * ===================================================================================\r\n     * This function now correctly handles pasted content by prioritizing HTML and\r\n     * cleaning it with the robust `sanitizeHtml` function.\r\n     */\r\n    const handlePaste = (e) => {\r\n        e.preventDefault();\r\n        const clipboardData = e.clipboardData || window.clipboardData;\r\n        let pasteData = '';\r\n\r\n        // Prioritize HTML content if available, as it contains rich formatting.\r\n        if (clipboardData.types.includes('text/html')) {\r\n            const dirtyHtml = clipboardData.getData('text/html');\r\n            // Use the new robust sanitize function to clean the HTML.\r\n            pasteData = sanitizeHtml(dirtyHtml);\r\n        } else {\r\n            // Fallback for plain text: use the markdown converter for lists.\r\n            const plainText = clipboardData.getData('text/plain');\r\n            pasteData = pasteAsMarkdown(plainText);\r\n        }\r\n\r\n        // Insert the final cleaned HTML into the editor.\r\n        document.execCommand('insertHTML', false, pasteData);\r\n    };\r\n\r\n    const handleKeyDown = (e) => {\r\n        if (!editorRef.current) return;\r\n        if (e.key === 'Tab') {\r\n            e.preventDefault();\r\n            document.execCommand('insertHTML', false, '&nbsp;&nbsp;&nbsp;&nbsp;');\r\n        }\r\n        if (e.ctrlKey || e.metaKey) {\r\n            switch (e.key) {\r\n                case 'b': e.preventDefault(); handleRichTextCommand('bold'); break;\r\n                case 'i': e.preventDefault(); handleRichTextCommand('italic'); break;\r\n                case 'u': e.preventDefault(); handleRichTextCommand('underline'); break;\r\n                default: break;\r\n            }\r\n        }\r\n        setTimeout(() => handleRichTextChange(), 0);\r\n    };\r\n\r\n    const closeInlineEditor = (save = false) => {\r\n        if (save && inlineEditor.onSave) {\r\n            // The ref has the most up-to-date HTML content.\r\n            inlineEditor.onSave(richTextContentRef.current);\r\n        }\r\n        setInlineEditor({ show: false, content: '', field: null, onSave: null, criterionId: null, level: null, type: null });\r\n        richTextContentRef.current = '';\r\n    };\r\n\r\n    const calculateTotalPoints = () => rubricData.criteria.reduce((total, c) => total + c.maxPoints, 0);\r\n\r\n    const updateAssignmentInfo = (field, value) => {\r\n        setRubricData(prev => {\r\n            const updated = { ...prev, assignmentInfo: { ...prev.assignmentInfo, [field]: value } };\r\n            if (field !== 'totalPoints') updated.assignmentInfo.totalPoints = calculateTotalPoints();\r\n            return updated;\r\n        });\r\n    };\r\n\r\n    const addCriterion = () => {\r\n        const newCriterion = { id: `criterion-${Date.now()}`, name: '', description: '', maxPoints: 20, weight: 20, levels: {}, feedbackLibrary: { strengths: [], improvements: [], general: [] } };\r\n        setRubricData(prev => ({ ...prev, criteria: [...prev.criteria, newCriterion] }));\r\n    };\r\n\r\n    const removeCriterion = (id) => setRubricData(prev => ({ ...prev, criteria: prev.criteria.filter(c => c.id !== id) }));\r\n    const updateCriterion = (id, field, value) => setRubricData(prev => ({ ...prev, criteria: prev.criteria.map(c => c.id === id ? { ...c, [field]: value } : c) }));\r\n    const updateCriterionLevel = (id, level, field, value) => {\r\n        setRubricData(prev => ({\r\n            ...prev,\r\n            criteria: prev.criteria.map(c => c.id === id ? { ...c, levels: { ...c.levels, [level]: { ...c.levels[level], [field]: value } } } : c)\r\n        }));\r\n    };\r\n\r\n    const addFeedbackItem = (id, cat, item) => {\r\n        if (!item?.trim()) return;\r\n        setRubricData(prev => ({\r\n            ...prev,\r\n            criteria: prev.criteria.map(c => c.id === id ? { ...c, feedbackLibrary: { ...c.feedbackLibrary, [cat]: [...c.feedbackLibrary[cat], item.trim()] } } : c)\r\n        }));\r\n    };\r\n\r\n    const removeFeedbackItem = (id, cat, index) => {\r\n        setRubricData(prev => ({\r\n            ...prev,\r\n            criteria: prev.criteria.map(c => c.id === id ? { ...c, feedbackLibrary: { ...c.feedbackLibrary, [cat]: c.feedbackLibrary[cat].filter((_, i) => i !== index) } } : c)\r\n        }));\r\n    };\r\n\r\n    const calculatePointRange = (criterion, level) => {\r\n        const rubricLevel = rubricData.rubricLevels.find(l => l.level === level);\r\n        if (!rubricLevel) return '0';\r\n        return pointingSystem === 'multiplier' ? (level === 'incomplete' ? '0' : Math.round(criterion.maxPoints * rubricLevel.multiplier).toString()) : (criterion.levels[level]?.pointRange || '0');\r\n    };\r\n\r\n    const getDisplayLevels = () => reversedOrder ? [...rubricData.rubricLevels].reverse() : rubricData.rubricLevels;\r\n\r\n    const prepareRubricForExport = () => {\r\n        const exportData = { ...rubricData, assignmentInfo: { ...rubricData.assignmentInfo, totalPoints: calculateTotalPoints() } };\r\n        exportData.criteria = exportData.criteria.map(c => ({ ...c, levels: Object.fromEntries(rubricData.rubricLevels.map(l => [l.level, { pointRange: calculatePointRange(c, l.level), description: c.levels[l.level]?.description || '' }])) }));\r\n        return exportData;\r\n    };\r\n\r\n    const downloadJson = (data, fileName) => {\r\n        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = fileName;\r\n        link.click();\r\n        URL.revokeObjectURL(url);\r\n    };\r\n\r\n    const saveRubric = () => downloadJson(rubricData, `rubric_${rubricData.assignmentInfo.title.replace(/\\s+/g, '_') || 'draft'}_${new Date().toISOString().split('T')[0]}.json`);\r\n    const exportForGrading = () => downloadJson(prepareRubricForExport(), `rubric_${rubricData.assignmentInfo.title.replace(/\\s+/g, '_') || 'export'}_final.json`);\r\n    const transferToGrading = () => transferRubricToGradingWithDetails(prepareRubricForExport());\r\n\r\n    const importRubric = (e) => {\r\n        const file = e.target.files[0];\r\n        if (file) {\r\n            const reader = new FileReader();\r\n            reader.onload = (ev) => {\r\n                try {\r\n                    const imported = JSON.parse(ev.target.result);\r\n                    if (imported.assignmentInfo && imported.criteria && imported.rubricLevels) setRubricData(imported);\r\n                    else alert('Invalid rubric format.');\r\n                } catch (err) {\r\n                    alert('Error loading rubric: ' + err.message);\r\n                }\r\n            };\r\n            reader.readAsText(file);\r\n        }\r\n        e.target.value = '';\r\n    };\r\n\r\n    const resetRubric = () => {\r\n        if (window.confirm('Reset to a blank rubric? All current work will be lost.')) {\r\n            setRubricData({\r\n                assignmentInfo: { title: '', description: '', weight: 25, passingThreshold: 60, totalPoints: 100 },\r\n                rubricLevels: [...defaultLevels],\r\n                criteria: [{ id: 'criterion-1', name: '', description: '', maxPoints: 20, weight: 20, levels: {}, feedbackLibrary: { strengths: [], improvements: [], general: [] } }]\r\n            });\r\n        }\r\n    };\r\n\r\n    // ... The rest of the component's render logic, including JSX, remains the same.\r\n    // The ContentDisplay, RichTextToolbar, and all table rendering logic are unchanged.\r\n    // I am omitting the large JSX block for brevity as no changes were made to it.\r\n    // The key changes are the new `sanitizeHtml` function and the updated `handlePaste` function shown above.\r\n\r\n    const exportToHTML = () => {\r\n        const displayLevels = getDisplayLevels();\r\n        const totalPoints = calculateTotalPoints();\r\n\r\n        const htmlContent = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>${rubricData.assignmentInfo.title || 'Assessment Rubric'} - Rubric</title>\r\n    <style>\r\n        body { font-family: 'Arial', sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; line-height: 1.4; }\r\n        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 3px solid #1e40af; }\r\n        .header h1 { color: #1e40af; margin-bottom: 10px; }\r\n        .assignment-info { background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #e2e8f0; }\r\n        .rubric-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 0.85rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }\r\n        .rubric-table th, .rubric-table td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }\r\n        .rubric-table th { background: #1e40af; color: white; text-align: center; font-weight: 600; }\r\n        .criterion-name { font-weight: bold; background: #f8fafc; padding: 15px; }\r\n        .point-range { text-align: center; font-weight: bold; color: #1e40af; font-size: 1.1em; }\r\n        .level-description { font-size: 0.9rem; line-height: 1.4; }\r\n        .overall-score { background: #eff6ff; padding: 25px; border-radius: 8px; margin-top: 30px; border: 2px solid #bfdbfe; }\r\n        .footer { margin-top: 40px; text-align: center; font-size: 0.9rem; color: #666; border-top: 1px solid #e2e8f0; padding-top: 20px; }\r\n        .level-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-top: 20px; }\r\n        .level-card { text-align: center; padding: 15px; border-radius: 8px; border: 2px solid; }\r\n        @media print { body { margin: 0; padding: 15px; } .level-grid { break-inside: avoid; } }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <h1>${rubricData.assignmentInfo.title || 'Assessment Rubric'}</h1>\r\n        <p style=\"color: #64748b; font-size: 1.1em;\">${stripHtml(rubricData.assignmentInfo.description) || 'No description provided'}</p>\r\n    </div>\r\n    \r\n    <div class=\"assignment-info\">\r\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\r\n            <p><strong>Assignment Weight:</strong> ${rubricData.assignmentInfo.weight}% of Final Grade</p>\r\n            <p><strong>Passing Threshold:</strong> ${rubricData.assignmentInfo.passingThreshold}%</p>\r\n            <p><strong>Total Points:</strong> ${totalPoints}</p>\r\n            <p><strong>Number of Criteria:</strong> ${rubricData.criteria.length}</p>\r\n        </div>\r\n    </div>\r\n    \r\n    <table class=\"rubric-table\">\r\n        <thead>\r\n            <tr>\r\n                <th style=\"width: 20%\">Criterion</th>\r\n                ${displayLevels.map(level => `<th style=\"width: ${80 / displayLevels.length}%; background-color: ${level.color};\">${level.name}</th>`).join('')}\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            ${rubricData.criteria.map(criterion => `\r\n                <tr>\r\n                    <td class=\"criterion-name\">\r\n                        <strong style=\"color: #1e40af; font-size: 1.1em;\">${criterion.name || 'Unnamed Criterion'}</strong>\r\n                        <div style=\"font-weight: normal; color: #475569; margin-top: 8px; font-style: italic;\">\r\n                            ${(criterion.description) || 'No description provided'}\r\n                        </div>\r\n                        <div style=\"background: #1e40af; color: white; padding: 5px 10px; border-radius: 4px; margin-top: 10px; text-align: center; font-weight: bold;\">\r\n                            ${criterion.maxPoints} points\r\n                        </div>\r\n                    </td>\r\n                    ${displayLevels.map(level => `\r\n                        <td style=\"background-color: ${level.color}08;\">\r\n                            <div class=\"point-range\" style=\"color: ${level.color}; margin-bottom: 10px;\">\r\n                                ${calculatePointRange(criterion, level.level)} pts\r\n                            </div>\r\n                            <div class=\"level-description\">\r\n                                ${(criterion.levels[level.level]?.description) || '<em>Not defined</em>'}\r\n                            </div>\r\n                        </td>\r\n                    `).join('')}\r\n                </tr>\r\n            `).join('')}\r\n        </tbody>\r\n    </table>\r\n    \r\n    <div class=\"overall-score\">\r\n        <h3 style=\"color: #1e40af; margin-bottom: 15px;\">Overall Achievement Levels</h3>\r\n        <p style=\"color: #475569; margin-bottom: 20px;\">Each submission receives an overall achievement level based on total rubric score.</p>\r\n        <div class=\"level-grid\">\r\n            ${displayLevels.map(level => `\r\n                <div class=\"level-card\" style=\"border-color: ${level.color}; background-color: ${level.color}15;\">\r\n                    <div style=\"font-weight: bold; color: ${level.color}; margin-bottom: 5px;\">${level.name}</div>\r\n                    <div style=\"font-size: 1.2em; font-weight: bold; margin: 8px 0; color: ${level.color};\">\r\n                        ${Math.round(totalPoints * level.multiplier)}+ pts\r\n                    </div>\r\n                    <div style=\"font-size: 0.8em; color: #64748b;\">${(level.multiplier * 100).toFixed(0)}% or higher</div>\r\n                </div>\r\n            `).join('')}\r\n        </div>\r\n    </div>\r\n    \r\n    <div class=\"footer\">\r\n        <p><strong>Rubric Generated:</strong> ${new Date().toLocaleDateString('en-US', {\r\n            weekday: 'long',\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric',\r\n            hour: '2-digit',\r\n            minute: '2-digit'\r\n        })}</p>\r\n        <p>Total Possible Points: <strong>${totalPoints}</strong> | Criteria: <strong>${rubricData.criteria.length}</strong> | Levels: <strong>${rubricData.rubricLevels.length}</strong></p>\r\n    </div>\r\n</body>\r\n</html>`;\r\n\r\n        const htmlBlob = new Blob([htmlContent], { type: 'text/html' });\r\n        const url = URL.createObjectURL(htmlBlob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = `rubric_${rubricData.assignmentInfo.title.replace(/\\s+/g, '_') || 'display'}_${new Date().toISOString().split('T')[0]}.html`;\r\n        link.click();\r\n        URL.revokeObjectURL(url);\r\n    };\r\n\r\n    const ContentDisplay = ({ content, onEdit, placeholder, isTextarea = false, className = \"\" }) => {\r\n        const hasHtml = containsHtml(content);\r\n\r\n        if (hasHtml && !isTextarea) {\r\n            return (\r\n                <div className={`relative group ${className}`}>\r\n                    <div\r\n                        className=\"p-2 border rounded text-xs bg-white min-h-[80px] max-h-[300px] overflow-y-auto\"\r\n                        style={{\r\n                            wordWrap: 'break-word',\r\n                            overflowWrap: 'break-word',\r\n                            whiteSpace: 'pre-wrap',\r\n                            maxWidth: '100%'\r\n                        }}\r\n                        dangerouslySetInnerHTML={{ __html: content }}\r\n                    />\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={onEdit}\r\n                        className=\"absolute top-1 right-1 opacity-70 group-hover:opacity-100 transition-opacity bg-blue-500 text-white rounded p-1 hover:bg-blue-600 cursor-pointer\"\r\n                        title=\"Open rich text editor\"\r\n                    >\r\n                        <Edit3 size={12} />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (isTextarea) {\r\n            return (\r\n                <div className=\"relative\">\r\n                    <textarea\r\n                        value={stripHtml(content)}\r\n                        onChange={(e) => onEdit(e.target.value)}\r\n                        className={`w-full p-3 border rounded-lg resize-both hover:border-blue-400 transition-all duration-200 pr-12 ${className}`}\r\n                        rows=\"3\"\r\n                        placeholder={placeholder}\r\n                        title=\"Type here for quick editing, or click the expand button for rich text editor\"\r\n                        style={{\r\n                            minHeight: '80px',\r\n                            maxHeight: '200px',\r\n                            resize: 'both',\r\n                            wordWrap: 'break-word',\r\n                            overflowWrap: 'break-word'\r\n                        }}\r\n                    />\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => onEdit(null, true)}\r\n                        className=\"absolute top-2 right-2 z-10 opacity-70 hover:opacity-100 transition-opacity bg-blue-500 text-white rounded p-1 hover:bg-blue-600 cursor-pointer\"\r\n                        title=\"Open rich text editor\"\r\n                    >\r\n                        <Maximize2 size={14} />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"relative\">\r\n                <textarea\r\n                    value={stripHtml(content)}\r\n                    onChange={(e) => onEdit(e.target.value)}\r\n                    className={`w-full p-2 border rounded text-xs resize-both hover:border-blue-400 transition-all duration-200 pr-8 ${className}`}\r\n                    rows=\"2\"\r\n                    placeholder={placeholder}\r\n                    title=\"Type here for quick editing, or click the expand button for rich text editor\"\r\n                    style={{\r\n                        minHeight: '48px',\r\n                        maxHeight: '200px',\r\n                        resize: 'both',\r\n                        wordWrap: 'break-word',\r\n                        overflowWrap: 'break-word'\r\n                    }}\r\n                />\r\n                <button\r\n                    type=\"button\"\r\n                    onClick={() => onEdit(null, true)}\r\n                    className=\"absolute top-1 right-1 z-10 opacity-70 hover:opacity-100 transition-opacity bg-blue-500 text-white rounded p-1 hover:bg-blue-600 cursor-pointer\"\r\n                    title=\"Open rich text editor\"\r\n                >\r\n                    <Maximize2 size={12} />\r\n                </button>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const RichTextToolbar = () => (\r\n        <div className=\"border-b bg-gray-50 p-3\">\r\n            <div className=\"flex flex-wrap gap-1 mb-2\">\r\n                <div className=\"flex border-r border-gray-300 pr-2 mr-2\">\r\n                    <select\r\n                        onChange={(e) => { if (e.target.value) { handleRichTextCommand('formatBlock', e.target.value); e.target.value = ''; } }}\r\n                        className=\"p-1 text-xs border rounded\"\r\n                        title=\"Text Format\"\r\n                    >\r\n                        <option value=\"\">Format</option>\r\n                        <option value=\"h1\">Heading 1</option>\r\n                        <option value=\"h2\">Heading 2</option>\r\n                        <option value=\"h3\">Heading 3</option>\r\n                        <option value=\"p\">Paragraph</option>\r\n                        <option value=\"blockquote\">Quote</option>\r\n                        <option value=\"pre\">Code Block</option>\r\n                    </select>\r\n                </div>\r\n\r\n                <div className=\"flex border-r border-gray-300 pr-2 mr-2\">\r\n                    <button type=\"button\" onClick={() => handleRichTextCommand('bold')} className=\"p-2 hover:bg-gray-200 rounded\" title=\"Bold (Ctrl+B)\"><span className=\"font-bold\">B</span></button>\r\n                    <button type=\"button\" onClick={() => handleRichTextCommand('italic')} className=\"p-2 hover:bg-gray-200 rounded\" title=\"Italic (Ctrl+I)\"><span className=\"italic\">I</span></button>\r\n                    <button type=\"button\" onClick={() => handleRichTextCommand('underline')} className=\"p-2 hover:bg-gray-200 rounded\" title=\"Underline (Ctrl+U)\"><span className=\"underline\">U</span></button>\r\n                    <button type=\"button\" onClick={() => handleRichTextCommand('strikeThrough')} className=\"p-2 hover:bg-gray-200 rounded\" title=\"Strikethrough\"><span className=\"line-through\">S</span></button>\r\n                </div>\r\n\r\n                <div className=\"flex border-r border-gray-300 pr-2 mr-2\">\r\n                    <input type=\"color\" onChange={(e) => handleRichTextCommand('foreColor', e.target.value)} className=\"w-8 h-8 border rounded cursor-pointer\" title=\"Text Color\" />\r\n                    <input type=\"color\" onChange={(e) => handleRichTextCommand('hiliteColor', e.target.value)} className=\"w-8 h-8 border rounded cursor-pointer ml-1\" title=\"Highlight Color\" />\r\n                </div>\r\n\r\n                <div className=\"flex border-r border-gray-300 pr-2 mr-2\">\r\n                    <button type=\"button\" onClick={() => handleRichTextCommand('insertUnorderedList')} className=\"p-2 hover:bg-gray-200 rounded\" title=\"Bullet List\">• List</button>\r\n                    <button type=\"button\" onClick={() => handleRichTextCommand('insertOrderedList')} className=\"p-2 hover:bg-gray-200 rounded\" title=\"Numbered List\">1. List</button>\r\n                </div>\r\n\r\n                <div className=\"flex\">\r\n                    <button type=\"button\" onClick={() => handleRichTextCommand('removeFormat')} className=\"p-2 hover:bg-gray-200 rounded\" title=\"Clear Formatting\">Clear</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50 p-6\">\r\n            <style>{`\r\n                .rubric-table-container table { table-layout: fixed; width: 100%; }\r\n                .rubric-table-container td { max-width: 0; word-wrap: break-word; overflow-wrap: break-word; white-space: pre-wrap; vertical-align: top; }\r\n                .rich-text-editor li { margin: 0.2em 0; line-height: 1.4; }\r\n                .rich-text-editor li p { margin: 0; }\r\n                .rich-text-editor ul, .rich-text-editor ol { margin: 0.5em 0; padding-left: 1.5em; line-height: 1.5; }\r\n            `}</style>\r\n            <div className=\"max-w-7xl mx-auto bg-white rounded-lg shadow-lg\">\r\n                <div className=\"bg-blue-900 text-white p-6 rounded-t-lg\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                        <div>\r\n                            <h1 className=\"text-2xl font-bold\">Professional Rubric Builder</h1>\r\n                            <p className=\"text-blue-200\">Create comprehensive assessment rubrics with detailed criteria and feedback</p>\r\n                        </div>\r\n                        <div className=\"flex gap-2 flex-wrap\">\r\n                            <button onClick={resetRubric} className=\"bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded flex items-center gap-1 text-sm\"><RotateCcw size={14} /> Reset</button>\r\n                            <button onClick={() => importInputRef.current?.click()} className=\"bg-purple-700 hover:bg-purple-600 px-3 py-2 rounded flex items-center gap-1 text-sm\"><Upload size={14} /> Import</button>\r\n                            <button onClick={transferToGrading} className=\"bg-blue-700 hover:bg-blue-600 px-3 py-2 rounded flex items-center gap-1 text-sm\"><ArrowRight size={14} /> Use for Grading</button>\r\n                            <button onClick={saveRubric} className=\"bg-teal-700 hover:bg-teal-600 px-3 py-2 rounded flex items-center gap-1 text-sm\"><Save size={14} /> Save Draft</button>\r\n                            <button onClick={exportForGrading} className=\"bg-green-700 hover:bg-green-600 px-3 py-2 rounded flex items-center gap-1 text-sm\"><Download size={14} /> Export JSON</button>\r\n                            <button onClick={exportToHTML} className=\"bg-orange-700 hover:bg-orange-600 px-3 py-2 rounded flex items-center gap-1 text-sm\"><FileText size={14} /> Export HTML</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"p-6\">\r\n                    {/* Assignment Info Section */}\r\n                    <div className=\"assignment-info bg-blue-50 border border-blue-200 p-6 rounded-lg mb-6\">\r\n                        <h3 className=\"text-lg font-semibold text-blue-800 mb-4\">Assignment Information</h3>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Assignment Title *</label>\r\n                                <input type=\"text\" value={rubricData.assignmentInfo.title} onChange={(e) => updateAssignmentInfo('title', e.target.value)} className=\"w-full p-3 border rounded-lg\" />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Weight (% of Final Grade)</label>\r\n                                <input type=\"number\" value={rubricData.assignmentInfo.weight} onChange={(e) => updateAssignmentInfo('weight', parseInt(e.target.value) || 0)} className=\"w-full p-3 border rounded-lg\" />\r\n                            </div>\r\n                            <div className=\"md:col-span-2\">\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Description</label>\r\n                                <ContentDisplay\r\n                                    content={rubricData.assignmentInfo.description}\r\n                                    onEdit={(value, openRichEditor) => {\r\n                                        if (openRichEditor) openInlineEditor(rubricData.assignmentInfo.description, 'Assignment Description', (newContent) => updateAssignmentInfo('description', newContent), null, null, 'assignment');\r\n                                        else updateAssignmentInfo('description', value);\r\n                                    }}\r\n                                    isTextarea={true}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Inline Rich Text Editor Modal */}\r\n                    {inlineEditor.show && (\r\n                        <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\r\n                            <div className=\"bg-white rounded-lg shadow-2xl w-full max-w-3xl flex flex-col\">\r\n                                <div className=\"flex justify-between items-center p-4 border-b\">\r\n                                    <h4 className=\"text-lg font-semibold\">{inlineEditor.field}</h4>\r\n                                    <div>\r\n                                        <button onClick={() => closeInlineEditor(true)} className=\"bg-blue-600 text-white px-4 py-2 rounded mr-2\">Save</button>\r\n                                        <button onClick={() => closeInlineEditor(false)} className=\"bg-gray-600 text-white px-4 py-2 rounded\">Cancel</button>\r\n                                    </div>\r\n                                </div>\r\n                                <RichTextToolbar />\r\n                                <div className=\"p-4 flex-grow\">\r\n                                    <div\r\n                                        ref={editorRef}\r\n                                        contentEditable={true}\r\n                                        onInput={handleRichTextChange}\r\n                                        onKeyDown={handleKeyDown}\r\n                                        onPaste={handlePaste}\r\n                                        className=\"w-full h-full p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 rich-text-editor\"\r\n                                        style={{ minHeight: '300px' }}\r\n                                        suppressContentEditableWarning={true}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Rubric Table */}\r\n                    <div className=\"bg-white border rounded-lg overflow-hidden mb-6 rubric-table-container\">\r\n                        <div className=\"bg-gray-50 p-4 border-b flex justify-between items-center\">\r\n                            <h3 className=\"text-lg font-semibold text-gray-800\">Assessment Criteria Matrix</h3>\r\n                            <button onClick={addCriterion} className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2\"><Plus size={16} /> Add Criterion</button>\r\n                        </div>\r\n                        <div className=\"overflow-x-auto\">\r\n                            <table className=\"w-full border-collapse\">\r\n                                <thead>\r\n                                    <tr className=\"bg-gray-100\">\r\n                                        <th className=\"border p-3 text-left font-semibold\">Criterion</th>\r\n                                        {getDisplayLevels().map(level => (\r\n                                            <th key={level.level} className=\"border p-3 text-center font-semibold\" style={{ backgroundColor: level.color + '20', color: level.color }}>{level.name}</th>\r\n                                        ))}\r\n                                        <th className=\"border p-3 text-center font-semibold\">Actions</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {rubricData.criteria.map((criterion, index) => (\r\n                                        <tr key={criterion.id}>\r\n                                            <td className=\"border p-3 bg-gray-50\">\r\n                                                <input type=\"text\" value={criterion.name} onChange={(e) => updateCriterion(criterion.id, 'name', e.target.value)} className=\"w-full p-2 border rounded mb-2\" placeholder={`Criterion ${index + 1}`} />\r\n                                                <ContentDisplay\r\n                                                    content={criterion.description}\r\n                                                    onEdit={(value, openRichEditor) => {\r\n                                                        if (openRichEditor) openInlineEditor(criterion.description, `Criterion Description`, (newContent) => updateCriterion(criterion.id, 'description', newContent), criterion.id, null, 'criterion');\r\n                                                        else updateCriterion(criterion.id, 'description', value);\r\n                                                    }}\r\n                                                />\r\n                                                <input type=\"number\" value={criterion.maxPoints} onChange={(e) => updateCriterion(criterion.id, 'maxPoints', parseInt(e.target.value) || 0)} className=\"w-full p-1 border rounded text-sm mt-2\" />\r\n                                            </td>\r\n                                            {getDisplayLevels().map(level => (\r\n                                                <td key={level.level} className=\"border p-3\">\r\n                                                    <div className=\"font-bold text-center text-sm\" style={{ color: level.color }}>{calculatePointRange(criterion, level.level)} pts</div>\r\n                                                    <ContentDisplay\r\n                                                        content={criterion.levels[level.level]?.description || ''}\r\n                                                        onEdit={(value, openRichEditor) => {\r\n                                                            if (openRichEditor) openInlineEditor(criterion.levels[level.level]?.description, `${level.name} Description`, (newContent) => updateCriterionLevel(criterion.id, level.level, 'description', newContent), criterion.id, level.level, 'level');\r\n                                                            else updateCriterionLevel(criterion.id, level.level, 'description', value);\r\n                                                        }}\r\n                                                    />\r\n                                                </td>\r\n                                            ))}\r\n                                            <td className=\"border p-3 text-center\">\r\n                                                <button onClick={() => removeCriterion(criterion.id)} className=\"text-red-600 hover:text-red-800\" disabled={rubricData.criteria.length <= 1}><X size={16} /></button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <input ref={importInputRef} type=\"file\" accept=\".json\" onChange={importRubric} className=\"hidden\" />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default RubricCreator;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}