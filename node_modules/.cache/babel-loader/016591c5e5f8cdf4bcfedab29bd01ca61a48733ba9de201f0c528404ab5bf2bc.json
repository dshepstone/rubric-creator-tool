{"ast":null,"code":"var _jsxFileName = \"C:\\\\local clones\\\\rubric-creation-app\\\\src\\\\components\\\\GradingTemplate.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Download, Upload, FileText, Video, Plus, X, Save, FileDown, Bot, ChevronDown, ChevronUp, ArrowLeft, ArrowRight, Users, PlayCircle, CheckCircle, Clock, SkipForward, SkipBack, Pause, RotateCcw } from 'lucide-react';\nimport { useAssessment } from './SharedContext';\n\n// Sample comprehensive rubric from the PDF\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst sampleRubric = {\n  assignmentInfo: {\n    title: \"Digital Portfolio Project - Final Showcase\",\n    description: \"Students will create a comprehensive digital portfolio showcasing their best work from the semester, including 5-7 completed projects with professional presentation, artist statements, and technical documentation. The portfolio must demonstrate growth, technical proficiency, and creative vision suitable for industry presentation.\",\n    weight: 30,\n    passingThreshold: 65,\n    totalPoints: 120\n  },\n  rubricLevels: [{\n    level: 'incomplete',\n    name: 'Incomplete',\n    description: 'No submission or unusable',\n    color: '#95a5a6',\n    multiplier: 0\n  }, {\n    level: 'unacceptable',\n    name: 'Unacceptable',\n    description: 'Below minimum standards',\n    color: '#e74c3c',\n    multiplier: 0.3\n  }, {\n    level: 'developing',\n    name: 'Developing',\n    description: 'Approaching standards',\n    color: '#f39c12',\n    multiplier: 0.55\n  }, {\n    level: 'acceptable',\n    name: 'Acceptable (PASS)',\n    description: 'Meets minimum standards',\n    color: '#27ae60',\n    multiplier: 0.7\n  }, {\n    level: 'emerging',\n    name: 'Emerging',\n    description: 'Above standard expectations',\n    color: '#2980b9',\n    multiplier: 0.82\n  }, {\n    level: 'accomplished',\n    name: 'Accomplished',\n    description: 'Strong professional quality',\n    color: '#16a085',\n    multiplier: 0.92\n  }, {\n    level: 'exceptional',\n    name: 'Exceptional',\n    description: 'Outstanding professional quality',\n    color: '#8e44ad',\n    multiplier: 1.0\n  }],\n  criteria: [{\n    id: 'technical-proficiency',\n    name: 'Technical Proficiency & Craft',\n    description: 'Demonstration of technical skills, software mastery, and attention to detail in execution',\n    maxPoints: 35,\n    weight: 29,\n    levels: {\n      incomplete: {\n        description: 'No technical work submitted or files corrupted/unusable.',\n        pointRange: '0'\n      },\n      unacceptable: {\n        description: 'Severe technical issues: poor resolution, improper file formats, broken links, or significant software handling problems that interfere with viewing work.',\n        pointRange: '8-12'\n      },\n      developing: {\n        description: 'Basic technical competency shown but with noticeable issues: inconsistent quality, some resolution problems, or workflow inefficiencies. Software use shows beginner-level understanding.',\n        pointRange: '16-21'\n      },\n      acceptable: {\n        description: 'Solid technical foundation with appropriate file formats, good resolution, and functional navigation. Demonstrates competent use of course software with minimal technical distractions.',\n        pointRange: '22-26'\n      },\n      emerging: {\n        description: 'Strong technical execution with excellent file management, optimized formats, and smooth user experience. Shows advanced software techniques and professional workflow habits.',\n        pointRange: '27-30'\n      },\n      accomplished: {\n        description: 'High-level technical mastery with innovative use of tools, excellent optimization, and seamless integration of multiple software platforms. Technical choices enhance artistic vision.',\n        pointRange: '31-33'\n      },\n      exceptional: {\n        description: 'Exceptional technical virtuosity demonstrating mastery of advanced techniques, custom solutions, and industry-standard workflows. Technical execution elevates the artistic content to professional levels.',\n        pointRange: '34-35'\n      }\n    },\n    feedbackLibrary: {\n      strengths: ['Excellent file management and organization', 'Professional-quality technical execution', 'Innovative use of software tools', 'Seamless integration across platforms'],\n      improvements: ['Optimize file sizes for web delivery', 'Improve resolution consistency', 'Review proper file naming conventions', 'Consider mobile responsiveness'],\n      general: ['Technical skills show strong development', 'Consider exploring advanced techniques', 'Portfolio demonstrates software competency']\n    }\n  }, {\n    id: 'creative-vision',\n    name: 'Creative Vision & Artistic Development',\n    description: 'Originality, artistic voice, conceptual depth, and evolution of creative ideas',\n    maxPoints: 30,\n    weight: 25,\n    levels: {\n      incomplete: {\n        description: 'No creative work presented or completely derivative.',\n        pointRange: '0'\n      },\n      unacceptable: {\n        description: 'Limited creativity with heavy reliance on tutorials or templates. Little evidence of personal artistic voice or original thinking.',\n        pointRange: '7-10'\n      },\n      developing: {\n        description: 'Some original ideas present but inconsistent development. Creative choices show potential but lack depth or coherent vision.',\n        pointRange: '13-17'\n      },\n      acceptable: {\n        description: 'Clear creative direction with personal style emerging. Shows good problem-solving and conceptual thinking with adequate originality.',\n        pointRange: '18-22'\n      },\n      emerging: {\n        description: 'Strong creative vision with distinctive personal style. Demonstrates innovative thinking and sophisticated conceptual development.',\n        pointRange: '23-26'\n      },\n      accomplished: {\n        description: 'Exceptional creative development with unique artistic voice. Shows mastery of design principles and innovative approaches to visual communication.',\n        pointRange: '27-29'\n      },\n      exceptional: {\n        description: 'Outstanding creative vision that pushes boundaries and demonstrates professional-level artistic development. Highly original and conceptually sophisticated.',\n        pointRange: '30'\n      }\n    },\n    feedbackLibrary: {\n      strengths: ['Strong personal artistic voice', 'Innovative conceptual approaches', 'Excellent visual storytelling', 'Distinctive creative style'],\n      improvements: ['Develop concepts more thoroughly', 'Push creative boundaries further', 'Strengthen visual hierarchy', 'Consider audience engagement'],\n      general: ['Creative development shows strong growth', 'Portfolio demonstrates artistic maturity', 'Conceptual thinking is well-developed']\n    }\n  }, {\n    id: 'portfolio-presentation',\n    name: 'Portfolio Presentation & Organization',\n    description: 'Professional presentation, layout design, navigation, and overall user experience',\n    maxPoints: 25,\n    weight: 21,\n    levels: {\n      incomplete: {\n        description: 'No organized presentation or completely inaccessible.',\n        pointRange: '0'\n      },\n      unacceptable: {\n        description: 'Poor organization with confusing navigation, inconsistent layout, or significant usability issues.',\n        pointRange: '6-9'\n      },\n      developing: {\n        description: 'Basic organization present but with layout inconsistencies or navigation problems. Shows understanding of presentation but needs refinement.',\n        pointRange: '11-15'\n      },\n      acceptable: {\n        description: 'Well-organized portfolio with clear navigation and consistent presentation. Professional appearance with good user experience.',\n        pointRange: '16-19'\n      },\n      emerging: {\n        description: 'Excellent presentation with sophisticated layout design, intuitive navigation, and engaging user interface.',\n        pointRange: '20-22'\n      },\n      accomplished: {\n        description: 'Exceptional presentation quality with innovative design solutions and seamless user experience. Portfolio itself demonstrates design mastery.',\n        pointRange: '23-24'\n      },\n      exceptional: {\n        description: 'Outstanding presentation that sets new standards for portfolio design. Every aspect contributes to a cohesive, professional brand experience.',\n        pointRange: '25'\n      }\n    },\n    feedbackLibrary: {\n      strengths: ['Excellent visual hierarchy', 'Professional layout design', 'Intuitive navigation system', 'Consistent branding throughout'],\n      improvements: ['Improve loading times', 'Enhance mobile responsiveness', 'Clarify navigation structure', 'Strengthen visual consistency'],\n      general: ['Portfolio presentation is professional', 'Layout demonstrates design understanding', 'User experience is well-considered']\n    }\n  }, {\n    id: 'written-reflection',\n    name: 'Written Reflection & Artist Statements',\n    description: 'Quality of written analysis, self-reflection, and articulation of artistic process',\n    maxPoints: 20,\n    weight: 17,\n    levels: {\n      incomplete: {\n        description: 'No written reflection provided.',\n        pointRange: '0'\n      },\n      unacceptable: {\n        description: 'Minimal or superficial writing with poor grammar and little insight into artistic process.',\n        pointRange: '5-7'\n      },\n      developing: {\n        description: 'Basic reflection with some insight but lacking depth or clear articulation of artistic development.',\n        pointRange: '9-12'\n      },\n      acceptable: {\n        description: 'Good written reflection that demonstrates understanding of artistic process and clear communication of ideas.',\n        pointRange: '13-15'\n      },\n      emerging: {\n        description: 'Strong written analysis with thoughtful reflection on artistic growth and articulate discussion of creative decisions.',\n        pointRange: '16-17'\n      },\n      accomplished: {\n        description: 'Exceptional written work that demonstrates deep understanding of artistic practice and sophisticated communication skills.',\n        pointRange: '18-19'\n      },\n      exceptional: {\n        description: 'Outstanding written reflection that contributes significantly to understanding of artistic development and creative practice.',\n        pointRange: '20'\n      }\n    },\n    feedbackLibrary: {\n      strengths: ['Thoughtful artistic reflection', 'Clear communication of ideas', 'Strong analytical thinking', 'Professional writing quality'],\n      improvements: ['Develop ideas more thoroughly', 'Improve grammar and syntax', 'Add more specific examples', 'Strengthen conclusion'],\n      general: ['Written work shows good reflection', 'Communication skills are developing', 'Artistic awareness is evident']\n    }\n  }, {\n    id: 'professional-readiness',\n    name: 'Professional Readiness & Industry Standards',\n    description: 'Adherence to professional standards, industry practices, and career preparation',\n    maxPoints: 10,\n    weight: 8,\n    levels: {\n      incomplete: {\n        description: 'No evidence of professional preparation.',\n        pointRange: '0'\n      },\n      unacceptable: {\n        description: 'Little attention to professional standards or industry expectations.',\n        pointRange: '2-3'\n      },\n      developing: {\n        description: 'Some awareness of professional practices but inconsistent application.',\n        pointRange: '4-6'\n      },\n      acceptable: {\n        description: 'Good understanding of professional standards with appropriate presentation for industry viewing.',\n        pointRange: '7-8'\n      },\n      emerging: {\n        description: 'Strong professional preparation with portfolio ready for industry presentation.',\n        pointRange: '8-9'\n      },\n      accomplished: {\n        description: 'Exceptional professional readiness exceeding industry standards.',\n        pointRange: '9-10'\n      },\n      exceptional: {\n        description: 'Outstanding professional preparation that demonstrates career readiness.',\n        pointRange: '10'\n      }\n    },\n    feedbackLibrary: {\n      strengths: ['Industry-ready presentation', 'Professional attention to detail', 'Strong career preparation', 'Excellent professional standards'],\n      improvements: ['Research industry standards', 'Improve professional presentation', 'Add career preparation elements', 'Consider industry feedback'],\n      general: ['Shows strong professional development', 'Portfolio demonstrates career readiness', 'Professional standards are evident']\n    }\n  }]\n};\nconst GradingTemplate = () => {\n  _s();\n  // Get shared context - ENHANCED with new functions\n  const {\n    sharedRubric,\n    sharedCourseDetails,\n    setSharedCourseDetails,\n    gradingData: sharedGradingData,\n    setGradingData: setSharedGradingData,\n    updateStudentInfo,\n    updateCourseInfo,\n    updateAssignmentInfo,\n    clearGradingFormData,\n    classList,\n    setClassList,\n    setCurrentStudent,\n    gradingSession,\n    setGradingSession,\n    nextStudentInSession,\n    previousStudentInSession,\n    updateGradingSession,\n    initializeGradingSession,\n    setActiveTab,\n    currentStudent,\n    saveDraft,\n    loadDraft,\n    // NEW: Add the draft/final grade functions\n    saveFinalGrade,\n    loadFinalGrade,\n    finalGrades,\n    getGradeStatus\n  } = useAssessment();\n\n  // Helper function to convert HTML content to readable text format\n  const renderFormattedContent = htmlContent => {\n    if (!htmlContent) return '';\n\n    // Convert basic HTML to readable text format\n    let textContent = htmlContent.replace(/<br\\s*\\/?>/gi, '\\n').replace(/<\\/p>/gi, '\\n').replace(/<p[^>]*>/gi, '').replace(/<strong[^>]*>(.*?)<\\/strong>/gi, '**$1**').replace(/<b[^>]*>(.*?)<\\/b>/gi, '**$1**').replace(/<em[^>]*>(.*?)<\\/em>/gi, '*$1*').replace(/<i[^>]*>(.*?)<\\/i>/gi, '*$1*').replace(/<u[^>]*>(.*?)<\\/u>/gi, '_$1_').replace(/<h3[^>]*>(.*?)<\\/h3>/gi, '### $1\\n').replace(/<li[^>]*>(.*?)<\\/li>/gi, '• $1\\n').replace(/<\\/ul>/gi, '\\n').replace(/<ul[^>]*>/gi, '').replace(/<\\/ol>/gi, '\\n').replace(/<ol[^>]*>/gi, '').replace(/<[^>]*>/g, '') // Remove any remaining HTML tags\n    .replace(/\\n\\s*\\n/g, '\\n') // Remove extra line breaks\n    .trim();\n    return textContent;\n  };\n\n  // State for all grading data - initialize from shared context or defaults\n  const [localGradingData, setLocalGradingData] = useState(() => {\n    // 1) Try loading a saved draft first\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      const draft = loadDraft(currentStudent.id);\n      if (draft) {\n        return draft;\n      }\n    }\n    // 2) If rubric was just transferred, use that\n    if (sharedGradingData) {\n      return {\n        ...sharedGradingData,\n        student: currentStudent || sharedGradingData.student\n      };\n    }\n    // 3) Otherwise, start fresh for this student\n    return {\n      student: currentStudent || {\n        name: '',\n        id: '',\n        email: ''\n      },\n      course: (sharedCourseDetails === null || sharedCourseDetails === void 0 ? void 0 : sharedCourseDetails.course) || {\n        code: '',\n        name: '',\n        instructor: '',\n        term: ''\n      },\n      assignment: (sharedCourseDetails === null || sharedCourseDetails === void 0 ? void 0 : sharedCourseDetails.assignment) || {\n        name: '',\n        dueDate: '',\n        maxPoints: 100\n      },\n      feedback: {\n        general: '',\n        strengths: '',\n        improvements: ''\n      },\n      attachments: [],\n      videoLinks: [],\n      latePolicy: {\n        level: 'none',\n        penaltyApplied: false\n      },\n      metadata: {\n        gradedBy: '',\n        gradedDate: '',\n        aiAssisted: false,\n        rubricIntegrated: false\n      },\n      rubricGrading: {}\n    };\n  });\n\n  // Use local grading data as the main state\n  const gradingData = localGradingData;\n  const setGradingData = setLocalGradingData;\n\n  // Rubric-specific state\n  const [loadedRubric, setLoadedRubric] = useState(() => {\n    return sharedRubric || sampleRubric;\n  });\n  const [rubricGrading, setRubricGrading] = useState({});\n  const [showRubricComments, setShowRubricComments] = useState({});\n  const [showHeaderGuide, setShowHeaderGuide] = useState(false);\n  const fileInputRef = useRef(null);\n  const moduleInputRef = useRef(null);\n  const rubricInputRef = useRef(null);\n\n  // Video link management\n  const [videoLinkInput, setVideoLinkInput] = useState('');\n  const [videoTitle, setVideoTitle] = useState('');\n\n  // Auto-save to shared context whenever gradingData changes\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      setSharedGradingData(gradingData);\n      setSharedCourseDetails({\n        student: gradingData.student,\n        course: gradingData.course,\n        assignment: gradingData.assignment\n      });\n    }, 1000);\n    return () => clearTimeout(timeoutId);\n  }, [gradingData, setSharedGradingData, setSharedCourseDetails]);\n\n  // Load shared data when available\n  useEffect(() => {\n    if (sharedRubric) {\n      setLoadedRubric(sharedRubric);\n    }\n  }, [sharedRubric]);\n  useEffect(() => {\n    if (sharedCourseDetails) {\n      setGradingData(prevData => ({\n        ...prevData,\n        student: sharedCourseDetails.student || prevData.student,\n        course: sharedCourseDetails.course || prevData.course,\n        assignment: sharedCourseDetails.assignment || prevData.assignment\n      }));\n    }\n  }, [sharedCourseDetails]);\n\n  // Late Policy Levels\n  const latePolicyLevels = {\n    none: {\n      name: 'On Time',\n      multiplier: 1.0,\n      description: 'Assignment submitted on or before due date and time - marked out of 100%',\n      color: '#16a34a'\n    },\n    within24: {\n      name: '1-24 Hours Late',\n      multiplier: 0.8,\n      description: 'Assignment received within 24 hours of due date - 20% reduction (marked out of 80%)',\n      color: '#ea580c'\n    },\n    after24: {\n      name: 'More than 24 Hours Late',\n      multiplier: 0.0,\n      description: 'Assignment received after 24 hours from due date - mark of zero (0)',\n      color: '#dc2626'\n    }\n  };\n\n  // Initialize rubric grading state when component mounts or rubric changes\n  useEffect(() => {\n    if (loadedRubric) {\n      const initialGrading = {};\n      loadedRubric.criteria.forEach(criterion => {\n        initialGrading[criterion.id] = {\n          criterionId: criterion.id,\n          selectedLevel: null,\n          customComments: ''\n        };\n      });\n      setRubricGrading(initialGrading);\n\n      // Update assignment details\n      setGradingData(prevData => {\n        var _loadedRubric$assignm, _loadedRubric$assignm2;\n        return {\n          ...prevData,\n          assignment: {\n            ...prevData.assignment,\n            name: ((_loadedRubric$assignm = loadedRubric.assignmentInfo) === null || _loadedRubric$assignm === void 0 ? void 0 : _loadedRubric$assignm.title) || prevData.assignment.name,\n            maxPoints: ((_loadedRubric$assignm2 = loadedRubric.assignmentInfo) === null || _loadedRubric$assignm2 === void 0 ? void 0 : _loadedRubric$assignm2.totalPoints) || prevData.assignment.maxPoints\n          },\n          metadata: {\n            ...prevData.metadata,\n            rubricIntegrated: true\n          }\n        };\n      });\n    }\n  }, [loadedRubric]);\n\n  // ENHANCED: Load saved data when student changes\n  useEffect(() => {\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      console.log('🔍 Loading data for student:', currentStudent.name);\n\n      // Get the grade status for this student\n      const gradeStatus = getGradeStatus(currentStudent.id);\n      console.log('📊 Grade status:', gradeStatus);\n      let savedData = null;\n      if (gradeStatus === 'final') {\n        // Load final grade data\n        savedData = loadFinalGrade ? loadFinalGrade(currentStudent.id) : null;\n        console.log('📋 Loading final grade data:', savedData ? 'FOUND' : 'NOT FOUND');\n      } else if (gradeStatus === 'draft') {\n        // Load draft data\n        savedData = loadDraft(currentStudent.id);\n        console.log('📝 Loading draft data:', savedData ? 'FOUND' : 'NOT FOUND');\n      }\n      if (savedData) {\n        console.log('✅ Successfully loaded saved grade data');\n        setLocalGradingData(savedData);\n\n        // Load rubric grading if available\n        if (savedData.rubricGrading) {\n          setRubricGrading(savedData.rubricGrading);\n        }\n\n        // Load other form data\n        setVideoLinkInput('');\n        setVideoTitle('');\n      } else {\n        console.log('🆕 No saved data found, starting fresh');\n        resetGradingForm();\n      }\n    }\n  }, [currentStudent, getGradeStatus, loadDraft, loadFinalGrade]);\n\n  // Calculate total score with late policy applied\n  const calculateTotalScore = () => {\n    let rawScore = 0;\n    if (loadedRubric) {\n      rawScore = Object.values(rubricGrading).reduce((total, grading) => {\n        const criterion = loadedRubric.criteria.find(c => c.id === grading.criterionId);\n        if (criterion && grading.selectedLevel) {\n          const level = loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel);\n          return total + criterion.maxPoints * level.multiplier;\n        }\n        return total;\n      }, 0);\n    } else {\n      rawScore = gradingData.rubric.reduce((total, item) => total + item.score, 0);\n    }\n    const latePolicyLevel = latePolicyLevels[gradingData.latePolicy.level];\n    const finalScore = rawScore * latePolicyLevel.multiplier;\n    return {\n      rawScore: rawScore,\n      finalScore: finalScore,\n      penaltyApplied: gradingData.latePolicy.level !== 'none',\n      latePolicyDescription: latePolicyLevel.description\n    };\n  };\n\n  // Update late policy\n  const updateLatePolicy = level => {\n    setGradingData(prevData => ({\n      ...prevData,\n      latePolicy: {\n        level: level,\n        penaltyApplied: level !== 'none'\n      }\n    }));\n  };\n\n  // Update rubric grading\n  const updateRubricGrading = (criterionId, level, comments = null) => {\n    setRubricGrading(prev => {\n      const existingGrading = prev[criterionId];\n      const existingComments = (existingGrading === null || existingGrading === void 0 ? void 0 : existingGrading.customComments) || '';\n      return {\n        ...prev,\n        [criterionId]: {\n          criterionId,\n          selectedLevel: level,\n          customComments: comments !== null ? comments : existingComments\n        }\n      };\n    });\n  };\n\n  // Add feedback comment to criterion\n  const addCriterionFeedback = (criterionId, comment) => {\n    const currentGrading = rubricGrading[criterionId];\n    const currentComments = (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.customComments) || '';\n    const newComments = currentComments ? `${currentComments}\\n• ${comment}` : `• ${comment}`;\n    setRubricGrading(prev => ({\n      ...prev,\n      [criterionId]: {\n        ...prev[criterionId],\n        criterionId,\n        selectedLevel: (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel) || null,\n        customComments: newComments\n      }\n    }));\n  };\n\n  // Toggle rubric comments visibility\n  const toggleRubricComments = criterionId => {\n    setShowRubricComments(prev => ({\n      ...prev,\n      [criterionId]: !prev[criterionId]\n    }));\n  };\n\n  // Add video link\n  const addVideoLink = () => {\n    if (videoLinkInput.trim()) {\n      setGradingData(prevData => ({\n        ...prevData,\n        videoLinks: [...prevData.videoLinks, {\n          id: Date.now(),\n          url: videoLinkInput.trim(),\n          title: videoTitle.trim() || 'Video Link'\n        }]\n      }));\n      setVideoLinkInput('');\n      setVideoTitle('');\n    }\n  };\n\n  // Remove video link\n  const removeVideoLink = id => {\n    setGradingData(prevData => ({\n      ...prevData,\n      videoLinks: prevData.videoLinks.filter(link => link.id !== id)\n    }));\n  };\n\n  // Handle file uploads\n  const handleFileUpload = files => {\n    const newAttachments = Array.from(files).map(file => ({\n      id: Date.now() + Math.random(),\n      name: file.name,\n      size: file.size,\n      type: file.type,\n      file: file\n    }));\n    Promise.all(newAttachments.map(attachment => {\n      return new Promise(resolve => {\n        if (attachment.type.startsWith('image/')) {\n          const reader = new FileReader();\n          reader.onload = e => {\n            attachment.base64Data = e.target.result;\n            resolve(attachment);\n          };\n          reader.readAsDataURL(attachment.file);\n        } else {\n          resolve(attachment);\n        }\n      });\n    })).then(processedAttachments => {\n      setGradingData(prevData => ({\n        ...prevData,\n        attachments: [...prevData.attachments, ...processedAttachments]\n      }));\n    });\n  };\n\n  // Remove attachment\n  const removeAttachment = id => {\n    setGradingData(prevData => ({\n      ...prevData,\n      attachments: prevData.attachments.filter(att => att.id !== id)\n    }));\n  };\n\n  // ENHANCED: New student navigation functions for draft/final system\n  const handleNextStudentAsDraft = () => {\n    // Save current student's work as draft\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      console.log('💾 Saving as draft for student:', currentStudent.name);\n      saveDraft(currentStudent.id, localGradingData);\n    }\n    const success = nextStudentInSession('draft');\n    if (!success) {\n      alert('Grading session completed! All students have been graded.');\n      setActiveTab('class-manager');\n    } else {\n      resetGradingForm();\n      console.log('✅ Draft saved, moved to next student');\n    }\n  };\n  const handleNextStudentAsFinal = () => {\n    // Save current student's work as final grade\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      console.log('✅ Finalizing grade for student:', currentStudent.name);\n      saveFinalGrade(currentStudent.id, localGradingData);\n    }\n    const success = nextStudentInSession('final');\n    if (!success) {\n      alert('Grading session completed! All students have been graded.');\n      setActiveTab('class-manager');\n    } else {\n      resetGradingForm();\n      console.log('✅ Final grade saved, moved to next student');\n    }\n  };\n  const handlePreviousStudent = () => {\n    // Auto-save current student's work before moving\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      saveDraft(currentStudent.id, localGradingData);\n    }\n    const success = previousStudentInSession();\n    if (!success) {\n      console.log('Already at first student or no active session');\n    } else {\n      resetGradingForm();\n    }\n  };\n  const resetGradingForm = () => {\n    // Reset only the grading-specific data\n    setLocalGradingData(prev => ({\n      ...prev,\n      feedback: {\n        general: '',\n        strengths: '',\n        improvements: ''\n      },\n      attachments: [],\n      videoLinks: [],\n      latePolicy: {\n        level: 'none',\n        penaltyApplied: false\n      }\n    }));\n\n    // Reset rubric grading state\n    if (loadedRubric) {\n      const initialGrading = {};\n      loadedRubric.criteria.forEach(criterion => {\n        initialGrading[criterion.id] = {\n          criterionId: criterion.id,\n          selectedLevel: null,\n          customComments: ''\n        };\n      });\n      setRubricGrading(initialGrading);\n    }\n  };\n\n  // Get current student info for navigation display\n  const getCurrentStudentInfo = () => {\n    if (!classList || !(gradingSession !== null && gradingSession !== void 0 && gradingSession.active) || !gradingSession.currentStudent) {\n      return null;\n    }\n    const currentIndex = gradingSession.currentStudentIndex;\n    const totalStudents = classList.students.length;\n    const student = gradingSession.currentStudent;\n    return {\n      student,\n      position: currentIndex + 1,\n      total: totalStudents,\n      isFirst: currentIndex === 0,\n      isLast: currentIndex === totalStudents - 1\n    };\n  };\n  const currentStudentInfo = getCurrentStudentInfo();\n\n  // Export functions\n  const exportToHTML = () => {\n    const scoreCalculation = calculateTotalScore();\n    const totalScore = scoreCalculation.finalScore;\n    const rawScore = scoreCalculation.rawScore;\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\n    const percentage = (totalScore / maxPoints * 100).toFixed(1);\n    const penaltyApplied = scoreCalculation.penaltyApplied;\n\n    // Build attachments HTML with embedded Base64 images\n    const attachmentsHTML = gradingData.attachments.map((att, index) => {\n      if (att.base64Data) {\n        return `\n                  <div class=\"attachment-item\">\n                      <img src=\"${att.base64Data}\" \n                           alt=\"${att.name}\" \n                           class=\"clickable-image\"\n                           data-index=\"${index}\"\n                           style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" />\n                      <div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div>\n                      <div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div>\n                      <div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div>\n                  </div>\n              `;\n      } else {\n        return `\n                  <div class=\"attachment-item\">\n                      <div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">\n                          📄\n                      </div>\n                      <div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div>\n                      <div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div>\n                  </div>\n              `;\n      }\n    }).join('');\n\n    // Build video links HTML\n    const videoLinksHTML = gradingData.videoLinks.map(link => `\n          <div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\">\n              <div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\">\n                  <span style=\"font-size: 1.25rem;\">🎥</span>\n                  <strong style=\"color: #495057;\">${link.title}</strong>\n              </div>\n              <a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">\n                  ${link.url}\n              </a>\n          </div>\n      `).join('');\n\n    // Enhanced rubric table with complete comments\n    const rubricTableHTML = loadedRubric ? `\n      <div class=\"rubric-section\" style=\"margin-top: 30px;\">\n          <h3>📋 Detailed Rubric Assessment</h3>\n          <div style=\"background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;\">\n              <strong>Assignment:</strong> ${loadedRubric.assignmentInfo.title}<br>\n              <strong>Description:</strong> ${renderFormattedContent(loadedRubric.assignmentInfo.description)}<br>\n              <strong>Weight:</strong> ${loadedRubric.assignmentInfo.weight}% of Final Grade<br>\n              <strong>Passing Threshold:</strong> ${loadedRubric.assignmentInfo.passingThreshold}%  \n          </div>\n          \n          <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 0.9rem;\">\n              <thead>\n                  <tr style=\"background: #2c3e50; color: white;\">\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th>\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Max Points</th>\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Level Achieved</th>\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Points Earned</th>\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Assessment & Comments</th>\n                  </tr>\n              </thead>\n              <tbody>\n                  ${loadedRubric.criteria.map(criterion => {\n      const grading = rubricGrading[criterion.id];\n      const level = grading !== null && grading !== void 0 && grading.selectedLevel ? loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel) : null;\n      const points = level ? (criterion.maxPoints * level.multiplier).toFixed(1) : '0';\n      const levelDescription = level && criterion.levels[level.level] ? renderFormattedContent(criterion.levels[level.level].description) : '';\n      const additionalComments = (grading === null || grading === void 0 ? void 0 : grading.customComments) || '';\n      return `\n                          <tr>\n                              <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\n                                  <strong style=\"color: #2c3e50;\">${criterion.name}</strong><br>\n                                  <small style=\"color: #666; font-style: italic;\">${renderFormattedContent(criterion.description)}</small>\n                              </td>\n                              <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold;\">${criterion.maxPoints}</td>\n                              <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; ${level ? `background-color: ${level.color}15; color: ${level.color}; font-weight: bold;` : ''}\">${level ? level.name : 'Not Assessed'}</td>\n                              <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td>\n                              <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\n                                  ${levelDescription ? `\n                                      <div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\">\n                                          <strong style=\"color: ${level.color};\">Level Description:</strong><br>\n                                          <span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span>\n                                      </div>\n                                  ` : ''}\n                                  ${additionalComments ? `\n                                      <div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\">\n                                          <strong style=\"color: #856404;\">Additional Comments:</strong><br>\n                                          <span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span>\n                                      </div>\n                                  ` : ''}\n                                  ${!levelDescription && !additionalComments ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}\n                              </td>\n                          </tr>\n                      `;\n    }).join('')}\n              </tbody>\n          </table>\n          \n          <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\">\n              <h4 style=\"color: #2e7d32; margin-bottom: 10px;\">📊 Rubric Score Summary</h4>\n              <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\n                  <div>\n                      <strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br>\n                      <strong>Percentage:</strong> ${percentage}%\n                  </div>\n                  <div>\n                      <strong>Grade Status:</strong> \n                      <span style=\"color: ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">\n                          ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}\n                      </span>\n                  </div>\n                  ${penaltyApplied ? `\n                      <div style=\"color: #ff9800;\">\n                          <strong>Late Penalty Applied:</strong><br>\n                          Raw Score: ${Math.round(rawScore * 10) / 10}\n                      </div>\n                  ` : ''}\n              </div>\n          </div>\n      </div>\n      ` : '';\n    const htmlContent = `\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <title>Grade Report - ${gradingData.student.name}</title>\n      <style>\n          body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; line-height: 1.6; }\n          .header { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; }\n          .score-summary { background: #e8f5e8; border: 2px solid #4caf50; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center; }\n          .late-policy-section { margin: 30px 0; background: #fff5f5; border: 1px solid #f87171; border-radius: 8px; padding: 20px; }\n          .feedback-section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 8px; }\n          .attachments { margin: 30px 0; }\n          .attachment-item { \n              display: inline-block; \n              text-align: center; \n              margin: 1rem; \n              padding: 1rem; \n              background: #fff; \n              border: 1px solid #ddd; \n              border-radius: 8px; \n              box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n              max-width: 250px;\n              vertical-align: top;\n          }\n          .clickable-image {\n              cursor: pointer;\n              transition: all 0.3s ease;\n              position: relative;\n          }\n          .clickable-image:hover {\n              transform: scale(1.05);\n              box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n          }\n          .video-links { margin: 30px 0; }\n          .video-link-item { margin-bottom: 1rem; }\n          .video-link-item a { color: #007bff; text-decoration: none; }\n          .video-link-item a:hover { text-decoration: underline; }\n          h1, h2, h3 { color: #333; }\n          \n          /* Modal styles for full-size image viewing */\n          .image-modal {\n              display: none;\n              position: fixed;\n              z-index: 1000;\n              left: 0;\n              top: 0;\n              width: 100%;\n              height: 100%;\n              background-color: rgba(0,0,0,0.9);\n              animation: fadeIn 0.3s ease;\n          }\n          .image-modal.show {\n              display: flex;\n              align-items: center;\n              justify-content: center;\n          }\n          .modal-content {\n              max-width: 95%;\n              max-height: 95%;\n              object-fit: contain;\n              border-radius: 8px;\n              box-shadow: 0 4px 20px rgba(0,0,0,0.5);\n              animation: zoomIn 0.3s ease;\n          }\n          .close-modal {\n              position: absolute;\n              top: 20px;\n              right: 30px;\n              color: white;\n              font-size: 40px;\n              font-weight: bold;\n              cursor: pointer;\n              z-index: 1001;\n              background: rgba(0,0,0,0.5);\n              border-radius: 50%;\n              width: 50px;\n              height: 50px;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              line-height: 1;\n          }\n          .close-modal:hover {\n              background: rgba(0,0,0,0.8);\n          }\n          .modal-caption {\n              position: absolute;\n              bottom: 20px;\n              left: 50%;\n              transform: translateX(-50%);\n              color: white;\n              background: rgba(0,0,0,0.7);\n              padding: 10px 20px;\n              border-radius: 6px;\n              text-align: center;\n              max-width: 80%;\n          }\n          \n          @keyframes fadeIn {\n              from { opacity: 0; }\n              to { opacity: 1; }\n          }\n          @keyframes zoomIn {\n              from { transform: scale(0.5); opacity: 0; }\n              to { transform: scale(1); opacity: 1; }\n          }\n          \n          @media print {\n              .attachment-item { break-inside: avoid; }\n              .video-link-item { break-inside: avoid; }\n              .image-modal { display: none !important; }\n          }\n      </style>\n    </head>\n    <body>\n      <div class=\"header\">\n          <h1>📋 Grade Report</h1>\n          <p><strong>Student:</strong> ${gradingData.student.name} (${gradingData.student.id})</p>\n          <p><strong>Course:</strong> ${gradingData.course.code} - ${gradingData.course.name}</p>\n          <p><strong>Assignment:</strong> ${gradingData.assignment.name}</p>\n          <p><strong>Instructor:</strong> ${gradingData.course.instructor}</p>\n          <p><strong>Term:</strong> ${gradingData.course.term}</p>\n      </div>\n    \n      <div class=\"score-summary\">\n          <h2>📊 Final Score</h2>\n          <div style=\"font-size: 2rem; font-weight: bold; color: #2e7d32; margin: 15px 0;\">\n              ${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)\n          </div>\n          <p style=\"margin: 10px 0; color: #555;\">\n              ${loadedRubric ? `Rubric: ${loadedRubric.assignmentInfo.title}` : ``}\n              ${penaltyApplied ? ` | Late Policy: ${latePolicyLevels[gradingData.latePolicy.level].name}` : ''}\n          </p>\n      </div>\n    \n      ${penaltyApplied ? `\n      <div class=\"late-policy-section\">\n          <h3 style=\"color: #dc2626;\">📅 Late Submission Policy Applied</h3>\n          <p><strong>Policy Status:</strong> ${latePolicyLevels[gradingData.latePolicy.level].name}</p>\n          <p>${latePolicyLevels[gradingData.latePolicy.level].description}</p>\n          <p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} → <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\n      </div>\n      ` : ''}\n    \n      ${rubricTableHTML}\n      \n      ${Object.entries(gradingData.feedback).filter(([key, value]) => value).map(([key, value]) => `\n          <div class=\"feedback-section\">\n              <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\n              <p>${value.replace(/\\n/g, '<br>')}</p>\n          </div>\n      `).join('')}\n    \n      ${attachmentsHTML ? `\n      <div class=\"attachments\">\n          <h3>📎 File Attachments</h3>\n          <div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">\n              ${attachmentsHTML}\n          </div>\n      </div>\n      ` : ''}\n    \n      ${videoLinksHTML ? `\n      <div class=\"video-links\">\n          <h3>🎥 Video Review Links</h3>\n          ${videoLinksHTML}\n      </div>\n      ` : ''}\n      \n      <p style=\"margin-top: 40px; text-align: center; color: #666; font-size: 0.9rem;\">\n          Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}\n      </p>\n    \n      <div id=\"imageModal\" class=\"image-modal\">\n          <span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span>\n          <img class=\"modal-content\" id=\"modalImage\">\n          <div class=\"modal-caption\" id=\"modalCaption\"></div>\n      </div>\n    \n      <script>\n          // Store attachment data for modal functionality\n          const attachmentData = ${JSON.stringify(gradingData.attachments)};\n          \n          function openImageModal(imageSrc, caption) {\n              const modal = document.getElementById('imageModal');\n              const modalImg = document.getElementById('modalImage');\n              const modalCaption = document.getElementById('modalCaption');\n              \n              modal.classList.add('show');\n              modalImg.src = imageSrc;\n              modalCaption.textContent = caption;\n              \n              // Prevent body scrolling when modal is open\n              document.body.style.overflow = 'hidden';\n          }\n    \n          function closeImageModal() {\n              const modal = document.getElementById('imageModal');\n              modal.classList.remove('show');\n              document.body.style.overflow = 'auto';\n          }\n    \n          // Add click event listeners when DOM is loaded\n          document.addEventListener('DOMContentLoaded', function() {\n              const clickableImages = document.querySelectorAll('.clickable-image');\n              clickableImages.forEach(img => {\n                  img.addEventListener('click', function() {\n                      const index = parseInt(this.getAttribute('data-index'));\n                      const attachment = attachmentData[index];\n                      if (attachment && attachment.base64Data) {\n                          openImageModal(attachment.base64Data, attachment.name);\n                      }\n                  });\n              });\n    \n              // Close modal when clicking outside the image\n              document.getElementById('imageModal').addEventListener('click', function(e) {\n                  if (e.target === this) {\n                      closeImageModal();\n                  }\n              });\n    \n              // Close modal with Escape key\n              document.addEventListener('keydown', function(e) {\n                  if (e.key === 'Escape') {\n                      closeImageModal();\n                  }\n              });\n          });\n      </script>\n    </body>\n    </html>`;\n    const htmlBlob = new Blob([htmlContent], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(htmlBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `grade_report_${gradingData.student.name || 'student'}_${gradingData.assignment.name || 'assignment'}.html`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n  const exportToPDF = () => {\n    const scoreCalculation = calculateTotalScore();\n    const totalScore = scoreCalculation.finalScore;\n    const rawScore = scoreCalculation.rawScore;\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\n    const percentage = (totalScore / maxPoints * 100).toFixed(1);\n    const penaltyApplied = scoreCalculation.penaltyApplied;\n    const currentDate = new Date().toLocaleDateString('en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n\n    // Build attachments HTML (PDF optimized)\n    const attachmentsHTML = gradingData.attachments.map((att, index) => {\n      if (att.base64Data) {\n        return `\n                    <div class=\"attachment-item\">\n                        <img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"attachment-image\" />\n                        <div class=\"attachment-info\">\n                            <div class=\"attachment-name\">${att.name}</div>\n                            <div class=\"attachment-size\">${(att.size / 1024).toFixed(1)} KB</div>\n                        </div>\n                    </div>\n                `;\n      } else {\n        return `\n                    <div class=\"attachment-item\">\n                        <div class=\"file-icon\">📄</div>\n                        <div class=\"attachment-info\">\n                            <div class=\"attachment-name\">${att.name}</div>\n                            <div class=\"attachment-size\">${(att.size / 1024).toFixed(1)} KB</div>\n                        </div>\n                    </div>\n                `;\n      }\n    }).join('');\n\n    // Build video links HTML\n    const videoLinksHTML = gradingData.videoLinks.map(link => `\n            <div class=\"video-link-item\">\n                <span class=\"video-icon\">🎥</span>\n                <div class=\"video-info\">\n                    <div class=\"video-title\">${link.title}</div>\n                    <div class=\"video-url\">${link.url}</div>\n                </div>\n            </div>\n        `).join('');\n\n    // Enhanced rubric table for PDF\n    const rubricTableHTML = loadedRubric ? `\n        <div class=\"rubric-section\">\n            <h3 class=\"section-title\">📋 Detailed Rubric Assessment</h3>\n            <div class=\"rubric-info\">\n                <div class=\"info-grid\">\n                    <div><strong>Assignment:</strong> ${loadedRubric.assignmentInfo.title}</div>\n                    <div><strong>Weight:</strong> ${loadedRubric.assignmentInfo.weight}% of Final Grade</div>\n                    <div><strong>Passing Threshold:</strong> ${loadedRubric.assignmentInfo.passingThreshold}%</div>\n                    <div><strong>Total Points:</strong> ${loadedRubric.assignmentInfo.totalPoints}</div>\n                </div>\n                <div class=\"assignment-description\">${renderFormattedContent(loadedRubric.assignmentInfo.description)}</div>\n            </div>\n            \n            <table class=\"rubric-table\">\n                <thead>\n                    <tr>\n                        <th class=\"criterion-header\">Criterion</th>\n                        <th class=\"points-header\">Max Points</th>\n                        <th class=\"level-header\">Level Achieved</th>\n                        <th class=\"earned-header\">Points Earned</th>\n                        <th class=\"comments-header\">Assessment & Comments</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ${loadedRubric.criteria.map(criterion => {\n      const grading = rubricGrading[criterion.id];\n      const level = grading !== null && grading !== void 0 && grading.selectedLevel ? loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel) : null;\n      const points = level ? (criterion.maxPoints * level.multiplier).toFixed(1) : '0';\n      const levelDescription = level && criterion.levels[level.level] ? renderFormattedContent(criterion.levels[level.level].description) : '';\n      const additionalComments = (grading === null || grading === void 0 ? void 0 : grading.customComments) || '';\n      return `\n                            <tr class=\"criterion-row\">\n                                <td class=\"criterion-cell\">\n                                    <div class=\"criterion-name\">${criterion.name}</div>\n                                    <div class=\"criterion-desc\">${renderFormattedContent(criterion.description)}</div>\n                                </td>\n                                <td class=\"points-cell\">${criterion.maxPoints}</td>\n                                <td class=\"level-cell ${level ? 'level-achieved' : ''}\" ${level ? `style=\"background-color: ${level.color}20; color: ${level.color};\"` : ''}>\n                                    ${level ? level.name : 'Not Assessed'}\n                                </td>\n                                <td class=\"earned-cell\">${points}</td>\n                                <td class=\"comments-cell\">\n                                    ${levelDescription ? `\n                                        <div class=\"level-description\">\n                                            <strong>Level Description:</strong>\n                                            <p>${levelDescription}</p>\n                                        </div>\n                                    ` : ''}\n                                    ${additionalComments ? `\n                                        <div class=\"additional-comments\">\n                                            <strong>Additional Comments:</strong>\n                                            <p>${additionalComments.replace(/\\n/g, '<br>')}</p>\n                                        </div>\n                                    ` : ''}\n                                    ${!levelDescription && !additionalComments ? '<em>No assessment provided</em>' : ''}\n                                </td>\n                            </tr>\n                        `;\n    }).join('')}\n                </tbody>\n            </table>\n            \n            <div class=\"rubric-summary\">\n                <div class=\"summary-grid\">\n                    <div class=\"summary-item\">\n                        <strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}\n                    </div>\n                    <div class=\"summary-item\">\n                        <strong>Percentage:</strong> ${percentage}%\n                    </div>\n                    <div class=\"summary-item\">\n                        <strong>Grade Status:</strong> \n                        <span class=\"${percentage >= loadedRubric.assignmentInfo.passingThreshold ? 'passing' : 'needs-improvement'}\">\n                            ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}\n                        </span>\n                    </div>\n                    ${penaltyApplied ? `\n                        <div class=\"summary-item penalty\">\n                            <strong>Late Penalty Applied:</strong> Raw Score: ${Math.round(rawScore * 10) / 10}\n                        </div>\n                    ` : ''}\n                </div>\n            </div>\n        </div>\n        ` : '';\n    const pdfContent = `\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Grade Report - ${gradingData.student.name}</title>\n        <style>\n            @page {\n                size: A4;\n                margin: 0.75in;\n                @top-center {\n                    content: \"Grade Report - ${gradingData.student.name}\";\n                    font-size: 10pt;\n                    color: #666;\n                }\n                @bottom-center {\n                    content: \"Page \" counter(page) \" of \" counter(pages) \" | Generated on ${currentDate}\";\n                    font-size: 9pt;\n                    color: #666;\n                }\n            }\n            \n            body {\n                font-family: 'Arial', sans-serif;\n                line-height: 1.4;\n                color: #333;\n                background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n                margin: 0;\n                padding: 0;\n            }\n            \n            .header {\n                background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);\n                color: white;\n                padding: 25px;\n                border-radius: 10px;\n                margin-bottom: 25px;\n                position: relative;\n                overflow: hidden;\n            }\n            \n            .header::before {\n                content: '';\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                background: url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='m36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\") repeat;\n                z-index: 0;\n            }\n            \n            .header-content {\n                position: relative;\n                z-index: 1;\n            }\n            \n            .header h1 {\n                font-size: 28px;\n                margin: 0 0 10px 0;\n                font-weight: 700;\n            }\n            \n            .header-info {\n                display: grid;\n                grid-template-columns: 1fr 1fr;\n                gap: 20px;\n                margin-top: 15px;\n            }\n            \n            .header-info p {\n                margin: 5px 0;\n                font-size: 14px;\n            }\n            \n            .score-summary {\n                background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);\n                border: 2px solid #16a34a;\n                border-radius: 12px;\n                padding: 25px;\n                margin: 25px 0;\n                text-align: center;\n                position: relative;\n                overflow: hidden;\n            }\n            \n            .score-summary::before {\n                content: '';\n                position: absolute;\n                top: -50%;\n                left: -50%;\n                width: 200%;\n                height: 200%;\n                background: conic-gradient(from 0deg, transparent, rgba(34, 197, 94, 0.1), transparent);\n                animation: rotate 20s linear infinite;\n                z-index: 0;\n            }\n            \n            .score-content {\n                position: relative;\n                z-index: 1;\n            }\n            \n            .final-score {\n                font-size: 48px;\n                font-weight: 700;\n                color: #15803d;\n                margin: 15px 0;\n            }\n            \n            .score-percentage {\n                font-size: 24px;\n                color: #166534;\n                margin-bottom: 15px;\n            }\n            \n            .section-title {\n                color: #1e40af;\n                font-size: 20px;\n                font-weight: 600;\n                margin: 25px 0 15px 0;\n                padding-bottom: 8px;\n                border-bottom: 2px solid #3b82f6;\n            }\n            \n            .rubric-info {\n                background: #f8fafc;\n                border: 1px solid #e2e8f0;\n                border-radius: 8px;\n                padding: 20px;\n                margin-bottom: 20px;\n            }\n            \n            .info-grid {\n                display: grid;\n                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n                gap: 15px;\n                margin-bottom: 15px;\n            }\n            \n            .assignment-description {\n                font-style: italic;\n                color: #64748b;\n                margin-top: 10px;\n                padding-top: 10px;\n                border-top: 1px solid #e2e8f0;\n            }\n            \n            .rubric-table {\n                width: 100%;\n                border-collapse: collapse;\n                margin-bottom: 25px;\n                background: white;\n                border-radius: 8px;\n                overflow: hidden;\n                box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);\n            }\n            \n            .rubric-table th {\n                background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);\n                color: white;\n                padding: 15px 12px;\n                font-weight: 600;\n                text-align: left;\n                font-size: 14px;\n            }\n            \n            .rubric-table td {\n                padding: 12px;\n                border-bottom: 1px solid #e2e8f0;\n                vertical-align: top;\n                font-size: 13px;\n            }\n            \n            .criterion-cell {\n                background: #f8fafc;\n                border-right: 1px solid #e2e8f0;\n                width: 20%;\n            }\n            \n            .criterion-name {\n                font-weight: 600;\n                color: #1e40af;\n                margin-bottom: 5px;\n            }\n            \n            .criterion-desc {\n                font-size: 12px;\n                color: #64748b;\n                font-style: italic;\n            }\n            \n            .points-cell, .earned-cell {\n                text-align: center;\n                font-weight: 600;\n                width: 10%;\n            }\n            \n            .level-cell {\n                text-align: center;\n                font-weight: 600;\n                width: 15%;\n            }\n            \n            .level-achieved {\n                border-radius: 4px;\n                padding: 8px 4px;\n            }\n            \n            .comments-cell {\n                width: 45%;\n            }\n            \n            .level-description {\n                background: #f1f5f9;\n                border-left: 4px solid #3b82f6;\n                padding: 10px;\n                margin-bottom: 10px;\n                border-radius: 4px;\n            }\n            \n            .level-description strong {\n                color: #1e40af;\n            }\n            \n            .level-description p {\n                margin: 5px 0;\n                line-height: 1.4;\n            }\n            \n            .additional-comments {\n                background: #fffbeb;\n                border: 1px solid #fbbf24;\n                border-radius: 4px;\n                padding: 10px;\n                margin-top: 10px;\n            }\n            \n            .additional-comments strong {\n                color: #92400e;\n            }\n            \n            .additional-comments p {\n                margin: 5px 0;\n                line-height: 1.4;\n            }\n            \n            .rubric-summary {\n                background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n                border: 2px solid #3b82f6;\n                border-radius: 8px;\n                padding: 20px;\n                margin-top: 25px;\n            }\n            \n            .summary-grid {\n                display: grid;\n                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n                gap: 15px;\n            }\n            \n            .summary-item {\n                font-size: 14px;\n            }\n            \n            .passing {\n                color: #16a34a;\n                font-weight: 600;\n            }\n            \n            .needs-improvement {\n                color: #dc2626;\n                font-weight: 600;\n            }\n            \n            .penalty {\n                color: #ea580c;\n            }\n            \n            .late-policy-section {\n                background: #fef2f2;\n                border: 1px solid #fca5a5;\n                border-radius: 8px;\n                padding: 20px;\n                margin: 20px 0;\n            }\n            \n            .feedback-section {\n                background: #f9fafb;\n                border-radius: 8px;\n                padding: 20px;\n                margin: 20px 0;\n                border-left: 4px solid #3b82f6;\n            }\n            \n            .feedback-section h3 {\n                color: #1e40af;\n                margin-top: 0;\n            }\n            \n            .attachments {\n                margin: 25px 0;\n            }\n            \n            .attachment-item {\n                display: inline-block;\n                margin: 10px;\n                padding: 15px;\n                background: white;\n                border: 1px solid #e2e8f0;\n                border-radius: 8px;\n                text-align: center;\n                max-width: 200px;\n                vertical-align: top;\n            }\n            \n            .attachment-image {\n                max-width: 150px;\n                max-height: 150px;\n                object-fit: contain;\n                border-radius: 4px;\n                margin-bottom: 10px;\n            }\n            \n            .file-icon {\n                font-size: 48px;\n                margin-bottom: 10px;\n            }\n            \n            .attachment-name {\n                font-weight: 500;\n                font-size: 12px;\n                word-break: break-word;\n            }\n            \n            .attachment-size {\n                font-size: 11px;\n                color: #64748b;\n            }\n            \n            .video-links {\n                margin: 25px 0;\n            }\n            \n            .video-link-item {\n                background: white;\n                border: 1px solid #e2e8f0;\n                border-radius: 8px;\n                padding: 15px;\n                margin-bottom: 10px;\n                display: flex;\n                align-items: center;\n                gap: 15px;\n            }\n            \n            .video-icon {\n                font-size: 24px;\n            }\n            \n            .video-title {\n                font-weight: 600;\n                margin-bottom: 5px;\n            }\n            \n            .video-url {\n                font-size: 12px;\n                color: #3b82f6;\n                word-break: break-all;\n            }\n            \n            .footer {\n                text-align: center;\n                margin-top: 40px;\n                padding-top: 20px;\n                border-top: 1px solid #e2e8f0;\n                color: #64748b;\n                font-size: 12px;\n            }\n            \n            @keyframes rotate {\n                to {\n                    transform: rotate(360deg);\n                }\n            }\n            \n            @media print {\n                body {\n                    background: white;\n                }\n                .header, .score-summary {\n                    break-inside: avoid;\n                }\n                .rubric-table {\n                    break-inside: avoid;\n                }\n                .attachment-item {\n                    break-inside: avoid;\n                }\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"header\">\n            <div class=\"header-content\">\n                <h1>📋 Grade Report</h1>\n                <div class=\"header-info\">\n                    <div>\n                        <p><strong>Student:</strong> ${gradingData.student.name}</p>\n                        <p><strong>Student ID:</strong> ${gradingData.student.id}</p>\n                        <p><strong>Email:</strong> ${gradingData.student.email}</p>\n                    </div>\n                    <div>\n                        <p><strong>Course:</strong> ${gradingData.course.code} - ${gradingData.course.name}</p>\n                        <p><strong>Instructor:</strong> ${gradingData.course.instructor}</p>\n                        <p><strong>Term:</strong> ${gradingData.course.term}</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    \n        <div class=\"score-summary\">\n            <div class=\"score-content\">\n                <h2 style=\"margin: 0 0 10px 0; color: #15803d;\">📊 Final Score</h2>\n                <div class=\"final-score\">\n                    ${totalScore.toFixed(1)} / ${maxPoints}\n                </div>\n                <div class=\"score-percentage\">\n                    ${percentage}%\n                </div>\n                <p style=\"margin: 10px 0; color: #166534;\">\n                    ${loadedRubric ? `Assessment: ${loadedRubric.assignmentInfo.title}` : ``}\n                    ${penaltyApplied ? ` | Late Policy: ${latePolicyLevels[gradingData.latePolicy.level].name}` : ''}\n                </p>\n            </div>\n        </div>\n    \n        ${penaltyApplied ? `\n        <div class=\"late-policy-section\">\n            <h3 style=\"color: #dc2626; margin-top: 0;\">📅 Late Submission Policy Applied</h3>\n            <p><strong>Policy Status:</strong> ${latePolicyLevels[gradingData.latePolicy.level].name}</p>\n            <p>${latePolicyLevels[gradingData.latePolicy.level].description}</p>\n            <p><strong>Calculation:</strong> Raw Score ${Math.round(rawScore * 10) / 10}/${maxPoints} → Final Score ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\n        </div>\n        ` : ''}\n    \n        ${rubricTableHTML}\n        \n        ${Object.entries(gradingData.feedback).filter(([key, value]) => value).map(([key, value]) => `\n            <div class=\"feedback-section\">\n                <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\n                <p>${value.replace(/\\n/g, '<br>')}</p>\n            </div>\n        `).join('')}\n    \n        ${attachmentsHTML ? `\n        <div class=\"attachments\">\n            <h3 class=\"section-title\">📎 File Attachments</h3>\n            ${attachmentsHTML}\n        </div>\n        ` : ''}\n    \n        ${videoLinksHTML ? `\n        <div class=\"video-links\">\n            <h3 class=\"section-title\">🎥 Video Review Links</h3>\n            ${videoLinksHTML}\n        </div>\n        ` : ''}\n        \n        <div class=\"footer\">\n            <p><strong>Grade Report Generated</strong></p>\n            <p>${currentDate} | ${new Date().toLocaleTimeString()}</p>\n            <p>Assessment Platform v2.0 | Professional Grading System</p>\n        </div>\n    </body>\n    </html>`;\n\n    // Create a new window for PDF printing\n    const printWindow = window.open('', '_blank', 'width=800,height=600');\n    printWindow.document.write(pdfContent);\n    printWindow.document.close();\n\n    // Wait for content to load then trigger print\n    printWindow.onload = function () {\n      setTimeout(() => {\n        printWindow.print();\n      }, 500);\n    };\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '2rem',\n      maxWidth: '1200px',\n      margin: '0 auto',\n      fontFamily: 'system-ui, sans-serif'\n    },\n    children: [currentStudentInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: 'linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)',\n        border: '2px solid #0ea5e9',\n        borderRadius: '0.75rem',\n        padding: '1rem',\n        marginBottom: '2rem',\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            margin: '0 0 0.5rem 0',\n            color: '#0c4a6e',\n            fontSize: '1.25rem'\n          },\n          children: [\"Currently Grading: \", currentStudentInfo.student.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1704,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            margin: 0,\n            color: '#075985',\n            fontSize: '0.875rem'\n          },\n          children: [\"Student \", currentStudentInfo.position, \" of \", currentStudentInfo.total, \" \\u2022 ID: \", currentStudentInfo.student.id]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1707,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1703,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '0.75rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handlePreviousStudent,\n          disabled: currentStudentInfo.isFirst,\n          style: {\n            padding: '0.5rem 1rem',\n            background: currentStudentInfo.isFirst ? '#e5e7eb' : '#6b7280',\n            color: currentStudentInfo.isFirst ? '#9ca3af' : 'white',\n            border: 'none',\n            borderRadius: '0.375rem',\n            cursor: currentStudentInfo.isFirst ? 'not-allowed' : 'pointer',\n            fontSize: '0.875rem'\n          },\n          children: \"\\u2190 Previous\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1712,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab('class-manager'),\n          style: {\n            padding: '0.5rem 1rem',\n            background: '#374151',\n            color: 'white',\n            border: 'none',\n            borderRadius: '0.375rem',\n            cursor: 'pointer',\n            fontSize: '0.875rem'\n          },\n          children: \"Class Manager\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1727,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1711,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1693,\n      columnNumber: 9\n    }, this), loadedRubric && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\n        border: '1px solid #bbf7d0',\n        borderRadius: '0.75rem',\n        padding: '1.5rem',\n        marginBottom: '2rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'flex-start',\n          marginBottom: '1rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            style: {\n              fontSize: '1.25rem',\n              fontWeight: '700',\n              color: '#15803d',\n              marginBottom: '0.5rem'\n            },\n            children: \"\\uD83D\\uDCCB Active Assignment Rubric\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1758,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              color: '#16a34a',\n              fontWeight: '600',\n              fontSize: '1.1rem'\n            },\n            children: loadedRubric.assignmentInfo.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1761,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: '0.875rem',\n              color: '#059669'\n            },\n            children: renderFormattedContent(loadedRubric.assignmentInfo.description)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1764,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1757,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '0.875rem',\n              color: '#059669'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                margin: '0.25rem 0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Weight:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1771,\n                columnNumber: 19\n              }, this), \" \", loadedRubric.assignmentInfo.weight, \"% of Final Grade\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1770,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                margin: '0.25rem 0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Passing:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1774,\n                columnNumber: 19\n              }, this), \" \", loadedRubric.assignmentInfo.passingThreshold, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1773,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                margin: '0.25rem 0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Total Points:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1777,\n                columnNumber: 19\n              }, this), \" \", loadedRubric.assignmentInfo.totalPoints]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1776,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1769,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1768,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1756,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          gap: '1.5rem'\n        },\n        children: loadedRubric.criteria.map(criterion => {\n          var _loadedRubric$rubricL, _criterion$levels$cur, _criterion$levels$cur2;\n          const currentGrading = rubricGrading[criterion.id];\n          const showComments = showRubricComments[criterion.id];\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: 'white',\n              border: '1px solid #d1d5db',\n              borderRadius: '0.5rem',\n              padding: '1.25rem',\n              boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'flex-start',\n                marginBottom: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  flex: 1\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  style: {\n                    fontSize: '1.125rem',\n                    fontWeight: '600',\n                    color: '#374151'\n                  },\n                  children: [criterion.name, /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      color: '#3b82f6',\n                      marginLeft: '0.5rem'\n                    },\n                    children: [\"(\", criterion.maxPoints, \" pts)\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1801,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1799,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    fontSize: '0.875rem',\n                    color: '#6b7280',\n                    marginTop: '0.25rem'\n                  },\n                  children: renderFormattedContent(criterion.description)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1805,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1798,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => toggleRubricComments(criterion.id),\n                style: {\n                  color: '#3b82f6',\n                  background: 'none',\n                  border: 'none',\n                  fontSize: '0.875rem',\n                  textDecoration: 'underline',\n                  cursor: 'pointer',\n                  marginLeft: '1rem'\n                },\n                children: [showComments ? 'Hide' : 'Show', \" Level Details\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1809,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1797,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\n                gap: '0.5rem',\n                marginBottom: '1rem'\n              },\n              children: loadedRubric.rubricLevels.map(level => {\n                const isSelected = (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel) === level.level;\n                const points = Math.round(criterion.maxPoints * level.multiplier);\n                return /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => updateRubricGrading(criterion.id, level.level),\n                  style: {\n                    padding: '0.75rem',\n                    borderRadius: '0.5rem',\n                    border: `2px solid ${isSelected ? level.color : '#d1d5db'}`,\n                    fontSize: '0.875rem',\n                    fontWeight: '500',\n                    cursor: 'pointer',\n                    transition: 'all 0.2s ease',\n                    backgroundColor: isSelected ? level.color : 'white',\n                    color: isSelected ? 'white' : '#374151',\n                    transform: isSelected ? 'scale(1.05)' : 'none',\n                    textAlign: 'center'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: '600'\n                    },\n                    children: level.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1854,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '0.75rem',\n                      marginTop: '0.25rem'\n                    },\n                    children: [level.level === 'incomplete' ? '0' : points, \" pts\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1855,\n                    columnNumber: 27\n                  }, this)]\n                }, level.level, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1837,\n                  columnNumber: 25\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1826,\n              columnNumber: 19\n            }, this), showComments && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                background: '#f9fafb',\n                borderRadius: '0.5rem',\n                padding: '1rem',\n                marginBottom: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                style: {\n                  fontWeight: '600',\n                  color: '#374151',\n                  marginBottom: '0.75rem'\n                },\n                children: \"Level Descriptions:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1871,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'grid',\n                  gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\n                  gap: '0.75rem'\n                },\n                children: loadedRubric.rubricLevels.map(level => {\n                  var _criterion$levels$lev, _criterion$levels$lev2;\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      background: 'white',\n                      borderRadius: '0.25rem',\n                      border: '1px solid #d1d5db',\n                      borderLeft: `4px solid ${level.color}`,\n                      padding: '0.75rem'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontWeight: '500',\n                        fontSize: '0.875rem',\n                        color: level.color\n                      },\n                      children: level.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1890,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontSize: '0.75rem',\n                        color: '#6b7280',\n                        marginBottom: '0.5rem'\n                      },\n                      children: [(_criterion$levels$lev = criterion.levels[level.level]) === null || _criterion$levels$lev === void 0 ? void 0 : _criterion$levels$lev.pointRange, \" pts\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1893,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontSize: '0.75rem',\n                        color: '#374151'\n                      },\n                      children: renderFormattedContent((_criterion$levels$lev2 = criterion.levels[level.level]) === null || _criterion$levels$lev2 === void 0 ? void 0 : _criterion$levels$lev2.description)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1896,\n                      columnNumber: 29\n                    }, this)]\n                  }, level.level, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1880,\n                    columnNumber: 27\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1874,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1865,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: '0.875rem',\n                  fontWeight: '500',\n                  color: '#374151',\n                  marginBottom: '0.5rem'\n                },\n                children: \"Additional Comments:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1907,\n                columnNumber: 21\n              }, this), criterion.feedbackLibrary && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  gap: '0.5rem',\n                  marginBottom: '0.75rem',\n                  flexWrap: 'wrap'\n                },\n                children: Object.entries(criterion.feedbackLibrary).map(([category, comments]) => /*#__PURE__*/_jsxDEV(\"select\", {\n                  onChange: e => {\n                    if (e.target.value) {\n                      addCriterionFeedback(criterion.id, e.target.value);\n                      e.target.value = '';\n                    }\n                  },\n                  defaultValue: \"\",\n                  style: {\n                    padding: '0.5rem',\n                    border: '1px solid #d1d5db',\n                    borderRadius: '0.25rem',\n                    fontSize: '0.75rem',\n                    cursor: 'pointer'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: [\"Add \", category, \"...\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1938,\n                    columnNumber: 29\n                  }, this), comments.map((comment, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: comment,\n                    children: renderFormattedContent(comment)\n                  }, idx, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1940,\n                    columnNumber: 31\n                  }, this))]\n                }, category, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1921,\n                  columnNumber: 27\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1919,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                value: (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.customComments) || '',\n                onChange: e => updateRubricGrading(criterion.id, currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel, e.target.value),\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  resize: 'none',\n                  minHeight: '80px'\n                },\n                rows: \"3\",\n                placeholder: \"Add specific feedback for this criterion...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1947,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1906,\n              columnNumber: 19\n            }, this), (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel) && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: '0.75rem',\n                padding: '0.75rem',\n                background: '#eff6ff',\n                borderRadius: '0.25rem',\n                border: '1px solid #bfdbfe'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.875rem'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Selected Level:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1974,\n                  columnNumber: 25\n                }, this), \" \", (_loadedRubric$rubricL = loadedRubric.rubricLevels.find(l => l.level === currentGrading.selectedLevel)) === null || _loadedRubric$rubricL === void 0 ? void 0 : _loadedRubric$rubricL.name, ' ', \"(\", (_criterion$levels$cur = criterion.levels[currentGrading.selectedLevel]) === null || _criterion$levels$cur === void 0 ? void 0 : _criterion$levels$cur.pointRange, \" pts)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1973,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.875rem',\n                  color: '#374151',\n                  marginTop: '0.25rem'\n                },\n                children: renderFormattedContent((_criterion$levels$cur2 = criterion.levels[currentGrading.selectedLevel]) === null || _criterion$levels$cur2 === void 0 ? void 0 : _criterion$levels$cur2.description)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1977,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1966,\n              columnNumber: 21\n            }, this)]\n          }, criterion.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1790,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1784,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1749,\n      columnNumber: 9\n    }, this), loadedRubric && currentStudentInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: 'linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)',\n        border: '2px solid #10b981',\n        borderRadius: '0.75rem',\n        padding: '1.5rem',\n        marginTop: '2rem',\n        textAlign: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          fontSize: '1.25rem',\n          fontWeight: '600',\n          color: '#047857',\n          marginBottom: '1rem'\n        },\n        children: \"Ready to move to the next student?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2000,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: '#065f46',\n          marginBottom: '1.5rem',\n          fontSize: '0.875rem'\n        },\n        children: \"Choose how to save the current grading before proceeding.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2003,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '1rem',\n          justifyContent: 'center',\n          flexWrap: 'wrap'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleNextStudentAsDraft,\n          style: {\n            display: 'inline-flex',\n            alignItems: 'center',\n            gap: '0.5rem',\n            background: 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)',\n            color: 'white',\n            padding: '0.75rem 1.5rem',\n            borderRadius: '0.5rem',\n            border: 'none',\n            cursor: 'pointer',\n            fontSize: '0.875rem',\n            fontWeight: '600',\n            boxShadow: '0 2px 8px rgba(251, 191, 36, 0.4)',\n            transition: 'all 0.2s ease'\n          },\n          onMouseOver: e => {\n            e.target.style.transform = 'translateY(-2px)';\n            e.target.style.boxShadow = '0 4px 12px rgba(251, 191, 36, 0.5)';\n          },\n          onMouseOut: e => {\n            e.target.style.transform = 'translateY(0)';\n            e.target.style.boxShadow = '0 2px 8px rgba(251, 191, 36, 0.4)';\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: '1.1rem'\n            },\n            children: \"\\uD83D\\uDCDD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2035,\n            columnNumber: 15\n          }, this), \"Save & Grade Next Student\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2009,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleNextStudentAsFinal,\n          style: {\n            display: 'inline-flex',\n            alignItems: 'center',\n            gap: '0.5rem',\n            background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\n            color: 'white',\n            padding: '0.75rem 1.5rem',\n            borderRadius: '0.5rem',\n            border: 'none',\n            cursor: 'pointer',\n            fontSize: '0.875rem',\n            fontWeight: '600',\n            boxShadow: '0 2px 8px rgba(16, 185, 129, 0.4)',\n            transition: 'all 0.2s ease'\n          },\n          onMouseOver: e => {\n            e.target.style.transform = 'translateY(-2px)';\n            e.target.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.5)';\n          },\n          onMouseOut: e => {\n            e.target.style.transform = 'translateY(0)';\n            e.target.style.boxShadow = '0 2px 8px rgba(16, 185, 129, 0.4)';\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: '1.1rem'\n            },\n            children: \"\\u2705\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2066,\n            columnNumber: 15\n          }, this), \"Finalize & Grade Next Student\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2040,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2007,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '1rem',\n          padding: '0.75rem',\n          background: 'rgba(255, 255, 255, 0.6)',\n          borderRadius: '0.375rem',\n          fontSize: '0.75rem',\n          color: '#065f46'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Draft:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2079,\n          columnNumber: 13\n        }, this), \" Save progress, can edit later \\u2022 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Finalize:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2079,\n          columnNumber: 69\n        }, this), \" Complete grading, ready for student/LMS\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2071,\n        columnNumber: 11\n      }, this), currentStudentInfo.isLast && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '1rem',\n          padding: '0.75rem',\n          background: '#fef3c7',\n          borderRadius: '0.375rem',\n          fontSize: '0.875rem',\n          color: '#92400e',\n          fontWeight: '500'\n        },\n        children: \"\\uD83C\\uDF89 This is the last student in your grading session!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2083,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1992,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1687,\n    columnNumber: 5\n  }, this);\n};\n_s(GradingTemplate, \"AusjmjKF6EzKrlxvfLMc2QeNtNE=\", false, function () {\n  return [useAssessment];\n});\n_c = GradingTemplate;\nexport default GradingTemplate;\nvar _c;\n$RefreshReg$(_c, \"GradingTemplate\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Download","Upload","FileText","Video","Plus","X","Save","FileDown","Bot","ChevronDown","ChevronUp","ArrowLeft","ArrowRight","Users","PlayCircle","CheckCircle","Clock","SkipForward","SkipBack","Pause","RotateCcw","useAssessment","jsxDEV","_jsxDEV","sampleRubric","assignmentInfo","title","description","weight","passingThreshold","totalPoints","rubricLevels","level","name","color","multiplier","criteria","id","maxPoints","levels","incomplete","pointRange","unacceptable","developing","acceptable","emerging","accomplished","exceptional","feedbackLibrary","strengths","improvements","general","GradingTemplate","_s","sharedRubric","sharedCourseDetails","setSharedCourseDetails","gradingData","sharedGradingData","setGradingData","setSharedGradingData","updateStudentInfo","updateCourseInfo","updateAssignmentInfo","clearGradingFormData","classList","setClassList","setCurrentStudent","gradingSession","setGradingSession","nextStudentInSession","previousStudentInSession","updateGradingSession","initializeGradingSession","setActiveTab","currentStudent","saveDraft","loadDraft","saveFinalGrade","loadFinalGrade","finalGrades","getGradeStatus","renderFormattedContent","htmlContent","textContent","replace","trim","localGradingData","setLocalGradingData","draft","student","email","course","code","instructor","term","assignment","dueDate","feedback","attachments","videoLinks","latePolicy","penaltyApplied","metadata","gradedBy","gradedDate","aiAssisted","rubricIntegrated","rubricGrading","loadedRubric","setLoadedRubric","setRubricGrading","showRubricComments","setShowRubricComments","showHeaderGuide","setShowHeaderGuide","fileInputRef","moduleInputRef","rubricInputRef","videoLinkInput","setVideoLinkInput","videoTitle","setVideoTitle","timeoutId","setTimeout","clearTimeout","prevData","latePolicyLevels","none","within24","after24","initialGrading","forEach","criterion","criterionId","selectedLevel","customComments","_loadedRubric$assignm","_loadedRubric$assignm2","console","log","gradeStatus","savedData","resetGradingForm","calculateTotalScore","rawScore","Object","values","reduce","total","grading","find","c","l","rubric","item","score","latePolicyLevel","finalScore","latePolicyDescription","updateLatePolicy","updateRubricGrading","comments","prev","existingGrading","existingComments","addCriterionFeedback","comment","currentGrading","currentComments","newComments","toggleRubricComments","addVideoLink","Date","now","url","removeVideoLink","filter","link","handleFileUpload","files","newAttachments","Array","from","map","file","Math","random","size","type","Promise","all","attachment","resolve","startsWith","reader","FileReader","onload","e","base64Data","target","result","readAsDataURL","then","processedAttachments","removeAttachment","att","handleNextStudentAsDraft","success","alert","handleNextStudentAsFinal","handlePreviousStudent","getCurrentStudentInfo","active","currentIndex","currentStudentIndex","totalStudents","students","length","position","isFirst","isLast","currentStudentInfo","exportToHTML","scoreCalculation","totalScore","percentage","toFixed","attachmentsHTML","index","join","videoLinksHTML","rubricTableHTML","points","levelDescription","additionalComments","round","entries","key","value","charAt","toUpperCase","slice","toLocaleDateString","toLocaleTimeString","JSON","stringify","htmlBlob","Blob","URL","createObjectURL","document","createElement","href","download","click","revokeObjectURL","exportToPDF","currentDate","weekday","year","month","day","pdfContent","printWindow","window","open","write","close","print","style","padding","maxWidth","margin","fontFamily","children","background","border","borderRadius","marginBottom","display","justifyContent","alignItems","fontSize","fileName","_jsxFileName","lineNumber","columnNumber","gap","onClick","disabled","cursor","fontWeight","textAlign","flexDirection","_loadedRubric$rubricL","_criterion$levels$cur","_criterion$levels$cur2","showComments","boxShadow","flex","marginLeft","marginTop","textDecoration","gridTemplateColumns","isSelected","transition","backgroundColor","transform","_criterion$levels$lev","_criterion$levels$lev2","borderLeft","flexWrap","category","onChange","defaultValue","idx","width","resize","minHeight","rows","placeholder","onMouseOver","onMouseOut","_c","$RefreshReg$"],"sources":["C:/local clones/rubric-creation-app/src/components/GradingTemplate.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport {\r\n  Download, Upload, FileText, Video, Plus, X, Save, FileDown, Bot,\r\n  ChevronDown, ChevronUp, ArrowLeft, ArrowRight, Users, PlayCircle,\r\n  CheckCircle, Clock, SkipForward, SkipBack, Pause, RotateCcw\r\n} from 'lucide-react';\r\nimport { useAssessment } from './SharedContext';\r\n\r\n// Sample comprehensive rubric from the PDF\r\nconst sampleRubric = {\r\n  assignmentInfo: {\r\n    title: \"Digital Portfolio Project - Final Showcase\",\r\n    description: \"Students will create a comprehensive digital portfolio showcasing their best work from the semester, including 5-7 completed projects with professional presentation, artist statements, and technical documentation. The portfolio must demonstrate growth, technical proficiency, and creative vision suitable for industry presentation.\",\r\n    weight: 30,\r\n    passingThreshold: 65,\r\n    totalPoints: 120\r\n  },\r\n  rubricLevels: [\r\n    { level: 'incomplete', name: 'Incomplete', description: 'No submission or unusable', color: '#95a5a6', multiplier: 0 },\r\n    { level: 'unacceptable', name: 'Unacceptable', description: 'Below minimum standards', color: '#e74c3c', multiplier: 0.3 },\r\n    { level: 'developing', name: 'Developing', description: 'Approaching standards', color: '#f39c12', multiplier: 0.55 },\r\n    { level: 'acceptable', name: 'Acceptable (PASS)', description: 'Meets minimum standards', color: '#27ae60', multiplier: 0.7 },\r\n    { level: 'emerging', name: 'Emerging', description: 'Above standard expectations', color: '#2980b9', multiplier: 0.82 },\r\n    { level: 'accomplished', name: 'Accomplished', description: 'Strong professional quality', color: '#16a085', multiplier: 0.92 },\r\n    { level: 'exceptional', name: 'Exceptional', description: 'Outstanding professional quality', color: '#8e44ad', multiplier: 1.0 }\r\n  ],\r\n  criteria: [\r\n    {\r\n      id: 'technical-proficiency',\r\n      name: 'Technical Proficiency & Craft',\r\n      description: 'Demonstration of technical skills, software mastery, and attention to detail in execution',\r\n      maxPoints: 35,\r\n      weight: 29,\r\n      levels: {\r\n        incomplete: { description: 'No technical work submitted or files corrupted/unusable.', pointRange: '0' },\r\n        unacceptable: { description: 'Severe technical issues: poor resolution, improper file formats, broken links, or significant software handling problems that interfere with viewing work.', pointRange: '8-12' },\r\n        developing: { description: 'Basic technical competency shown but with noticeable issues: inconsistent quality, some resolution problems, or workflow inefficiencies. Software use shows beginner-level understanding.', pointRange: '16-21' },\r\n        acceptable: { description: 'Solid technical foundation with appropriate file formats, good resolution, and functional navigation. Demonstrates competent use of course software with minimal technical distractions.', pointRange: '22-26' },\r\n        emerging: { description: 'Strong technical execution with excellent file management, optimized formats, and smooth user experience. Shows advanced software techniques and professional workflow habits.', pointRange: '27-30' },\r\n        accomplished: { description: 'High-level technical mastery with innovative use of tools, excellent optimization, and seamless integration of multiple software platforms. Technical choices enhance artistic vision.', pointRange: '31-33' },\r\n        exceptional: { description: 'Exceptional technical virtuosity demonstrating mastery of advanced techniques, custom solutions, and industry-standard workflows. Technical execution elevates the artistic content to professional levels.', pointRange: '34-35' }\r\n      },\r\n      feedbackLibrary: {\r\n        strengths: [\r\n          'Excellent file management and organization',\r\n          'Professional-quality technical execution',\r\n          'Innovative use of software tools',\r\n          'Seamless integration across platforms'\r\n        ],\r\n        improvements: [\r\n          'Optimize file sizes for web delivery',\r\n          'Improve resolution consistency',\r\n          'Review proper file naming conventions',\r\n          'Consider mobile responsiveness'\r\n        ],\r\n        general: [\r\n          'Technical skills show strong development',\r\n          'Consider exploring advanced techniques',\r\n          'Portfolio demonstrates software competency'\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      id: 'creative-vision',\r\n      name: 'Creative Vision & Artistic Development',\r\n      description: 'Originality, artistic voice, conceptual depth, and evolution of creative ideas',\r\n      maxPoints: 30,\r\n      weight: 25,\r\n      levels: {\r\n        incomplete: { description: 'No creative work presented or completely derivative.', pointRange: '0' },\r\n        unacceptable: { description: 'Limited creativity with heavy reliance on tutorials or templates. Little evidence of personal artistic voice or original thinking.', pointRange: '7-10' },\r\n        developing: { description: 'Some original ideas present but inconsistent development. Creative choices show potential but lack depth or coherent vision.', pointRange: '13-17' },\r\n        acceptable: { description: 'Clear creative direction with personal style emerging. Shows good problem-solving and conceptual thinking with adequate originality.', pointRange: '18-22' },\r\n        emerging: { description: 'Strong creative vision with distinctive personal style. Demonstrates innovative thinking and sophisticated conceptual development.', pointRange: '23-26' },\r\n        accomplished: { description: 'Exceptional creative development with unique artistic voice. Shows mastery of design principles and innovative approaches to visual communication.', pointRange: '27-29' },\r\n        exceptional: { description: 'Outstanding creative vision that pushes boundaries and demonstrates professional-level artistic development. Highly original and conceptually sophisticated.', pointRange: '30' }\r\n      },\r\n      feedbackLibrary: {\r\n        strengths: [\r\n          'Strong personal artistic voice',\r\n          'Innovative conceptual approaches',\r\n          'Excellent visual storytelling',\r\n          'Distinctive creative style'\r\n        ],\r\n        improvements: [\r\n          'Develop concepts more thoroughly',\r\n          'Push creative boundaries further',\r\n          'Strengthen visual hierarchy',\r\n          'Consider audience engagement'\r\n        ],\r\n        general: [\r\n          'Creative development shows strong growth',\r\n          'Portfolio demonstrates artistic maturity',\r\n          'Conceptual thinking is well-developed'\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      id: 'portfolio-presentation',\r\n      name: 'Portfolio Presentation & Organization',\r\n      description: 'Professional presentation, layout design, navigation, and overall user experience',\r\n      maxPoints: 25,\r\n      weight: 21,\r\n      levels: {\r\n        incomplete: { description: 'No organized presentation or completely inaccessible.', pointRange: '0' },\r\n        unacceptable: { description: 'Poor organization with confusing navigation, inconsistent layout, or significant usability issues.', pointRange: '6-9' },\r\n        developing: { description: 'Basic organization present but with layout inconsistencies or navigation problems. Shows understanding of presentation but needs refinement.', pointRange: '11-15' },\r\n        acceptable: { description: 'Well-organized portfolio with clear navigation and consistent presentation. Professional appearance with good user experience.', pointRange: '16-19' },\r\n        emerging: { description: 'Excellent presentation with sophisticated layout design, intuitive navigation, and engaging user interface.', pointRange: '20-22' },\r\n        accomplished: { description: 'Exceptional presentation quality with innovative design solutions and seamless user experience. Portfolio itself demonstrates design mastery.', pointRange: '23-24' },\r\n        exceptional: { description: 'Outstanding presentation that sets new standards for portfolio design. Every aspect contributes to a cohesive, professional brand experience.', pointRange: '25' }\r\n      },\r\n      feedbackLibrary: {\r\n        strengths: [\r\n          'Excellent visual hierarchy',\r\n          'Professional layout design',\r\n          'Intuitive navigation system',\r\n          'Consistent branding throughout'\r\n        ],\r\n        improvements: [\r\n          'Improve loading times',\r\n          'Enhance mobile responsiveness',\r\n          'Clarify navigation structure',\r\n          'Strengthen visual consistency'\r\n        ],\r\n        general: [\r\n          'Portfolio presentation is professional',\r\n          'Layout demonstrates design understanding',\r\n          'User experience is well-considered'\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      id: 'written-reflection',\r\n      name: 'Written Reflection & Artist Statements',\r\n      description: 'Quality of written analysis, self-reflection, and articulation of artistic process',\r\n      maxPoints: 20,\r\n      weight: 17,\r\n      levels: {\r\n        incomplete: { description: 'No written reflection provided.', pointRange: '0' },\r\n        unacceptable: { description: 'Minimal or superficial writing with poor grammar and little insight into artistic process.', pointRange: '5-7' },\r\n        developing: { description: 'Basic reflection with some insight but lacking depth or clear articulation of artistic development.', pointRange: '9-12' },\r\n        acceptable: { description: 'Good written reflection that demonstrates understanding of artistic process and clear communication of ideas.', pointRange: '13-15' },\r\n        emerging: { description: 'Strong written analysis with thoughtful reflection on artistic growth and articulate discussion of creative decisions.', pointRange: '16-17' },\r\n        accomplished: { description: 'Exceptional written work that demonstrates deep understanding of artistic practice and sophisticated communication skills.', pointRange: '18-19' },\r\n        exceptional: { description: 'Outstanding written reflection that contributes significantly to understanding of artistic development and creative practice.', pointRange: '20' }\r\n      },\r\n      feedbackLibrary: {\r\n        strengths: [\r\n          'Thoughtful artistic reflection',\r\n          'Clear communication of ideas',\r\n          'Strong analytical thinking',\r\n          'Professional writing quality'\r\n        ],\r\n        improvements: [\r\n          'Develop ideas more thoroughly',\r\n          'Improve grammar and syntax',\r\n          'Add more specific examples',\r\n          'Strengthen conclusion'\r\n        ],\r\n        general: [\r\n          'Written work shows good reflection',\r\n          'Communication skills are developing',\r\n          'Artistic awareness is evident'\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      id: 'professional-readiness',\r\n      name: 'Professional Readiness & Industry Standards',\r\n      description: 'Adherence to professional standards, industry practices, and career preparation',\r\n      maxPoints: 10,\r\n      weight: 8,\r\n      levels: {\r\n        incomplete: { description: 'No evidence of professional preparation.', pointRange: '0' },\r\n        unacceptable: { description: 'Little attention to professional standards or industry expectations.', pointRange: '2-3' },\r\n        developing: { description: 'Some awareness of professional practices but inconsistent application.', pointRange: '4-6' },\r\n        acceptable: { description: 'Good understanding of professional standards with appropriate presentation for industry viewing.', pointRange: '7-8' },\r\n        emerging: { description: 'Strong professional preparation with portfolio ready for industry presentation.', pointRange: '8-9' },\r\n        accomplished: { description: 'Exceptional professional readiness exceeding industry standards.', pointRange: '9-10' },\r\n        exceptional: { description: 'Outstanding professional preparation that demonstrates career readiness.', pointRange: '10' }\r\n      },\r\n      feedbackLibrary: {\r\n        strengths: [\r\n          'Industry-ready presentation',\r\n          'Professional attention to detail',\r\n          'Strong career preparation',\r\n          'Excellent professional standards'\r\n        ],\r\n        improvements: [\r\n          'Research industry standards',\r\n          'Improve professional presentation',\r\n          'Add career preparation elements',\r\n          'Consider industry feedback'\r\n        ],\r\n        general: [\r\n          'Shows strong professional development',\r\n          'Portfolio demonstrates career readiness',\r\n          'Professional standards are evident'\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n};\r\n\r\nconst GradingTemplate = () => {\r\n  // Get shared context - ENHANCED with new functions\r\n  const {\r\n    sharedRubric,\r\n    sharedCourseDetails,\r\n    setSharedCourseDetails,\r\n    gradingData: sharedGradingData,\r\n    setGradingData: setSharedGradingData,\r\n    updateStudentInfo,\r\n    updateCourseInfo,\r\n    updateAssignmentInfo,\r\n    clearGradingFormData,\r\n    classList,\r\n    setClassList,\r\n    setCurrentStudent,\r\n    gradingSession,\r\n    setGradingSession,\r\n    nextStudentInSession,\r\n    previousStudentInSession,\r\n    updateGradingSession,\r\n    initializeGradingSession,\r\n    setActiveTab,\r\n    currentStudent,\r\n    saveDraft,\r\n    loadDraft,\r\n    // NEW: Add the draft/final grade functions\r\n    saveFinalGrade,\r\n    loadFinalGrade,\r\n    finalGrades,\r\n    getGradeStatus\r\n  } = useAssessment();\r\n\r\n  // Helper function to convert HTML content to readable text format\r\n  const renderFormattedContent = (htmlContent) => {\r\n    if (!htmlContent) return '';\r\n\r\n    // Convert basic HTML to readable text format\r\n    let textContent = htmlContent\r\n      .replace(/<br\\s*\\/?>/gi, '\\n')\r\n      .replace(/<\\/p>/gi, '\\n')\r\n      .replace(/<p[^>]*>/gi, '')\r\n      .replace(/<strong[^>]*>(.*?)<\\/strong>/gi, '**$1**')\r\n      .replace(/<b[^>]*>(.*?)<\\/b>/gi, '**$1**')\r\n      .replace(/<em[^>]*>(.*?)<\\/em>/gi, '*$1*')\r\n      .replace(/<i[^>]*>(.*?)<\\/i>/gi, '*$1*')\r\n      .replace(/<u[^>]*>(.*?)<\\/u>/gi, '_$1_')\r\n      .replace(/<h3[^>]*>(.*?)<\\/h3>/gi, '### $1\\n')\r\n      .replace(/<li[^>]*>(.*?)<\\/li>/gi, '• $1\\n')\r\n      .replace(/<\\/ul>/gi, '\\n')\r\n      .replace(/<ul[^>]*>/gi, '')\r\n      .replace(/<\\/ol>/gi, '\\n')\r\n      .replace(/<ol[^>]*>/gi, '')\r\n      .replace(/<[^>]*>/g, '') // Remove any remaining HTML tags\r\n      .replace(/\\n\\s*\\n/g, '\\n') // Remove extra line breaks\r\n      .trim();\r\n\r\n    return textContent;\r\n  };\r\n\r\n  // State for all grading data - initialize from shared context or defaults\r\n  const [localGradingData, setLocalGradingData] = useState(() => {\r\n    // 1) Try loading a saved draft first\r\n    if (currentStudent?.id) {\r\n      const draft = loadDraft(currentStudent.id);\r\n      if (draft) {\r\n        return draft;\r\n      }\r\n    }\r\n    // 2) If rubric was just transferred, use that\r\n    if (sharedGradingData) {\r\n      return { ...sharedGradingData, student: currentStudent || sharedGradingData.student };\r\n    }\r\n    // 3) Otherwise, start fresh for this student\r\n    return {\r\n      student: currentStudent || { name: '', id: '', email: '' },\r\n      course: sharedCourseDetails?.course || { code: '', name: '', instructor: '', term: '' },\r\n      assignment: sharedCourseDetails?.assignment || { name: '', dueDate: '', maxPoints: 100 },\r\n      feedback: { general: '', strengths: '', improvements: '' },\r\n      attachments: [],\r\n      videoLinks: [],\r\n      latePolicy: { level: 'none', penaltyApplied: false },\r\n      metadata: {\r\n        gradedBy: '',\r\n        gradedDate: '',\r\n        aiAssisted: false,\r\n        rubricIntegrated: false\r\n      },\r\n      rubricGrading: {}\r\n    };\r\n  });\r\n\r\n  // Use local grading data as the main state\r\n  const gradingData = localGradingData;\r\n  const setGradingData = setLocalGradingData;\r\n\r\n  // Rubric-specific state\r\n  const [loadedRubric, setLoadedRubric] = useState(() => {\r\n    return sharedRubric || sampleRubric;\r\n  });\r\n  const [rubricGrading, setRubricGrading] = useState({});\r\n  const [showRubricComments, setShowRubricComments] = useState({});\r\n  const [showHeaderGuide, setShowHeaderGuide] = useState(false);\r\n\r\n  const fileInputRef = useRef(null);\r\n  const moduleInputRef = useRef(null);\r\n  const rubricInputRef = useRef(null);\r\n\r\n  // Video link management\r\n  const [videoLinkInput, setVideoLinkInput] = useState('');\r\n  const [videoTitle, setVideoTitle] = useState('');\r\n\r\n  // Auto-save to shared context whenever gradingData changes\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      setSharedGradingData(gradingData);\r\n      setSharedCourseDetails({\r\n        student: gradingData.student,\r\n        course: gradingData.course,\r\n        assignment: gradingData.assignment\r\n      });\r\n    }, 1000);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [gradingData, setSharedGradingData, setSharedCourseDetails]);\r\n\r\n  // Load shared data when available\r\n  useEffect(() => {\r\n    if (sharedRubric) {\r\n      setLoadedRubric(sharedRubric);\r\n    }\r\n  }, [sharedRubric]);\r\n\r\n  useEffect(() => {\r\n    if (sharedCourseDetails) {\r\n      setGradingData(prevData => ({\r\n        ...prevData,\r\n        student: sharedCourseDetails.student || prevData.student,\r\n        course: sharedCourseDetails.course || prevData.course,\r\n        assignment: sharedCourseDetails.assignment || prevData.assignment\r\n      }));\r\n    }\r\n  }, [sharedCourseDetails]);\r\n\r\n  // Late Policy Levels\r\n  const latePolicyLevels = {\r\n    none: {\r\n      name: 'On Time',\r\n      multiplier: 1.0,\r\n      description: 'Assignment submitted on or before due date and time - marked out of 100%',\r\n      color: '#16a34a'\r\n    },\r\n    within24: {\r\n      name: '1-24 Hours Late',\r\n      multiplier: 0.8,\r\n      description: 'Assignment received within 24 hours of due date - 20% reduction (marked out of 80%)',\r\n      color: '#ea580c'\r\n    },\r\n    after24: {\r\n      name: 'More than 24 Hours Late',\r\n      multiplier: 0.0,\r\n      description: 'Assignment received after 24 hours from due date - mark of zero (0)',\r\n      color: '#dc2626'\r\n    }\r\n  };\r\n\r\n  // Initialize rubric grading state when component mounts or rubric changes\r\n  useEffect(() => {\r\n    if (loadedRubric) {\r\n      const initialGrading = {};\r\n      loadedRubric.criteria.forEach(criterion => {\r\n        initialGrading[criterion.id] = {\r\n          criterionId: criterion.id,\r\n          selectedLevel: null,\r\n          customComments: ''\r\n        };\r\n      });\r\n      setRubricGrading(initialGrading);\r\n\r\n      // Update assignment details\r\n      setGradingData(prevData => ({\r\n        ...prevData,\r\n        assignment: {\r\n          ...prevData.assignment,\r\n          name: loadedRubric.assignmentInfo?.title || prevData.assignment.name,\r\n          maxPoints: loadedRubric.assignmentInfo?.totalPoints || prevData.assignment.maxPoints\r\n        },\r\n        metadata: {\r\n          ...prevData.metadata,\r\n          rubricIntegrated: true\r\n        }\r\n      }));\r\n    }\r\n  }, [loadedRubric]);\r\n\r\n  // ENHANCED: Load saved data when student changes\r\n  useEffect(() => {\r\n    if (currentStudent?.id) {\r\n      console.log('🔍 Loading data for student:', currentStudent.name);\r\n\r\n      // Get the grade status for this student\r\n      const gradeStatus = getGradeStatus(currentStudent.id);\r\n      console.log('📊 Grade status:', gradeStatus);\r\n\r\n      let savedData = null;\r\n\r\n      if (gradeStatus === 'final') {\r\n        // Load final grade data\r\n        savedData = loadFinalGrade ? loadFinalGrade(currentStudent.id) : null;\r\n        console.log('📋 Loading final grade data:', savedData ? 'FOUND' : 'NOT FOUND');\r\n      } else if (gradeStatus === 'draft') {\r\n        // Load draft data\r\n        savedData = loadDraft(currentStudent.id);\r\n        console.log('📝 Loading draft data:', savedData ? 'FOUND' : 'NOT FOUND');\r\n      }\r\n\r\n      if (savedData) {\r\n        console.log('✅ Successfully loaded saved grade data');\r\n        setLocalGradingData(savedData);\r\n\r\n        // Load rubric grading if available\r\n        if (savedData.rubricGrading) {\r\n          setRubricGrading(savedData.rubricGrading);\r\n        }\r\n\r\n        // Load other form data\r\n        setVideoLinkInput('');\r\n        setVideoTitle('');\r\n      } else {\r\n        console.log('🆕 No saved data found, starting fresh');\r\n        resetGradingForm();\r\n      }\r\n    }\r\n  }, [currentStudent, getGradeStatus, loadDraft, loadFinalGrade]);\r\n\r\n\r\n  // Calculate total score with late policy applied\r\n  const calculateTotalScore = () => {\r\n    let rawScore = 0;\r\n\r\n    if (loadedRubric) {\r\n      rawScore = Object.values(rubricGrading).reduce((total, grading) => {\r\n        const criterion = loadedRubric.criteria.find(c => c.id === grading.criterionId);\r\n        if (criterion && grading.selectedLevel) {\r\n          const level = loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel);\r\n          return total + (criterion.maxPoints * level.multiplier);\r\n        }\r\n        return total;\r\n      }, 0);\r\n    } else {\r\n      rawScore = gradingData.rubric.reduce((total, item) => total + item.score, 0);\r\n    }\r\n\r\n    const latePolicyLevel = latePolicyLevels[gradingData.latePolicy.level];\r\n    const finalScore = rawScore * latePolicyLevel.multiplier;\r\n\r\n    return {\r\n      rawScore: rawScore,\r\n      finalScore: finalScore,\r\n      penaltyApplied: gradingData.latePolicy.level !== 'none',\r\n      latePolicyDescription: latePolicyLevel.description\r\n    };\r\n  };\r\n\r\n  // Update late policy\r\n  const updateLatePolicy = (level) => {\r\n    setGradingData(prevData => ({\r\n      ...prevData,\r\n      latePolicy: {\r\n        level: level,\r\n        penaltyApplied: level !== 'none'\r\n      }\r\n    }));\r\n  };\r\n\r\n  // Update rubric grading\r\n  const updateRubricGrading = (criterionId, level, comments = null) => {\r\n    setRubricGrading(prev => {\r\n      const existingGrading = prev[criterionId];\r\n      const existingComments = existingGrading?.customComments || '';\r\n\r\n      return {\r\n        ...prev,\r\n        [criterionId]: {\r\n          criterionId,\r\n          selectedLevel: level,\r\n          customComments: comments !== null ? comments : existingComments\r\n        }\r\n      };\r\n    });\r\n  };\r\n\r\n  // Add feedback comment to criterion\r\n  const addCriterionFeedback = (criterionId, comment) => {\r\n    const currentGrading = rubricGrading[criterionId];\r\n    const currentComments = currentGrading?.customComments || '';\r\n    const newComments = currentComments ? `${currentComments}\\n• ${comment}` : `• ${comment}`;\r\n\r\n    setRubricGrading(prev => ({\r\n      ...prev,\r\n      [criterionId]: {\r\n        ...prev[criterionId],\r\n        criterionId,\r\n        selectedLevel: currentGrading?.selectedLevel || null,\r\n        customComments: newComments\r\n      }\r\n    }));\r\n  };\r\n\r\n  // Toggle rubric comments visibility\r\n  const toggleRubricComments = (criterionId) => {\r\n    setShowRubricComments(prev => ({\r\n      ...prev,\r\n      [criterionId]: !prev[criterionId]\r\n    }));\r\n  };\r\n\r\n  // Add video link\r\n  const addVideoLink = () => {\r\n    if (videoLinkInput.trim()) {\r\n      setGradingData(prevData => ({\r\n        ...prevData,\r\n        videoLinks: [...prevData.videoLinks, {\r\n          id: Date.now(),\r\n          url: videoLinkInput.trim(),\r\n          title: videoTitle.trim() || 'Video Link'\r\n        }]\r\n      }));\r\n      setVideoLinkInput('');\r\n      setVideoTitle('');\r\n    }\r\n  };\r\n\r\n  // Remove video link\r\n  const removeVideoLink = (id) => {\r\n    setGradingData(prevData => ({\r\n      ...prevData,\r\n      videoLinks: prevData.videoLinks.filter(link => link.id !== id)\r\n    }));\r\n  };\r\n\r\n  // Handle file uploads\r\n  const handleFileUpload = (files) => {\r\n    const newAttachments = Array.from(files).map(file => ({\r\n      id: Date.now() + Math.random(),\r\n      name: file.name,\r\n      size: file.size,\r\n      type: file.type,\r\n      file: file\r\n    }));\r\n\r\n    Promise.all(newAttachments.map(attachment => {\r\n      return new Promise((resolve) => {\r\n        if (attachment.type.startsWith('image/')) {\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => {\r\n            attachment.base64Data = e.target.result;\r\n            resolve(attachment);\r\n          };\r\n          reader.readAsDataURL(attachment.file);\r\n        } else {\r\n          resolve(attachment);\r\n        }\r\n      });\r\n    })).then(processedAttachments => {\r\n      setGradingData(prevData => ({\r\n        ...prevData,\r\n        attachments: [...prevData.attachments, ...processedAttachments]\r\n      }));\r\n    });\r\n  };\r\n\r\n  // Remove attachment\r\n  const removeAttachment = (id) => {\r\n    setGradingData(prevData => ({\r\n      ...prevData,\r\n      attachments: prevData.attachments.filter(att => att.id !== id)\r\n    }));\r\n  };\r\n\r\n  // ENHANCED: New student navigation functions for draft/final system\r\n  const handleNextStudentAsDraft = () => {\r\n    // Save current student's work as draft\r\n    if (currentStudent?.id) {\r\n      console.log('💾 Saving as draft for student:', currentStudent.name);\r\n      saveDraft(currentStudent.id, localGradingData);\r\n    }\r\n\r\n    const success = nextStudentInSession('draft');\r\n    if (!success) {\r\n      alert('Grading session completed! All students have been graded.');\r\n      setActiveTab('class-manager');\r\n    } else {\r\n      resetGradingForm();\r\n      console.log('✅ Draft saved, moved to next student');\r\n    }\r\n  };\r\n\r\n  const handleNextStudentAsFinal = () => {\r\n    // Save current student's work as final grade\r\n    if (currentStudent?.id) {\r\n      console.log('✅ Finalizing grade for student:', currentStudent.name);\r\n      saveFinalGrade(currentStudent.id, localGradingData);\r\n    }\r\n\r\n    const success = nextStudentInSession('final');\r\n    if (!success) {\r\n      alert('Grading session completed! All students have been graded.');\r\n      setActiveTab('class-manager');\r\n    } else {\r\n      resetGradingForm();\r\n      console.log('✅ Final grade saved, moved to next student');\r\n    }\r\n  };\r\n\r\n  const handlePreviousStudent = () => {\r\n    // Auto-save current student's work before moving\r\n    if (currentStudent?.id) {\r\n      saveDraft(currentStudent.id, localGradingData);\r\n    }\r\n\r\n    const success = previousStudentInSession();\r\n    if (!success) {\r\n      console.log('Already at first student or no active session');\r\n    } else {\r\n      resetGradingForm();\r\n    }\r\n  };\r\n\r\n  const resetGradingForm = () => {\r\n    // Reset only the grading-specific data\r\n    setLocalGradingData(prev => ({\r\n      ...prev,\r\n      feedback: { general: '', strengths: '', improvements: '' },\r\n      attachments: [],\r\n      videoLinks: [],\r\n      latePolicy: { level: 'none', penaltyApplied: false }\r\n    }));\r\n\r\n    // Reset rubric grading state\r\n    if (loadedRubric) {\r\n      const initialGrading = {};\r\n      loadedRubric.criteria.forEach(criterion => {\r\n        initialGrading[criterion.id] = {\r\n          criterionId: criterion.id,\r\n          selectedLevel: null,\r\n          customComments: ''\r\n        };\r\n      });\r\n      setRubricGrading(initialGrading);\r\n    }\r\n  };\r\n\r\n  // Get current student info for navigation display\r\n  const getCurrentStudentInfo = () => {\r\n    if (!classList || !gradingSession?.active || !gradingSession.currentStudent) {\r\n      return null;\r\n    }\r\n\r\n    const currentIndex = gradingSession.currentStudentIndex;\r\n    const totalStudents = classList.students.length;\r\n    const student = gradingSession.currentStudent;\r\n\r\n    return {\r\n      student,\r\n      position: currentIndex + 1,\r\n      total: totalStudents,\r\n      isFirst: currentIndex === 0,\r\n      isLast: currentIndex === totalStudents - 1\r\n    };\r\n  };\r\n\r\n  const currentStudentInfo = getCurrentStudentInfo();\r\n\r\n  // Export functions\r\n  const exportToHTML = () => {\r\n    const scoreCalculation = calculateTotalScore();\r\n    const totalScore = scoreCalculation.finalScore;\r\n    const rawScore = scoreCalculation.rawScore;\r\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\r\n    const percentage = ((totalScore / maxPoints) * 100).toFixed(1);\r\n    const penaltyApplied = scoreCalculation.penaltyApplied;\r\n\r\n    // Build attachments HTML with embedded Base64 images\r\n    const attachmentsHTML = gradingData.attachments.map((att, index) => {\r\n      if (att.base64Data) {\r\n        return `\r\n                  <div class=\"attachment-item\">\r\n                      <img src=\"${att.base64Data}\" \r\n                           alt=\"${att.name}\" \r\n                           class=\"clickable-image\"\r\n                           data-index=\"${index}\"\r\n                           style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" />\r\n                      <div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div>\r\n                      <div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div>\r\n                      <div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div>\r\n                  </div>\r\n              `;\r\n      } else {\r\n        return `\r\n                  <div class=\"attachment-item\">\r\n                      <div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">\r\n                          📄\r\n                      </div>\r\n                      <div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div>\r\n                      <div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div>\r\n                  </div>\r\n              `;\r\n      }\r\n    }).join('');\r\n\r\n\r\n\r\n    // Build video links HTML\r\n    const videoLinksHTML = gradingData.videoLinks.map(link => `\r\n          <div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\">\r\n              <div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\">\r\n                  <span style=\"font-size: 1.25rem;\">🎥</span>\r\n                  <strong style=\"color: #495057;\">${link.title}</strong>\r\n              </div>\r\n              <a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">\r\n                  ${link.url}\r\n              </a>\r\n          </div>\r\n      `).join('');\r\n\r\n    // Enhanced rubric table with complete comments\r\n    const rubricTableHTML = loadedRubric ? `\r\n      <div class=\"rubric-section\" style=\"margin-top: 30px;\">\r\n          <h3>📋 Detailed Rubric Assessment</h3>\r\n          <div style=\"background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;\">\r\n              <strong>Assignment:</strong> ${loadedRubric.assignmentInfo.title}<br>\r\n              <strong>Description:</strong> ${renderFormattedContent(loadedRubric.assignmentInfo.description)}<br>\r\n              <strong>Weight:</strong> ${loadedRubric.assignmentInfo.weight}% of Final Grade<br>\r\n              <strong>Passing Threshold:</strong> ${loadedRubric.assignmentInfo.passingThreshold}%  \r\n          </div>\r\n          \r\n          <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 0.9rem;\">\r\n              <thead>\r\n                  <tr style=\"background: #2c3e50; color: white;\">\r\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th>\r\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Max Points</th>\r\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Level Achieved</th>\r\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Points Earned</th>\r\n                      <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Assessment & Comments</th>\r\n                  </tr>\r\n              </thead>\r\n              <tbody>\r\n                  ${loadedRubric.criteria.map(criterion => {\r\n      const grading = rubricGrading[criterion.id];\r\n      const level = grading?.selectedLevel ? loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel) : null;\r\n      const points = level ? (criterion.maxPoints * level.multiplier).toFixed(1) : '0';\r\n      const levelDescription = level && criterion.levels[level.level] ? renderFormattedContent(criterion.levels[level.level].description) : '';\r\n      const additionalComments = grading?.customComments || '';\r\n\r\n      return `\r\n                          <tr>\r\n                              <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\r\n                                  <strong style=\"color: #2c3e50;\">${criterion.name}</strong><br>\r\n                                  <small style=\"color: #666; font-style: italic;\">${renderFormattedContent(criterion.description)}</small>\r\n                              </td>\r\n                              <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold;\">${criterion.maxPoints}</td>\r\n                              <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; ${level ? `background-color: ${level.color}15; color: ${level.color}; font-weight: bold;` : ''}\">${level ? level.name : 'Not Assessed'}</td>\r\n                              <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td>\r\n                              <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\r\n                                  ${levelDescription ? `\r\n                                      <div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\">\r\n                                          <strong style=\"color: ${level.color};\">Level Description:</strong><br>\r\n                                          <span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span>\r\n                                      </div>\r\n                                  ` : ''}\r\n                                  ${additionalComments ? `\r\n                                      <div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\">\r\n                                          <strong style=\"color: #856404;\">Additional Comments:</strong><br>\r\n                                          <span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span>\r\n                                      </div>\r\n                                  ` : ''}\r\n                                  ${(!levelDescription && !additionalComments) ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}\r\n                              </td>\r\n                          </tr>\r\n                      `;\r\n    }).join('')}\r\n              </tbody>\r\n          </table>\r\n          \r\n          <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\">\r\n              <h4 style=\"color: #2e7d32; margin-bottom: 10px;\">📊 Rubric Score Summary</h4>\r\n              <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\r\n                  <div>\r\n                      <strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br>\r\n                      <strong>Percentage:</strong> ${percentage}%\r\n                  </div>\r\n                  <div>\r\n                      <strong>Grade Status:</strong> \r\n                      <span style=\"color: ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">\r\n                          ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}\r\n                      </span>\r\n                  </div>\r\n                  ${penaltyApplied ? `\r\n                      <div style=\"color: #ff9800;\">\r\n                          <strong>Late Penalty Applied:</strong><br>\r\n                          Raw Score: ${Math.round(rawScore * 10) / 10}\r\n                      </div>\r\n                  ` : ''}\r\n              </div>\r\n          </div>\r\n      </div>\r\n      ` : '';\r\n\r\n    const htmlContent = `\r\n    <!DOCTYPE html>\r\n    <html lang=\"en\">\r\n    <head>\r\n      <meta charset=\"UTF-8\">\r\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n      <title>Grade Report - ${gradingData.student.name}</title>\r\n      <style>\r\n          body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; line-height: 1.6; }\r\n          .header { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; }\r\n          .score-summary { background: #e8f5e8; border: 2px solid #4caf50; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center; }\r\n          .late-policy-section { margin: 30px 0; background: #fff5f5; border: 1px solid #f87171; border-radius: 8px; padding: 20px; }\r\n          .feedback-section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 8px; }\r\n          .attachments { margin: 30px 0; }\r\n          .attachment-item { \r\n              display: inline-block; \r\n              text-align: center; \r\n              margin: 1rem; \r\n              padding: 1rem; \r\n              background: #fff; \r\n              border: 1px solid #ddd; \r\n              border-radius: 8px; \r\n              box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n              max-width: 250px;\r\n              vertical-align: top;\r\n          }\r\n          .clickable-image {\r\n              cursor: pointer;\r\n              transition: all 0.3s ease;\r\n              position: relative;\r\n          }\r\n          .clickable-image:hover {\r\n              transform: scale(1.05);\r\n              box-shadow: 0 4px 8px rgba(0,0,0,0.2);\r\n          }\r\n          .video-links { margin: 30px 0; }\r\n          .video-link-item { margin-bottom: 1rem; }\r\n          .video-link-item a { color: #007bff; text-decoration: none; }\r\n          .video-link-item a:hover { text-decoration: underline; }\r\n          h1, h2, h3 { color: #333; }\r\n          \r\n          /* Modal styles for full-size image viewing */\r\n          .image-modal {\r\n              display: none;\r\n              position: fixed;\r\n              z-index: 1000;\r\n              left: 0;\r\n              top: 0;\r\n              width: 100%;\r\n              height: 100%;\r\n              background-color: rgba(0,0,0,0.9);\r\n              animation: fadeIn 0.3s ease;\r\n          }\r\n          .image-modal.show {\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n          }\r\n          .modal-content {\r\n              max-width: 95%;\r\n              max-height: 95%;\r\n              object-fit: contain;\r\n              border-radius: 8px;\r\n              box-shadow: 0 4px 20px rgba(0,0,0,0.5);\r\n              animation: zoomIn 0.3s ease;\r\n          }\r\n          .close-modal {\r\n              position: absolute;\r\n              top: 20px;\r\n              right: 30px;\r\n              color: white;\r\n              font-size: 40px;\r\n              font-weight: bold;\r\n              cursor: pointer;\r\n              z-index: 1001;\r\n              background: rgba(0,0,0,0.5);\r\n              border-radius: 50%;\r\n              width: 50px;\r\n              height: 50px;\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n              line-height: 1;\r\n          }\r\n          .close-modal:hover {\r\n              background: rgba(0,0,0,0.8);\r\n          }\r\n          .modal-caption {\r\n              position: absolute;\r\n              bottom: 20px;\r\n              left: 50%;\r\n              transform: translateX(-50%);\r\n              color: white;\r\n              background: rgba(0,0,0,0.7);\r\n              padding: 10px 20px;\r\n              border-radius: 6px;\r\n              text-align: center;\r\n              max-width: 80%;\r\n          }\r\n          \r\n          @keyframes fadeIn {\r\n              from { opacity: 0; }\r\n              to { opacity: 1; }\r\n          }\r\n          @keyframes zoomIn {\r\n              from { transform: scale(0.5); opacity: 0; }\r\n              to { transform: scale(1); opacity: 1; }\r\n          }\r\n          \r\n          @media print {\r\n              .attachment-item { break-inside: avoid; }\r\n              .video-link-item { break-inside: avoid; }\r\n              .image-modal { display: none !important; }\r\n          }\r\n      </style>\r\n    </head>\r\n    <body>\r\n      <div class=\"header\">\r\n          <h1>📋 Grade Report</h1>\r\n          <p><strong>Student:</strong> ${gradingData.student.name} (${gradingData.student.id})</p>\r\n          <p><strong>Course:</strong> ${gradingData.course.code} - ${gradingData.course.name}</p>\r\n          <p><strong>Assignment:</strong> ${gradingData.assignment.name}</p>\r\n          <p><strong>Instructor:</strong> ${gradingData.course.instructor}</p>\r\n          <p><strong>Term:</strong> ${gradingData.course.term}</p>\r\n      </div>\r\n    \r\n      <div class=\"score-summary\">\r\n          <h2>📊 Final Score</h2>\r\n          <div style=\"font-size: 2rem; font-weight: bold; color: #2e7d32; margin: 15px 0;\">\r\n              ${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)\r\n          </div>\r\n          <p style=\"margin: 10px 0; color: #555;\">\r\n              ${loadedRubric ? `Rubric: ${loadedRubric.assignmentInfo.title}` : ``}\r\n              ${penaltyApplied ? ` | Late Policy: ${latePolicyLevels[gradingData.latePolicy.level].name}` : ''}\r\n          </p>\r\n      </div>\r\n    \r\n      ${penaltyApplied ? `\r\n      <div class=\"late-policy-section\">\r\n          <h3 style=\"color: #dc2626;\">📅 Late Submission Policy Applied</h3>\r\n          <p><strong>Policy Status:</strong> ${latePolicyLevels[gradingData.latePolicy.level].name}</p>\r\n          <p>${latePolicyLevels[gradingData.latePolicy.level].description}</p>\r\n          <p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} → <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\r\n      </div>\r\n      ` : ''}\r\n    \r\n      ${rubricTableHTML}\r\n      \r\n      ${Object.entries(gradingData.feedback).filter(([key, value]) => value).map(([key, value]) => `\r\n          <div class=\"feedback-section\">\r\n              <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\r\n              <p>${value.replace(/\\n/g, '<br>')}</p>\r\n          </div>\r\n      `).join('')}\r\n    \r\n      ${attachmentsHTML ? `\r\n      <div class=\"attachments\">\r\n          <h3>📎 File Attachments</h3>\r\n          <div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">\r\n              ${attachmentsHTML}\r\n          </div>\r\n      </div>\r\n      ` : ''}\r\n    \r\n      ${videoLinksHTML ? `\r\n      <div class=\"video-links\">\r\n          <h3>🎥 Video Review Links</h3>\r\n          ${videoLinksHTML}\r\n      </div>\r\n      ` : ''}\r\n      \r\n      <p style=\"margin-top: 40px; text-align: center; color: #666; font-size: 0.9rem;\">\r\n          Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}\r\n      </p>\r\n    \r\n      <div id=\"imageModal\" class=\"image-modal\">\r\n          <span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span>\r\n          <img class=\"modal-content\" id=\"modalImage\">\r\n          <div class=\"modal-caption\" id=\"modalCaption\"></div>\r\n      </div>\r\n    \r\n      <script>\r\n          // Store attachment data for modal functionality\r\n          const attachmentData = ${JSON.stringify(gradingData.attachments)};\r\n          \r\n          function openImageModal(imageSrc, caption) {\r\n              const modal = document.getElementById('imageModal');\r\n              const modalImg = document.getElementById('modalImage');\r\n              const modalCaption = document.getElementById('modalCaption');\r\n              \r\n              modal.classList.add('show');\r\n              modalImg.src = imageSrc;\r\n              modalCaption.textContent = caption;\r\n              \r\n              // Prevent body scrolling when modal is open\r\n              document.body.style.overflow = 'hidden';\r\n          }\r\n    \r\n          function closeImageModal() {\r\n              const modal = document.getElementById('imageModal');\r\n              modal.classList.remove('show');\r\n              document.body.style.overflow = 'auto';\r\n          }\r\n    \r\n          // Add click event listeners when DOM is loaded\r\n          document.addEventListener('DOMContentLoaded', function() {\r\n              const clickableImages = document.querySelectorAll('.clickable-image');\r\n              clickableImages.forEach(img => {\r\n                  img.addEventListener('click', function() {\r\n                      const index = parseInt(this.getAttribute('data-index'));\r\n                      const attachment = attachmentData[index];\r\n                      if (attachment && attachment.base64Data) {\r\n                          openImageModal(attachment.base64Data, attachment.name);\r\n                      }\r\n                  });\r\n              });\r\n    \r\n              // Close modal when clicking outside the image\r\n              document.getElementById('imageModal').addEventListener('click', function(e) {\r\n                  if (e.target === this) {\r\n                      closeImageModal();\r\n                  }\r\n              });\r\n    \r\n              // Close modal with Escape key\r\n              document.addEventListener('keydown', function(e) {\r\n                  if (e.key === 'Escape') {\r\n                      closeImageModal();\r\n                  }\r\n              });\r\n          });\r\n      </script>\r\n    </body>\r\n    </html>`;\r\n\r\n    const htmlBlob = new Blob([htmlContent], { type: 'text/html' });\r\n    const url = URL.createObjectURL(htmlBlob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `grade_report_${gradingData.student.name || 'student'}_${gradingData.assignment.name || 'assignment'}.html`;\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const exportToPDF = () => {\r\n    const scoreCalculation = calculateTotalScore();\r\n    const totalScore = scoreCalculation.finalScore;\r\n    const rawScore = scoreCalculation.rawScore;\r\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\r\n    const percentage = ((totalScore / maxPoints) * 100).toFixed(1);\r\n    const penaltyApplied = scoreCalculation.penaltyApplied;\r\n    const currentDate = new Date().toLocaleDateString('en-US', {\r\n      weekday: 'long',\r\n      year: 'numeric',\r\n      month: 'long',\r\n      day: 'numeric'\r\n    });\r\n\r\n    // Build attachments HTML (PDF optimized)\r\n    const attachmentsHTML = gradingData.attachments.map((att, index) => {\r\n      if (att.base64Data) {\r\n        return `\r\n                    <div class=\"attachment-item\">\r\n                        <img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"attachment-image\" />\r\n                        <div class=\"attachment-info\">\r\n                            <div class=\"attachment-name\">${att.name}</div>\r\n                            <div class=\"attachment-size\">${(att.size / 1024).toFixed(1)} KB</div>\r\n                        </div>\r\n                    </div>\r\n                `;\r\n      } else {\r\n        return `\r\n                    <div class=\"attachment-item\">\r\n                        <div class=\"file-icon\">📄</div>\r\n                        <div class=\"attachment-info\">\r\n                            <div class=\"attachment-name\">${att.name}</div>\r\n                            <div class=\"attachment-size\">${(att.size / 1024).toFixed(1)} KB</div>\r\n                        </div>\r\n                    </div>\r\n                `;\r\n      }\r\n    }).join('');\r\n\r\n    // Build video links HTML\r\n    const videoLinksHTML = gradingData.videoLinks.map(link => `\r\n            <div class=\"video-link-item\">\r\n                <span class=\"video-icon\">🎥</span>\r\n                <div class=\"video-info\">\r\n                    <div class=\"video-title\">${link.title}</div>\r\n                    <div class=\"video-url\">${link.url}</div>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n\r\n    // Enhanced rubric table for PDF\r\n    const rubricTableHTML = loadedRubric ? `\r\n        <div class=\"rubric-section\">\r\n            <h3 class=\"section-title\">📋 Detailed Rubric Assessment</h3>\r\n            <div class=\"rubric-info\">\r\n                <div class=\"info-grid\">\r\n                    <div><strong>Assignment:</strong> ${loadedRubric.assignmentInfo.title}</div>\r\n                    <div><strong>Weight:</strong> ${loadedRubric.assignmentInfo.weight}% of Final Grade</div>\r\n                    <div><strong>Passing Threshold:</strong> ${loadedRubric.assignmentInfo.passingThreshold}%</div>\r\n                    <div><strong>Total Points:</strong> ${loadedRubric.assignmentInfo.totalPoints}</div>\r\n                </div>\r\n                <div class=\"assignment-description\">${renderFormattedContent(loadedRubric.assignmentInfo.description)}</div>\r\n            </div>\r\n            \r\n            <table class=\"rubric-table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th class=\"criterion-header\">Criterion</th>\r\n                        <th class=\"points-header\">Max Points</th>\r\n                        <th class=\"level-header\">Level Achieved</th>\r\n                        <th class=\"earned-header\">Points Earned</th>\r\n                        <th class=\"comments-header\">Assessment & Comments</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    ${loadedRubric.criteria.map(criterion => {\r\n      const grading = rubricGrading[criterion.id];\r\n      const level = grading?.selectedLevel ? loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel) : null;\r\n      const points = level ? (criterion.maxPoints * level.multiplier).toFixed(1) : '0';\r\n      const levelDescription = level && criterion.levels[level.level] ? renderFormattedContent(criterion.levels[level.level].description) : '';\r\n      const additionalComments = grading?.customComments || '';\r\n\r\n      return `\r\n                            <tr class=\"criterion-row\">\r\n                                <td class=\"criterion-cell\">\r\n                                    <div class=\"criterion-name\">${criterion.name}</div>\r\n                                    <div class=\"criterion-desc\">${renderFormattedContent(criterion.description)}</div>\r\n                                </td>\r\n                                <td class=\"points-cell\">${criterion.maxPoints}</td>\r\n                                <td class=\"level-cell ${level ? 'level-achieved' : ''}\" ${level ? `style=\"background-color: ${level.color}20; color: ${level.color};\"` : ''}>\r\n                                    ${level ? level.name : 'Not Assessed'}\r\n                                </td>\r\n                                <td class=\"earned-cell\">${points}</td>\r\n                                <td class=\"comments-cell\">\r\n                                    ${levelDescription ? `\r\n                                        <div class=\"level-description\">\r\n                                            <strong>Level Description:</strong>\r\n                                            <p>${levelDescription}</p>\r\n                                        </div>\r\n                                    ` : ''}\r\n                                    ${additionalComments ? `\r\n                                        <div class=\"additional-comments\">\r\n                                            <strong>Additional Comments:</strong>\r\n                                            <p>${additionalComments.replace(/\\n/g, '<br>')}</p>\r\n                                        </div>\r\n                                    ` : ''}\r\n                                    ${(!levelDescription && !additionalComments) ? '<em>No assessment provided</em>' : ''}\r\n                                </td>\r\n                            </tr>\r\n                        `;\r\n    }).join('')}\r\n                </tbody>\r\n            </table>\r\n            \r\n            <div class=\"rubric-summary\">\r\n                <div class=\"summary-grid\">\r\n                    <div class=\"summary-item\">\r\n                        <strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}\r\n                    </div>\r\n                    <div class=\"summary-item\">\r\n                        <strong>Percentage:</strong> ${percentage}%\r\n                    </div>\r\n                    <div class=\"summary-item\">\r\n                        <strong>Grade Status:</strong> \r\n                        <span class=\"${percentage >= loadedRubric.assignmentInfo.passingThreshold ? 'passing' : 'needs-improvement'}\">\r\n                            ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}\r\n                        </span>\r\n                    </div>\r\n                    ${penaltyApplied ? `\r\n                        <div class=\"summary-item penalty\">\r\n                            <strong>Late Penalty Applied:</strong> Raw Score: ${Math.round(rawScore * 10) / 10}\r\n                        </div>\r\n                    ` : ''}\r\n                </div>\r\n            </div>\r\n        </div>\r\n        ` : '';\r\n\r\n    const pdfContent = `\r\n    <!DOCTYPE html>\r\n    <html lang=\"en\">\r\n    <head>\r\n        <meta charset=\"UTF-8\">\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n        <title>Grade Report - ${gradingData.student.name}</title>\r\n        <style>\r\n            @page {\r\n                size: A4;\r\n                margin: 0.75in;\r\n                @top-center {\r\n                    content: \"Grade Report - ${gradingData.student.name}\";\r\n                    font-size: 10pt;\r\n                    color: #666;\r\n                }\r\n                @bottom-center {\r\n                    content: \"Page \" counter(page) \" of \" counter(pages) \" | Generated on ${currentDate}\";\r\n                    font-size: 9pt;\r\n                    color: #666;\r\n                }\r\n            }\r\n            \r\n            body {\r\n                font-family: 'Arial', sans-serif;\r\n                line-height: 1.4;\r\n                color: #333;\r\n                background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\r\n                margin: 0;\r\n                padding: 0;\r\n            }\r\n            \r\n            .header {\r\n                background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);\r\n                color: white;\r\n                padding: 25px;\r\n                border-radius: 10px;\r\n                margin-bottom: 25px;\r\n                position: relative;\r\n                overflow: hidden;\r\n            }\r\n            \r\n            .header::before {\r\n                content: '';\r\n                position: absolute;\r\n                top: 0;\r\n                left: 0;\r\n                right: 0;\r\n                bottom: 0;\r\n                background: url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='m36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\") repeat;\r\n                z-index: 0;\r\n            }\r\n            \r\n            .header-content {\r\n                position: relative;\r\n                z-index: 1;\r\n            }\r\n            \r\n            .header h1 {\r\n                font-size: 28px;\r\n                margin: 0 0 10px 0;\r\n                font-weight: 700;\r\n            }\r\n            \r\n            .header-info {\r\n                display: grid;\r\n                grid-template-columns: 1fr 1fr;\r\n                gap: 20px;\r\n                margin-top: 15px;\r\n            }\r\n            \r\n            .header-info p {\r\n                margin: 5px 0;\r\n                font-size: 14px;\r\n            }\r\n            \r\n            .score-summary {\r\n                background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);\r\n                border: 2px solid #16a34a;\r\n                border-radius: 12px;\r\n                padding: 25px;\r\n                margin: 25px 0;\r\n                text-align: center;\r\n                position: relative;\r\n                overflow: hidden;\r\n            }\r\n            \r\n            .score-summary::before {\r\n                content: '';\r\n                position: absolute;\r\n                top: -50%;\r\n                left: -50%;\r\n                width: 200%;\r\n                height: 200%;\r\n                background: conic-gradient(from 0deg, transparent, rgba(34, 197, 94, 0.1), transparent);\r\n                animation: rotate 20s linear infinite;\r\n                z-index: 0;\r\n            }\r\n            \r\n            .score-content {\r\n                position: relative;\r\n                z-index: 1;\r\n            }\r\n            \r\n            .final-score {\r\n                font-size: 48px;\r\n                font-weight: 700;\r\n                color: #15803d;\r\n                margin: 15px 0;\r\n            }\r\n            \r\n            .score-percentage {\r\n                font-size: 24px;\r\n                color: #166534;\r\n                margin-bottom: 15px;\r\n            }\r\n            \r\n            .section-title {\r\n                color: #1e40af;\r\n                font-size: 20px;\r\n                font-weight: 600;\r\n                margin: 25px 0 15px 0;\r\n                padding-bottom: 8px;\r\n                border-bottom: 2px solid #3b82f6;\r\n            }\r\n            \r\n            .rubric-info {\r\n                background: #f8fafc;\r\n                border: 1px solid #e2e8f0;\r\n                border-radius: 8px;\r\n                padding: 20px;\r\n                margin-bottom: 20px;\r\n            }\r\n            \r\n            .info-grid {\r\n                display: grid;\r\n                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n                gap: 15px;\r\n                margin-bottom: 15px;\r\n            }\r\n            \r\n            .assignment-description {\r\n                font-style: italic;\r\n                color: #64748b;\r\n                margin-top: 10px;\r\n                padding-top: 10px;\r\n                border-top: 1px solid #e2e8f0;\r\n            }\r\n            \r\n            .rubric-table {\r\n                width: 100%;\r\n                border-collapse: collapse;\r\n                margin-bottom: 25px;\r\n                background: white;\r\n                border-radius: 8px;\r\n                overflow: hidden;\r\n                box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);\r\n            }\r\n            \r\n            .rubric-table th {\r\n                background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);\r\n                color: white;\r\n                padding: 15px 12px;\r\n                font-weight: 600;\r\n                text-align: left;\r\n                font-size: 14px;\r\n            }\r\n            \r\n            .rubric-table td {\r\n                padding: 12px;\r\n                border-bottom: 1px solid #e2e8f0;\r\n                vertical-align: top;\r\n                font-size: 13px;\r\n            }\r\n            \r\n            .criterion-cell {\r\n                background: #f8fafc;\r\n                border-right: 1px solid #e2e8f0;\r\n                width: 20%;\r\n            }\r\n            \r\n            .criterion-name {\r\n                font-weight: 600;\r\n                color: #1e40af;\r\n                margin-bottom: 5px;\r\n            }\r\n            \r\n            .criterion-desc {\r\n                font-size: 12px;\r\n                color: #64748b;\r\n                font-style: italic;\r\n            }\r\n            \r\n            .points-cell, .earned-cell {\r\n                text-align: center;\r\n                font-weight: 600;\r\n                width: 10%;\r\n            }\r\n            \r\n            .level-cell {\r\n                text-align: center;\r\n                font-weight: 600;\r\n                width: 15%;\r\n            }\r\n            \r\n            .level-achieved {\r\n                border-radius: 4px;\r\n                padding: 8px 4px;\r\n            }\r\n            \r\n            .comments-cell {\r\n                width: 45%;\r\n            }\r\n            \r\n            .level-description {\r\n                background: #f1f5f9;\r\n                border-left: 4px solid #3b82f6;\r\n                padding: 10px;\r\n                margin-bottom: 10px;\r\n                border-radius: 4px;\r\n            }\r\n            \r\n            .level-description strong {\r\n                color: #1e40af;\r\n            }\r\n            \r\n            .level-description p {\r\n                margin: 5px 0;\r\n                line-height: 1.4;\r\n            }\r\n            \r\n            .additional-comments {\r\n                background: #fffbeb;\r\n                border: 1px solid #fbbf24;\r\n                border-radius: 4px;\r\n                padding: 10px;\r\n                margin-top: 10px;\r\n            }\r\n            \r\n            .additional-comments strong {\r\n                color: #92400e;\r\n            }\r\n            \r\n            .additional-comments p {\r\n                margin: 5px 0;\r\n                line-height: 1.4;\r\n            }\r\n            \r\n            .rubric-summary {\r\n                background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\r\n                border: 2px solid #3b82f6;\r\n                border-radius: 8px;\r\n                padding: 20px;\r\n                margin-top: 25px;\r\n            }\r\n            \r\n            .summary-grid {\r\n                display: grid;\r\n                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n                gap: 15px;\r\n            }\r\n            \r\n            .summary-item {\r\n                font-size: 14px;\r\n            }\r\n            \r\n            .passing {\r\n                color: #16a34a;\r\n                font-weight: 600;\r\n            }\r\n            \r\n            .needs-improvement {\r\n                color: #dc2626;\r\n                font-weight: 600;\r\n            }\r\n            \r\n            .penalty {\r\n                color: #ea580c;\r\n            }\r\n            \r\n            .late-policy-section {\r\n                background: #fef2f2;\r\n                border: 1px solid #fca5a5;\r\n                border-radius: 8px;\r\n                padding: 20px;\r\n                margin: 20px 0;\r\n            }\r\n            \r\n            .feedback-section {\r\n                background: #f9fafb;\r\n                border-radius: 8px;\r\n                padding: 20px;\r\n                margin: 20px 0;\r\n                border-left: 4px solid #3b82f6;\r\n            }\r\n            \r\n            .feedback-section h3 {\r\n                color: #1e40af;\r\n                margin-top: 0;\r\n            }\r\n            \r\n            .attachments {\r\n                margin: 25px 0;\r\n            }\r\n            \r\n            .attachment-item {\r\n                display: inline-block;\r\n                margin: 10px;\r\n                padding: 15px;\r\n                background: white;\r\n                border: 1px solid #e2e8f0;\r\n                border-radius: 8px;\r\n                text-align: center;\r\n                max-width: 200px;\r\n                vertical-align: top;\r\n            }\r\n            \r\n            .attachment-image {\r\n                max-width: 150px;\r\n                max-height: 150px;\r\n                object-fit: contain;\r\n                border-radius: 4px;\r\n                margin-bottom: 10px;\r\n            }\r\n            \r\n            .file-icon {\r\n                font-size: 48px;\r\n                margin-bottom: 10px;\r\n            }\r\n            \r\n            .attachment-name {\r\n                font-weight: 500;\r\n                font-size: 12px;\r\n                word-break: break-word;\r\n            }\r\n            \r\n            .attachment-size {\r\n                font-size: 11px;\r\n                color: #64748b;\r\n            }\r\n            \r\n            .video-links {\r\n                margin: 25px 0;\r\n            }\r\n            \r\n            .video-link-item {\r\n                background: white;\r\n                border: 1px solid #e2e8f0;\r\n                border-radius: 8px;\r\n                padding: 15px;\r\n                margin-bottom: 10px;\r\n                display: flex;\r\n                align-items: center;\r\n                gap: 15px;\r\n            }\r\n            \r\n            .video-icon {\r\n                font-size: 24px;\r\n            }\r\n            \r\n            .video-title {\r\n                font-weight: 600;\r\n                margin-bottom: 5px;\r\n            }\r\n            \r\n            .video-url {\r\n                font-size: 12px;\r\n                color: #3b82f6;\r\n                word-break: break-all;\r\n            }\r\n            \r\n            .footer {\r\n                text-align: center;\r\n                margin-top: 40px;\r\n                padding-top: 20px;\r\n                border-top: 1px solid #e2e8f0;\r\n                color: #64748b;\r\n                font-size: 12px;\r\n            }\r\n            \r\n            @keyframes rotate {\r\n                to {\r\n                    transform: rotate(360deg);\r\n                }\r\n            }\r\n            \r\n            @media print {\r\n                body {\r\n                    background: white;\r\n                }\r\n                .header, .score-summary {\r\n                    break-inside: avoid;\r\n                }\r\n                .rubric-table {\r\n                    break-inside: avoid;\r\n                }\r\n                .attachment-item {\r\n                    break-inside: avoid;\r\n                }\r\n            }\r\n        </style>\r\n    </head>\r\n    <body>\r\n        <div class=\"header\">\r\n            <div class=\"header-content\">\r\n                <h1>📋 Grade Report</h1>\r\n                <div class=\"header-info\">\r\n                    <div>\r\n                        <p><strong>Student:</strong> ${gradingData.student.name}</p>\r\n                        <p><strong>Student ID:</strong> ${gradingData.student.id}</p>\r\n                        <p><strong>Email:</strong> ${gradingData.student.email}</p>\r\n                    </div>\r\n                    <div>\r\n                        <p><strong>Course:</strong> ${gradingData.course.code} - ${gradingData.course.name}</p>\r\n                        <p><strong>Instructor:</strong> ${gradingData.course.instructor}</p>\r\n                        <p><strong>Term:</strong> ${gradingData.course.term}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    \r\n        <div class=\"score-summary\">\r\n            <div class=\"score-content\">\r\n                <h2 style=\"margin: 0 0 10px 0; color: #15803d;\">📊 Final Score</h2>\r\n                <div class=\"final-score\">\r\n                    ${totalScore.toFixed(1)} / ${maxPoints}\r\n                </div>\r\n                <div class=\"score-percentage\">\r\n                    ${percentage}%\r\n                </div>\r\n                <p style=\"margin: 10px 0; color: #166534;\">\r\n                    ${loadedRubric ? `Assessment: ${loadedRubric.assignmentInfo.title}` : ``}\r\n                    ${penaltyApplied ? ` | Late Policy: ${latePolicyLevels[gradingData.latePolicy.level].name}` : ''}\r\n                </p>\r\n            </div>\r\n        </div>\r\n    \r\n        ${penaltyApplied ? `\r\n        <div class=\"late-policy-section\">\r\n            <h3 style=\"color: #dc2626; margin-top: 0;\">📅 Late Submission Policy Applied</h3>\r\n            <p><strong>Policy Status:</strong> ${latePolicyLevels[gradingData.latePolicy.level].name}</p>\r\n            <p>${latePolicyLevels[gradingData.latePolicy.level].description}</p>\r\n            <p><strong>Calculation:</strong> Raw Score ${Math.round(rawScore * 10) / 10}/${maxPoints} → Final Score ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\r\n        </div>\r\n        ` : ''}\r\n    \r\n        ${rubricTableHTML}\r\n        \r\n        ${Object.entries(gradingData.feedback).filter(([key, value]) => value).map(([key, value]) => `\r\n            <div class=\"feedback-section\">\r\n                <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\r\n                <p>${value.replace(/\\n/g, '<br>')}</p>\r\n            </div>\r\n        `).join('')}\r\n    \r\n        ${attachmentsHTML ? `\r\n        <div class=\"attachments\">\r\n            <h3 class=\"section-title\">📎 File Attachments</h3>\r\n            ${attachmentsHTML}\r\n        </div>\r\n        ` : ''}\r\n    \r\n        ${videoLinksHTML ? `\r\n        <div class=\"video-links\">\r\n            <h3 class=\"section-title\">🎥 Video Review Links</h3>\r\n            ${videoLinksHTML}\r\n        </div>\r\n        ` : ''}\r\n        \r\n        <div class=\"footer\">\r\n            <p><strong>Grade Report Generated</strong></p>\r\n            <p>${currentDate} | ${new Date().toLocaleTimeString()}</p>\r\n            <p>Assessment Platform v2.0 | Professional Grading System</p>\r\n        </div>\r\n    </body>\r\n    </html>`;\r\n\r\n    // Create a new window for PDF printing\r\n    const printWindow = window.open('', '_blank', 'width=800,height=600');\r\n    printWindow.document.write(pdfContent);\r\n    printWindow.document.close();\r\n\r\n    // Wait for content to load then trigger print\r\n    printWindow.onload = function () {\r\n      setTimeout(() => {\r\n        printWindow.print();\r\n      }, 500);\r\n    };\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '1200px', margin: '0 auto', fontFamily: 'system-ui, sans-serif' }}>\r\n\r\n      {/* ... (keep all existing header content) */}\r\n\r\n      {/* Current Student Navigation Display */}\r\n      {currentStudentInfo && (\r\n        <div style={{\r\n          background: 'linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)',\r\n          border: '2px solid #0ea5e9',\r\n          borderRadius: '0.75rem',\r\n          padding: '1rem',\r\n          marginBottom: '2rem',\r\n          display: 'flex',\r\n          justifyContent: 'space-between',\r\n          alignItems: 'center'\r\n        }}>\r\n          <div>\r\n            <h3 style={{ margin: '0 0 0.5rem 0', color: '#0c4a6e', fontSize: '1.25rem' }}>\r\n              Currently Grading: {currentStudentInfo.student.name}\r\n            </h3>\r\n            <p style={{ margin: 0, color: '#075985', fontSize: '0.875rem' }}>\r\n              Student {currentStudentInfo.position} of {currentStudentInfo.total} • ID: {currentStudentInfo.student.id}\r\n            </p>\r\n          </div>\r\n          <div style={{ display: 'flex', gap: '0.75rem' }}>\r\n            <button\r\n              onClick={handlePreviousStudent}\r\n              disabled={currentStudentInfo.isFirst}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                background: currentStudentInfo.isFirst ? '#e5e7eb' : '#6b7280',\r\n                color: currentStudentInfo.isFirst ? '#9ca3af' : 'white',\r\n                border: 'none',\r\n                borderRadius: '0.375rem',\r\n                cursor: currentStudentInfo.isFirst ? 'not-allowed' : 'pointer',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            >\r\n              ← Previous\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab('class-manager')}\r\n              style={{\r\n                padding: '0.5rem 1rem',\r\n                background: '#374151',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '0.375rem',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem'\r\n              }}\r\n            >\r\n              Class Manager\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ... (existing form content like course info, student info, etc. would be here) */}\r\n\r\n      {/* Loaded Rubric Section */}\r\n      {loadedRubric && (\r\n        <div style={{\r\n          background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\r\n          border: '1px solid #bbf7d0',\r\n          borderRadius: '0.75rem',\r\n          padding: '1.5rem',\r\n          marginBottom: '2rem'\r\n        }}>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n            <div>\r\n              <h3 style={{ fontSize: '1.25rem', fontWeight: '700', color: '#15803d', marginBottom: '0.5rem' }}>\r\n                📋 Active Assignment Rubric\r\n              </h3>\r\n              <p style={{ color: '#16a34a', fontWeight: '600', fontSize: '1.1rem' }}>\r\n                {loadedRubric.assignmentInfo.title}\r\n              </p>\r\n              <p style={{ fontSize: '0.875rem', color: '#059669' }}>\r\n                {renderFormattedContent(loadedRubric.assignmentInfo.description)}\r\n              </p>\r\n            </div>\r\n            <div style={{ textAlign: 'right' }}>\r\n              <div style={{ fontSize: '0.875rem', color: '#059669' }}>\r\n                <p style={{ margin: '0.25rem 0' }}>\r\n                  <strong>Weight:</strong> {loadedRubric.assignmentInfo.weight}% of Final Grade\r\n                </p>\r\n                <p style={{ margin: '0.25rem 0' }}>\r\n                  <strong>Passing:</strong> {loadedRubric.assignmentInfo.passingThreshold}%\r\n                </p>\r\n                <p style={{ margin: '0.25rem 0' }}>\r\n                  <strong>Total Points:</strong> {loadedRubric.assignmentInfo.totalPoints}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Rubric Grading Interface */}\r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '1.5rem' }}>\r\n            {loadedRubric.criteria.map((criterion) => {\r\n              const currentGrading = rubricGrading[criterion.id];\r\n              const showComments = showRubricComments[criterion.id];\r\n\r\n              return (\r\n                <div key={criterion.id} style={{\r\n                  background: 'white',\r\n                  border: '1px solid #d1d5db',\r\n                  borderRadius: '0.5rem',\r\n                  padding: '1.25rem',\r\n                  boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)'\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n                    <div style={{ flex: 1 }}>\r\n                      <h4 style={{ fontSize: '1.125rem', fontWeight: '600', color: '#374151' }}>\r\n                        {criterion.name}\r\n                        <span style={{ color: '#3b82f6', marginLeft: '0.5rem' }}>\r\n                          ({criterion.maxPoints} pts)\r\n                        </span>\r\n                      </h4>\r\n                      <p style={{ fontSize: '0.875rem', color: '#6b7280', marginTop: '0.25rem' }}>\r\n                        {renderFormattedContent(criterion.description)}\r\n                      </p>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => toggleRubricComments(criterion.id)}\r\n                      style={{\r\n                        color: '#3b82f6',\r\n                        background: 'none',\r\n                        border: 'none',\r\n                        fontSize: '0.875rem',\r\n                        textDecoration: 'underline',\r\n                        cursor: 'pointer',\r\n                        marginLeft: '1rem'\r\n                      }}\r\n                    >\r\n                      {showComments ? 'Hide' : 'Show'} Level Details\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Level Selection */}\r\n                  <div style={{\r\n                    display: 'grid',\r\n                    gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\r\n                    gap: '0.5rem',\r\n                    marginBottom: '1rem'\r\n                  }}>\r\n                    {loadedRubric.rubricLevels.map((level) => {\r\n                      const isSelected = currentGrading?.selectedLevel === level.level;\r\n                      const points = Math.round(criterion.maxPoints * level.multiplier);\r\n\r\n                      return (\r\n                        <button\r\n                          key={level.level}\r\n                          onClick={() => updateRubricGrading(criterion.id, level.level)}\r\n                          style={{\r\n                            padding: '0.75rem',\r\n                            borderRadius: '0.5rem',\r\n                            border: `2px solid ${isSelected ? level.color : '#d1d5db'}`,\r\n                            fontSize: '0.875rem',\r\n                            fontWeight: '500',\r\n                            cursor: 'pointer',\r\n                            transition: 'all 0.2s ease',\r\n                            backgroundColor: isSelected ? level.color : 'white',\r\n                            color: isSelected ? 'white' : '#374151',\r\n                            transform: isSelected ? 'scale(1.05)' : 'none',\r\n                            textAlign: 'center'\r\n                          }}\r\n                        >\r\n                          <div style={{ fontWeight: '600' }}>{level.name}</div>\r\n                          <div style={{ fontSize: '0.75rem', marginTop: '0.25rem' }}>\r\n                            {level.level === 'incomplete' ? '0' : points} pts\r\n                          </div>\r\n                        </button>\r\n                      );\r\n                    })}\r\n                  </div>\r\n\r\n                  {/* Level Descriptions */}\r\n                  {showComments && (\r\n                    <div style={{\r\n                      background: '#f9fafb',\r\n                      borderRadius: '0.5rem',\r\n                      padding: '1rem',\r\n                      marginBottom: '1rem'\r\n                    }}>\r\n                      <h5 style={{ fontWeight: '600', color: '#374151', marginBottom: '0.75rem' }}>\r\n                        Level Descriptions:\r\n                      </h5>\r\n                      <div style={{\r\n                        display: 'grid',\r\n                        gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\r\n                        gap: '0.75rem'\r\n                      }}>\r\n                        {loadedRubric.rubricLevels.map((level) => (\r\n                          <div\r\n                            key={level.level}\r\n                            style={{\r\n                              background: 'white',\r\n                              borderRadius: '0.25rem',\r\n                              border: '1px solid #d1d5db',\r\n                              borderLeft: `4px solid ${level.color}`,\r\n                              padding: '0.75rem'\r\n                            }}\r\n                          >\r\n                            <div style={{ fontWeight: '500', fontSize: '0.875rem', color: level.color }}>\r\n                              {level.name}\r\n                            </div>\r\n                            <div style={{ fontSize: '0.75rem', color: '#6b7280', marginBottom: '0.5rem' }}>\r\n                              {criterion.levels[level.level]?.pointRange} pts\r\n                            </div>\r\n                            <div style={{ fontSize: '0.75rem', color: '#374151' }}>\r\n                              {renderFormattedContent(criterion.levels[level.level]?.description)}\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Custom Comments */}\r\n                  <div>\r\n                    <label style={{\r\n                      display: 'block',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500',\r\n                      color: '#374151',\r\n                      marginBottom: '0.5rem'\r\n                    }}>\r\n                      Additional Comments:\r\n                    </label>\r\n\r\n                    {/* Quick Feedback Dropdowns */}\r\n                    {criterion.feedbackLibrary && (\r\n                      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.75rem', flexWrap: 'wrap' }}>\r\n                        {Object.entries(criterion.feedbackLibrary).map(([category, comments]) => (\r\n                          <select\r\n                            key={category}\r\n                            onChange={(e) => {\r\n                              if (e.target.value) {\r\n                                addCriterionFeedback(criterion.id, e.target.value);\r\n                                e.target.value = '';\r\n                              }\r\n                            }}\r\n                            defaultValue=\"\"\r\n                            style={{\r\n                              padding: '0.5rem',\r\n                              border: '1px solid #d1d5db',\r\n                              borderRadius: '0.25rem',\r\n                              fontSize: '0.75rem',\r\n                              cursor: 'pointer'\r\n                            }}\r\n                          >\r\n                            <option value=\"\">Add {category}...</option>\r\n                            {comments.map((comment, idx) => (\r\n                              <option key={idx} value={comment}>{renderFormattedContent(comment)}</option>\r\n                            ))}\r\n                          </select>\r\n                        ))}\r\n                      </div>\r\n                    )}\r\n\r\n                    <textarea\r\n                      value={currentGrading?.customComments || ''}\r\n                      onChange={(e) => updateRubricGrading(criterion.id, currentGrading?.selectedLevel, e.target.value)}\r\n                      style={{\r\n                        width: '100%',\r\n                        padding: '0.75rem',\r\n                        border: '1px solid #d1d5db',\r\n                        borderRadius: '0.5rem',\r\n                        fontSize: '0.875rem',\r\n                        resize: 'none',\r\n                        minHeight: '80px'\r\n                      }}\r\n                      rows=\"3\"\r\n                      placeholder=\"Add specific feedback for this criterion...\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Selected Level Feedback */}\r\n                  {currentGrading?.selectedLevel && (\r\n                    <div style={{\r\n                      marginTop: '0.75rem',\r\n                      padding: '0.75rem',\r\n                      background: '#eff6ff',\r\n                      borderRadius: '0.25rem',\r\n                      border: '1px solid #bfdbfe'\r\n                    }}>\r\n                      <div style={{ fontSize: '0.875rem' }}>\r\n                        <strong>Selected Level:</strong> {loadedRubric.rubricLevels.find(l => l.level === currentGrading.selectedLevel)?.name}\r\n                        {' '}({criterion.levels[currentGrading.selectedLevel]?.pointRange} pts)\r\n                      </div>\r\n                      <div style={{ fontSize: '0.875rem', color: '#374151', marginTop: '0.25rem' }}>\r\n                        {renderFormattedContent(criterion.levels[currentGrading.selectedLevel]?.description)}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n\r\n      {/* ENHANCED: Complete and Grade Next Section - PLACED AFTER RUBRIC ITEMS */}\r\n      {loadedRubric && currentStudentInfo && (\r\n        <div style={{\r\n          background: 'linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)',\r\n          border: '2px solid #10b981',\r\n          borderRadius: '0.75rem',\r\n          padding: '1.5rem',\r\n          marginTop: '2rem',\r\n          textAlign: 'center'\r\n        }}>\r\n          <h3 style={{ fontSize: '1.25rem', fontWeight: '600', color: '#047857', marginBottom: '1rem' }}>\r\n            Ready to move to the next student?\r\n          </h3>\r\n          <p style={{ color: '#065f46', marginBottom: '1.5rem', fontSize: '0.875rem' }}>\r\n            Choose how to save the current grading before proceeding.\r\n          </p>\r\n\r\n          <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center', flexWrap: 'wrap' }}>\r\n            {/* Save as Draft & Grade Next Button */}\r\n            <button\r\n              onClick={handleNextStudentAsDraft}\r\n              style={{\r\n                display: 'inline-flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                background: 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)',\r\n                color: 'white',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '0.5rem',\r\n                border: 'none',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '600',\r\n                boxShadow: '0 2px 8px rgba(251, 191, 36, 0.4)',\r\n                transition: 'all 0.2s ease'\r\n              }}\r\n              onMouseOver={(e) => {\r\n                e.target.style.transform = 'translateY(-2px)';\r\n                e.target.style.boxShadow = '0 4px 12px rgba(251, 191, 36, 0.5)';\r\n              }}\r\n              onMouseOut={(e) => {\r\n                e.target.style.transform = 'translateY(0)';\r\n                e.target.style.boxShadow = '0 2px 8px rgba(251, 191, 36, 0.4)';\r\n              }}\r\n            >\r\n              <span style={{ fontSize: '1.1rem' }}>📝</span>\r\n              Save & Grade Next Student\r\n            </button>\r\n\r\n            {/* Finalize & Grade Next Button */}\r\n            <button\r\n              onClick={handleNextStudentAsFinal}\r\n              style={{\r\n                display: 'inline-flex',\r\n                alignItems: 'center',\r\n                gap: '0.5rem',\r\n                background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\r\n                color: 'white',\r\n                padding: '0.75rem 1.5rem',\r\n                borderRadius: '0.5rem',\r\n                border: 'none',\r\n                cursor: 'pointer',\r\n                fontSize: '0.875rem',\r\n                fontWeight: '600',\r\n                boxShadow: '0 2px 8px rgba(16, 185, 129, 0.4)',\r\n                transition: 'all 0.2s ease'\r\n              }}\r\n              onMouseOver={(e) => {\r\n                e.target.style.transform = 'translateY(-2px)';\r\n                e.target.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.5)';\r\n              }}\r\n              onMouseOut={(e) => {\r\n                e.target.style.transform = 'translateY(0)';\r\n                e.target.style.boxShadow = '0 2px 8px rgba(16, 185, 129, 0.4)';\r\n              }}\r\n            >\r\n              <span style={{ fontSize: '1.1rem' }}>✅</span>\r\n              Finalize & Grade Next Student\r\n            </button>\r\n          </div>\r\n\r\n          <div style={{\r\n            marginTop: '1rem',\r\n            padding: '0.75rem',\r\n            background: 'rgba(255, 255, 255, 0.6)',\r\n            borderRadius: '0.375rem',\r\n            fontSize: '0.75rem',\r\n            color: '#065f46'\r\n          }}>\r\n            <strong>Draft:</strong> Save progress, can edit later • <strong>Finalize:</strong> Complete grading, ready for student/LMS\r\n          </div>\r\n\r\n          {currentStudentInfo.isLast && (\r\n            <div style={{\r\n              marginTop: '1rem',\r\n              padding: '0.75rem',\r\n              background: '#fef3c7',\r\n              borderRadius: '0.375rem',\r\n              fontSize: '0.875rem',\r\n              color: '#92400e',\r\n              fontWeight: '500'\r\n            }}>\r\n              🎉 This is the last student in your grading session!\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* ... (keep all existing file attachments, export buttons, etc.) */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GradingTemplate;"],"mappings":"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A,8BAA8B1B,WAAW,CAACiC,OAAO,CAACzD,IAAI;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyCwB,WAAW,CAACiC,OAAO,CAACzD,IAAI,KAAKwB,WAAW,CAACiC,OAAO,CAACrD,EAAE;AAC5F,wCAAwCoB,WAAW,CAACmC,MAAM,CAACC,IAAI,MAAMpC,WAAW,CAACmC,MAAM,CAAC3D,IAAI;AAC5F,4CAA4CwB,WAAW,CAACuC,UAAU,CAAC/D,IAAI;AACvE,4CAA4CwB,WAAW,CAACmC,MAAM,CAACE,UAAU;AACzE,sCAAsCrC,WAAW,CAACmC,MAAM,CAACG,IAAI;AAC7D;AACA;AACA;AACA;AACA;AACA,gBAAgBkI,UAAU,CAACE,OAAO,CAAC,CAAC,CAAC,MAAM7L,SAAS,KAAK4L,UAAU;AACnE;AACA;AACA,gBAAgBrH,YAAY,GAAG,WAAWA,YAAY,CAACpF,cAAc,CAACC,KAAK,EAAE,GAAG,EAAE;AAClF,gBAAgB4E,cAAc,GAAG,mBAAmByB,gBAAgB,CAACtE,WAAW,CAAC4C,UAAU,CAACrE,KAAK,CAAC,CAACC,IAAI,EAAE,GAAG,EAAE;AAC9G;AACA;AACA;AACA,QAA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,GAAI,iCAAiC,GAAG,EAAE;AACzH;AACA;AACA,yBAAyB;IACrB,CAAC,CAAC,CAACL,IAAI,CAAC,EAAE,CAAC;AACf;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD5C,IAAI,CAACkD,KAAK,CAACX,UAAU,GAAG,EAAE,CAAC,GAAG,EAAE,MAAM3L,SAAS;AACvG;AACA;AACA,uDAAuD4L,UAAU;AACjE;AACA;AACA;AACA,uCAAuCA,UAAU,IAAIrH,YAAY,CAACpF,cAAc,CAACI,gBAAgB,GAAG,SAAS,GAAG,mBAAmB;AACnI,8BAA8BqM,UAAU,IAAIrH,YAAY,CAACpF,cAAc,CAACI,gBAAgB,GAAG,WAAW,GAAG,qBAAqB;AAC9H;AACA;AACA,sBAAsByE,cAAc,GAAG;AACvC;AACA,gFAAgFoF,IAAI,CAACkD,KAAK,CAAC3F,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE;AAC9G;AACA,qBAAqB,GAAG,EAAE;AAC1B;AACA;AACA;AACA,SAAS,GAAG,EAAE;IAEV,MAAMsH,UAAU,GAAG;AACvB;AACA;AACA;AACA;AACA;AACA,gCAAgC9M,WAAW,CAACiC,OAAO,CAACzD,IAAI;AACxD;AACA;AACA;AACA;AACA;AACA,+CAA+CwB,WAAW,CAACiC,OAAO,CAACzD,IAAI;AACvE;AACA;AACA;AACA;AACA,4FAA4FiO,WAAW;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuDzM,WAAW,CAACiC,OAAO,CAACzD,IAAI;AAC/E,0DAA0DwB,WAAW,CAACiC,OAAO,CAACrD,EAAE;AAChF,qDAAqDoB,WAAW,CAACiC,OAAO,CAACC,KAAK;AAC9E;AACA;AACA,sDAAsDlC,WAAW,CAACmC,MAAM,CAACC,IAAI,MAAMpC,WAAW,CAACmC,MAAM,CAAC3D,IAAI;AAC1G,0DAA0DwB,WAAW,CAACmC,MAAM,CAACE,UAAU;AACvF,oDAAoDrC,WAAW,CAACmC,MAAM,CAACG,IAAI;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsBkI,UAAU,CAACE,OAAO,CAAC,CAAC,CAAC,MAAM7L,SAAS;AAC1D;AACA;AACA,sBAAsB4L,UAAU;AAChC;AACA;AACA,sBAAsBrH,YAAY,GAAG,eAAeA,YAAY,CAACpF,cAAc,CAACC,KAAK,EAAE,GAAG,EAAE;AAC5F,sBAAsB4E,cAAc,GAAG,mBAAmByB,gBAAgB,CAACtE,WAAW,CAAC4C,UAAU,CAACrE,KAAK,CAAC,CAACC,IAAI,EAAE,GAAG,EAAE;AACpH;AACA;AACA;AACA;AACA,UAAUqE,cAAc,GAAG;AAC3B;AACA;AACA,iDAAiDyB,gBAAgB,CAACtE,WAAW,CAAC4C,UAAU,CAACrE,KAAK,CAAC,CAACC,IAAI;AACpG,iBAAiB8F,gBAAgB,CAACtE,WAAW,CAAC4C,UAAU,CAACrE,KAAK,CAAC,CAACL,WAAW;AAC3E,yDAAyD+J,IAAI,CAACkD,KAAK,CAAC3F,QAAQ,GA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}