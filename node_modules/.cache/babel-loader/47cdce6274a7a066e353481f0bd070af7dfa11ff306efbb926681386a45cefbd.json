{"ast":null,"code":"var _jsxFileName = \"C:\\\\local clones\\\\rubric-creation-app\\\\src\\\\components\\\\ClassListManager.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect } from 'react';\nimport { Upload, Users, BookOpen, GraduationCap, Play, Download, CheckCircle, Clock, AlertCircle, Unlock, FileText, ExternalLink, FileSpreadsheet, Settings // Add this for policy management\n} from 'lucide-react';\nimport { useAssessment } from './SharedContext';\nimport { parseExcelFile, validateStudentData } from '../utils/excelParser';\n\n// Add new imports for grading policy management\nimport gradingPolicyService from '../services/gradingPolicyService';\nimport { useGradingPolicies, useGradingPolicyForProgram, useGradeCalculation, useGradingPolicyManager } from '../hooks/useGradingPolicies';\n\n/**\r\n * Enhanced getLetterGrade function with dynamic policy support\r\n * Falls back to original hardcoded scales if policy service fails\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst getLetterGrade = async (percentage, programType, customProgramId = null, selectedPolicy = null) => {\n  // Try dynamic policy calculation first\n  try {\n    const result = await gradingPolicyService.calculateGrade(percentage, selectedPolicy === null || selectedPolicy === void 0 ? void 0 : selectedPolicy.id, programType, customProgramId);\n    if (result.success) {\n      return result.data.letter;\n    }\n  } catch (error) {\n    console.warn('Dynamic grading failed, using legacy fallback:', error);\n  }\n\n  // Legacy fallback - your original hardcoded scales (preserved exactly)\n  const scales = {\n    degree: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }],\n    diploma: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }],\n    certificate: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }],\n    graduateCertificate: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }]\n  };\n\n  // Pick the right scale (default to degree if missing)\n  const scale = scales[programType] || scales.degree;\n\n  // Find the first entry where percentage ‚â• min\n  const entry = scale.find(e => percentage >= e.min);\n  return entry ? entry.grade : 'N/A';\n};\nconst ClassListManager = () => {\n  _s();\n  var _classList$courseMeta2, _classList$courseMeta17, _classList$courseMeta18, _classList$courseMeta19, _classList$courseMeta20, _classList$validation;\n  const fileInputRef = useRef(null);\n  const [importStatus, setImportStatus] = useState('');\n\n  // Add new grading policy state management using TanStack Query hooks\n  const {\n    data: availablePolicies = [],\n    isLoading: policiesLoading\n  } = useGradingPolicies({\n    isActive: true\n  });\n  const [currentProgramType, setCurrentProgramType] = useState('degree');\n  const {\n    data: selectedPolicy\n  } = useGradingPolicyForProgram(currentProgramType);\n  const gradeCalculation = useGradeCalculation();\n  const {\n    prefetchPolicyForProgram\n  } = useGradingPolicyManager();\n\n  /*\r\n   * FIXES COMPLETED IN THIS UPDATE:\r\n   * ===============================\r\n   * ‚úÖ Excel import functionality (instead of CSV)\r\n   * ‚úÖ Start batch grading session with pause/resume functionality\r\n   * ‚úÖ Enhanced status indicators with proper draft/final states\r\n   * ‚úÖ Export entire class grades as CSV, HTML, and PDF with Final Grade column\r\n   * ‚úÖ Action buttons properly handle Edit/View, Finalize, Export Grade, Unlock\r\n   * ‚úÖ Grade calculation function added for exports\r\n   * ‚úÖ CSV and HTML exports now include calculated final grades and percentages\r\n   * ‚úÖ Dynamic grading policy integration with fallback to legacy scales\r\n   *\r\n   * PENDING FIX (requires GradingTemplate update):\r\n   * ==============================================\r\n   * ‚ùå View action still opens empty grade sheet for saved grades\r\n   *\r\n   * SOLUTION: Add the useEffect from gradingtemplate_fix artifact to GradingTemplate.js\r\n   * and add loadFinalGrade + finalGrades to SharedContext value object.\r\n   *\r\n   * Once implemented, the View action will properly load saved rubric selections,\r\n   * feedback, attachments, video links, and late policy for both draft and final grades.\r\n   */\n\n  const {\n    classList,\n    setClassList,\n    gradingSession,\n    setGradingSession,\n    initializeGradingSession,\n    setActiveTab,\n    setCurrentStudent,\n    hasDraft,\n    getGradeStatus,\n    saveFinalGrade,\n    loadDraft,\n    saveDraft,\n    drafts,\n    sharedRubric,\n    updateStudentInfo,\n    updateAssignmentInfo,\n    loadFinalGrade,\n    // This should be available after SharedContext fix\n    finalGrades,\n    // This should be available after SharedContext fix\n    rubricFormData\n  } = useAssessment();\n\n  // Load current program type from class metadata and update policy\n  useEffect(() => {\n    var _classList$courseMeta;\n    if (classList !== null && classList !== void 0 && (_classList$courseMeta = classList.courseMetadata) !== null && _classList$courseMeta !== void 0 && _classList$courseMeta.programType) {\n      setCurrentProgramType(classList.courseMetadata.programType);\n    }\n  }, [classList === null || classList === void 0 ? void 0 : (_classList$courseMeta2 = classList.courseMetadata) === null || _classList$courseMeta2 === void 0 ? void 0 : _classList$courseMeta2.programType]);\n\n  // Prefetch policies for better UX\n  useEffect(() => {\n    const programTypes = ['degree', 'diploma', 'certificate', 'graduateCertificate', 'apprenticeship', 'healthScience', 'gasTechnician'];\n    programTypes.forEach(type => {\n      if (type !== currentProgramType) {\n        prefetchPolicyForProgram(type);\n      }\n    });\n  }, [currentProgramType, prefetchPolicyForProgram]);\n\n  // Enhanced handler to change the program type for grading with policy loading\n  const handleProgramTypeChange = e => {\n    const newType = e.target.value;\n    setCurrentProgramType(newType);\n    setClassList(prev => ({\n      ...prev,\n      courseMetadata: {\n        ...prev.courseMetadata,\n        programType: newType\n      }\n    }));\n  };\n\n  // Helper function for status display (preserved exactly from original)\n  const getStatusDisplay = (progress, studentId) => {\n    const gradeStatus = getGradeStatus(studentId);\n    if (gradeStatus === 'final') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n          className: \"w-4 h-4 text-green-600\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium\",\n          children: \"Final\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }, this);\n    } else if (gradeStatus === 'draft') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(Clock, {\n          className: \"w-4 h-4 text-yellow-600\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-medium\",\n          children: \"Draft\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this);\n    } else if ((progress === null || progress === void 0 ? void 0 : progress.status) === 'in-progress') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-medium\",\n          children: \"In Progress\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-4 h-4 bg-gray-300 rounded-full\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full\",\n          children: \"Not Started\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  // Helper function to finalize a draft grade (preserved exactly from original)\n  const finalizeGrade = studentId => {\n    const draftData = drafts[studentId];\n    if (draftData) {\n      saveFinalGrade(studentId, draftData);\n\n      // Update class list progress\n      const studentIndex = classList.students.findIndex(s => s.id === studentId);\n      if (studentIndex >= 0) {\n        const updatedProgress = [...classList.gradingProgress];\n        updatedProgress[studentIndex] = {\n          ...updatedProgress[studentIndex],\n          status: 'completed_final',\n          lastModified: new Date().toISOString(),\n          gradeType: 'final'\n        };\n        setClassList(prev => ({\n          ...prev,\n          gradingProgress: updatedProgress\n        }));\n      }\n    }\n  };\n\n  // Helper function to unlock a final grade (preserved exactly from original)\n  const unlockGrade = studentId => {\n    // For now, we'll implement this by updating the class list progress\n    // The actual unlocking logic should be implemented in SharedContext\n    const studentIndex = classList.students.findIndex(s => s.id === studentId);\n    if (studentIndex >= 0) {\n      const updatedProgress = [...classList.gradingProgress];\n      updatedProgress[studentIndex] = {\n        ...updatedProgress[studentIndex],\n        status: 'completed_draft',\n        lastModified: new Date().toISOString(),\n        gradeType: 'draft'\n      };\n      setClassList(prev => ({\n        ...prev,\n        gradingProgress: updatedProgress\n      }));\n    }\n\n    // Note: Full unlock functionality requires additional implementation in SharedContext\n    console.log('Unlock grade for student:', studentId);\n  };\n\n  // Helper function to load final grade data (preserved exactly from original)\n  const loadFinalGradeData = studentId => {\n    // Use loadFinalGrade if available, otherwise fallback to checking finalGrades directly\n    if (typeof loadFinalGrade === 'function') {\n      return loadFinalGrade(studentId);\n    }\n    // Fallback: check finalGrades directly if available\n    if (finalGrades && finalGrades[studentId]) {\n      // FIX: Corrected 'finalGrdes' to 'finalGrades'\n      return finalGrades[studentId];\n    }\n    // Last resort: check drafts (this maintains current behavior)\n    return drafts[studentId] || null;\n  };\n\n  // **ENHANCED**: This function now uses dynamic grading with fallback to legacy calculation\n  const calculateStudentGrade = async studentId => {\n    var _classList$courseMeta3, _classList$courseMeta4;\n    const gradeStatus = getGradeStatus(studentId);\n    let gradeData = null;\n    if (gradeStatus === 'final') {\n      gradeData = loadFinalGradeData(studentId);\n    } else if (gradeStatus === 'draft') {\n      gradeData = loadDraft(studentId);\n    }\n\n    // The grade calculation relies on having the student's saved grade data AND the rubric structure.\n    // If any part is missing, we can't calculate the grade.\n    if (!gradeData || !gradeData.rubricGrading || !sharedRubric || !sharedRubric.criteria || !sharedRubric.rubricLevels) {\n      return {\n        score: 'N/A',\n        maxPossible: 'N/A',\n        percentage: 'N/A',\n        letterGrade: 'N/A'\n      };\n    }\n    let totalScore = 0;\n    let maxPossible = 0;\n\n    // Correctly calculate score based on criterion points and level multipliers\n    sharedRubric.criteria.forEach(criterion => {\n      const gradingSelection = gradeData.rubricGrading[criterion.id];\n      const criterionMaxPoints = Number(criterion.maxPoints) || 0;\n      maxPossible += criterionMaxPoints;\n      if (gradingSelection && gradingSelection.selectedLevel) {\n        const levelData = sharedRubric.rubricLevels.find(l => l.level === gradingSelection.selectedLevel);\n        if (levelData) {\n          const levelMultiplier = Number(levelData.multiplier) || 0;\n          totalScore += criterionMaxPoints * levelMultiplier;\n        }\n      }\n    });\n\n    // Apply late penalty if applicable\n    if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\n      const latePenalties = {\n        within24: 0.8,\n        after24: 0.0\n      };\n      const multiplier = latePenalties[gradeData.latePolicy.level] || 1.0;\n      totalScore *= multiplier;\n    }\n    const numericScore = Math.round(totalScore * 10) / 10;\n    const maxScore = Math.round(maxPossible * 10) / 10;\n    const percentage = maxScore > 0 ? Math.round(numericScore / maxScore * 100) : 0;\n\n    // Use enhanced getLetterGrade with dynamic policy support\n    const letterGrade = await getLetterGrade(percentage, ((_classList$courseMeta3 = classList.courseMetadata) === null || _classList$courseMeta3 === void 0 ? void 0 : _classList$courseMeta3.programType) || 'degree', (_classList$courseMeta4 = classList.courseMetadata) === null || _classList$courseMeta4 === void 0 ? void 0 : _classList$courseMeta4.customProgramId, selectedPolicy);\n    return {\n      score: numericScore,\n      maxPossible: maxScore,\n      percentage,\n      letterGrade\n    };\n  };\n\n  // Helper function to load student for grading (preserved exactly from original)\n  const loadStudentForGrading = student => {\n    const gradeStatus = getGradeStatus(student.id);\n\n    // Set the current student first\n    setCurrentStudent(student);\n\n    // Load the student info into the grading form\n    updateStudentInfo({\n      name: student.name,\n      id: student.id,\n      email: student.email\n    });\n\n    // Load rubric assignment info if available\n    if (sharedRubric) {\n      var _sharedRubric$assignm, _sharedRubric$assignm2;\n      updateAssignmentInfo({\n        name: ((_sharedRubric$assignm = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm === void 0 ? void 0 : _sharedRubric$assignm.title) || '',\n        maxPoints: ((_sharedRubric$assignm2 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm2 === void 0 ? void 0 : _sharedRubric$assignm2.totalPoints) || 100\n      });\n    }\n\n    // Provide user feedback and load appropriate data\n    if (gradeStatus === 'final') {\n      const finalData = loadFinalGradeData(student.id);\n      console.log(`Loading final grade for ${student.name}:`, finalData ? 'Found' : 'Not found');\n    } else if (gradeStatus === 'draft') {\n      const draftData = loadDraft(student.id);\n      console.log(`Loading draft for ${student.name}:`, draftData ? 'Found' : 'Not found');\n    } else {\n      console.log(`Starting new grade for ${student.name}`);\n    }\n\n    // Switch to grading tool - the GradingTemplate useEffect will handle loading the data\n    setActiveTab('grading-tool');\n\n    // Note: The actual data loading happens in GradingTemplate's useEffect for currentStudent\n  };\n\n  // Helper function to get grading progress statistics (preserved exactly from original)\n  const getGradingProgress = () => {\n    if (!classList) return {\n      completed: 0,\n      total: 0,\n      percentage: 0,\n      final: 0,\n      draft: 0\n    };\n    const final = classList.gradingProgress.filter(p => {\n      var _p$status;\n      return (_p$status = p.status) === null || _p$status === void 0 ? void 0 : _p$status.startsWith('completed_final');\n    }).length;\n    const draft = classList.gradingProgress.filter(p => {\n      var _p$status2;\n      return (_p$status2 = p.status) === null || _p$status2 === void 0 ? void 0 : _p$status2.startsWith('completed_draft');\n    }).length;\n    const completed = final + draft;\n    const total = classList.students.length;\n    const percentage = total > 0 ? Math.round(completed / total * 100) : 0;\n    return {\n      completed,\n      total,\n      percentage,\n      final,\n      draft\n    };\n  };\n\n  // ‚îÄ‚îÄ Build a portrait-friendly Class Grade Report ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\n  const getPortraitClassReportHTML = () => {\n    var _sharedRubric$assignm3, _classList$courseMeta5, _classList$courseMeta6, _classList$courseMeta7;\n    const now = new Date();\n    const currentDate = now.toLocaleDateString('en-CA'); // YYYY-MM-DD\n    const currentTime = now.toLocaleTimeString('en-CA');\n    // Grab the rubric title from context\n    const rubricName = (sharedRubric === null || sharedRubric === void 0 ? void 0 : (_sharedRubric$assignm3 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm3 === void 0 ? void 0 : _sharedRubric$assignm3.title) || 'Unnamed Rubric';\n    // Calculate grades\n    const rowsHtml = classList.students.map((student, idx) => {\n      const info = calculateStudentGrade(student.id);\n      const num = info.score !== 'N/A' ? `${info.score}/${info.maxPossible}` : 'N/A';\n      return `\n      <tr>\n        <td>${idx + 1}</td>\n        <td>${student.id}</td>\n        <td>${student.name}</td>\n        <td>${num}</td>\n        <td>${info.letterGrade || 'N/A'}</td>\n        <td>${info.percentage !== 'N/A' ? info.percentage + '%' : 'N/A'}</td>\n      </tr>`;\n    }).join('');\n    return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Portrait Class Report</title>\n  <style>\n  /* Force portrait layout with small margins */\n  @page {\n    size: A4 portrait;\n    margin: 15mm;\n  }\n\n  /* Global resets */\n  *, *::before, *::after {\n    box-sizing: border-box;\n  }\n  body {\n    margin: 0;\n    padding: 0;\n    font-family: sans-serif;\n    font-size: 12px;\n    line-height: 1.4;\n    color: #333;\n    background: white;\n  }\n\n  /* Header */\n  .header {\n    text-align: center;\n    margin-bottom: 8px;\n  }\n  .header h1 {\n    font-size: 18px;\n    margin: 4px 0;\n  }\n  .header .meta {\n    font-size: 14px;\n    color: #555;\n  }\n\n  /* Container to allow horizontal scroll if needed */\n  .table-container {\n    width: 100%;\n    overflow-x: auto;\n  }\n\n  /* Main table */\n  table {\n    width: 100%;\n    border-collapse: collapse;\n    table-layout: fixed;             /* evenly distribute column widths */\n  }\n  thead {\n    display: table-header-group;     /* repeat header on each printed page */\n  }\n  tbody {\n    display: table-row-group;\n  }\n  th, td {\n  padding: 8px 12px;\n  text-align: left;\n  border-bottom: 1px solid #e5e7eb;\n\n  /* allow wrapping anywhere, even inside long words like emails */\n  white-space: normal;\n  word-wrap: break-word;        /* for legacy support */\n  overflow-wrap: anywhere;      /* modern browsers */\n  word-break: break-all;        /* if you really need to force breaks */\n  vertical-align: top;\n}\n\n  \n  tr:nth-child(even) td {\n    background-color: #fafafa;\n  }\n\n  /* Footer */\n  .footer {\n    margin-top: 12px;\n    font-size: 10px;\n    text-align: center;\n    color: #666;\n  }\n\n  /* Print tweaks */\n  @media print {\n    body {\n      background: white;\n    }\n    .table-container {\n      overflow-x: visible;\n    }\n  }\n</style>\n\n</head>\n<body>\n  <div class=\"header\">\n    <h1>Class Grade Report</h1>\n    <div class=\"meta\">\n      ${((_classList$courseMeta5 = classList.courseMetadata) === null || _classList$courseMeta5 === void 0 ? void 0 : _classList$courseMeta5.courseCode) || ''} ‚Äì\n      ${((_classList$courseMeta6 = classList.courseMetadata) === null || _classList$courseMeta6 === void 0 ? void 0 : _classList$courseMeta6.courseName) || ''} |\n      Section: ${((_classList$courseMeta7 = classList.courseMetadata) === null || _classList$courseMeta7 === void 0 ? void 0 : _classList$courseMeta7.section) || ''}<br>\n      Rubric: ${rubricName}\n      Generated: ${currentDate} ${currentTime}\n    </div>\n  </div>\n\n  <table>\n    <thead>\n      <tr>\n        <th style=\"width:4%\">#</th>\n        <th style=\"width:15%\">Student ID</th>\n        <th style=\"width:40%\">Name</th>\n        <th style=\"width:15%\">Numeric Grade</th>\n        <th style=\"width:12%\">Letter Grade</th>\n        <th style=\"width:14%\">%</th>\n      </tr>\n    </thead>\n    <tbody>\n      ${rowsHtml}\n    </tbody>\n  </table>\n\n  <div class=\"footer\">\n    Imported from: ${classList.fileName}\n  </div>\n</body>\n</html>`;\n  };\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n  // ‚îÄ‚îÄ Generate the full HTML for class‚Äêgrades report ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\n  const getClassGradesHTML = () => {\n    var _classList$courseMeta8, _classList$courseMeta9, _classList$courseMeta0, _classList$courseMeta1, _sharedRubric$assignm4;\n    const progress = getGradingProgress();\n    const currentDate = new Date().toLocaleDateString('en-US', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n    const currentTime = new Date().toLocaleTimeString();\n\n    // ‚Äî‚Äî‚Äî Build all the <tr> rows with single‚Äêquoted strings ‚Äî no back‚Äêticks inside!  \n    const rowsHtml = classList.students.map((student, i) => {\n      var _prog$status, _prog$status2;\n      const prog = classList.gradingProgress[i] || {};\n      const info = calculateStudentGrade(student.id);\n      const lm = prog.lastModified ? new Date(prog.lastModified).toLocaleDateString() : 'Never';\n      const statusClass = (_prog$status = prog.status) !== null && _prog$status !== void 0 && _prog$status.includes('final') ? 'status-final' : (_prog$status2 = prog.status) !== null && _prog$status2 !== void 0 && _prog$status2.includes('draft') ? 'status-draft' : 'status-pending';\n      return '<tr>' + '<td>' + (i + 1) + '</td>' + '<td>' + student.id + '</td>' + '<td>' + student.name + '</td>' + '<td>' + student.email + '</td>' + '<td>' + (student.program || '') + '</td>' + '<td><span class=\"status-badge ' + statusClass + '\">' + (prog.status || 'pending') + '</span></td>' + '<td>' + (prog.gradeType || 'none') + '</td>' + '<td>' + (info.score !== 'N/A' ? info.score + '/' + info.maxPossible : 'N/A') + '</td>' + '<td>' + (info.letterGrade || 'N/A') + '</td>' + '<td>' + (info.percentage !== 'N/A' ? info.percentage + '%' : 'N/A') + '</td>' + '<td>' + lm + '</td>' + '</tr>';\n    }).join('');\n\n    // ‚Äî‚Äî‚Äî Now splice rowsHtml into one clean back‚Äêtick literal\n    return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Class Grade Report - ${((_classList$courseMeta8 = classList.courseMetadata) === null || _classList$courseMeta8 === void 0 ? void 0 : _classList$courseMeta8.courseCode) || ''}</title>\n  <style>\n    @page { size: A4 portrait; margin:15mm; }\n    *, *::before, *::after { box-sizing:border-box }\n    body { margin:0; padding:0; font-family:sans-serif; font-size:12px; line-height:1.4; color:#333; }\n    .header { text-align:center; margin-bottom:12px; }\n    .header h1 { font-size:18px; margin:4px 0; }\n    .header .meta { font-size:14px; color:#555; }\n    .table-container { width:100%; overflow-x:auto; margin-bottom:12px; }\n    table { width:100%; border-collapse:collapse; table-layout:fixed; }\n    thead { display:table-header-group; }\n    th, td {\n      padding:8px 12px; text-align:left; border-bottom:1px solid #e5e7eb;\n      white-space:normal; word-wrap:break-word; overflow-wrap:anywhere; word-break:break-all;\n      vertical-align:top;\n    }\n    th { background:#f0f0f0; font-weight:600; position:sticky; top:0; }\n    tr:nth-child(even) td { background:#fafafa; }\n    .footer { font-size:10px; text-align:center; color:#666; margin-top:12px; }\n    @media print { body{background:white} .table-container{overflow-x:visible} }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <h1>üìä Class Grade Report</h1>\n    <div class=\"meta\">\n      ${((_classList$courseMeta9 = classList.courseMetadata) === null || _classList$courseMeta9 === void 0 ? void 0 : _classList$courseMeta9.courseCode) || ''} ‚Äì ${((_classList$courseMeta0 = classList.courseMetadata) === null || _classList$courseMeta0 === void 0 ? void 0 : _classList$courseMeta0.courseName) || ''} |\n      Section: ${((_classList$courseMeta1 = classList.courseMetadata) === null || _classList$courseMeta1 === void 0 ? void 0 : _classList$courseMeta1.section) || ''}<br>\n      Rubric: ${(sharedRubric === null || sharedRubric === void 0 ? void 0 : (_sharedRubric$assignm4 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm4 === void 0 ? void 0 : _sharedRubric$assignm4.title) || 'Unnamed Rubric'}<br>\n      Generated: ${currentDate} | ${currentTime}\n    </div>\n  </div>\n\n  <div class=\"table-container\">\n    <table>\n      <thead>\n        <tr>\n          <th>#</th><th>Student ID</th><th>Name</th><th>Email</th>\n          <th>Program</th><th>Status</th><th>Grade Type</th>\n          <th>Final Grade</th><th>Letter Grade</th><th>Percentage</th><th>Last Modified</th>\n        </tr>\n      </thead>\n      <tbody>\n        ${rowsHtml}\n      </tbody>\n    </table>\n  </div>\n\n  <div class=\"footer\">\n    Imported from: ${classList.fileName}\n  </div>\n</body>\n</html>`;\n  };\n\n  // Export class grades as CSV (preserved exactly from original)\n  const exportClassGradesCSV = () => {\n    var _classList$courseMeta10;\n    if (!classList) return;\n\n    // 1) Build a 2D array where the first column is the row number\n    const rows = [\n    // now 11 headers instead of 10\n    ['#', 'Student ID', 'Student Name', 'Email', 'Program', 'Status', 'Grade Type', 'Numeric Grade', 'Letter Grade', 'Percentage', 'Last Modified'], ...classList.students.map((student, index) => {\n      const progress = classList.gradingProgress[index] || {};\n      const gradeInfo = calculateStudentGrade(student.id);\n      const lm = progress.lastModified ? new Date(progress.lastModified).toLocaleDateString() : 'Never';\n      return [index + 1,\n      // ‚Üê new \"#\" column\n      student.id, student.name, student.email, student.program || 'N/A', progress.status || 'pending', progress.gradeType || 'none', gradeInfo.score !== 'N/A' ? `${gradeInfo.score}/${gradeInfo.maxPossible}` : 'N/A', gradeInfo.letterGrade || 'N/A', gradeInfo.percentage !== 'N/A' ? `${gradeInfo.percentage}%` : 'N/A', lm];\n    })];\n\n    // 2) Quote each cell (handles commas/quotes in names, etc.)\n    const quote = cell => `\"${String(cell).trim().replace(/\"/g, '\"\"')}\"`;\n\n    // 3) Join into a CSV string with CRLFs\n    const csvContent = rows.map(row => row.map(quote).join(',')).join('\\r\\n');\n\n    // 4) Trigger download (unchanged)\n    const blob = new Blob([csvContent], {\n      type: 'text/csv'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `${((_classList$courseMeta10 = classList.courseMetadata) === null || _classList$courseMeta10 === void 0 ? void 0 : _classList$courseMeta10.courseCode) || 'class'}_grades_${new Date().toISOString().slice(0, 10)}.csv`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n\n  // ‚îÄ‚îÄ Export class grades as HTML via download ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\n  const exportClassGradesHTML = () => {\n    var _classList$courseMeta11;\n    if (!classList) return;\n    const htmlContent = getClassGradesHTML();\n    const blob = new Blob([htmlContent], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `${((_classList$courseMeta11 = classList.courseMetadata) === null || _classList$courseMeta11 === void 0 ? void 0 : _classList$courseMeta11.courseCode) || 'Class'}_grades.html`;\n    link.style.display = 'none';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  };\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n  // ‚îÄ‚îÄ Export Class Grades as a portrait PDF ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\n  const exportClassGradesPortraitPDF = () => {\n    if (!classList) return;\n\n    // Open a new window with our portrait HTML\n    const printWin = window.open('', '_blank', 'width=800,height=600');\n    printWin.document.write(getPortraitClassReportHTML());\n    printWin.document.close();\n    printWin.focus();\n\n    // When it loads, trigger the print dialog\n    printWin.onload = () => {\n      printWin.print();\n      // Optionally close after printing:\n      // printWin.close();\n    };\n  };\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n  // Complete exportStudentGrade function for ClassListManager.js (preserved exactly from original)\n  const exportStudentGrade = studentId => {\n    // 1. Make sure we have a classList and sharedRubric\n    if (!classList || !sharedRubric) {\n      alert('No class list or rubric available. Please ensure both are loaded.');\n      return;\n    }\n\n    // 2. Find the student in the class list\n    const student = classList.students.find(s => s.id === studentId);\n    if (!student) {\n      alert('Student not found in class list.');\n      return;\n    }\n\n    // 3. Load the student's grade data\n    const gradeStatus = getGradeStatus(studentId);\n    let gradeData = null;\n    if (gradeStatus === 'final') {\n      gradeData = loadFinalGradeData(studentId);\n    } else if (gradeStatus === 'draft') {\n      gradeData = loadDraft(studentId);\n    } else {\n      alert('No grade data found for this student. Please grade the student first.');\n      return;\n    }\n    if (!gradeData) {\n      alert('Unable to load grade data for this student.');\n      return;\n    }\n\n    // 4. Late Policy Levels (same as in GradingTemplate.js)\n    const latePolicyLevels = {\n      none: {\n        name: 'On Time',\n        multiplier: 1.0,\n        description: 'Assignment submitted on or before due date and time - marked out of 100%',\n        color: '#16a34a'\n      },\n      within24: {\n        name: '1-24 Hours Late',\n        multiplier: 0.8,\n        description: 'Assignment received within 24 hours of due date - 20% reduction (marked out of 80%)',\n        color: '#ea580c'\n      },\n      after24: {\n        name: 'More than 24 Hours Late',\n        multiplier: 0.0,\n        description: 'Assignment received after 24 hours from due date - mark of zero (0)',\n        color: '#dc2626'\n      }\n    };\n\n    // 5. Calculate scores (replicated from GradingTemplate.js)\n    const calculateTotalScore = () => {\n      if (!sharedRubric || !gradeData.rubricGrading) {\n        return {\n          finalScore: 0,\n          rawScore: 0,\n          penaltyApplied: false\n        };\n      }\n      let totalScore = 0;\n      const totalPossible = sharedRubric.assignmentInfo.totalPoints;\n      sharedRubric.criteria.forEach(criterion => {\n        const rubricGrading = gradeData.rubricGrading[criterion.id];\n        if (rubricGrading && rubricGrading.selectedLevel) {\n          const level = sharedRubric.rubricLevels.find(l => l.level === rubricGrading.selectedLevel);\n          if (level) {\n            const points = criterion.maxPoints * level.multiplier;\n            totalScore += points;\n          }\n        }\n      });\n      const rawScore = totalScore;\n      let finalScore = totalScore;\n      let penaltyApplied = false;\n\n      // Apply late penalty if applicable\n      if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\n        const latePolicyLevel = latePolicyLevels[gradeData.latePolicy.level];\n        if (latePolicyLevel) {\n          finalScore = totalScore * latePolicyLevel.multiplier;\n          penaltyApplied = true;\n        }\n      }\n      return {\n        finalScore,\n        rawScore,\n        penaltyApplied\n      };\n    };\n\n    // 6. Generate HTML report (based on GradingTemplate.js generateStudentReportHTML)\n    const generateStudentReportHTML = () => {\n      var _gradeData$attachment, _gradeData$videoLinks, _gradeData$course, _classList$courseMeta12, _gradeData$course2, _classList$courseMeta13, _gradeData$assignment, _sharedRubric$assignm5, _gradeData$course3, _classList$courseMeta14, _gradeData$course4, _classList$courseMeta15;\n      const scoreCalculation = calculateTotalScore();\n      const totalScore = scoreCalculation.finalScore;\n      const rawScore = scoreCalculation.rawScore;\n      const maxPoints = sharedRubric.assignmentInfo.totalPoints;\n      const percentage = (totalScore / (maxPoints || 1) * 100).toFixed(1);\n      const penaltyApplied = scoreCalculation.penaltyApplied;\n\n      // Generate attachments HTML\n      const attachmentsHTML = ((_gradeData$attachment = gradeData.attachments) === null || _gradeData$attachment === void 0 ? void 0 : _gradeData$attachment.map((att, index) => {\n        if (att.base64Data) {\n          return `<div class=\"attachment-item\"><img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"clickable-image\" data-index=\"${index}\" style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" /><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div><div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div></div>`;\n        } else {\n          return `<div class=\"attachment-item\"><div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">üìÑ</div><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div></div>`;\n        }\n      }).join('')) || '';\n\n      // Generate video links HTML\n      const videoLinksHTML = ((_gradeData$videoLinks = gradeData.videoLinks) === null || _gradeData$videoLinks === void 0 ? void 0 : _gradeData$videoLinks.map(link => `<div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\"><div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\"><span style=\"font-size: 1.25rem;\">üé•</span><strong style=\"color: #495057;\">${link.title}</strong></div><a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">${link.url}</a></div>`).join('')) || '';\n\n      // Generate rubric table HTML\n      const rubricTableHTML = sharedRubric ? `\n            <div style=\"margin: 30px 0;\">\n                <h3>üìä Detailed Rubric Assessment</h3>\n                <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9rem;\">\n                    <thead>\n                        <tr style=\"background: #f8f9fa;\">\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th>\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 120px;\">Level Achieved</th>\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 80px;\">Points</th>\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Details & Comments</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ${sharedRubric.criteria.map(criterion => {\n        var _gradeData$rubricGrad, _criterion$levels, _criterion$levels$sel;\n        const rubricGrading = (_gradeData$rubricGrad = gradeData.rubricGrading) === null || _gradeData$rubricGrad === void 0 ? void 0 : _gradeData$rubricGrad[criterion.id];\n        const selectedLevel = rubricGrading === null || rubricGrading === void 0 ? void 0 : rubricGrading.selectedLevel;\n        const level = selectedLevel ? sharedRubric.rubricLevels.find(l => l.level === selectedLevel) : null;\n        const points = level ? Math.round(criterion.maxPoints * level.multiplier * 10) / 10 : 0;\n        const levelDescription = level && (_criterion$levels = criterion.levels) !== null && _criterion$levels !== void 0 && (_criterion$levels$sel = _criterion$levels[selectedLevel]) !== null && _criterion$levels$sel !== void 0 && _criterion$levels$sel.description ? criterion.levels[selectedLevel].description : '';\n        const additionalComments = (rubricGrading === null || rubricGrading === void 0 ? void 0 : rubricGrading.customComments) || '';\n        return `<tr>\n                                <td style=\"border: 1px solid #ddd; padding: 12px; vertical-align: top;\">\n                                    <strong>${criterion.name}</strong><br>\n                                    <small style=\"color: #666;\">${criterion.description || ''}</small><br>\n                                    <small style=\"color: #888;\">Max Points: ${criterion.maxPoints}</small>\n                                </td>\n                                <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; vertical-align: top;\">\n                                    <span style=\"display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; background: ${(level === null || level === void 0 ? void 0 : level.color) || '#f0f0f0'}; color: white;\">\n                                        ${(level === null || level === void 0 ? void 0 : level.name) || 'Not Assessed'}\n                                    </span>\n                                </td>\n                                <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td>\n                                <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\n                                    ${levelDescription ? `<div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\"><strong style=\"color: ${level.color};\">Level Description:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span></div>` : ''}\n                                    ${additionalComments ? `<div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\"><strong style=\"color: #856404;\">Additional Comments:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span></div>` : ''}\n                                    ${!levelDescription && !additionalComments ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}\n                                </td>\n                            </tr>`;\n      }).join('')}\n                    </tbody>\n                </table>\n                <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\">\n                    <h4 style=\"color: #2e7d32; margin-bottom: 10px;\">üìä Rubric Score Summary</h4>\n                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\n                        <div><strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br><strong>Percentage:</strong> ${percentage}%</div>\n                        <div><strong>Grade Status:</strong><span style=\"color: ${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '‚úì PASSING' : '‚úó NEEDS IMPROVEMENT'}</span></div>\n                        ${penaltyApplied ? `<div style=\"color: #ff9800;\"><strong>Late Penalty Applied:</strong><br>Raw Score: ${Math.round(rawScore * 10) / 10}</div>` : ''}\n                    </div>\n                </div>\n            </div>` : '';\n\n      // Complete HTML document\n      const htmlContent = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Grade Report - ${student.name}</title>\n    <style>\n        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; line-height: 1.6; }\n        .header { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; }\n        .score-summary { background: #e8f5e8; border: 2px solid #4caf50; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center; }\n        .late-policy-section { margin: 30px 0; background: #fff5f5; border: 1px solid #f87171; border-radius: 8px; padding: 20px; }\n        .feedback-section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 8px; }\n        .attachments { margin: 30px 0; }\n        .attachment-item { display: inline-block; text-align: center; margin: 1rem; padding: 1rem; background: #fff; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,.1); max-width: 250px; vertical-align: top; }\n        .clickable-image { cursor: pointer; transition: all .3s ease; position: relative; }\n        .clickable-image:hover { transform: scale(1.05); box-shadow: 0 4px 8px rgba(0,0,0,.2); }\n        .video-links { margin: 30px 0; }\n        .video-link-item { margin-bottom: 1rem; }\n        .video-link-item a { color: #007bff; text-decoration: none; }\n        .video-link-item a:hover { text-decoration: underline; }\n        h1, h2, h3 { color: #333; }\n        .image-modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,.9); animation: fadeIn .3s ease; }\n        .image-modal.show { display: flex; align-items: center; justify-content: center; }\n        .modal-content { max-width: 95%; max-height: 95%; object-fit: contain; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,.5); animation: zoomIn .3s ease; }\n        .close-modal { position: absolute; top: 20px; right: 30px; color: #fff; font-size: 40px; font-weight: 700; cursor: pointer; z-index: 1001; background: rgba(0,0,0,.5); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; line-height: 1; }\n        .close-modal:hover { background: rgba(0,0,0,.8); }\n        .modal-caption { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: #fff; background: rgba(0,0,0,.7); padding: 10px 20px; border-radius: 6px; text-align: center; max-width: 80%; }\n        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\n        @keyframes zoomIn { from { transform: scale(.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }\n        @media print { .attachment-item, .video-link-item { break-inside: avoid; } .image-modal { display: none!important; } }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üìã Grade Report</h1>\n        <p><strong>Student:</strong> ${student.name} (${student.id})</p>\n        <p><strong>Course:</strong> ${((_gradeData$course = gradeData.course) === null || _gradeData$course === void 0 ? void 0 : _gradeData$course.code) || ((_classList$courseMeta12 = classList.courseMetadata) === null || _classList$courseMeta12 === void 0 ? void 0 : _classList$courseMeta12.courseCode) || ''} - ${((_gradeData$course2 = gradeData.course) === null || _gradeData$course2 === void 0 ? void 0 : _gradeData$course2.name) || ((_classList$courseMeta13 = classList.courseMetadata) === null || _classList$courseMeta13 === void 0 ? void 0 : _classList$courseMeta13.courseName) || ''}</p>\n        <p><strong>Assignment:</strong> ${((_gradeData$assignment = gradeData.assignment) === null || _gradeData$assignment === void 0 ? void 0 : _gradeData$assignment.name) || ((_sharedRubric$assignm5 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm5 === void 0 ? void 0 : _sharedRubric$assignm5.title) || ''}</p>\n        <p><strong>Instructor:</strong> ${((_gradeData$course3 = gradeData.course) === null || _gradeData$course3 === void 0 ? void 0 : _gradeData$course3.instructor) || ((_classList$courseMeta14 = classList.courseMetadata) === null || _classList$courseMeta14 === void 0 ? void 0 : _classList$courseMeta14.instructor) || ''}</p>\n        <p><strong>Term:</strong> ${((_gradeData$course4 = gradeData.course) === null || _gradeData$course4 === void 0 ? void 0 : _gradeData$course4.term) || ((_classList$courseMeta15 = classList.courseMetadata) === null || _classList$courseMeta15 === void 0 ? void 0 : _classList$courseMeta15.term) || ''}</p>\n    </div>\n\n    <div class=\"score-summary\">\n        <h2>üìä Final Score</h2>\n        <div style=\"font-size: 2rem; font-weight: 700; color: #2e7d32; margin: 15px 0;\">\n            ${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)\n        </div>\n        <p style=\"margin: 10px 0; color: #555;\">\n            ${sharedRubric ? `Rubric: ${sharedRubric.assignmentInfo.title}` : \"\"}\n            ${penaltyApplied ? ` | Late Policy: ${latePolicyLevels[gradeData.latePolicy.level].name}` : \"\"}\n        </p>\n    </div>\n\n    ${penaltyApplied ? `\n        <div class=\"late-policy-section\">\n            <h3 style=\"color: #dc2626;\">üìÖ Late Submission Policy Applied</h3>\n            <p><strong>Policy Status:</strong> ${latePolicyLevels[gradeData.latePolicy.level].name}</p>\n            <p>${latePolicyLevels[gradeData.latePolicy.level].description}</p>\n            <p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} ‚Üí <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\n        </div>\n    ` : \"\"}\n\n    ${rubricTableHTML}\n\n    ${Object.entries(gradeData.feedback || {}).filter(([key, text]) => text).map(([key, text]) => `\n        <div class=\"feedback-section\">\n            <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\n            <p>${text.replace(/\\n/g, \"<br>\")}</p>\n        </div>\n    `).join(\"\")}\n\n    ${attachmentsHTML ? `\n        <div class=\"attachments\">\n            <h3>üìé File Attachments</h3>\n            <div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">\n                ${attachmentsHTML}\n            </div>\n        </div>\n    ` : \"\"}\n\n    ${videoLinksHTML ? `\n        <div class=\"video-links\">\n            <h3>üé• Video Review Links</h3>\n            ${videoLinksHTML}\n        </div>\n    ` : \"\"}\n\n    <p style=\"margin-top: 40px; text-align: center; color: #666; font-size: .9rem;\">\n        Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}\n    </p>\n\n    <div id=\"imageModal\" class=\"image-modal\">\n        <span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span>\n        <img class=\"modal-content\" id=\"modalImage\">\n        <div class=\"modal-caption\" id=\"modalCaption\"></div>\n    </div>\n\n    <script>\n        const attachmentData = ${JSON.stringify(gradeData.attachments || [])};\n        \n        function openImageModal(src, caption) {\n            const modal = document.getElementById(\"imageModal\");\n            const modalImg = document.getElementById(\"modalImage\");\n            const modalCaption = document.getElementById(\"modalCaption\");\n            modal.classList.add(\"show\");\n            modalImg.src = src;\n            modalCaption.textContent = caption;\n            document.body.style.overflow = \"hidden\";\n        }\n        \n        function closeImageModal() {\n            document.getElementById(\"imageModal\").classList.remove(\"show\");\n            document.body.style.overflow = \"auto\";\n        }\n        \n        document.addEventListener(\"DOMContentLoaded\", function() {\n            document.querySelectorAll(\".clickable-image\").forEach(img => {\n                img.addEventListener(\"click\", function() {\n                    const index = parseInt(this.getAttribute(\"data-index\"));\n                    const attachment = attachmentData[index];\n                    if (attachment && attachment.base64Data) {\n                        openImageModal(attachment.base64Data, attachment.name);\n                    }\n                });\n            });\n            \n            document.getElementById(\"imageModal\").addEventListener(\"click\", function(e) {\n                if (e.target === this) {\n                    closeImageModal();\n                }\n            });\n            \n            document.addEventListener(\"keydown\", function(e) {\n                if (e.key === \"Escape\") {\n                    closeImageModal();\n                }\n            });\n        });\n    </script>\n</body>\n</html>`;\n      return htmlContent;\n    };\n\n    // 7. Generate and export the HTML file\n    try {\n      var _sharedRubric$assignm6, _sharedRubric$assignm7;\n      const htmlContent = generateStudentReportHTML();\n      const htmlBlob = new Blob([htmlContent], {\n        type: 'text/html'\n      });\n      const url = URL.createObjectURL(htmlBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `grade_report_${student.name.replace(/[^a-zA-Z0-9]/g, '_')}_${((_sharedRubric$assignm6 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm6 === void 0 ? void 0 : (_sharedRubric$assignm7 = _sharedRubric$assignm6.title) === null || _sharedRubric$assignm7 === void 0 ? void 0 : _sharedRubric$assignm7.replace(/[^a-zA-Z0-9]/g, '_')) || 'assignment'}.html`;\n      link.click();\n      URL.revokeObjectURL(url);\n      console.log(`‚úÖ Individual grade report exported for student: ${student.name}`);\n    } catch (error) {\n      console.error('Error generating individual grade report:', error);\n      alert('Error generating grade report. Please check the console for details.');\n    }\n  };\n\n  // File upload handling (preserved exactly from original)\n  const handleFileUpload = async event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    setImportStatus('processing');\n    try {\n      var _result$courseMetadat, _result$courseMetadat2, _result$courseMetadat3, _result$courseMetadat4, _result$courseMetadat5, _result$courseMetadat6, _result$courseMetadat7;\n      // Use Excel parser instead of manual CSV parsing\n      const result = await parseExcelFile(file);\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to parse Excel file');\n      }\n\n      // Validate the parsed student data\n      const validation = validateStudentData(result.students);\n      if (result.students.length === 0) {\n        throw new Error('No valid student records found in Excel file');\n      }\n\n      // Create grading progress tracking for each student\n      const gradingProgress = result.students.map(() => ({\n        status: 'pending',\n        lastModified: null,\n        gradeType: null\n      }));\n      const classListData = {\n        students: result.students,\n        gradingProgress,\n        fileName: file.name,\n        fileSize: file.size,\n        importTime: new Date().toISOString(),\n        // Now include \"instructor\" (falls back to 'TBD' if none)\n        courseMetadata: {\n          courseCode: ((_result$courseMetadat = result.courseMetadata) === null || _result$courseMetadat === void 0 ? void 0 : _result$courseMetadat.courseCode) || 'IMPORTED',\n          courseName: ((_result$courseMetadat2 = result.courseMetadata) === null || _result$courseMetadat2 === void 0 ? void 0 : _result$courseMetadat2.courseName) || 'Excel Import',\n          section: ((_result$courseMetadat3 = result.courseMetadata) === null || _result$courseMetadat3 === void 0 ? void 0 : _result$courseMetadat3.section) || 'DEFAULT',\n          programType: ((_result$courseMetadat4 = result.courseMetadata) === null || _result$courseMetadat4 === void 0 ? void 0 : _result$courseMetadat4.programType) || 'degree',\n          // e.g. 'degree' | 'diploma' | 'certificate'\n          // ‚Üê Try .instructor first, then .professors (your Excel parser writes the names there)\n          instructor: ((_result$courseMetadat5 = result.courseMetadata) === null || _result$courseMetadat5 === void 0 ? void 0 : _result$courseMetadat5.instructor // if you manually had an \"Instructor\" column\n          ) || ((_result$courseMetadat6 = result.courseMetadata) === null || _result$courseMetadat6 === void 0 ? void 0 : _result$courseMetadat6.professors) // fall back to your \"Professors\" column\n          || 'TBD',\n          term: ((_result$courseMetadat7 = result.courseMetadata) === null || _result$courseMetadat7 === void 0 ? void 0 : _result$courseMetadat7.term) || 'TBD'\n        },\n        validation: {\n          validationScore: validation.validationScore || 100,\n          issues: validation.issues || []\n        }\n      };\n      setClassList(classListData);\n      setImportStatus('success');\n      setTimeout(() => setImportStatus(''), 3000);\n    } catch (error) {\n      console.error('Excel import error:', error);\n      setImportStatus('error');\n      setTimeout(() => setImportStatus(''), 3000);\n    }\n  };\n\n  // Session management functions (preserved exactly from original)\n  const startGradingSession = () => {\n    if (!classList || classList.students.length === 0) {\n      alert('No students available for grading.');\n      return;\n    }\n    if (!sharedRubric) {\n      alert('Please load a rubric before starting batch grading.');\n      return;\n    }\n\n    // Initialize the grading session (this will set up the first student)\n    const success = initializeGradingSession(classList);\n    if (success) {\n      setActiveTab('grading-tool');\n    }\n  };\n\n  // Pause the grading session\n  const pauseGradingSession = () => {\n    setGradingSession(prev => ({\n      ...prev,\n      active: false\n    }));\n  };\n\n  // Resume the grading session\n  const resumeGradingSession = () => {\n    setGradingSession(prev => ({\n      ...prev,\n      active: true\n    }));\n    setActiveTab('grading-tool');\n  };\n\n  // NEW: Policy Preview Component\n  const PolicyPreview = ({\n    policy\n  }) => {\n    var _policy$gradeScale, _policy$gradeScale2;\n    if (!policy) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-semibold text-blue-800 mb-2 text-sm\",\n        children: [\"\\uD83D\\uDCCB Active Grading Policy: \", policy.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1201,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-xs text-blue-700 mb-2\",\n        children: policy.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1204,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 md:grid-cols-4 gap-1 text-xs\",\n        children: (_policy$gradeScale = policy.gradeScale) === null || _policy$gradeScale === void 0 ? void 0 : _policy$gradeScale.slice(0, 4).map((grade, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white p-1 rounded border text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-bold text-blue-800\",\n            children: grade.letter\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1209,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-blue-600\",\n            children: [grade.minPercentage, \"%+\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1210,\n            columnNumber: 29\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1208,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1206,\n        columnNumber: 17\n      }, this), ((_policy$gradeScale2 = policy.gradeScale) === null || _policy$gradeScale2 === void 0 ? void 0 : _policy$gradeScale2.length) > 4 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-blue-600 mt-1\",\n        children: [\"...and \", policy.gradeScale.length - 4, \" more grades\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1216,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1200,\n      columnNumber: 13\n    }, this);\n  };\n\n  // Enhanced program type dropdown with policy support\n  const renderEnhancedProgramTypeDropdown = () => {\n    var _classList$courseMeta16;\n    const programTypes = gradingPolicyService.getSupportedProgramTypes();\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"programType\",\n        className: \"block text-sm font-bold text-gray-700\",\n        children: \"Program Type:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1230,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"programType\",\n        name: \"programType\",\n        value: ((_classList$courseMeta16 = classList.courseMetadata) === null || _classList$courseMeta16 === void 0 ? void 0 : _classList$courseMeta16.programType) || 'degree',\n        onChange: handleProgramTypeChange,\n        className: \"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\",\n        children: programTypes.map(type => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: type.value,\n          children: type.label\n        }, type.value, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1239,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1231,\n        columnNumber: 17\n      }, this), selectedPolicy && /*#__PURE__*/_jsxDEV(PolicyPreview, {\n        policy: selectedPolicy\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1246,\n        columnNumber: 36\n      }, this), (policiesLoading || gradeCalculation.isPending) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 text-blue-600 mt-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1251,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs\",\n          children: policiesLoading ? 'Loading grading policies...' : 'Calculating grade...'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1252,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1250,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1229,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-7xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gradient-to-r text-gray-800 p-6 rounded-t-lg shadow-lg\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-3xl font-bold mb-2\",\n              children: \"Class List Manager\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1268,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-600\",\n              children: \"Import, manage, and grade entire classes efficiently\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1269,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1267,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-4\",\n            children: [classList && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-right\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-2xl font-bold\",\n                children: classList.students.length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1276,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-700\",\n                children: \"Students\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1279,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1275,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Users, {\n              size: 48,\n              className: \"text-gray-700\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1284,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1273,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1266,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1265,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-b-lg shadow-lg\",\n        children: [!classList && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"max-w-2xl mx-auto text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-blue-50 border border-blue-200 rounded-lg p-8 mb-6\",\n              children: [/*#__PURE__*/_jsxDEV(FileSpreadsheet, {\n                size: 48,\n                className: \"mx-auto text-blue-600 mb-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1295,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-2xl font-bold text-gray-800 mb-4\",\n                children: \"Import Student List\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1296,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-600 mb-6\",\n                children: \"Upload an Excel file (.xls or .xlsx) containing your student roster to begin class management.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1299,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                ref: fileInputRef,\n                type: \"file\",\n                accept: \".xls,.xlsx\",\n                onChange: handleFileUpload,\n                className: \"hidden\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1303,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  var _fileInputRef$current;\n                  return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n                },\n                disabled: importStatus === 'processing',\n                className: \"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium transition-colors inline-flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\",\n                children: [/*#__PURE__*/_jsxDEV(FileSpreadsheet, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1316,\n                  columnNumber: 41\n                }, this), importStatus === 'processing' ? 'Processing...' : 'Choose Excel File']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1311,\n                columnNumber: 37\n              }, this), importStatus === 'success' && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-4 text-green-600 font-medium\",\n                children: \"\\u2713 Excel file imported successfully!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1321,\n                columnNumber: 41\n              }, this), importStatus === 'error' && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-4 text-red-600 font-medium\",\n                children: \"\\u2717 Error importing Excel file. Please check format and try again.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1327,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1294,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-50 rounded-lg p-6 text-left\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"font-semibold text-gray-800 mb-3\",\n                children: \"Expected Excel Format:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1334,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-600 space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Required columns:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1336,\n                    columnNumber: 46\n                  }, this), \" ID, Name, Email\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1336,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Optional columns:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1337,\n                    columnNumber: 46\n                  }, this), \" Program, Campus, Level, Status\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1337,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"File types:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1338,\n                    columnNumber: 46\n                  }, this), \" .xls or .xlsx\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1338,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Note:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1339,\n                    columnNumber: 46\n                  }, this), \" First row should contain column headers\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1339,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1335,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1333,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1293,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1292,\n          columnNumber: 25\n        }, this), classList && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(BookOpen, {\n                  className: \"text-blue-600\",\n                  size: 24\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1354,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-blue-800\",\n                  children: \"Course Information\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1355,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1353,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2 text-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Code:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1361,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta17 = classList.courseMetadata) === null || _classList$courseMeta17 === void 0 ? void 0 : _classList$courseMeta17.courseCode) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1360,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Name:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1365,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta18 = classList.courseMetadata) === null || _classList$courseMeta18 === void 0 ? void 0 : _classList$courseMeta18.courseName) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1364,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Section:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1369,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta19 = classList.courseMetadata) === null || _classList$courseMeta19 === void 0 ? void 0 : _classList$courseMeta19.section) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1368,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Professor:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1373,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta20 = classList.courseMetadata) === null || _classList$courseMeta20 === void 0 ? void 0 : _classList$courseMeta20.instructor) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1372,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-3\",\n                  children: renderEnhancedProgramTypeDropdown()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1378,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1359,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1352,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(GraduationCap, {\n                  className: \"text-green-600\",\n                  size: 24\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1387,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-green-800\",\n                  children: \"Grading Progress\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1388,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1386,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2 text-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Total Students:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1394,\n                    columnNumber: 45\n                  }, this), \" \", classList.students.length]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1393,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Final Grades:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1397,\n                    columnNumber: 45\n                  }, this), ' ', getGradingProgress().final]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1396,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Draft Grades:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1401,\n                    columnNumber: 45\n                  }, this), ' ', getGradingProgress().draft]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1400,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Completion:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1405,\n                    columnNumber: 45\n                  }, this), ' ', getGradingProgress().percentage, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1404,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1392,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1385,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(Play, {\n                  className: \"text-purple-600\",\n                  size: 24\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1414,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-purple-800\",\n                  children: \"Batch Grading Session\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1415,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1413,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-3\",\n                children: !(gradingSession !== null && gradingSession !== void 0 && gradingSession.active) ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-purple-600 mb-2\",\n                    children: (gradingSession === null || gradingSession === void 0 ? void 0 : gradingSession.currentStudentIndex) > 0 ? `Paused at student ${gradingSession.currentStudentIndex + 1} of ${classList.students.length}` : 'Ready to start batch grading'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1422,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex gap-2\",\n                    children: [(gradingSession === null || gradingSession === void 0 ? void 0 : gradingSession.currentStudentIndex) > 0 ? /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: resumeGradingSession,\n                      className: \"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors\",\n                      children: [/*#__PURE__*/_jsxDEV(Play, {\n                        size: 16\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1434,\n                        columnNumber: 61\n                      }, this), \"Resume Session\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1430,\n                      columnNumber: 57\n                    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: startGradingSession,\n                      disabled: !sharedRubric,\n                      className: \"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n                      children: [/*#__PURE__*/_jsxDEV(Play, {\n                        size: 16\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1443,\n                        columnNumber: 61\n                      }, this), \"Start Batch Grading\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1438,\n                      columnNumber: 57\n                    }, this), !sharedRubric && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-xs text-purple-600 mt-1\",\n                      children: \"Load a rubric first\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1448,\n                      columnNumber: 57\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1428,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1421,\n                  columnNumber: 45\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-green-600 font-medium mb-2\",\n                    children: [\"\\u2713 Session Active - Student \", gradingSession.currentStudentIndex + 1, \" of \", classList.students.length]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1456,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: pauseGradingSession,\n                    className: \"flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors\",\n                    children: [/*#__PURE__*/_jsxDEV(Clock, {\n                      size: 16\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1463,\n                      columnNumber: 53\n                    }, this), \"Pause Session\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1459,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1455,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1419,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1412,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1350,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white border border-gray-200 rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"px-6 py-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-semibold text-gray-800\",\n                children: \"Student Roster\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1475,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: exportClassGradesCSV,\n                  className: \"px-2 py-1 rounded text-xs font-medium text-white bg-green-500 hover:bg-green-700 focus:ring-2 focus:ring-green-500 transition-colors duration-150\",\n                  children: [/*#__PURE__*/_jsxDEV(Download, {\n                    size: 14\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1483,\n                    columnNumber: 45\n                  }, this), \"CSV\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1479,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: exportClassGradesHTML,\n                  className: \"flex items-center gap-1 px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(FileText, {\n                    size: 14\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1490,\n                    columnNumber: 45\n                  }, this), \"HTML\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1486,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: exportClassGradesPortraitPDF,\n                  className: \"flex items-center gap-1 px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-medium transition-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(FileText, {\n                    size: 14\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1497,\n                    columnNumber: 45\n                  }, this), \"PDF\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1493,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1478,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1474,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"overflow-x-auto\",\n              children: /*#__PURE__*/_jsxDEV(\"table\", {\n                className: \"table-auto w-max mx-auto\",\n                children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                  className: \"bg-gray-50\",\n                  children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"#\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1507,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Status\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1510,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Student ID\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1513,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Name\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1516,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Email\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1519,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Program\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1522,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"w-48 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Actions\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1525,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1506,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1505,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                  className: \"bg-white divide-y divide-gray-200\",\n                  children: classList.students.map((student, index) => {\n                    const progress = classList.gradingProgress[index];\n                    const isCurrentStudent = gradingSession.active && index === gradingSession.currentStudentIndex;\n                    const gradeStatus = getGradeStatus(student.id);\n                    return /*#__PURE__*/_jsxDEV(\"tr\", {\n                      className: `${isCurrentStudent ? 'bg-blue-50 border-l-4 border-blue-500' : 'hover:bg-gray-50'} transition-colors`,\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\",\n                        children: index + 1\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1544,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-6 py-4 whitespace-nowrap\",\n                        children: getStatusDisplay(progress, student.id)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1547,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\",\n                        children: student.id\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1550,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\",\n                        children: student.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1553,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-4 py-2 whitespace-normal break-words text-sm text-gray-500 max-w-xs\",\n                        children: student.email\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1556,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",\n                        children: student.program\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1559,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"w-48 px-4 py-2 text-sm whitespace-normal\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex flex-wrap items-center gap-2\",\n                          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => loadStudentForGrading(student),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-blue-500 hover:bg-blue-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-blue-500 duration-150\",\n                            children: gradeStatus === 'final' ? 'View' : 'Edit'\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1566,\n                            columnNumber: 65\n                          }, this), gradeStatus === 'draft' && /*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => finalizeGrade(student.id),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-green-500 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-green-500 duration-150\",\n                            children: \"Finalize\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1575,\n                            columnNumber: 69\n                          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => exportStudentGrade(student.id),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-purple-500 hover:bg-purple-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-purple-500 duration-150\",\n                            children: [/*#__PURE__*/_jsxDEV(ExternalLink, {\n                              size: 14\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1588,\n                              columnNumber: 69\n                            }, this), \"Export Grade\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1584,\n                            columnNumber: 65\n                          }, this), gradeStatus === 'final' && /*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => unlockGrade(student.id),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-orange-500 hover:bg-orange-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-orange-500 duration-150\",\n                            children: [/*#__PURE__*/_jsxDEV(Unlock, {\n                              size: 14\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1598,\n                              columnNumber: 73\n                            }, this), \"Unlock\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1594,\n                            columnNumber: 69\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1564,\n                          columnNumber: 61\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1563,\n                        columnNumber: 57\n                      }, this)]\n                    }, student.id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1537,\n                      columnNumber: 53\n                    }, this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1530,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1504,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1503,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1473,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-8 bg-gray-50 rounded-lg p-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-semibold text-gray-800 mb-4\",\n              children: \"Import Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1614,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"File:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1617,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: classList.fileName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1618,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1616,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Import Date:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1621,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: new Date(classList.importTime).toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1622,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1620,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Data Quality:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1627,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: [((_classList$validation = classList.validation) === null || _classList$validation === void 0 ? void 0 : _classList$validation.validationScore) || 0, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1628,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1626,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Total Students:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1633,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: classList.students.length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1634,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1632,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1615,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1613,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1348,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1289,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1263,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1262,\n    columnNumber: 9\n  }, this);\n};\n_s(ClassListManager, \"2Lyrn+Vmdb02rpyIsW89ah7Gzz4=\", false, function () {\n  return [useGradingPolicies, useGradingPolicyForProgram, useGradeCalculation, useGradingPolicyManager, useAssessment];\n});\n_c = ClassListManager;\nexport default ClassListManager;\nvar _c;\n$RefreshReg$(_c, \"ClassListManager\");","map":{"version":3,"names":["React","useRef","useState","useEffect","Upload","Users","BookOpen","GraduationCap","Play","Download","CheckCircle","Clock","AlertCircle","Unlock","FileText","ExternalLink","FileSpreadsheet","Settings","useAssessment","parseExcelFile","validateStudentData","gradingPolicyService","useGradingPolicies","useGradingPolicyForProgram","useGradeCalculation","useGradingPolicyManager","jsxDEV","_jsxDEV","getLetterGrade","percentage","programType","customProgramId","selectedPolicy","result","calculateGrade","id","success","data","letter","error","console","warn","scales","degree","min","grade","diploma","certificate","graduateCertificate","scale","entry","find","e","ClassListManager","_s","_classList$courseMeta2","_classList$courseMeta17","_classList$courseMeta18","_classList$courseMeta19","_classList$courseMeta20","_classList$validation","fileInputRef","importStatus","setImportStatus","availablePolicies","isLoading","policiesLoading","isActive","currentProgramType","setCurrentProgramType","gradeCalculation","prefetchPolicyForProgram","classList","setClassList","gradingSession","setGradingSession","initializeGradingSession","setActiveTab","setCurrentStudent","hasDraft","getGradeStatus","saveFinalGrade","loadDraft","saveDraft","drafts","sharedRubric","updateStudentInfo","updateAssignmentInfo","loadFinalGrade","finalGrades","rubricFormData","_classList$courseMeta","courseMetadata","programTypes","forEach","type","handleProgramTypeChange","newType","target","value","prev","getStatusDisplay","progress","studentId","gradeStatus","className","children","fileName","_jsxFileName","lineNumber","columnNumber","status","finalizeGrade","draftData","studentIndex","students","findIndex","s","updatedProgress","gradingProgress","lastModified","Date","toISOString","gradeType","unlockGrade","log","loadFinalGradeData","calculateStudentGrade","_classList$courseMeta3","_classList$courseMeta4","gradeData","rubricGrading","criteria","rubricLevels","score","maxPossible","letterGrade","totalScore","criterion","gradingSelection","criterionMaxPoints","Number","maxPoints","selectedLevel","levelData","l","level","levelMultiplier","multiplier","latePolicy","latePenalties","within24","after24","numericScore","Math","round","maxScore","loadStudentForGrading","student","name","email","_sharedRubric$assignm","_sharedRubric$assignm2","assignmentInfo","title","totalPoints","finalData","getGradingProgress","completed","total","final","draft","filter","p","_p$status","startsWith","length","_p$status2","getPortraitClassReportHTML","_sharedRubric$assignm3","_classList$courseMeta5","_classList$courseMeta6","_classList$courseMeta7","now","currentDate","toLocaleDateString","currentTime","toLocaleTimeString","rubricName","rowsHtml","map","idx","info","num","join","courseCode","courseName","section","getClassGradesHTML","_classList$courseMeta8","_classList$courseMeta9","_classList$courseMeta0","_classList$courseMeta1","_sharedRubric$assignm4","weekday","year","month","day","i","_prog$status","_prog$status2","prog","lm","statusClass","includes","program","exportClassGradesCSV","_classList$courseMeta10","rows","index","gradeInfo","quote","cell","String","trim","replace","csvContent","row","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","slice","click","revokeObjectURL","exportClassGradesHTML","_classList$courseMeta11","htmlContent","style","display","body","appendChild","removeChild","exportClassGradesPortraitPDF","printWin","window","open","write","close","focus","onload","print","exportStudentGrade","alert","latePolicyLevels","none","description","color","calculateTotalScore","finalScore","rawScore","penaltyApplied","totalPossible","points","latePolicyLevel","generateStudentReportHTML","_gradeData$attachment","_gradeData$videoLinks","_gradeData$course","_classList$courseMeta12","_gradeData$course2","_classList$courseMeta13","_gradeData$assignment","_sharedRubric$assignm5","_gradeData$course3","_classList$courseMeta14","_gradeData$course4","_classList$courseMeta15","scoreCalculation","toFixed","attachmentsHTML","attachments","att","base64Data","size","videoLinksHTML","videoLinks","rubricTableHTML","_gradeData$rubricGrad","_criterion$levels","_criterion$levels$sel","levelDescription","levels","additionalComments","customComments","passingThreshold","course","code","assignment","instructor","term","Object","entries","feedback","key","text","charAt","toUpperCase","JSON","stringify","_sharedRubric$assignm6","_sharedRubric$assignm7","htmlBlob","handleFileUpload","event","file","files","_result$courseMetadat","_result$courseMetadat2","_result$courseMetadat3","_result$courseMetadat4","_result$courseMetadat5","_result$courseMetadat6","_result$courseMetadat7","Error","validation","classListData","fileSize","importTime","professors","validationScore","issues","setTimeout","startGradingSession","pauseGradingSession","active","resumeGradingSession","PolicyPreview","policy","_policy$gradeScale","_policy$gradeScale2","gradeScale","minPercentage","renderEnhancedProgramTypeDropdown","_classList$courseMeta16","getSupportedProgramTypes","htmlFor","onChange","label","isPending","ref","accept","onClick","_fileInputRef$current","current","disabled","currentStudentIndex","isCurrentStudent","_c","$RefreshReg$"],"sources":["C:/local clones/rubric-creation-app/src/components/ClassListManager.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\r\nimport {\r\n    Upload,\r\n    Users,\r\n    BookOpen,\r\n    GraduationCap,\r\n    Play,\r\n    Download,\r\n    CheckCircle,\r\n    Clock,\r\n    AlertCircle,\r\n    Unlock,\r\n    FileText,\r\n    ExternalLink,\r\n    FileSpreadsheet,\r\n    Settings  // Add this for policy management\r\n} from 'lucide-react';\r\nimport { useAssessment } from './SharedContext';\r\nimport { parseExcelFile, validateStudentData } from '../utils/excelParser';\r\n\r\n// Add new imports for grading policy management\r\nimport gradingPolicyService from '../services/gradingPolicyService';\r\nimport {\r\n    useGradingPolicies,\r\n    useGradingPolicyForProgram,\r\n    useGradeCalculation,\r\n    useGradingPolicyManager\r\n} from '../hooks/useGradingPolicies';\r\n\r\n/**\r\n * Enhanced getLetterGrade function with dynamic policy support\r\n * Falls back to original hardcoded scales if policy service fails\r\n */\r\nconst getLetterGrade = async (percentage, programType, customProgramId = null, selectedPolicy = null) => {\r\n    // Try dynamic policy calculation first\r\n    try {\r\n        const result = await gradingPolicyService.calculateGrade(\r\n            percentage,\r\n            selectedPolicy?.id,\r\n            programType,\r\n            customProgramId\r\n        );\r\n\r\n        if (result.success) {\r\n            return result.data.letter;\r\n        }\r\n    } catch (error) {\r\n        console.warn('Dynamic grading failed, using legacy fallback:', error);\r\n    }\r\n\r\n    // Legacy fallback - your original hardcoded scales (preserved exactly)\r\n    const scales = {\r\n        degree: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ],\r\n        diploma: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ],\r\n        certificate: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ],\r\n        graduateCertificate: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ]\r\n    };\r\n\r\n    // Pick the right scale (default to degree if missing)\r\n    const scale = scales[programType] || scales.degree;\r\n\r\n    // Find the first entry where percentage ‚â• min\r\n    const entry = scale.find(e => percentage >= e.min);\r\n\r\n    return entry ? entry.grade : 'N/A';\r\n};\r\n\r\nconst ClassListManager = () => {\r\n    const fileInputRef = useRef(null);\r\n    const [importStatus, setImportStatus] = useState('');\r\n\r\n    // Add new grading policy state management using TanStack Query hooks\r\n    const { data: availablePolicies = [], isLoading: policiesLoading } = useGradingPolicies({ isActive: true });\r\n    const [currentProgramType, setCurrentProgramType] = useState('degree');\r\n    const { data: selectedPolicy } = useGradingPolicyForProgram(currentProgramType);\r\n    const gradeCalculation = useGradeCalculation();\r\n    const { prefetchPolicyForProgram } = useGradingPolicyManager();\r\n\r\n    /*\r\n     * FIXES COMPLETED IN THIS UPDATE:\r\n     * ===============================\r\n     * ‚úÖ Excel import functionality (instead of CSV)\r\n     * ‚úÖ Start batch grading session with pause/resume functionality\r\n     * ‚úÖ Enhanced status indicators with proper draft/final states\r\n     * ‚úÖ Export entire class grades as CSV, HTML, and PDF with Final Grade column\r\n     * ‚úÖ Action buttons properly handle Edit/View, Finalize, Export Grade, Unlock\r\n     * ‚úÖ Grade calculation function added for exports\r\n     * ‚úÖ CSV and HTML exports now include calculated final grades and percentages\r\n     * ‚úÖ Dynamic grading policy integration with fallback to legacy scales\r\n     *\r\n     * PENDING FIX (requires GradingTemplate update):\r\n     * ==============================================\r\n     * ‚ùå View action still opens empty grade sheet for saved grades\r\n     *\r\n     * SOLUTION: Add the useEffect from gradingtemplate_fix artifact to GradingTemplate.js\r\n     * and add loadFinalGrade + finalGrades to SharedContext value object.\r\n     *\r\n     * Once implemented, the View action will properly load saved rubric selections,\r\n     * feedback, attachments, video links, and late policy for both draft and final grades.\r\n     */\r\n\r\n    const {\r\n        classList,\r\n        setClassList,\r\n        gradingSession,\r\n        setGradingSession,\r\n        initializeGradingSession,\r\n        setActiveTab,\r\n        setCurrentStudent,\r\n        hasDraft,\r\n        getGradeStatus,\r\n        saveFinalGrade,\r\n        loadDraft,\r\n        saveDraft,\r\n        drafts,\r\n        sharedRubric,\r\n        updateStudentInfo,\r\n        updateAssignmentInfo,\r\n        loadFinalGrade, // This should be available after SharedContext fix\r\n        finalGrades, // This should be available after SharedContext fix\r\n        rubricFormData,\r\n    } = useAssessment();\r\n\r\n    // Load current program type from class metadata and update policy\r\n    useEffect(() => {\r\n        if (classList?.courseMetadata?.programType) {\r\n            setCurrentProgramType(classList.courseMetadata.programType);\r\n        }\r\n    }, [classList?.courseMetadata?.programType]);\r\n\r\n    // Prefetch policies for better UX\r\n    useEffect(() => {\r\n        const programTypes = ['degree', 'diploma', 'certificate', 'graduateCertificate', 'apprenticeship', 'healthScience', 'gasTechnician'];\r\n        programTypes.forEach(type => {\r\n            if (type !== currentProgramType) {\r\n                prefetchPolicyForProgram(type);\r\n            }\r\n        });\r\n    }, [currentProgramType, prefetchPolicyForProgram]);\r\n\r\n    // Enhanced handler to change the program type for grading with policy loading\r\n    const handleProgramTypeChange = (e) => {\r\n        const newType = e.target.value;\r\n        setCurrentProgramType(newType);\r\n        setClassList(prev => ({\r\n            ...prev,\r\n            courseMetadata: {\r\n                ...prev.courseMetadata,\r\n                programType: newType,\r\n            },\r\n        }));\r\n    };\r\n\r\n    // Helper function for status display (preserved exactly from original)\r\n    const getStatusDisplay = (progress, studentId) => {\r\n        const gradeStatus = getGradeStatus(studentId);\r\n\r\n        if (gradeStatus === 'final') {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <CheckCircle className=\"w-4 h-4 text-green-600\" />\r\n                    <span className=\"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium\">\r\n                        Final\r\n                    </span>\r\n                </div>\r\n            );\r\n        } else if (gradeStatus === 'draft') {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <Clock className=\"w-4 h-4 text-yellow-600\" />\r\n                    <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-medium\">\r\n                        Draft\r\n                    </span>\r\n                </div>\r\n            );\r\n        } else if (progress?.status === 'in-progress') {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-medium\">\r\n                        In Progress\r\n                    </span>\r\n                </div>\r\n            );\r\n        } else {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-4 h-4 bg-gray-300 rounded-full\"></div>\r\n                    <span className=\"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full\">\r\n                        Not Started\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n    };\r\n\r\n    // Helper function to finalize a draft grade (preserved exactly from original)\r\n    const finalizeGrade = (studentId) => {\r\n        const draftData = drafts[studentId];\r\n        if (draftData) {\r\n            saveFinalGrade(studentId, draftData);\r\n\r\n            // Update class list progress\r\n            const studentIndex = classList.students.findIndex(s => s.id === studentId);\r\n            if (studentIndex >= 0) {\r\n                const updatedProgress = [...classList.gradingProgress];\r\n                updatedProgress[studentIndex] = {\r\n                    ...updatedProgress[studentIndex],\r\n                    status: 'completed_final',\r\n                    lastModified: new Date().toISOString(),\r\n                    gradeType: 'final'\r\n                };\r\n                setClassList(prev => ({\r\n                    ...prev,\r\n                    gradingProgress: updatedProgress\r\n                }));\r\n            }\r\n        }\r\n    };\r\n\r\n    // Helper function to unlock a final grade (preserved exactly from original)\r\n    const unlockGrade = (studentId) => {\r\n        // For now, we'll implement this by updating the class list progress\r\n        // The actual unlocking logic should be implemented in SharedContext\r\n        const studentIndex = classList.students.findIndex(s => s.id === studentId);\r\n        if (studentIndex >= 0) {\r\n            const updatedProgress = [...classList.gradingProgress];\r\n            updatedProgress[studentIndex] = {\r\n                ...updatedProgress[studentIndex],\r\n                status: 'completed_draft',\r\n                lastModified: new Date().toISOString(),\r\n                gradeType: 'draft'\r\n            };\r\n            setClassList(prev => ({\r\n                ...prev,\r\n                gradingProgress: updatedProgress\r\n            }));\r\n        }\r\n\r\n        // Note: Full unlock functionality requires additional implementation in SharedContext\r\n        console.log('Unlock grade for student:', studentId);\r\n    };\r\n\r\n    // Helper function to load final grade data (preserved exactly from original)\r\n    const loadFinalGradeData = (studentId) => {\r\n        // Use loadFinalGrade if available, otherwise fallback to checking finalGrades directly\r\n        if (typeof loadFinalGrade === 'function') {\r\n            return loadFinalGrade(studentId);\r\n        }\r\n        // Fallback: check finalGrades directly if available\r\n        if (finalGrades && finalGrades[studentId]) { // FIX: Corrected 'finalGrdes' to 'finalGrades'\r\n            return finalGrades[studentId];\r\n        }\r\n        // Last resort: check drafts (this maintains current behavior)\r\n        return drafts[studentId] || null;\r\n    };\r\n\r\n    // **ENHANCED**: This function now uses dynamic grading with fallback to legacy calculation\r\n    const calculateStudentGrade = async (studentId) => {\r\n        const gradeStatus = getGradeStatus(studentId);\r\n        let gradeData = null;\r\n\r\n        if (gradeStatus === 'final') {\r\n            gradeData = loadFinalGradeData(studentId);\r\n        } else if (gradeStatus === 'draft') {\r\n            gradeData = loadDraft(studentId);\r\n        }\r\n\r\n        // The grade calculation relies on having the student's saved grade data AND the rubric structure.\r\n        // If any part is missing, we can't calculate the grade.\r\n        if (!gradeData || !gradeData.rubricGrading || !sharedRubric || !sharedRubric.criteria || !sharedRubric.rubricLevels) {\r\n            return { score: 'N/A', maxPossible: 'N/A', percentage: 'N/A', letterGrade: 'N/A' };\r\n        }\r\n\r\n        let totalScore = 0;\r\n        let maxPossible = 0;\r\n\r\n        // Correctly calculate score based on criterion points and level multipliers\r\n        sharedRubric.criteria.forEach(criterion => {\r\n            const gradingSelection = gradeData.rubricGrading[criterion.id];\r\n            const criterionMaxPoints = Number(criterion.maxPoints) || 0;\r\n            maxPossible += criterionMaxPoints;\r\n\r\n            if (gradingSelection && gradingSelection.selectedLevel) {\r\n                const levelData = sharedRubric.rubricLevels.find(l => l.level === gradingSelection.selectedLevel);\r\n                if (levelData) {\r\n                    const levelMultiplier = Number(levelData.multiplier) || 0;\r\n                    totalScore += criterionMaxPoints * levelMultiplier;\r\n                }\r\n            }\r\n        });\r\n\r\n        // Apply late penalty if applicable\r\n        if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\r\n            const latePenalties = { within24: 0.8, after24: 0.0 };\r\n            const multiplier = latePenalties[gradeData.latePolicy.level] || 1.0;\r\n            totalScore *= multiplier;\r\n        }\r\n\r\n        const numericScore = Math.round(totalScore * 10) / 10;\r\n        const maxScore = Math.round(maxPossible * 10) / 10;\r\n        const percentage = maxScore > 0 ? Math.round((numericScore / maxScore) * 100) : 0;\r\n\r\n        // Use enhanced getLetterGrade with dynamic policy support\r\n        const letterGrade = await getLetterGrade(\r\n            percentage,\r\n            classList.courseMetadata?.programType || 'degree',\r\n            classList.courseMetadata?.customProgramId,\r\n            selectedPolicy\r\n        );\r\n\r\n        return {\r\n            score: numericScore,\r\n            maxPossible: maxScore,\r\n            percentage,\r\n            letterGrade\r\n        };\r\n    };\r\n\r\n    // Helper function to load student for grading (preserved exactly from original)\r\n    const loadStudentForGrading = (student) => {\r\n        const gradeStatus = getGradeStatus(student.id);\r\n\r\n        // Set the current student first\r\n        setCurrentStudent(student);\r\n\r\n        // Load the student info into the grading form\r\n        updateStudentInfo({\r\n            name: student.name,\r\n            id: student.id,\r\n            email: student.email\r\n        });\r\n\r\n        // Load rubric assignment info if available\r\n        if (sharedRubric) {\r\n            updateAssignmentInfo({\r\n                name: sharedRubric.assignmentInfo?.title || '',\r\n                maxPoints: sharedRubric.assignmentInfo?.totalPoints || 100\r\n            });\r\n        }\r\n\r\n        // Provide user feedback and load appropriate data\r\n        if (gradeStatus === 'final') {\r\n            const finalData = loadFinalGradeData(student.id);\r\n            console.log(`Loading final grade for ${student.name}:`, finalData ? 'Found' : 'Not found');\r\n        } else if (gradeStatus === 'draft') {\r\n            const draftData = loadDraft(student.id);\r\n            console.log(`Loading draft for ${student.name}:`, draftData ? 'Found' : 'Not found');\r\n        } else {\r\n            console.log(`Starting new grade for ${student.name}`);\r\n        }\r\n\r\n        // Switch to grading tool - the GradingTemplate useEffect will handle loading the data\r\n        setActiveTab('grading-tool');\r\n\r\n        // Note: The actual data loading happens in GradingTemplate's useEffect for currentStudent\r\n    };\r\n\r\n    // Helper function to get grading progress statistics (preserved exactly from original)\r\n    const getGradingProgress = () => {\r\n        if (!classList) return { completed: 0, total: 0, percentage: 0, final: 0, draft: 0 };\r\n\r\n        const final = classList.gradingProgress.filter(p =>\r\n            p.status?.startsWith('completed_final')\r\n        ).length;\r\n\r\n        const draft = classList.gradingProgress.filter(p =>\r\n            p.status?.startsWith('completed_draft')\r\n        ).length;\r\n\r\n        const completed = final + draft;\r\n        const total = classList.students.length;\r\n        const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\r\n\r\n        return { completed, total, percentage, final, draft };\r\n    };\r\n\r\n    // ‚îÄ‚îÄ Build a portrait-friendly Class Grade Report ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\r\n    const getPortraitClassReportHTML = () => {\r\n        const now = new Date();\r\n        const currentDate = now.toLocaleDateString('en-CA');  // YYYY-MM-DD\r\n        const currentTime = now.toLocaleTimeString('en-CA');\r\n        // Grab the rubric title from context\r\n        const rubricName = sharedRubric?.assignmentInfo?.title || 'Unnamed Rubric';\r\n        // Calculate grades\r\n        const rowsHtml = classList.students.map((student, idx) => {\r\n            const info = calculateStudentGrade(student.id);\r\n            const num = info.score !== 'N/A'\r\n                ? `${info.score}/${info.maxPossible}`\r\n                : 'N/A';\r\n            return `\r\n      <tr>\r\n        <td>${idx + 1}</td>\r\n        <td>${student.id}</td>\r\n        <td>${student.name}</td>\r\n        <td>${num}</td>\r\n        <td>${info.letterGrade || 'N/A'}</td>\r\n        <td>${info.percentage !== 'N/A' ? info.percentage + '%' : 'N/A'}</td>\r\n      </tr>`;\r\n        }).join('');\r\n\r\n        return `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title>Portrait Class Report</title>\r\n  <style>\r\n  /* Force portrait layout with small margins */\r\n  @page {\r\n    size: A4 portrait;\r\n    margin: 15mm;\r\n  }\r\n\r\n  /* Global resets */\r\n  *, *::before, *::after {\r\n    box-sizing: border-box;\r\n  }\r\n  body {\r\n    margin: 0;\r\n    padding: 0;\r\n    font-family: sans-serif;\r\n    font-size: 12px;\r\n    line-height: 1.4;\r\n    color: #333;\r\n    background: white;\r\n  }\r\n\r\n  /* Header */\r\n  .header {\r\n    text-align: center;\r\n    margin-bottom: 8px;\r\n  }\r\n  .header h1 {\r\n    font-size: 18px;\r\n    margin: 4px 0;\r\n  }\r\n  .header .meta {\r\n    font-size: 14px;\r\n    color: #555;\r\n  }\r\n\r\n  /* Container to allow horizontal scroll if needed */\r\n  .table-container {\r\n    width: 100%;\r\n    overflow-x: auto;\r\n  }\r\n\r\n  /* Main table */\r\n  table {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n    table-layout: fixed;             /* evenly distribute column widths */\r\n  }\r\n  thead {\r\n    display: table-header-group;     /* repeat header on each printed page */\r\n  }\r\n  tbody {\r\n    display: table-row-group;\r\n  }\r\n  th, td {\r\n  padding: 8px 12px;\r\n  text-align: left;\r\n  border-bottom: 1px solid #e5e7eb;\r\n\r\n  /* allow wrapping anywhere, even inside long words like emails */\r\n  white-space: normal;\r\n  word-wrap: break-word;        /* for legacy support */\r\n  overflow-wrap: anywhere;      /* modern browsers */\r\n  word-break: break-all;        /* if you really need to force breaks */\r\n  vertical-align: top;\r\n}\r\n\r\n  \r\n  tr:nth-child(even) td {\r\n    background-color: #fafafa;\r\n  }\r\n\r\n  /* Footer */\r\n  .footer {\r\n    margin-top: 12px;\r\n    font-size: 10px;\r\n    text-align: center;\r\n    color: #666;\r\n  }\r\n\r\n  /* Print tweaks */\r\n  @media print {\r\n    body {\r\n      background: white;\r\n    }\r\n    .table-container {\r\n      overflow-x: visible;\r\n    }\r\n  }\r\n</style>\r\n\r\n</head>\r\n<body>\r\n  <div class=\"header\">\r\n    <h1>Class Grade Report</h1>\r\n    <div class=\"meta\">\r\n      ${classList.courseMetadata?.courseCode || ''} ‚Äì\r\n      ${classList.courseMetadata?.courseName || ''} |\r\n      Section: ${classList.courseMetadata?.section || ''}<br>\r\n      Rubric: ${rubricName}\r\n      Generated: ${currentDate} ${currentTime}\r\n    </div>\r\n  </div>\r\n\r\n  <table>\r\n    <thead>\r\n      <tr>\r\n        <th style=\"width:4%\">#</th>\r\n        <th style=\"width:15%\">Student ID</th>\r\n        <th style=\"width:40%\">Name</th>\r\n        <th style=\"width:15%\">Numeric Grade</th>\r\n        <th style=\"width:12%\">Letter Grade</th>\r\n        <th style=\"width:14%\">%</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      ${rowsHtml}\r\n    </tbody>\r\n  </table>\r\n\r\n  <div class=\"footer\">\r\n    Imported from: ${classList.fileName}\r\n  </div>\r\n</body>\r\n</html>`;\r\n    };\r\n    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n\r\n    // ‚îÄ‚îÄ Generate the full HTML for class‚Äêgrades report ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\r\n    const getClassGradesHTML = () => {\r\n        const progress = getGradingProgress();\r\n        const currentDate = new Date().toLocaleDateString('en-US', {\r\n            weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'\r\n        });\r\n        const currentTime = new Date().toLocaleTimeString();\r\n\r\n        // ‚Äî‚Äî‚Äî Build all the <tr> rows with single‚Äêquoted strings ‚Äî no back‚Äêticks inside!  \r\n        const rowsHtml = classList.students.map((student, i) => {\r\n            const prog = classList.gradingProgress[i] || {};\r\n            const info = calculateStudentGrade(student.id);\r\n            const lm = prog.lastModified\r\n                ? new Date(prog.lastModified).toLocaleDateString()\r\n                : 'Never';\r\n            const statusClass = prog.status?.includes('final')\r\n                ? 'status-final'\r\n                : prog.status?.includes('draft')\r\n                    ? 'status-draft'\r\n                    : 'status-pending';\r\n\r\n            return (\r\n                '<tr>' +\r\n                '<td>' + (i + 1) + '</td>' +\r\n                '<td>' + student.id + '</td>' +\r\n                '<td>' + student.name + '</td>' +\r\n                '<td>' + student.email + '</td>' +\r\n                '<td>' + (student.program || '') + '</td>' +\r\n                '<td><span class=\"status-badge ' + statusClass + '\">' +\r\n                (prog.status || 'pending') +\r\n                '</span></td>' +\r\n                '<td>' + (prog.gradeType || 'none') + '</td>' +\r\n                '<td>' + (info.score !== 'N/A'\r\n                    ? info.score + '/' + info.maxPossible\r\n                    : 'N/A') + '</td>' +\r\n                '<td>' + (info.letterGrade || 'N/A') + '</td>' +\r\n                '<td>' + (info.percentage !== 'N/A'\r\n                    ? info.percentage + '%'\r\n                    : 'N/A') + '</td>' +\r\n                '<td>' + lm + '</td>' +\r\n                '</tr>'\r\n            );\r\n        }).join('');\r\n\r\n        // ‚Äî‚Äî‚Äî Now splice rowsHtml into one clean back‚Äêtick literal\r\n        return `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <title>Class Grade Report - ${classList.courseMetadata?.courseCode || ''}</title>\r\n  <style>\r\n    @page { size: A4 portrait; margin:15mm; }\r\n    *, *::before, *::after { box-sizing:border-box }\r\n    body { margin:0; padding:0; font-family:sans-serif; font-size:12px; line-height:1.4; color:#333; }\r\n    .header { text-align:center; margin-bottom:12px; }\r\n    .header h1 { font-size:18px; margin:4px 0; }\r\n    .header .meta { font-size:14px; color:#555; }\r\n    .table-container { width:100%; overflow-x:auto; margin-bottom:12px; }\r\n    table { width:100%; border-collapse:collapse; table-layout:fixed; }\r\n    thead { display:table-header-group; }\r\n    th, td {\r\n      padding:8px 12px; text-align:left; border-bottom:1px solid #e5e7eb;\r\n      white-space:normal; word-wrap:break-word; overflow-wrap:anywhere; word-break:break-all;\r\n      vertical-align:top;\r\n    }\r\n    th { background:#f0f0f0; font-weight:600; position:sticky; top:0; }\r\n    tr:nth-child(even) td { background:#fafafa; }\r\n    .footer { font-size:10px; text-align:center; color:#666; margin-top:12px; }\r\n    @media print { body{background:white} .table-container{overflow-x:visible} }\r\n  </style>\r\n</head>\r\n<body>\r\n  <div class=\"header\">\r\n    <h1>üìä Class Grade Report</h1>\r\n    <div class=\"meta\">\r\n      ${classList.courseMetadata?.courseCode || ''} ‚Äì ${classList.courseMetadata?.courseName || ''} |\r\n      Section: ${classList.courseMetadata?.section || ''}<br>\r\n      Rubric: ${sharedRubric?.assignmentInfo?.title || 'Unnamed Rubric'}<br>\r\n      Generated: ${currentDate} | ${currentTime}\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"table-container\">\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th>#</th><th>Student ID</th><th>Name</th><th>Email</th>\r\n          <th>Program</th><th>Status</th><th>Grade Type</th>\r\n          <th>Final Grade</th><th>Letter Grade</th><th>Percentage</th><th>Last Modified</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${rowsHtml}\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <div class=\"footer\">\r\n    Imported from: ${classList.fileName}\r\n  </div>\r\n</body>\r\n</html>`;\r\n    };\r\n\r\n    // Export class grades as CSV (preserved exactly from original)\r\n    const exportClassGradesCSV = () => {\r\n        if (!classList) return;\r\n\r\n        // 1) Build a 2D array where the first column is the row number\r\n        const rows = [\r\n            // now 11 headers instead of 10\r\n            ['#', 'Student ID', 'Student Name', 'Email', 'Program', 'Status', 'Grade Type', 'Numeric Grade', 'Letter Grade', 'Percentage', 'Last Modified'],\r\n            ...classList.students.map((student, index) => {\r\n                const progress = classList.gradingProgress[index] || {};\r\n                const gradeInfo = calculateStudentGrade(student.id);\r\n                const lm = progress.lastModified\r\n                    ? new Date(progress.lastModified).toLocaleDateString()\r\n                    : 'Never';\r\n\r\n                return [\r\n                    index + 1,                            // ‚Üê new \"#\" column\r\n                    student.id,\r\n                    student.name,\r\n                    student.email,\r\n                    student.program || 'N/A',\r\n                    progress.status || 'pending',\r\n                    progress.gradeType || 'none',\r\n                    gradeInfo.score !== 'N/A'\r\n                        ? `${gradeInfo.score}/${gradeInfo.maxPossible}`\r\n                        : 'N/A',\r\n                    gradeInfo.letterGrade || 'N/A',\r\n                    gradeInfo.percentage !== 'N/A'\r\n                        ? `${gradeInfo.percentage}%`\r\n                        : 'N/A',\r\n                    lm\r\n                ];\r\n            })\r\n        ];\r\n\r\n        // 2) Quote each cell (handles commas/quotes in names, etc.)\r\n        const quote = cell => `\"${String(cell).trim().replace(/\"/g, '\"\"')}\"`;\r\n\r\n        // 3) Join into a CSV string with CRLFs\r\n        const csvContent = rows\r\n            .map(row => row.map(quote).join(','))\r\n            .join('\\r\\n');\r\n\r\n        // 4) Trigger download (unchanged)\r\n        const blob = new Blob([csvContent], { type: 'text/csv' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = `${classList.courseMetadata?.courseCode || 'class'}_grades_${new Date().toISOString().slice(0, 10)}.csv`;\r\n        link.click();\r\n        URL.revokeObjectURL(url);\r\n    };\r\n\r\n    // ‚îÄ‚îÄ Export class grades as HTML via download ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\r\n    const exportClassGradesHTML = () => {\r\n        if (!classList) return;\r\n\r\n        const htmlContent = getClassGradesHTML();\r\n        const blob = new Blob([htmlContent], { type: 'text/html' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n\r\n        link.href = url;\r\n        link.download = `${classList.courseMetadata?.courseCode || 'Class'}_grades.html`;\r\n        link.style.display = 'none';\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n\r\n        URL.revokeObjectURL(url);\r\n    };\r\n    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n\r\n    // ‚îÄ‚îÄ Export Class Grades as a portrait PDF ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (preserved exactly)\r\n    const exportClassGradesPortraitPDF = () => {\r\n        if (!classList) return;\r\n\r\n        // Open a new window with our portrait HTML\r\n        const printWin = window.open('', '_blank', 'width=800,height=600');\r\n        printWin.document.write(getPortraitClassReportHTML());\r\n        printWin.document.close();\r\n        printWin.focus();\r\n\r\n        // When it loads, trigger the print dialog\r\n        printWin.onload = () => {\r\n            printWin.print();\r\n            // Optionally close after printing:\r\n            // printWin.close();\r\n        };\r\n    };\r\n    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n\r\n    // Complete exportStudentGrade function for ClassListManager.js (preserved exactly from original)\r\n    const exportStudentGrade = (studentId) => {\r\n        // 1. Make sure we have a classList and sharedRubric\r\n        if (!classList || !sharedRubric) {\r\n            alert('No class list or rubric available. Please ensure both are loaded.');\r\n            return;\r\n        }\r\n\r\n        // 2. Find the student in the class list\r\n        const student = classList.students.find(s => s.id === studentId);\r\n        if (!student) {\r\n            alert('Student not found in class list.');\r\n            return;\r\n        }\r\n\r\n        // 3. Load the student's grade data\r\n        const gradeStatus = getGradeStatus(studentId);\r\n        let gradeData = null;\r\n\r\n        if (gradeStatus === 'final') {\r\n            gradeData = loadFinalGradeData(studentId);\r\n        } else if (gradeStatus === 'draft') {\r\n            gradeData = loadDraft(studentId);\r\n        } else {\r\n            alert('No grade data found for this student. Please grade the student first.');\r\n            return;\r\n        }\r\n\r\n        if (!gradeData) {\r\n            alert('Unable to load grade data for this student.');\r\n            return;\r\n        }\r\n\r\n        // 4. Late Policy Levels (same as in GradingTemplate.js)\r\n        const latePolicyLevels = {\r\n            none: {\r\n                name: 'On Time',\r\n                multiplier: 1.0,\r\n                description: 'Assignment submitted on or before due date and time - marked out of 100%',\r\n                color: '#16a34a'\r\n            },\r\n            within24: {\r\n                name: '1-24 Hours Late',\r\n                multiplier: 0.8,\r\n                description: 'Assignment received within 24 hours of due date - 20% reduction (marked out of 80%)',\r\n                color: '#ea580c'\r\n            },\r\n            after24: {\r\n                name: 'More than 24 Hours Late',\r\n                multiplier: 0.0,\r\n                description: 'Assignment received after 24 hours from due date - mark of zero (0)',\r\n                color: '#dc2626'\r\n            }\r\n        };\r\n\r\n        // 5. Calculate scores (replicated from GradingTemplate.js)\r\n        const calculateTotalScore = () => {\r\n            if (!sharedRubric || !gradeData.rubricGrading) {\r\n                return { finalScore: 0, rawScore: 0, penaltyApplied: false };\r\n            }\r\n\r\n            let totalScore = 0;\r\n            const totalPossible = sharedRubric.assignmentInfo.totalPoints;\r\n\r\n            sharedRubric.criteria.forEach(criterion => {\r\n                const rubricGrading = gradeData.rubricGrading[criterion.id];\r\n                if (rubricGrading && rubricGrading.selectedLevel) {\r\n                    const level = sharedRubric.rubricLevels.find(l => l.level === rubricGrading.selectedLevel);\r\n                    if (level) {\r\n                        const points = criterion.maxPoints * level.multiplier;\r\n                        totalScore += points;\r\n                    }\r\n                }\r\n            });\r\n\r\n            const rawScore = totalScore;\r\n            let finalScore = totalScore;\r\n            let penaltyApplied = false;\r\n\r\n            // Apply late penalty if applicable\r\n            if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\r\n                const latePolicyLevel = latePolicyLevels[gradeData.latePolicy.level];\r\n                if (latePolicyLevel) {\r\n                    finalScore = totalScore * latePolicyLevel.multiplier;\r\n                    penaltyApplied = true;\r\n                }\r\n            }\r\n\r\n            return { finalScore, rawScore, penaltyApplied };\r\n        };\r\n\r\n        // 6. Generate HTML report (based on GradingTemplate.js generateStudentReportHTML)\r\n        const generateStudentReportHTML = () => {\r\n            const scoreCalculation = calculateTotalScore();\r\n            const totalScore = scoreCalculation.finalScore;\r\n            const rawScore = scoreCalculation.rawScore;\r\n            const maxPoints = sharedRubric.assignmentInfo.totalPoints;\r\n            const percentage = ((totalScore / (maxPoints || 1)) * 100).toFixed(1);\r\n            const penaltyApplied = scoreCalculation.penaltyApplied;\r\n\r\n            // Generate attachments HTML\r\n            const attachmentsHTML = gradeData.attachments?.map((att, index) => {\r\n                if (att.base64Data) {\r\n                    return `<div class=\"attachment-item\"><img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"clickable-image\" data-index=\"${index}\" style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" /><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div><div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div></div>`;\r\n                } else {\r\n                    return `<div class=\"attachment-item\"><div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">üìÑ</div><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div></div>`;\r\n                }\r\n            }).join('') || '';\r\n\r\n            // Generate video links HTML\r\n            const videoLinksHTML = gradeData.videoLinks?.map(link =>\r\n                `<div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\"><div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\"><span style=\"font-size: 1.25rem;\">üé•</span><strong style=\"color: #495057;\">${link.title}</strong></div><a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">${link.url}</a></div>`\r\n            ).join('') || '';\r\n\r\n            // Generate rubric table HTML\r\n            const rubricTableHTML = sharedRubric ? `\r\n            <div style=\"margin: 30px 0;\">\r\n                <h3>üìä Detailed Rubric Assessment</h3>\r\n                <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9rem;\">\r\n                    <thead>\r\n                        <tr style=\"background: #f8f9fa;\">\r\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th>\r\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 120px;\">Level Achieved</th>\r\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 80px;\">Points</th>\r\n                            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Details & Comments</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        ${sharedRubric.criteria.map(criterion => {\r\n                const rubricGrading = gradeData.rubricGrading?.[criterion.id];\r\n                const selectedLevel = rubricGrading?.selectedLevel;\r\n                const level = selectedLevel ? sharedRubric.rubricLevels.find(l => l.level === selectedLevel) : null;\r\n                const points = level ? Math.round(criterion.maxPoints * level.multiplier * 10) / 10 : 0;\r\n                const levelDescription = level && criterion.levels?.[selectedLevel]?.description ? criterion.levels[selectedLevel].description : '';\r\n                const additionalComments = rubricGrading?.customComments || '';\r\n\r\n                return `<tr>\r\n                                <td style=\"border: 1px solid #ddd; padding: 12px; vertical-align: top;\">\r\n                                    <strong>${criterion.name}</strong><br>\r\n                                    <small style=\"color: #666;\">${criterion.description || ''}</small><br>\r\n                                    <small style=\"color: #888;\">Max Points: ${criterion.maxPoints}</small>\r\n                                </td>\r\n                                <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; vertical-align: top;\">\r\n                                    <span style=\"display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; background: ${level?.color || '#f0f0f0'}; color: white;\">\r\n                                        ${level?.name || 'Not Assessed'}\r\n                                    </span>\r\n                                </td>\r\n                                <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td>\r\n                                <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\r\n                                    ${levelDescription ? `<div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\"><strong style=\"color: ${level.color};\">Level Description:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span></div>` : ''}\r\n                                    ${additionalComments ? `<div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\"><strong style=\"color: #856404;\">Additional Comments:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span></div>` : ''}\r\n                                    ${(!levelDescription && !additionalComments) ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}\r\n                                </td>\r\n                            </tr>`;\r\n            }).join('')}\r\n                    </tbody>\r\n                </table>\r\n                <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\">\r\n                    <h4 style=\"color: #2e7d32; margin-bottom: 10px;\">üìä Rubric Score Summary</h4>\r\n                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\r\n                        <div><strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br><strong>Percentage:</strong> ${percentage}%</div>\r\n                        <div><strong>Grade Status:</strong><span style=\"color: ${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '‚úì PASSING' : '‚úó NEEDS IMPROVEMENT'}</span></div>\r\n                        ${penaltyApplied ? `<div style=\"color: #ff9800;\"><strong>Late Penalty Applied:</strong><br>Raw Score: ${Math.round(rawScore * 10) / 10}</div>` : ''}\r\n                    </div>\r\n                </div>\r\n            </div>` : '';\r\n\r\n            // Complete HTML document\r\n            const htmlContent = `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Grade Report - ${student.name}</title>\r\n    <style>\r\n        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; line-height: 1.6; }\r\n        .header { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; }\r\n        .score-summary { background: #e8f5e8; border: 2px solid #4caf50; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center; }\r\n        .late-policy-section { margin: 30px 0; background: #fff5f5; border: 1px solid #f87171; border-radius: 8px; padding: 20px; }\r\n        .feedback-section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 8px; }\r\n        .attachments { margin: 30px 0; }\r\n        .attachment-item { display: inline-block; text-align: center; margin: 1rem; padding: 1rem; background: #fff; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,.1); max-width: 250px; vertical-align: top; }\r\n        .clickable-image { cursor: pointer; transition: all .3s ease; position: relative; }\r\n        .clickable-image:hover { transform: scale(1.05); box-shadow: 0 4px 8px rgba(0,0,0,.2); }\r\n        .video-links { margin: 30px 0; }\r\n        .video-link-item { margin-bottom: 1rem; }\r\n        .video-link-item a { color: #007bff; text-decoration: none; }\r\n        .video-link-item a:hover { text-decoration: underline; }\r\n        h1, h2, h3 { color: #333; }\r\n        .image-modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,.9); animation: fadeIn .3s ease; }\r\n        .image-modal.show { display: flex; align-items: center; justify-content: center; }\r\n        .modal-content { max-width: 95%; max-height: 95%; object-fit: contain; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,.5); animation: zoomIn .3s ease; }\r\n        .close-modal { position: absolute; top: 20px; right: 30px; color: #fff; font-size: 40px; font-weight: 700; cursor: pointer; z-index: 1001; background: rgba(0,0,0,.5); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; line-height: 1; }\r\n        .close-modal:hover { background: rgba(0,0,0,.8); }\r\n        .modal-caption { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: #fff; background: rgba(0,0,0,.7); padding: 10px 20px; border-radius: 6px; text-align: center; max-width: 80%; }\r\n        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\r\n        @keyframes zoomIn { from { transform: scale(.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }\r\n        @media print { .attachment-item, .video-link-item { break-inside: avoid; } .image-modal { display: none!important; } }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <h1>üìã Grade Report</h1>\r\n        <p><strong>Student:</strong> ${student.name} (${student.id})</p>\r\n        <p><strong>Course:</strong> ${gradeData.course?.code || classList.courseMetadata?.courseCode || ''} - ${gradeData.course?.name || classList.courseMetadata?.courseName || ''}</p>\r\n        <p><strong>Assignment:</strong> ${gradeData.assignment?.name || sharedRubric.assignmentInfo?.title || ''}</p>\r\n        <p><strong>Instructor:</strong> ${gradeData.course?.instructor || classList.courseMetadata?.instructor || ''}</p>\r\n        <p><strong>Term:</strong> ${gradeData.course?.term || classList.courseMetadata?.term || ''}</p>\r\n    </div>\r\n\r\n    <div class=\"score-summary\">\r\n        <h2>üìä Final Score</h2>\r\n        <div style=\"font-size: 2rem; font-weight: 700; color: #2e7d32; margin: 15px 0;\">\r\n            ${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)\r\n        </div>\r\n        <p style=\"margin: 10px 0; color: #555;\">\r\n            ${sharedRubric ? `Rubric: ${sharedRubric.assignmentInfo.title}` : \"\"}\r\n            ${penaltyApplied ? ` | Late Policy: ${latePolicyLevels[gradeData.latePolicy.level].name}` : \"\"}\r\n        </p>\r\n    </div>\r\n\r\n    ${penaltyApplied ? `\r\n        <div class=\"late-policy-section\">\r\n            <h3 style=\"color: #dc2626;\">üìÖ Late Submission Policy Applied</h3>\r\n            <p><strong>Policy Status:</strong> ${latePolicyLevels[gradeData.latePolicy.level].name}</p>\r\n            <p>${latePolicyLevels[gradeData.latePolicy.level].description}</p>\r\n            <p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} ‚Üí <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\r\n        </div>\r\n    ` : \"\"}\r\n\r\n    ${rubricTableHTML}\r\n\r\n    ${Object.entries(gradeData.feedback || {}).filter(([key, text]) => text).map(([key, text]) => `\r\n        <div class=\"feedback-section\">\r\n            <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\r\n            <p>${text.replace(/\\n/g, \"<br>\")}</p>\r\n        </div>\r\n    `).join(\"\")}\r\n\r\n    ${attachmentsHTML ? `\r\n        <div class=\"attachments\">\r\n            <h3>üìé File Attachments</h3>\r\n            <div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">\r\n                ${attachmentsHTML}\r\n            </div>\r\n        </div>\r\n    ` : \"\"}\r\n\r\n    ${videoLinksHTML ? `\r\n        <div class=\"video-links\">\r\n            <h3>üé• Video Review Links</h3>\r\n            ${videoLinksHTML}\r\n        </div>\r\n    ` : \"\"}\r\n\r\n    <p style=\"margin-top: 40px; text-align: center; color: #666; font-size: .9rem;\">\r\n        Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}\r\n    </p>\r\n\r\n    <div id=\"imageModal\" class=\"image-modal\">\r\n        <span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span>\r\n        <img class=\"modal-content\" id=\"modalImage\">\r\n        <div class=\"modal-caption\" id=\"modalCaption\"></div>\r\n    </div>\r\n\r\n    <script>\r\n        const attachmentData = ${JSON.stringify(gradeData.attachments || [])};\r\n        \r\n        function openImageModal(src, caption) {\r\n            const modal = document.getElementById(\"imageModal\");\r\n            const modalImg = document.getElementById(\"modalImage\");\r\n            const modalCaption = document.getElementById(\"modalCaption\");\r\n            modal.classList.add(\"show\");\r\n            modalImg.src = src;\r\n            modalCaption.textContent = caption;\r\n            document.body.style.overflow = \"hidden\";\r\n        }\r\n        \r\n        function closeImageModal() {\r\n            document.getElementById(\"imageModal\").classList.remove(\"show\");\r\n            document.body.style.overflow = \"auto\";\r\n        }\r\n        \r\n        document.addEventListener(\"DOMContentLoaded\", function() {\r\n            document.querySelectorAll(\".clickable-image\").forEach(img => {\r\n                img.addEventListener(\"click\", function() {\r\n                    const index = parseInt(this.getAttribute(\"data-index\"));\r\n                    const attachment = attachmentData[index];\r\n                    if (attachment && attachment.base64Data) {\r\n                        openImageModal(attachment.base64Data, attachment.name);\r\n                    }\r\n                });\r\n            });\r\n            \r\n            document.getElementById(\"imageModal\").addEventListener(\"click\", function(e) {\r\n                if (e.target === this) {\r\n                    closeImageModal();\r\n                }\r\n            });\r\n            \r\n            document.addEventListener(\"keydown\", function(e) {\r\n                if (e.key === \"Escape\") {\r\n                    closeImageModal();\r\n                }\r\n            });\r\n        });\r\n    </script>\r\n</body>\r\n</html>`;\r\n\r\n            return htmlContent;\r\n        };\r\n\r\n        // 7. Generate and export the HTML file\r\n        try {\r\n            const htmlContent = generateStudentReportHTML();\r\n            const htmlBlob = new Blob([htmlContent], { type: 'text/html' });\r\n            const url = URL.createObjectURL(htmlBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `grade_report_${student.name.replace(/[^a-zA-Z0-9]/g, '_')}_${sharedRubric.assignmentInfo?.title?.replace(/[^a-zA-Z0-9]/g, '_') || 'assignment'}.html`;\r\n            link.click();\r\n            URL.revokeObjectURL(url);\r\n\r\n            console.log(`‚úÖ Individual grade report exported for student: ${student.name}`);\r\n        } catch (error) {\r\n            console.error('Error generating individual grade report:', error);\r\n            alert('Error generating grade report. Please check the console for details.');\r\n        }\r\n    };\r\n\r\n    // File upload handling (preserved exactly from original)\r\n    const handleFileUpload = async (event) => {\r\n        const file = event.target.files[0];\r\n        if (!file) return;\r\n\r\n        setImportStatus('processing');\r\n\r\n        try {\r\n            // Use Excel parser instead of manual CSV parsing\r\n            const result = await parseExcelFile(file);\r\n\r\n            if (!result.success) {\r\n                throw new Error(result.error || 'Failed to parse Excel file');\r\n            }\r\n\r\n            // Validate the parsed student data\r\n            const validation = validateStudentData(result.students);\r\n\r\n            if (result.students.length === 0) {\r\n                throw new Error('No valid student records found in Excel file');\r\n            }\r\n\r\n            // Create grading progress tracking for each student\r\n            const gradingProgress = result.students.map(() => ({\r\n                status: 'pending',\r\n                lastModified: null,\r\n                gradeType: null\r\n            }));\r\n\r\n            const classListData = {\r\n                students: result.students,\r\n                gradingProgress,\r\n                fileName: file.name,\r\n                fileSize: file.size,\r\n                importTime: new Date().toISOString(),\r\n                // Now include \"instructor\" (falls back to 'TBD' if none)\r\n                courseMetadata: {\r\n                    courseCode: result.courseMetadata?.courseCode || 'IMPORTED',\r\n                    courseName: result.courseMetadata?.courseName || 'Excel Import',\r\n                    section: result.courseMetadata?.section || 'DEFAULT',\r\n                    programType: result.courseMetadata?.programType || 'degree', // e.g. 'degree' | 'diploma' | 'certificate'\r\n                    // ‚Üê Try .instructor first, then .professors (your Excel parser writes the names there)\r\n                    instructor: result.courseMetadata?.instructor // if you manually had an \"Instructor\" column\r\n                        ||\r\n                        result.courseMetadata?.professors // fall back to your \"Professors\" column\r\n                        ||\r\n                        'TBD',\r\n                    term: result.courseMetadata?.term || 'TBD'\r\n                },\r\n                validation: {\r\n                    validationScore: validation.validationScore || 100,\r\n                    issues: validation.issues || []\r\n                }\r\n            };\r\n\r\n            setClassList(classListData);\r\n            setImportStatus('success');\r\n\r\n            setTimeout(() => setImportStatus(''), 3000);\r\n        } catch (error) {\r\n            console.error('Excel import error:', error);\r\n            setImportStatus('error');\r\n            setTimeout(() => setImportStatus(''), 3000);\r\n        }\r\n    };\r\n\r\n    // Session management functions (preserved exactly from original)\r\n    const startGradingSession = () => {\r\n        if (!classList || classList.students.length === 0) {\r\n            alert('No students available for grading.');\r\n            return;\r\n        }\r\n\r\n        if (!sharedRubric) {\r\n            alert('Please load a rubric before starting batch grading.');\r\n            return;\r\n        }\r\n\r\n        // Initialize the grading session (this will set up the first student)\r\n        const success = initializeGradingSession(classList);\r\n        if (success) {\r\n            setActiveTab('grading-tool');\r\n        }\r\n    };\r\n\r\n    // Pause the grading session\r\n    const pauseGradingSession = () => {\r\n        setGradingSession(prev => ({\r\n            ...prev,\r\n            active: false\r\n        }));\r\n    };\r\n\r\n    // Resume the grading session\r\n    const resumeGradingSession = () => {\r\n        setGradingSession(prev => ({\r\n            ...prev,\r\n            active: true\r\n        }));\r\n        setActiveTab('grading-tool');\r\n    };\r\n\r\n    // NEW: Policy Preview Component\r\n    const PolicyPreview = ({ policy }) => {\r\n        if (!policy) return null;\r\n\r\n        return (\r\n            <div className=\"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                <h4 className=\"font-semibold text-blue-800 mb-2 text-sm\">\r\n                    üìã Active Grading Policy: {policy.name}\r\n                </h4>\r\n                <p className=\"text-xs text-blue-700 mb-2\">{policy.description}</p>\r\n\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-1 text-xs\">\r\n                    {policy.gradeScale?.slice(0, 4).map((grade, index) => (\r\n                        <div key={index} className=\"bg-white p-1 rounded border text-center\">\r\n                            <div className=\"font-bold text-blue-800\">{grade.letter}</div>\r\n                            <div className=\"text-blue-600\">{grade.minPercentage}%+</div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {policy.gradeScale?.length > 4 && (\r\n                    <div className=\"text-xs text-blue-600 mt-1\">\r\n                        ...and {policy.gradeScale.length - 4} more grades\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    // Enhanced program type dropdown with policy support\r\n    const renderEnhancedProgramTypeDropdown = () => {\r\n        const programTypes = gradingPolicyService.getSupportedProgramTypes();\r\n\r\n        return (\r\n            <div>\r\n                <label htmlFor=\"programType\" className=\"block text-sm font-bold text-gray-700\">Program Type:</label>\r\n                <select\r\n                    id=\"programType\"\r\n                    name=\"programType\"\r\n                    value={classList.courseMetadata?.programType || 'degree'}\r\n                    onChange={handleProgramTypeChange}\r\n                    className=\"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\r\n                >\r\n                    {programTypes.map(type => (\r\n                        <option key={type.value} value={type.value}>\r\n                            {type.label}\r\n                        </option>\r\n                    ))}\r\n                </select>\r\n\r\n                {/* Policy Preview */}\r\n                {selectedPolicy && <PolicyPreview policy={selectedPolicy} />}\r\n\r\n                {/* Policy Loading Indicator */}\r\n                {(policiesLoading || gradeCalculation.isPending) && (\r\n                    <div className=\"flex items-center gap-2 text-blue-600 mt-2\">\r\n                        <div className=\"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\r\n                        <span className=\"text-xs\">\r\n                            {policiesLoading ? 'Loading grading policies...' : 'Calculating grade...'}\r\n                        </span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50\">\r\n            <div className=\"max-w-7xl mx-auto\">\r\n                {/* Header (preserved exactly from original) */}\r\n                <div className=\"bg-gradient-to-r text-gray-800 p-6 rounded-t-lg shadow-lg\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                        <div>\r\n                            <h1 className=\"text-3xl font-bold mb-2\">Class List Manager</h1>\r\n                            <p className=\"text-gray-600\">\r\n                                Import, manage, and grade entire classes efficiently\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-4\">\r\n                            {classList && (\r\n                                <div className=\"text-right\">\r\n                                    <div className=\"text-2xl font-bold\">\r\n                                        {classList.students.length}\r\n                                    </div>\r\n                                    <div className=\"text-sm text-gray-700\">\r\n                                        Students\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                            <Users size={48} className=\"text-gray-700\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white rounded-b-lg shadow-lg\">\r\n                    {/* Import Section (preserved exactly from original) */}\r\n                    {!classList && (\r\n                        <div className=\"p-8\">\r\n                            <div className=\"max-w-2xl mx-auto text-center\">\r\n                                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-8 mb-6\">\r\n                                    <FileSpreadsheet size={48} className=\"mx-auto text-blue-600 mb-4\" />\r\n                                    <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">\r\n                                        Import Student List\r\n                                    </h2>\r\n                                    <p className=\"text-gray-600 mb-6\">\r\n                                        Upload an Excel file (.xls or .xlsx) containing your student roster to begin class management.\r\n                                    </p>\r\n\r\n                                    <input\r\n                                        ref={fileInputRef}\r\n                                        type=\"file\"\r\n                                        accept=\".xls,.xlsx\"\r\n                                        onChange={handleFileUpload}\r\n                                        className=\"hidden\"\r\n                                    />\r\n\r\n                                    <button\r\n                                        onClick={() => fileInputRef.current?.click()}\r\n                                        disabled={importStatus === 'processing'}\r\n                                        className=\"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium transition-colors inline-flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                    >\r\n                                        <FileSpreadsheet size={20} />\r\n                                        {importStatus === 'processing' ? 'Processing...' : 'Choose Excel File'}\r\n                                    </button>\r\n\r\n                                    {importStatus === 'success' && (\r\n                                        <div className=\"mt-4 text-green-600 font-medium\">\r\n                                            ‚úì Excel file imported successfully!\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {importStatus === 'error' && (\r\n                                        <div className=\"mt-4 text-red-600 font-medium\">\r\n                                            ‚úó Error importing Excel file. Please check format and try again.\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className=\"bg-gray-50 rounded-lg p-6 text-left\">\r\n                                    <h3 className=\"font-semibold text-gray-800 mb-3\">Expected Excel Format:</h3>\r\n                                    <div className=\"text-sm text-gray-600 space-y-2\">\r\n                                        <div><strong>Required columns:</strong> ID, Name, Email</div>\r\n                                        <div><strong>Optional columns:</strong> Program, Campus, Level, Status</div>\r\n                                        <div><strong>File types:</strong> .xls or .xlsx</div>\r\n                                        <div><strong>Note:</strong> First row should contain column headers</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Management Dashboard (preserved with enhanced program type dropdown) */}\r\n                    {classList && (\r\n                        <div className=\"p-6\">\r\n                            {/* Overview Cards */}\r\n                            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8\">\r\n                                {/* Course Info with Enhanced Program Type Dropdown */}\r\n                                <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\">\r\n                                    <div className=\"flex items-center gap-3 mb-4\">\r\n                                        <BookOpen className=\"text-blue-600\" size={24} />\r\n                                        <h3 className=\"text-lg font-semibold text-blue-800\">\r\n                                            Course Information\r\n                                        </h3>\r\n                                    </div>\r\n                                    <div className=\"space-y-2 text-sm\">\r\n                                        <div>\r\n                                            <strong>Code:</strong>{' '}\r\n                                            {classList.courseMetadata?.courseCode || 'N/A'}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Name:</strong>{' '}\r\n                                            {classList.courseMetadata?.courseName || 'N/A'}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Section:</strong>{' '}\r\n                                            {classList.courseMetadata?.section || 'N/A'}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Professor:</strong>{' '}\r\n                                            {classList.courseMetadata?.instructor || 'N/A'}\r\n                                        </div>\r\n\r\n                                        {/* ENHANCED: Program type selector with policy preview */}\r\n                                        <div className=\"mt-3\">\r\n                                            {renderEnhancedProgramTypeDropdown()}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Progress Stats (preserved exactly from original) */}\r\n                                <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6\">\r\n                                    <div className=\"flex items-center gap-3 mb-4\">\r\n                                        <GraduationCap className=\"text-green-600\" size={24} />\r\n                                        <h3 className=\"text-lg font-semibold text-green-800\">\r\n                                            Grading Progress\r\n                                        </h3>\r\n                                    </div>\r\n                                    <div className=\"space-y-2 text-sm\">\r\n                                        <div>\r\n                                            <strong>Total Students:</strong> {classList.students.length}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Final Grades:</strong>{' '}\r\n                                            {getGradingProgress().final}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Draft Grades:</strong>{' '}\r\n                                            {getGradingProgress().draft}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Completion:</strong>{' '}\r\n                                            {getGradingProgress().percentage}%\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Session Control (preserved exactly from original) */}\r\n                                <div className=\"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-6\">\r\n                                    <div className=\"flex items-center gap-3 mb-4\">\r\n                                        <Play className=\"text-purple-600\" size={24} />\r\n                                        <h3 className=\"text-lg font-semibold text-purple-800\">\r\n                                            Batch Grading Session\r\n                                        </h3>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        {!gradingSession?.active ? (\r\n                                            <div>\r\n                                                <div className=\"text-sm text-purple-600 mb-2\">\r\n                                                    {gradingSession?.currentStudentIndex > 0\r\n                                                        ? `Paused at student ${gradingSession.currentStudentIndex + 1} of ${classList.students.length}`\r\n                                                        : 'Ready to start batch grading'\r\n                                                    }\r\n                                                </div>\r\n                                                <div className=\"flex gap-2\">\r\n                                                    {gradingSession?.currentStudentIndex > 0 ? (\r\n                                                        <button\r\n                                                            onClick={resumeGradingSession}\r\n                                                            className=\"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors\"\r\n                                                        >\r\n                                                            <Play size={16} />\r\n                                                            Resume Session\r\n                                                        </button>\r\n                                                    ) : (\r\n                                                        <button\r\n                                                            onClick={startGradingSession}\r\n                                                            disabled={!sharedRubric}\r\n                                                            className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                                        >\r\n                                                            <Play size={16} />\r\n                                                            Start Batch Grading\r\n                                                        </button>\r\n                                                    )}\r\n                                                    {!sharedRubric && (\r\n                                                        <div className=\"text-xs text-purple-600 mt-1\">\r\n                                                            Load a rubric first\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div>\r\n                                                <div className=\"text-sm text-green-600 font-medium mb-2\">\r\n                                                    ‚úì Session Active - Student {gradingSession.currentStudentIndex + 1} of {classList.students.length}\r\n                                                </div>\r\n                                                <button\r\n                                                    onClick={pauseGradingSession}\r\n                                                    className=\"flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors\"\r\n                                                >\r\n                                                    <Clock size={16} />\r\n                                                    Pause Session\r\n                                                </button>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Student Table (preserved exactly from original) */}\r\n                            <div className=\"bg-white border border-gray-200 rounded-lg\">\r\n                                <div className=\"px-6 py-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center\">\r\n                                    <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                                        Student Roster\r\n                                    </h3>\r\n                                    <div className=\"flex gap-2\">\r\n                                        <button\r\n                                            onClick={exportClassGradesCSV}\r\n                                            className=\"px-2 py-1 rounded text-xs font-medium text-white bg-green-500 hover:bg-green-700 focus:ring-2 focus:ring-green-500 transition-colors duration-150\"\r\n                                        >\r\n                                            <Download size={14} />\r\n                                            CSV\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={exportClassGradesHTML}\r\n                                            className=\"flex items-center gap-1 px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors\"\r\n                                        >\r\n                                            <FileText size={14} />\r\n                                            HTML\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={exportClassGradesPortraitPDF}\r\n                                            className=\"flex items-center gap-1 px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-medium transition-colors\"\r\n                                        >\r\n                                            <FileText size={14} />\r\n                                            PDF\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"overflow-x-auto\">\r\n                                    <table className=\"table-auto w-max mx-auto\">\r\n                                        <thead className=\"bg-gray-50\">\r\n                                            <tr>\r\n                                                <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    #\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Status\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Student ID\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Name\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Email\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Program\r\n                                                </th>\r\n                                                <th className=\"w-48 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Actions\r\n                                                </th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                                            {classList.students.map((student, index) => {\r\n                                                const progress = classList.gradingProgress[index];\r\n                                                const isCurrentStudent = gradingSession.active && index === gradingSession.currentStudentIndex;\r\n                                                const gradeStatus = getGradeStatus(student.id);\r\n\r\n                                                return (\r\n                                                    <tr\r\n                                                        key={student.id}\r\n                                                        className={`${isCurrentStudent\r\n                                                            ? 'bg-blue-50 border-l-4 border-blue-500'\r\n                                                            : 'hover:bg-gray-50'\r\n                                                            } transition-colors`}\r\n                                                    >\r\n                                                        <td className=\"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\">\r\n                                                            {index + 1}\r\n                                                        </td>\r\n                                                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                            {getStatusDisplay(progress, student.id)}\r\n                                                        </td>\r\n                                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\r\n                                                            {student.id}\r\n                                                        </td>\r\n                                                        <td className=\"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\">\r\n                                                            {student.name}\r\n                                                        </td>\r\n                                                        <td className=\"px-4 py-2 whitespace-normal break-words text-sm text-gray-500 max-w-xs\">\r\n                                                            {student.email}\r\n                                                        </td>\r\n                                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                                                            {student.program}\r\n                                                        </td>\r\n\r\n                                                        <td className=\"w-48 px-4 py-2 text-sm whitespace-normal\">\r\n                                                            <div className=\"flex flex-wrap items-center gap-2\">\r\n                                                                {/* View or Edit */}\r\n                                                                <button\r\n                                                                    onClick={() => loadStudentForGrading(student)}\r\n                                                                    className=\"flex items-center gap-1 px-3 py-1 bg-blue-500 hover:bg-blue-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-blue-500 duration-150\"\r\n                                                                >\r\n                                                                    {gradeStatus === 'final' ? 'View' : 'Edit'}\r\n                                                                </button>\r\n\r\n                                                                {/* Finalize draft */}\r\n                                                                {gradeStatus === 'draft' && (\r\n                                                                    <button\r\n                                                                        onClick={() => finalizeGrade(student.id)}\r\n                                                                        className=\"flex items-center gap-1 px-3 py-1 bg-green-500 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-green-500 duration-150\"\r\n                                                                    >\r\n                                                                        Finalize\r\n                                                                    </button>\r\n                                                                )}\r\n\r\n                                                                {/* Export Grade (always visible) */}\r\n                                                                <button\r\n                                                                    onClick={() => exportStudentGrade(student.id)}\r\n                                                                    className=\"flex items-center gap-1 px-3 py-1 bg-purple-500 hover:bg-purple-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-purple-500 duration-150\"\r\n                                                                >\r\n                                                                    <ExternalLink size={14} />\r\n                                                                    Export Grade\r\n                                                                </button>\r\n\r\n                                                                {/* Unlock (only for final) */}\r\n                                                                {gradeStatus === 'final' && (\r\n                                                                    <button\r\n                                                                        onClick={() => unlockGrade(student.id)}\r\n                                                                        className=\"flex items-center gap-1 px-3 py-1 bg-orange-500 hover:bg-orange-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-orange-500 duration-150\"\r\n                                                                    >\r\n                                                                        <Unlock size={14} />\r\n                                                                        Unlock\r\n                                                                    </button>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                );\r\n                                            })}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Import Summary (preserved exactly from original) */}\r\n                            <div className=\"mt-8 bg-gray-50 rounded-lg p-6\">\r\n                                <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Import Summary</h3>\r\n                                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">File:</span>\r\n                                        <div className=\"font-medium\">{classList.fileName}</div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">Import Date:</span>\r\n                                        <div className=\"font-medium\">\r\n                                            {new Date(classList.importTime).toLocaleDateString()}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">Data Quality:</span>\r\n                                        <div className=\"font-medium\">\r\n                                            {classList.validation?.validationScore || 0}%\r\n                                        </div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">Total Students:</span>\r\n                                        <div className=\"font-medium\">{classList.students.length}</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ClassListManager;"],"mappings":"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AAU,GAAG,CAAAvG,YAAY,aAAZA,YAAY,wBAAA8F,sBAAA,GAAZ9F,YAAY,CAAE8E,cAAc,cAAAgB,sBAAA,uBAA5BA,sBAAA,CAA8Bf,KAAK,KAAI,gBAAgB;IAC1E;IACA,MAAMyB,QAAQ,GAAGrH,SAAS,CAAC2C,QAAQ,CAAC2E,GAAG,CAAC,CAAChC,OAAO,EAAEiC,GAAG,KAAK;MACtD,MAAMC,IAAI,GAAGjE,qBAAqB,CAAC+B,OAAO,CAAC3H,EAAE,CAAC;MAC9C,MAAM8J,GAAG,GAAGD,IAAI,CAAC1D,KAAK,KAAK,KAAK,GAC1B,GAAG0D,IAAI,CAAC1D,KAAK,IAAI0D,IAAI,CAACzD,WAAW,EAAE,GACnC,KAAK;MACX,OAAO;AACnB;AACA,cAAcwD,GAAG,GAAG,CAAC;AACrB,cAAcjC,OAAO,CAAC3H,EAAE;AACxB,cAAc2H,OAAO,CAACC,IAAI;AAC1B,cAAckC,GAAG;AACjB,cAAcD,IAAI,CAACxD,WAAW,IAAI,KAAK;AACvC,cAAcwD,IAAI,CAACnK,UAAU,KAAK,KAAK,GAAGmK,IAAI,CAACnK,UAAU,GAAG,GAAG,GAAG,KAAK;AACvE,YAAY;IACJ,CAAC,CAAC,CAACqK,IAAI,CAAC,EAAE,CAAC;IAEX,OAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}