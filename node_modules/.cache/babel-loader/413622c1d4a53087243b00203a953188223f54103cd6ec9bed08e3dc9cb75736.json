{"ast":null,"code":"var _jsxFileName = \"C:\\\\local clones\\\\rubric-creation-app\\\\src\\\\components\\\\ClassListManager.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect, useMemo } from 'react';\nimport { Upload, Users, BookOpen, GraduationCap, Play, Download, CheckCircle, Clock, AlertCircle, Unlock, FileText, ExternalLink, FileSpreadsheet, CheckCircle2, Settings } from 'lucide-react';\nimport { useAssessment, DEFAULT_LATE_POLICY } from './SharedContext';\nimport { parseExcelFile, validateStudentData } from '../utils/excelParser';\nimport { getSchoolLogo, generateReportHeader, getReportStyles, hasSchoolLogo } from './logoIntegrationUtility';\n\n// Add new imports for grading policy management\nimport gradingPolicyService from '../services/gradingPolicyService';\nimport { useGradingPolicies, useGradingPolicyForProgram, useGradeCalculation, useGradingPolicyManager } from '../hooks/useGradingPolicies';\n// Add gradebook utilities import for letter grade calculation\nimport { percentageToLetterGrade } from '../utils/gradebookUtilis';\n/**\r\n * Enhanced getLetterGrade function with dynamic policy support\r\n * Falls back to original hardcoded scales if policy service fails\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst getLetterGrade = async (percentage, programType, customProgramId = null, selectedPolicy = null) => {\n  // Try dynamic policy calculation first\n  try {\n    const result = await gradingPolicyService.calculateGrade(percentage, selectedPolicy === null || selectedPolicy === void 0 ? void 0 : selectedPolicy.id, programType, customProgramId);\n    if (result.success) {\n      return result.data.letter;\n    }\n  } catch (error) {\n    console.warn('Dynamic grading failed, using legacy fallback:', error);\n  }\n\n  // Legacy fallback - your original hardcoded scales (preserved exactly)\n  const scales = {\n    degree: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }],\n    diploma: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }],\n    certificate: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }],\n    graduateCertificate: [{\n      min: 90,\n      grade: 'A+'\n    }, {\n      min: 80,\n      grade: 'A'\n    }, {\n      min: 75,\n      grade: 'B+'\n    }, {\n      min: 70,\n      grade: 'B'\n    }, {\n      min: 65,\n      grade: 'C+'\n    }, {\n      min: 60,\n      grade: 'C'\n    }, {\n      min: 0,\n      grade: 'F'\n    }]\n  };\n\n  // Pick the right scale (default to degree if missing)\n  const scale = scales[programType] || scales.degree;\n\n  // Find the first entry where percentage ≥ min\n  const entry = scale.find(e => percentage >= e.min);\n  return entry ? entry.grade : 'N/A';\n};\nconst ClassListManager = () => {\n  _s();\n  var _classList$courseMeta2, _classList$courseMeta16, _classList$courseMeta17, _classList$courseMeta18, _classList$courseMeta19, _classList$validation;\n  const fileInputRef = useRef(null);\n  const [importStatus, setImportStatus] = useState('');\n\n  // Add new grading policy state management using TanStack Query hooks\n  const {\n    data: availablePolicies = [],\n    isLoading: policiesLoading\n  } = useGradingPolicies({\n    isActive: true\n  });\n  const [currentProgramType, setCurrentProgramType] = useState('degree');\n  const {\n    data: selectedPolicy\n  } = useGradingPolicyForProgram(currentProgramType);\n  const gradeCalculation = useGradeCalculation();\n  const {\n    prefetchPolicyForProgram\n  } = useGradingPolicyManager();\n  const {\n    classList,\n    setClassList,\n    gradingSession,\n    setGradingSession,\n    initializeGradingSession,\n    setActiveTab,\n    setCurrentStudent,\n    hasDraft,\n    getGradeStatus,\n    saveFinalGrade,\n    loadDraft,\n    saveDraft,\n    drafts,\n    sharedRubric,\n    updateStudentInfo,\n    updateAssignmentInfo,\n    updateCourseInfo,\n    // FIXED: Added updateCourseInfo from the context\n    loadFinalGrade,\n    finalGrades,\n    rubricFormData,\n    currentLatePolicy\n  } = useAssessment();\n\n  // Load current program type from class metadata and update policy\n  useEffect(() => {\n    var _classList$courseMeta;\n    if (classList !== null && classList !== void 0 && (_classList$courseMeta = classList.courseMetadata) !== null && _classList$courseMeta !== void 0 && _classList$courseMeta.programType) {\n      setCurrentProgramType(classList.courseMetadata.programType);\n    }\n  }, [classList === null || classList === void 0 ? void 0 : (_classList$courseMeta2 = classList.courseMetadata) === null || _classList$courseMeta2 === void 0 ? void 0 : _classList$courseMeta2.programType]);\n\n  // Prefetch policies for better UX\n  useEffect(() => {\n    const programTypes = ['degree', 'diploma', 'certificate', 'graduateCertificate', 'apprenticeship', 'healthScience', 'gasTechnician'];\n    programTypes.forEach(type => {\n      if (type !== currentProgramType) {\n        prefetchPolicyForProgram(type);\n      }\n    });\n  }, [currentProgramType, prefetchPolicyForProgram]);\n\n  // Enhanced handler to change the program type for grading with policy loading\n  const handleProgramTypeChange = e => {\n    const newType = e.target.value;\n    setCurrentProgramType(newType);\n    setClassList(prev => ({\n      ...prev,\n      courseMetadata: {\n        ...prev.courseMetadata,\n        programType: newType\n      }\n    }));\n  };\n\n  // Helper function for status display (preserved exactly from original)\n  const getStatusDisplay = (progress, studentId) => {\n    const gradeStatus = getGradeStatus(studentId);\n    if (gradeStatus === 'final') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n          className: \"w-4 h-4 text-green-600\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium\",\n          children: \"Final\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 17\n      }, this);\n    } else if (gradeStatus === 'draft') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(Clock, {\n          className: \"w-4 h-4 text-yellow-600\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-medium\",\n          children: \"Draft\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }, this);\n    } else if ((progress === null || progress === void 0 ? void 0 : progress.status) === 'in-progress') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-medium\",\n          children: \"In Progress\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 17\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-4 h-4 bg-gray-300 rounded-full\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full\",\n          children: \"Not Started\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  // Helper function to finalize a draft grade (preserved exactly from original)\n  const finalizeGrade = studentId => {\n    console.log('🔧 Finalizing grade for student:', studentId);\n    const draftData = drafts[studentId];\n    if (draftData) {\n      // Save the final grade\n      saveFinalGrade(studentId, draftData);\n\n      // Update class list progress with better logging\n      const studentIndex = classList.students.findIndex(s => s.id === studentId);\n      console.log('📍 Found student at index:', studentIndex);\n      if (studentIndex >= 0) {\n        const updatedProgress = [...classList.gradingProgress];\n        const previousProgress = updatedProgress[studentIndex];\n        updatedProgress[studentIndex] = {\n          ...updatedProgress[studentIndex],\n          status: 'completed_final',\n          lastModified: new Date().toISOString(),\n          gradeType: 'final'\n        };\n        console.log('📊 Progress update:', {\n          studentId,\n          before: previousProgress,\n          after: updatedProgress[studentIndex]\n        });\n        setClassList(prev => ({\n          ...prev,\n          gradingProgress: updatedProgress\n        }));\n        console.log('✅ Class list updated successfully');\n      } else {\n        console.error('❌ Student not found in class list:', studentId);\n      }\n    } else {\n      console.error('❌ No draft data found for student:', studentId);\n    }\n  };\n\n  // Helper function to unlock a final grade (preserved exactly from original)\n  const unlockGrade = studentId => {\n    // For now, we'll implement this by updating the class list progress\n    // The actual unlocking logic should be implemented in SharedContext\n    const studentIndex = classList.students.findIndex(s => s.id === studentId);\n    if (studentIndex >= 0) {\n      const updatedProgress = [...classList.gradingProgress];\n      updatedProgress[studentIndex] = {\n        ...updatedProgress[studentIndex],\n        status: 'completed_draft',\n        lastModified: new Date().toISOString(),\n        gradeType: 'draft'\n      };\n      setClassList(prev => ({\n        ...prev,\n        gradingProgress: updatedProgress\n      }));\n    }\n\n    // Note: Full unlock functionality requires additional implementation in SharedContext\n    console.log('Unlock grade for student:', studentId);\n  };\n\n  // Helper function to load final grade data (preserved exactly from original)\n  const loadFinalGradeData = studentId => {\n    // Use loadFinalGrade if available, otherwise fallback to checking finalGrades directly\n    if (typeof loadFinalGrade === 'function') {\n      return loadFinalGrade(studentId);\n    }\n    // Fallback: check finalGrades directly if available\n    if (finalGrades && finalGrades[studentId]) {\n      return finalGrades[studentId];\n    }\n    // Last resort: check drafts (this maintains current behavior)\n    return drafts[studentId] || null;\n  };\n\n  // **ENHANCED**: This function now uses dynamic grading with fallback to legacy calculation\n  // ENHANCED calculateStudentGrade function for ClassListManager.js\n  // Replace the existing calculateStudentGrade function (around lines 200-280)\n\n  const calculateStudentGrade = async studentId => {\n    var _sharedRubric$assignm2, _student$program, _classList$courseMeta3, _classList$courseMeta4;\n    const gradeStatus = getGradeStatus(studentId);\n    let gradeData = null;\n    if (gradeStatus === 'final') {\n      gradeData = loadFinalGradeData(studentId);\n    } else if (gradeStatus === 'draft') {\n      gradeData = loadDraft(studentId);\n    }\n\n    // If no grade data, return empty result\n    if (!gradeData || !sharedRubric || !sharedRubric.criteria) {\n      var _sharedRubric$assignm;\n      return {\n        score: 'N/A',\n        maxPossible: (sharedRubric === null || sharedRubric === void 0 ? void 0 : (_sharedRubric$assignm = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm === void 0 ? void 0 : _sharedRubric$assignm.totalPoints) || 100,\n        percentage: 'N/A',\n        letterGrade: 'N/A'\n      };\n    }\n\n    // Calculate raw score from rubric grading\n    let totalScore = 0;\n    let maxScore = ((_sharedRubric$assignm2 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm2 === void 0 ? void 0 : _sharedRubric$assignm2.totalPoints) || 0;\n    if (gradeData.rubricGrading) {\n      sharedRubric.criteria.forEach(criterion => {\n        const rubricGrading = gradeData.rubricGrading[criterion.id];\n        if (rubricGrading && rubricGrading.selectedLevel) {\n          const level = sharedRubric.rubricLevels.find(l => l.level === rubricGrading.selectedLevel);\n          if (level) {\n            totalScore += criterion.maxPoints * level.multiplier;\n          }\n        }\n      });\n    }\n\n    // Apply late policy if applicable\n    const activeLevels = (currentLatePolicy === null || currentLatePolicy === void 0 ? void 0 : currentLatePolicy.levels) || DEFAULT_LATE_POLICY.levels;\n    let finalScore = totalScore;\n    if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\n      const latePolicyLevel = activeLevels[gradeData.latePolicy.level] || activeLevels.none;\n      finalScore = totalScore * latePolicyLevel.multiplier;\n    }\n\n    // Calculate percentage\n    const percentage = maxScore > 0 ? Math.round(finalScore / maxScore * 100) : 0;\n\n    // ENHANCED: Determine program type from student and class data\n    const student = classList.students.find(s => s.id === studentId);\n    const programType = (student === null || student === void 0 ? void 0 : (_student$program = student.program) === null || _student$program === void 0 ? void 0 : _student$program.toLowerCase()) || ((_classList$courseMeta3 = classList.courseMetadata) === null || _classList$courseMeta3 === void 0 ? void 0 : (_classList$courseMeta4 = _classList$courseMeta3.programType) === null || _classList$courseMeta4 === void 0 ? void 0 : _classList$courseMeta4.toLowerCase()) || 'degree'; // default fallback\n\n    // ENHANCED: Use dynamic letter grade calculation with proper program type detection\n    let letterGrade = 'N/A';\n    try {\n      // First try using the grading policy service\n      if (gradingPolicyService) {\n        var _classList$courseMeta5, _gradeResult$data;\n        const gradeResult = await gradingPolicyService.calculateGrade(percentage, null,\n        // policyId - let it auto-select\n        programType, (_classList$courseMeta5 = classList.courseMetadata) === null || _classList$courseMeta5 === void 0 ? void 0 : _classList$courseMeta5.customProgramId);\n        if (gradeResult.success && (_gradeResult$data = gradeResult.data) !== null && _gradeResult$data !== void 0 && _gradeResult$data.letter) {\n          letterGrade = gradeResult.data.letter;\n        }\n      }\n\n      // Fallback to gradebook utilities if grading service fails\n      if (letterGrade === 'N/A') {\n        // Import the utility function if not already imported from '../utils/gradebookUtilis'\n        if (typeof percentageToLetterGrade === 'function') {\n          letterGrade = percentageToLetterGrade(percentage, programType);\n        } else {\n          // Manual fallback calculation\n          letterGrade = getLetterGradeFallback(percentage, programType);\n        }\n      }\n    } catch (error) {\n      console.warn('Error calculating letter grade, using fallback:', error);\n      letterGrade = getLetterGradeFallback(percentage, programType);\n    }\n    return {\n      score: Math.round(finalScore * 10) / 10,\n      maxPossible: maxScore,\n      percentage,\n      letterGrade\n    };\n  };\n\n  // ENHANCED: Fallback letter grade calculation function\n  const getLetterGradeFallback = (percentage, programType = 'degree') => {\n    // Define grading scales for different program types\n    const gradingScales = {\n      degree: [{\n        min: 90,\n        grade: 'A+'\n      }, {\n        min: 85,\n        grade: 'A'\n      }, {\n        min: 80,\n        grade: 'A-'\n      }, {\n        min: 77,\n        grade: 'B+'\n      }, {\n        min: 73,\n        grade: 'B'\n      }, {\n        min: 70,\n        grade: 'B-'\n      }, {\n        min: 67,\n        grade: 'C+'\n      }, {\n        min: 63,\n        grade: 'C'\n      }, {\n        min: 60,\n        grade: 'C-'\n      }, {\n        min: 50,\n        grade: 'D'\n      }, {\n        min: 0,\n        grade: 'F'\n      }],\n      diploma: [{\n        min: 90,\n        grade: 'A+'\n      }, {\n        min: 80,\n        grade: 'A'\n      }, {\n        min: 75,\n        grade: 'B+'\n      }, {\n        min: 70,\n        grade: 'B'\n      }, {\n        min: 65,\n        grade: 'C+'\n      }, {\n        min: 60,\n        grade: 'C'\n      }, {\n        min: 50,\n        grade: 'D'\n      }, {\n        min: 0,\n        grade: 'F'\n      }],\n      certificate: [{\n        min: 80,\n        grade: 'A'\n      }, {\n        min: 70,\n        grade: 'B'\n      }, {\n        min: 60,\n        grade: 'C'\n      }, {\n        min: 0,\n        grade: 'F'\n      }]\n    };\n    const scale = gradingScales[programType] || gradingScales.degree;\n    for (const {\n      min,\n      grade\n    } of scale) {\n      if (percentage >= min) {\n        return grade;\n      }\n    }\n    return 'F';\n  };\n\n  // Helper function to load student for grading (preserved exactly from original)\n  const loadStudentForGrading = student => {\n    const gradeStatus = getGradeStatus(student.id);\n\n    // Set the current student first\n    setCurrentStudent(student);\n\n    // Load the student info into the grading form\n    updateStudentInfo('name', student.name || '');\n    updateStudentInfo('id', student.id || '');\n    updateStudentInfo('email', student.email || '');\n\n    // Load rubric assignment info if available\n    if (sharedRubric) {\n      var _sharedRubric$assignm3, _sharedRubric$assignm4;\n      updateAssignmentInfo({\n        name: ((_sharedRubric$assignm3 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm3 === void 0 ? void 0 : _sharedRubric$assignm3.title) || '',\n        maxPoints: ((_sharedRubric$assignm4 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm4 === void 0 ? void 0 : _sharedRubric$assignm4.totalPoints) || 100\n      });\n    }\n\n    // Provide user feedback and load appropriate data\n    if (gradeStatus === 'final') {\n      const finalData = loadFinalGradeData(student.id);\n      console.log(`Loading final grade for ${student.name}:`, finalData ? 'Found' : 'Not found');\n    } else if (gradeStatus === 'draft') {\n      const draftData = loadDraft(student.id);\n      console.log(`Loading draft for ${student.name}:`, draftData ? 'Found' : 'Not found');\n    } else {\n      console.log(`Starting new grade for ${student.name}`);\n    }\n\n    // Switch to grading tool - the GradingTemplate useEffect will handle loading the data\n    setActiveTab('grading-tool');\n\n    // Note: The actual data loading happens in GradingTemplate's useEffect for currentStudent\n  };\n\n  // Helper function to get grading progress statistics (preserved exactly from original)\n  const getGradingProgress = () => {\n    if (!classList) return {\n      completed: 0,\n      total: 0,\n      percentage: 0,\n      final: 0,\n      draft: 0\n    };\n    let final = 0;\n    let draft = 0;\n\n    // Use actual grade status instead of stored progress data\n    classList.students.forEach(student => {\n      const gradeStatus = getGradeStatus(student.id);\n      if (gradeStatus === 'final') {\n        final++;\n      } else if (gradeStatus === 'draft') {\n        draft++;\n      }\n    });\n    const completed = final + draft;\n    const total = classList.students.length;\n    const percentage = total > 0 ? Math.round(completed / total * 100) : 0;\n    return {\n      completed,\n      total,\n      percentage,\n      final,\n      draft\n    };\n  };\n\n  // FIXED: Export class grades as CSV with async/await properly handled\n  const exportClassGradesCSV = async () => {\n    var _classList$courseMeta6;\n    if (!classList) return;\n    console.log('🔄 Starting CSV export with async grade calculations...');\n\n    // 1) Calculate grades for all students asynchronously\n    const studentGrades = await Promise.all(classList.students.map(async (student, index) => {\n      const progress = classList.gradingProgress[index] || {};\n      const gradeStatus = getGradeStatus(student.id); // Use consistent status check\n      const gradeInfo = await calculateStudentGrade(student.id);\n      const lm = progress.lastModified ? new Date(progress.lastModified).toLocaleDateString() : 'Never';\n      return [index + 1,\n      // # column\n      student.id, student.name, student.email, student.program || 'N/A', progress.status || 'pending', progress.gradeType || 'none', gradeInfo.score !== 'N/A' ? `${gradeInfo.score}/${gradeInfo.maxPossible}` : 'N/A', gradeInfo.letterGrade || 'N/A', gradeInfo.percentage !== 'N/A' ? `${gradeInfo.percentage}%` : 'N/A', lm];\n    }));\n\n    // 2) Build the complete data array with headers\n    const rows = [['#', 'Student ID', 'Student Name', 'Email', 'Program', 'Status', 'Grade Type', 'Numeric Grade', 'Letter Grade', 'Percentage', 'Last Modified'], ...studentGrades];\n\n    // 3) Quote each cell and create CSV\n    const quote = cell => `\"${String(cell).trim().replace(/\"/g, '\"\"')}\"`;\n    const csvContent = rows.map(row => row.map(quote).join(',')).join('\\r\\n');\n\n    // 4) Trigger download\n    const blob = new Blob([csvContent], {\n      type: 'text/csv'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `${((_classList$courseMeta6 = classList.courseMetadata) === null || _classList$courseMeta6 === void 0 ? void 0 : _classList$courseMeta6.courseCode) || 'class'}_grades_${new Date().toISOString().slice(0, 10)}.csv`;\n    link.click();\n    URL.revokeObjectURL(url);\n    console.log('✅ CSV export completed with letter grades');\n  };\n\n  // Enhanced version of your existing getClassGradesHTML function\n  const getClassGradesHTMLWithLogo = async () => {\n    var _classList$courseMeta7, _classList$courseMeta8, _classList$courseMeta9, _sharedRubric$assignm5;\n    const now = new Date();\n    const currentDate = now.toLocaleDateString('en-CA');\n    const currentTime = now.toLocaleTimeString('en-CA');\n    console.log('🔄 Generating class grades HTML with logo...');\n\n    // Calculate grades for all students asynchronously (your existing logic)\n    const studentRows = await Promise.all(classList.students.map(async (student, idx) => {\n      var _classList$gradingPro, _classList$gradingPro2, _classList$gradingPro3;\n      const info = await calculateStudentGrade(student.id);\n      const gradeDisplay = info.score !== 'N/A' ? `${info.score}%` : 'N/A';\n      const letterGrade = info.letterGrade || 'N/A';\n      const percentage = info.score !== 'N/A' ? `${info.score}%` : 'N/A';\n      const lastModified = (_classList$gradingPro = classList.gradingProgress[idx]) !== null && _classList$gradingPro !== void 0 && _classList$gradingPro.lastModified ? new Date(classList.gradingProgress[idx].lastModified).toLocaleDateString('en-CA') : 'Not graded';\n      return `\n        <tr>\n          <td>${idx + 1}</td>\n          <td>${student.id}</td>\n          <td>${student.name}</td>\n          <td>${student.email}</td>\n          <td>${student.program}</td>\n          <td>${((_classList$gradingPro2 = classList.gradingProgress[idx]) === null || _classList$gradingPro2 === void 0 ? void 0 : _classList$gradingPro2.status) || 'pending'}</td>\n          <td>${((_classList$gradingPro3 = classList.gradingProgress[idx]) === null || _classList$gradingPro3 === void 0 ? void 0 : _classList$gradingPro3.gradeType) || 'N/A'}</td>\n          <td>${gradeDisplay}</td>\n          <td>${letterGrade}</td>\n          <td>${percentage}</td>\n          <td>${lastModified}</td>\n        </tr>\n      `;\n    }));\n    const rowsHtml = studentRows.join('');\n\n    // Use the logo utility to generate header\n    const reportData = {\n      title: '📊 Class Grade Report',\n      // ← FIXED: Correct title for class report\n      courseCode: ((_classList$courseMeta7 = classList.courseMetadata) === null || _classList$courseMeta7 === void 0 ? void 0 : _classList$courseMeta7.courseCode) || '',\n      courseName: ((_classList$courseMeta8 = classList.courseMetadata) === null || _classList$courseMeta8 === void 0 ? void 0 : _classList$courseMeta8.courseName) || '',\n      section: ((_classList$courseMeta9 = classList.courseMetadata) === null || _classList$courseMeta9 === void 0 ? void 0 : _classList$courseMeta9.section) || '',\n      rubricTitle: (sharedRubric === null || sharedRubric === void 0 ? void 0 : (_sharedRubric$assignm5 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm5 === void 0 ? void 0 : _sharedRubric$assignm5.title) || 'Unnamed Rubric'\n    };\n    return `<!DOCTYPE html>\n<html>\n<head>\n  <title>Class Grade Report</title>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  ${getReportStyles()}\n</head>\n<body>\n  ${generateReportHeader(reportData)}\n\n  <div class=\"table-container\">\n    <table>\n      <thead>\n        <tr>\n          <th>#</th><th>Student ID</th><th>Name</th><th>Email</th>\n          <th>Program</th><th>Status</th><th>Grade Type</th>\n          <th>Final Grade</th><th>Letter Grade</th><th>Percentage</th><th>Last Modified</th>\n        </tr>\n      </thead>\n      <tbody>\n        ${rowsHtml}\n      </tbody>\n    </table>\n  </div>\n\n  <div class=\"footer\">\n    Imported from: ${classList.fileName}\n  </div>\n</body>\n</html>`;\n  };\n\n  // FIXED: Export class grades as HTML with async/await properly handled\n  const exportClassGradesHTML = async () => {\n    var _classList$courseMeta0;\n    if (!classList) return;\n    console.log('🔄 Exporting HTML with async grade calculations...');\n\n    // Use the logo-enhanced version\n    const htmlContent = await getClassGradesHTMLWithLogo();\n    const blob = new Blob([htmlContent], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `${((_classList$courseMeta0 = classList.courseMetadata) === null || _classList$courseMeta0 === void 0 ? void 0 : _classList$courseMeta0.courseCode) || 'Class'}_grades.html`;\n    link.style.display = 'none';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n    console.log('✅ HTML export completed with letter grades and logo');\n  };\n\n  // Enhanced version of your existing getPortraitClassReportHTML function\n  const getPortraitClassReportHTMLWithLogo = async () => {\n    var _sharedRubric$assignm6, _classList$courseMeta1, _classList$courseMeta10, _classList$courseMeta11;\n    const now = new Date();\n    const currentDate = now.toLocaleDateString('en-CA');\n    const currentTime = now.toLocaleTimeString('en-CA');\n    const rubricName = (sharedRubric === null || sharedRubric === void 0 ? void 0 : (_sharedRubric$assignm6 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm6 === void 0 ? void 0 : _sharedRubric$assignm6.title) || 'Unnamed Rubric';\n    console.log('🔄 Generating portrait report with logo and async grade calculations...');\n\n    // Calculate grades for all students asynchronously (your existing logic)\n    const studentRows = await Promise.all(classList.students.map(async (student, idx) => {\n      const info = await calculateStudentGrade(student.id);\n      const num = info.score !== 'N/A' ? parseFloat(info.score) : null;\n      const rowClass = num !== null ? num >= 80 ? 'high-grade' : num >= 60 ? 'medium-grade' : 'low-grade' : 'no-grade';\n      return `\n        <tr class=\"${rowClass}\">\n          <td style=\"text-align:center\">${idx + 1}</td>\n          <td>${student.id}</td>\n          <td><strong>${student.name}</strong></td>\n          <td>${student.email}</td>\n          <td>${student.program}</td>\n          <td style=\"text-align:center\">${info.score !== 'N/A' ? `${info.score}%` : 'N/A'}</td>\n          <td style=\"text-align:center; font-weight:bold\">${info.letterGrade || 'N/A'}</td>\n        </tr>\n      `;\n    }));\n    const studentRowsHtml = studentRows.join('');\n\n    // Use the logo utility to generate header\n    const reportData = {\n      title: '📊 Class Grade Report (Portrait)',\n      courseCode: ((_classList$courseMeta1 = classList.courseMetadata) === null || _classList$courseMeta1 === void 0 ? void 0 : _classList$courseMeta1.courseCode) || '',\n      courseName: ((_classList$courseMeta10 = classList.courseMetadata) === null || _classList$courseMeta10 === void 0 ? void 0 : _classList$courseMeta10.courseName) || '',\n      section: ((_classList$courseMeta11 = classList.courseMetadata) === null || _classList$courseMeta11 === void 0 ? void 0 : _classList$courseMeta11.section) || '',\n      rubricTitle: rubricName\n    };\n    return `<!DOCTYPE html>\n<html>\n<head>\n  <title>Class Grade Report</title>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  ${getReportStyles()}\n  <style>\n    .high-grade { background-color: #d4edda !important; }\n    .medium-grade { background-color: #fff3cd !important; }\n    .low-grade { background-color: #f8d7da !important; }\n    .no-grade { background-color: #f8f9fa !important; }\n    \n    @page {\n      size: A4 portrait;\n      margin: 15mm;\n    }\n    \n    @media print {\n      body { \n        font-size: 10pt; \n        background: white;\n      }\n      .school-logo, .report-logo { \n        max-height: 50px !important; \n      }\n      table { \n        page-break-inside: auto; \n      }\n      tr { \n        page-break-inside: avoid; \n        page-break-after: auto; \n      }\n      thead { \n        display: table-header-group; \n      }\n    }\n  </style>\n</head>\n<body>\n  ${generateReportHeader(reportData, {\n      maxHeight: 60\n    })}\n\n  <div class=\"table-container\">\n    <table>\n      <thead>\n        <tr style=\"background-color: #2563eb; color: white;\">\n          <th style=\"text-align:center\">#</th>\n          <th>Student ID</th>\n          <th>Name</th>\n          <th>Email</th>\n          <th>Program</th>\n          <th style=\"text-align:center\">Grade</th>\n          <th style=\"text-align:center\">Letter</th>\n        </tr>\n      </thead>\n      <tbody>\n        ${studentRowsHtml}\n      </tbody>\n    </table>\n  </div>\n\n  <div class=\"footer\">\n    <div style=\"margin-top: 20px; text-align: center; font-size: 12px; color: #666;\">\n      <strong>Grade Distribution Summary</strong><br>\n      Report generated on ${currentDate} at ${currentTime}<br>\n      Total Students: ${classList.students.length} | Rubric: ${rubricName}\n    </div>\n  </div>\n</body>\n</html>`;\n  };\n\n  // FIXED: Export portrait PDF with async/await properly handled\n  const exportClassGradesPortraitPDF = async () => {\n    if (!classList) return;\n    console.log('🔄 Generating PDF with async grade calculations and logo...');\n\n    // Use the logo-enhanced version\n    const htmlContent = await getPortraitClassReportHTMLWithLogo();\n    const printWin = window.open('', '_blank', 'width=800,height=600');\n    printWin.document.write(htmlContent);\n    printWin.document.close();\n    printWin.focus();\n    printWin.onload = () => {\n      printWin.print();\n    };\n    console.log('✅ PDF generation completed with letter grades and logo');\n  };\n\n  // Complete exportStudentGrade function for ClassListManager.js (preserved exactly from original)\n  const exportStudentGrade = studentId => {\n    // 1. Make sure we have a classList and sharedRubric\n    if (!classList || !sharedRubric) {\n      alert('No class list or rubric available. Please ensure both are loaded.');\n      return;\n    }\n\n    // 2. Find the student in the class list\n    const student = classList.students.find(s => s.id === studentId);\n    if (!student) {\n      alert('Student not found in class list.');\n      return;\n    }\n\n    // 3. Load the student's grade data\n    const gradeStatus = getGradeStatus(studentId);\n    let gradeData = null;\n    if (gradeStatus === 'final') {\n      gradeData = loadFinalGradeData(studentId);\n    } else if (gradeStatus === 'draft') {\n      gradeData = loadDraft(studentId);\n    } else {\n      alert('No grade data found for this student. Please grade the student first.');\n      return;\n    }\n    if (!gradeData) {\n      alert('Unable to load grade data for this student.');\n      return;\n    }\n\n    // 4. Access active late policy levels\n    const activeLevels = (currentLatePolicy === null || currentLatePolicy === void 0 ? void 0 : currentLatePolicy.levels) || DEFAULT_LATE_POLICY.levels;\n    const getSafeLatePolicy = level => {\n      if (!level || typeof level !== \"string\" || !activeLevels[level]) {\n        return activeLevels.none;\n      }\n      return activeLevels[level];\n    };\n\n    // 5. Calculate scores (replicated from GradingTemplate.js)\n    const calculateTotalScore = () => {\n      if (!sharedRubric || !gradeData.rubricGrading) {\n        return {\n          finalScore: 0,\n          rawScore: 0,\n          penaltyApplied: false\n        };\n      }\n      let totalScore = 0;\n      const totalPossible = sharedRubric.assignmentInfo.totalPoints;\n      sharedRubric.criteria.forEach(criterion => {\n        const rubricGrading = gradeData.rubricGrading[criterion.id];\n        if (rubricGrading && rubricGrading.selectedLevel) {\n          const level = sharedRubric.rubricLevels.find(l => l.level === rubricGrading.selectedLevel);\n          if (level) {\n            const points = criterion.maxPoints * level.multiplier;\n            totalScore += points;\n          }\n        }\n      });\n      const rawScore = totalScore;\n      let finalScore = totalScore;\n      let penaltyApplied = false;\n\n      // Apply late penalty if applicable\n      if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\n        var _gradeData$latePolicy;\n        const latePolicyLevel = getSafeLatePolicy((_gradeData$latePolicy = gradeData.latePolicy) === null || _gradeData$latePolicy === void 0 ? void 0 : _gradeData$latePolicy.level);\n        if (latePolicyLevel) {\n          finalScore = totalScore * latePolicyLevel.multiplier;\n          penaltyApplied = true;\n        }\n      }\n      return {\n        finalScore,\n        rawScore,\n        penaltyApplied\n      };\n    };\n\n    // 6. Generate HTML report (based on GradingTemplate.js generateStudentReportHTML)\n    // 6. Generate HTML report with logo integration (UPDATED VERSION)\n    const generateStudentReportHTML = () => {\n      var _gradeData$attachment, _gradeData$videoLinks, _classList$courseMeta12, _gradeData$course, _classList$courseMeta13, _gradeData$course2, _classList$courseMeta14, _sharedRubric$assignm7, _gradeData$assignment, _gradeData$latePolicy2, _gradeData$latePolicy3, _gradeData$latePolicy4, _sharedRubric$assignm8;\n      const scoreCalculation = calculateTotalScore();\n      const totalScore = scoreCalculation.finalScore;\n      const rawScore = scoreCalculation.rawScore;\n      const maxPoints = sharedRubric.assignmentInfo.totalPoints;\n      const percentage = (totalScore / (maxPoints || 1) * 100).toFixed(1);\n      const penaltyApplied = scoreCalculation.penaltyApplied;\n\n      // Generate attachments HTML (UNCHANGED)\n      const attachmentsHTML = ((_gradeData$attachment = gradeData.attachments) === null || _gradeData$attachment === void 0 ? void 0 : _gradeData$attachment.map((att, index) => {\n        if (att.base64Data) {\n          return `<div class=\"attachment-item\"><img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"clickable-image\" data-index=\"${index}\" style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" /><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div><div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div></div>`;\n        } else {\n          return `<div class=\"attachment-item\"><div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">📄</div><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div></div>`;\n        }\n      }).join('')) || '';\n\n      // Generate video links HTML (UNCHANGED)\n      const videoLinksHTML = ((_gradeData$videoLinks = gradeData.videoLinks) === null || _gradeData$videoLinks === void 0 ? void 0 : _gradeData$videoLinks.map(link => `<div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\"><div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\"><span style=\"font-size: 1.25rem;\">🎥</span><strong style=\"color: #495057;\">${link.title}</strong></div><a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">${link.url}</a></div>`).join('')) || '';\n\n      // Generate rubric table HTML (UNCHANGED)\n      const rubricTableHTML = sharedRubric ? `\n    <div style=\"margin: 30px 0;\">\n        <h3>📊 Detailed Rubric Assessment</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9rem;\">\n            <thead>\n                <tr style=\"background: #f8f9fa;\">\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th>\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 120px;\">Level Achieved</th>\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 80px;\">Points</th>\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Details & Comments</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${sharedRubric.criteria.map(criterion => {\n        var _gradeData$rubricGrad, _criterion$levels, _criterion$levels$sel;\n        const rubricGrading = (_gradeData$rubricGrad = gradeData.rubricGrading) === null || _gradeData$rubricGrad === void 0 ? void 0 : _gradeData$rubricGrad[criterion.id];\n        const selectedLevel = rubricGrading === null || rubricGrading === void 0 ? void 0 : rubricGrading.selectedLevel;\n        const level = selectedLevel ? sharedRubric.rubricLevels.find(l => l.level === selectedLevel) : null;\n        const points = level ? Math.round(criterion.maxPoints * level.multiplier * 10) / 10 : 0;\n        const levelDescription = level && (_criterion$levels = criterion.levels) !== null && _criterion$levels !== void 0 && (_criterion$levels$sel = _criterion$levels[selectedLevel]) !== null && _criterion$levels$sel !== void 0 && _criterion$levels$sel.description ? criterion.levels[selectedLevel].description : '';\n        const additionalComments = (rubricGrading === null || rubricGrading === void 0 ? void 0 : rubricGrading.customComments) || '';\n        return `<tr>\n                            <td style=\"border: 1px solid #ddd; padding: 12px; vertical-align: top;\">\n                                <strong>${criterion.name}</strong><br>\n                                <small style=\"color: #666;\">${criterion.description || ''}</small><br>\n                                <small style=\"color: #888;\">Max Points: ${criterion.maxPoints}</small>\n                            </td>\n                            <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; vertical-align: top;\">\n                                <span style=\"display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; background: ${(level === null || level === void 0 ? void 0 : level.color) || '#f0f0f0'}; color: white;\">\n                                    ${(level === null || level === void 0 ? void 0 : level.name) || 'Not Assessed'}\n                                </span>\n                            </td>\n                            <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td>\n                            <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\n                                ${levelDescription ? `<div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\"><strong style=\"color: ${level.color};\">Level Description:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span></div>` : ''}\n                                ${additionalComments ? `<div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\"><strong style=\"color: #856404;\">Additional Comments:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span></div>` : ''}\n                                ${!levelDescription && !additionalComments ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}\n                            </td>\n                        </tr>`;\n      }).join('')}\n            </tbody>\n        </table>\n        <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\">\n            <h4 style=\"color: #2e7d32; margin-bottom: 10px;\">📊 Rubric Score Summary</h4>\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\n                <div><strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br><strong>Percentage:</strong> ${percentage}%</div>\n                <div><strong>Grade Status:</strong><span style=\"color: ${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}</span></div>\n                ${penaltyApplied ? `<div style=\"color: #ff9800;\"><strong>Late Penalty Applied:</strong><br>Raw Score: ${Math.round(rawScore * 10) / 10}</div>` : ''}\n            </div>\n        </div>\n    </div>` : '';\n\n      // NEW: Generate header with logo using utility\n      const reportData = {\n        title: `📄 Individual Grade Report: ${student.name}`,\n        courseCode: ((_classList$courseMeta12 = classList.courseMetadata) === null || _classList$courseMeta12 === void 0 ? void 0 : _classList$courseMeta12.courseCode) || ((_gradeData$course = gradeData.course) === null || _gradeData$course === void 0 ? void 0 : _gradeData$course.code) || '',\n        courseName: ((_classList$courseMeta13 = classList.courseMetadata) === null || _classList$courseMeta13 === void 0 ? void 0 : _classList$courseMeta13.courseName) || ((_gradeData$course2 = gradeData.course) === null || _gradeData$course2 === void 0 ? void 0 : _gradeData$course2.name) || '',\n        section: ((_classList$courseMeta14 = classList.courseMetadata) === null || _classList$courseMeta14 === void 0 ? void 0 : _classList$courseMeta14.section) || '',\n        rubricTitle: (sharedRubric === null || sharedRubric === void 0 ? void 0 : (_sharedRubric$assignm7 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm7 === void 0 ? void 0 : _sharedRubric$assignm7.title) || ((_gradeData$assignment = gradeData.assignment) === null || _gradeData$assignment === void 0 ? void 0 : _gradeData$assignment.name) || 'Unnamed Rubric'\n      };\n      const headerHtml = generateReportHeader(reportData, {\n        maxHeight: 60\n      });\n\n      // Complete HTML document with logo integration\n      const htmlContent = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Grade Report - ${student.name}</title>\n    ${getReportStyles()}\n    <style>\n        /* Additional styles specific to individual reports */\n        .score-summary { \n            background: #e8f5e8; \n            border: 2px solid #4caf50; \n            border-radius: 8px; \n            padding: 20px; \n            margin: 20px 0; \n            text-align: center; \n        }\n        .late-policy-section { \n            margin: 30px 0; \n            background: #fff5f5; \n            border: 1px solid #f87171; \n            border-radius: 8px; \n            padding: 20px; \n        }\n        .feedback-section { \n            margin: 20px 0; \n            padding: 15px; \n            background: #f9f9f9; \n            border-radius: 8px; \n        }\n        .attachments { \n            margin: 30px 0; \n        }\n        .attachment-item { \n            display: inline-block; \n            text-align: center; \n            margin: 1rem; \n            padding: 1rem; \n            background: #fff; \n            border: 1px solid #ddd; \n            border-radius: 8px; \n            box-shadow: 0 2px 4px rgba(0,0,0,.1); \n            max-width: 250px; \n            vertical-align: top; \n        }\n        .clickable-image { \n            cursor: pointer; \n            transition: all .3s ease; \n            position: relative; \n        }\n        .clickable-image:hover { \n            transform: scale(1.05); \n            box-shadow: 0 4px 8px rgba(0,0,0,.2); \n        }\n        .video-links { \n            margin: 30px 0; \n        }\n        .video-link-item { \n            margin-bottom: 1rem; \n        }\n        .video-link-item a { \n            color: #007bff; \n            text-decoration: none; \n        }\n        .video-link-item a:hover { \n            text-decoration: underline; \n        }\n        .image-modal { \n            display: none; \n            position: fixed; \n            z-index: 1000; \n            left: 0; \n            top: 0; \n            width: 100%; \n            height: 100%; \n            background-color: rgba(0,0,0,.9); \n            animation: fadeIn .3s ease; \n        }\n        .image-modal.show { \n            display: flex; \n            align-items: center; \n            justify-content: center; \n        }\n        .modal-content { \n            max-width: 95%; \n            max-height: 95%; \n            object-fit: contain; \n            border-radius: 8px; \n            box-shadow: 0 4px 20px rgba(0,0,0,.5); \n            animation: zoomIn .3s ease; \n        }\n        .close-modal { \n            position: absolute; \n            top: 20px; \n            right: 30px; \n            color: #fff; \n            font-size: 40px; \n            font-weight: 700; \n            cursor: pointer; \n            z-index: 1001; \n            background: rgba(0,0,0,.5); \n            border-radius: 50%; \n            width: 50px; \n            height: 50px; \n            display: flex; \n            align-items: center; \n            justify-content: center; \n            line-height: 1; \n        }\n        .close-modal:hover { \n            background: rgba(0,0,0,.8); \n        }\n        .modal-caption { \n            position: absolute; \n            bottom: 20px; \n            left: 50%; \n            transform: translateX(-50%); \n            color: #fff; \n            background: rgba(0,0,0,.7); \n            padding: 10px 20px; \n            border-radius: 6px; \n            text-align: center; \n            max-width: 80%; \n        }\n        @keyframes fadeIn { \n            from { opacity: 0; } \n            to { opacity: 1; } \n        }\n        @keyframes zoomIn { \n            from { transform: scale(.5); opacity: 0; } \n            to { transform: scale(1); opacity: 1; } \n        }\n        @media print { \n            .attachment-item, .video-link-item { \n                break-inside: avoid; \n            } \n            .image-modal { \n                display: none!important; \n            } \n        }\n    </style>\n</head>\n<body>\n    ${headerHtml}\n\n    <div class=\"score-summary\">\n        <h2>📊 Final Score</h2>\n        <div style=\"font-size: 2rem; font-weight: 700; color: #2e7d32; margin: 15px 0;\">\n            ${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)\n        </div>\n        <p style=\"margin: 10px 0; color: #555;\">\n            ${sharedRubric ? `Rubric: ${sharedRubric.assignmentInfo.title}` : \"\"}\n            ${penaltyApplied ? ` | Late Policy: ${getSafeLatePolicy((_gradeData$latePolicy2 = gradeData.latePolicy) === null || _gradeData$latePolicy2 === void 0 ? void 0 : _gradeData$latePolicy2.level).name}` : \"\"}\n        </p>\n    </div>\n\n    ${penaltyApplied ? `\n        <div class=\"late-policy-section\">\n            <h3 style=\"color: #dc2626;\">📅 Late Submission Policy Applied</h3>\n            <p><strong>Policy Status:</strong> ${getSafeLatePolicy((_gradeData$latePolicy3 = gradeData.latePolicy) === null || _gradeData$latePolicy3 === void 0 ? void 0 : _gradeData$latePolicy3.level).name}</p>\n            <p>${getSafeLatePolicy((_gradeData$latePolicy4 = gradeData.latePolicy) === null || _gradeData$latePolicy4 === void 0 ? void 0 : _gradeData$latePolicy4.level).description}</p>\n            <p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} → <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\n        </div>\n    ` : \"\"}\n\n    ${rubricTableHTML}\n\n    ${Object.entries(gradeData.feedback || {}).filter(([key, text]) => text).map(([key, text]) => `\n        <div class=\"feedback-section\">\n            <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\n            <p>${text.replace(/\\n/g, \"<br>\")}</p>\n        </div>\n    `).join(\"\")}\n\n    ${attachmentsHTML ? `\n        <div class=\"attachments\">\n            <h3>📎 File Attachments</h3>\n            <div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">\n                ${attachmentsHTML}\n            </div>\n        </div>\n    ` : \"\"}\n\n    ${videoLinksHTML ? `\n        <div class=\"video-links\">\n            <h3>🎥 Video Review Links</h3>\n            ${videoLinksHTML}\n        </div>\n    ` : \"\"}\n\n    <div class=\"footer\">\n        <div style=\"margin-top: 40px; text-align: center; font-size: 12px; color: #666;\">\n            <strong>Individual Grade Report</strong><br>\n            Report generated on ${new Date().toLocaleDateString('en-CA')} at ${new Date().toLocaleTimeString('en-CA')}<br>\n            Student: ${student.name} | Assignment: ${(sharedRubric === null || sharedRubric === void 0 ? void 0 : (_sharedRubric$assignm8 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm8 === void 0 ? void 0 : _sharedRubric$assignm8.title) || 'Unnamed Assignment'}\n            ${hasSchoolLogo() ? '<br>Generated with institutional branding' : ''}\n        </div>\n    </div>\n\n    <div id=\"imageModal\" class=\"image-modal\">\n        <span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span>\n        <img class=\"modal-content\" id=\"modalImage\">\n        <div class=\"modal-caption\" id=\"modalCaption\"></div>\n    </div>\n\n    <script>\n        const attachmentData = ${JSON.stringify(gradeData.attachments || [])};\n        \n        function openImageModal(src, caption) {\n            const modal = document.getElementById(\"imageModal\");\n            const modalImg = document.getElementById(\"modalImage\");\n            const modalCaption = document.getElementById(\"modalCaption\");\n            modal.classList.add(\"show\");\n            modalImg.src = src;\n            modalCaption.textContent = caption;\n            document.body.style.overflow = \"hidden\";\n        }\n        \n        function closeImageModal() {\n            document.getElementById(\"imageModal\").classList.remove(\"show\");\n            document.body.style.overflow = \"auto\";\n        }\n        \n        document.addEventListener(\"DOMContentLoaded\", function() {\n            document.querySelectorAll(\".clickable-image\").forEach(img => {\n                img.addEventListener(\"click\", function() {\n                    const index = parseInt(this.getAttribute(\"data-index\"));\n                    const attachment = attachmentData[index];\n                    if (attachment && attachment.base64Data) {\n                        openImageModal(attachment.base64Data, attachment.name);\n                    }\n                });\n            });\n            \n            document.getElementById(\"imageModal\").addEventListener(\"click\", function(e) {\n                if (e.target === this) {\n                    closeImageModal();\n                }\n            });\n            \n            document.addEventListener(\"keydown\", function(e) {\n                if (e.key === \"Escape\") {\n                    closeImageModal();\n                }\n            });\n        });\n    </script>\n</body>\n</html>`;\n      return htmlContent;\n    };\n\n    // 7. Generate and export the HTML file\n    try {\n      var _sharedRubric$assignm9, _sharedRubric$assignm0;\n      const htmlContent = generateStudentReportHTML();\n      const htmlBlob = new Blob([htmlContent], {\n        type: 'text/html'\n      });\n      const url = URL.createObjectURL(htmlBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `grade_report_${student.name.replace(/[^a-zA-Z0-9]/g, '_')}_${((_sharedRubric$assignm9 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm9 === void 0 ? void 0 : (_sharedRubric$assignm0 = _sharedRubric$assignm9.title) === null || _sharedRubric$assignm0 === void 0 ? void 0 : _sharedRubric$assignm0.replace(/[^a-zA-Z0-9]/g, '_')) || 'assignment'}.html`;\n      link.click();\n      URL.revokeObjectURL(url);\n      console.log(`✅ Individual grade report exported for student: ${student.name}`);\n    } catch (error) {\n      console.error('Error generating individual grade report:', error);\n      alert('Error generating grade report. Please check the console for details.');\n    }\n  };\n\n  // File upload handling (preserved exactly from original)\n  // COMPLETE ENHANCED handleFileUpload function - replaces lines ~600-650 in ClassListManager.js\n  const handleFileUpload = async event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    setImportStatus('processing');\n    try {\n      var _result$courseMetadat, _result$courseMetadat2, _result$courseMetadat3, _result$courseMetadat4, _result$courseMetadat5, _result$courseMetadat6, _result$courseMetadat7, _result$courseMetadat8, _result$courseMetadat9, _result$courseMetadat0, _result$courseMetadat1, _result$courseMetadat10;\n      // Use Excel parser instead of manual CSV parsing\n      const result = await parseExcelFile(file);\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to parse Excel file');\n      }\n\n      // Validate the parsed student data\n      const validation = validateStudentData(result.students);\n      if (result.students.length === 0) {\n        throw new Error('No valid student records found in Excel file');\n      }\n\n      // Create grading progress tracking for each student\n      const gradingProgress = result.students.map(() => ({\n        status: 'pending',\n        lastModified: null,\n        gradeType: null\n      }));\n\n      // ENHANCED: Create the class list data structure with proper field mapping\n      const classListData = {\n        students: result.students,\n        gradingProgress,\n        fileName: file.name,\n        fileSize: file.size,\n        importTime: new Date().toISOString(),\n        courseMetadata: {\n          courseCode: ((_result$courseMetadat = result.courseMetadata) === null || _result$courseMetadat === void 0 ? void 0 : _result$courseMetadat.courseCode) || 'IMPORTED',\n          courseName: ((_result$courseMetadat2 = result.courseMetadata) === null || _result$courseMetadat2 === void 0 ? void 0 : _result$courseMetadat2.courseName) || 'Excel Import',\n          section: ((_result$courseMetadat3 = result.courseMetadata) === null || _result$courseMetadat3 === void 0 ? void 0 : _result$courseMetadat3.section) || 'DEFAULT',\n          programType: ((_result$courseMetadat4 = result.courseMetadata) === null || _result$courseMetadat4 === void 0 ? void 0 : _result$courseMetadat4.programType) || 'degree',\n          // ENHANCED: Handle both instructor and professors fields\n          professors: ((_result$courseMetadat5 = result.courseMetadata) === null || _result$courseMetadat5 === void 0 ? void 0 : _result$courseMetadat5.professors) || 'TBD',\n          instructor: ((_result$courseMetadat6 = result.courseMetadata) === null || _result$courseMetadat6 === void 0 ? void 0 : _result$courseMetadat6.instructor) || ((_result$courseMetadat7 = result.courseMetadata) === null || _result$courseMetadat7 === void 0 ? void 0 : _result$courseMetadat7.professors) || 'TBD',\n          term: ((_result$courseMetadat8 = result.courseMetadata) === null || _result$courseMetadat8 === void 0 ? void 0 : _result$courseMetadat8.term) || 'TBD',\n          hours: ((_result$courseMetadat9 = result.courseMetadata) === null || _result$courseMetadat9 === void 0 ? void 0 : _result$courseMetadat9.hours) || '',\n          gradeScale: ((_result$courseMetadat0 = result.courseMetadata) === null || _result$courseMetadat0 === void 0 ? void 0 : _result$courseMetadat0.gradeScale) || '',\n          department: ((_result$courseMetadat1 = result.courseMetadata) === null || _result$courseMetadat1 === void 0 ? void 0 : _result$courseMetadat1.department) || '',\n          campus: ((_result$courseMetadat10 = result.courseMetadata) === null || _result$courseMetadat10 === void 0 ? void 0 : _result$courseMetadat10.campus) || '',\n          totalStudents: result.students.length\n        },\n        validation: {\n          validationScore: validation.validationScore || 100,\n          issues: validation.issues || []\n        }\n      };\n      setClassList(classListData);\n      setImportStatus('success');\n\n      // ENHANCED: Auto-populate course information using corrected field mapping\n      if (result.courseMetadata) {\n        const courseInfo = {\n          code: result.courseMetadata.courseCode || '',\n          name: result.courseMetadata.courseName || '',\n          instructor: result.courseMetadata.instructor || result.courseMetadata.professors || '',\n          term: result.courseMetadata.term || ''\n        };\n        console.log('📊 Auto-populating course info from Excel:', courseInfo);\n        // Note: updateCourseInfo should be available from useAssessment hook\n        if (typeof updateCourseInfo === 'function') {\n          Object.entries(courseInfo).forEach(([field, value]) => {\n            updateCourseInfo(field, value);\n          });\n        }\n      }\n      console.log('✅ Excel import completed successfully:', {\n        students: result.students.length,\n        courseMetadata: classListData.courseMetadata\n      });\n      setTimeout(() => setImportStatus(''), 3000);\n    } catch (error) {\n      console.error('Excel import error:', error);\n      setImportStatus('error');\n      setTimeout(() => setImportStatus(''), 3000);\n    }\n  };\n\n  // ENHANCED startGradingSession function - replaces lines ~670-690 in ClassListManager.js\n  const startGradingSession = () => {\n    var _sharedRubric$assignm1;\n    if (!classList || classList.students.length === 0) {\n      alert('No students available for grading.');\n      return;\n    }\n    if (!sharedRubric) {\n      alert('Please load a rubric before starting batch grading.');\n      return;\n    }\n    console.log('🚀 Starting grading session with class data:', {\n      studentCount: classList.students.length,\n      courseMetadata: classList.courseMetadata,\n      rubricTitle: (_sharedRubric$assignm1 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm1 === void 0 ? void 0 : _sharedRubric$assignm1.title\n    });\n\n    // Initialize the grading session with enhanced data\n    const success = initializeGradingSession(classList);\n    if (success) {\n      var _sharedRubric$assignm10, _classList$students$;\n      setActiveTab('grading-tool');\n\n      // Show enhanced success message with course info confirmation\n      const courseInfo = classList.courseMetadata;\n      alert(`🎯 Batch Grading Started!\\n\\n` + `Rubric: ${((_sharedRubric$assignm10 = sharedRubric.assignmentInfo) === null || _sharedRubric$assignm10 === void 0 ? void 0 : _sharedRubric$assignm10.title) || 'Untitled'}\\n` + `Students: ${classList.students.length}\\n` + `Course: ${(courseInfo === null || courseInfo === void 0 ? void 0 : courseInfo.courseCode) || 'N/A'} - ${(courseInfo === null || courseInfo === void 0 ? void 0 : courseInfo.courseName) || 'N/A'}\\n` + `Instructor: ${(courseInfo === null || courseInfo === void 0 ? void 0 : courseInfo.instructor) || (courseInfo === null || courseInfo === void 0 ? void 0 : courseInfo.professors) || 'N/A'}\\n` + `Term: ${(courseInfo === null || courseInfo === void 0 ? void 0 : courseInfo.term) || 'N/A'}\\n\\n` + `Starting with: ${((_classList$students$ = classList.students[0]) === null || _classList$students$ === void 0 ? void 0 : _classList$students$.name) || 'First Student'}`);\n    } else {\n      alert('Failed to initialize grading session. Please check the console for details.');\n    }\n  };\n\n  // Pause the grading session\n  const pauseGradingSession = () => {\n    setGradingSession(prev => ({\n      ...prev,\n      active: false\n    }));\n  };\n\n  // Resume the grading session\n  const resumeGradingSession = () => {\n    setGradingSession(prev => ({\n      ...prev,\n      active: true\n    }));\n    setActiveTab('grading-tool');\n  };\n\n  // NEW: Policy Preview Component\n  const PolicyPreview = ({\n    policy\n  }) => {\n    var _policy$gradeScale, _policy$gradeScale2;\n    if (!policy) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-semibold text-blue-800 mb-2 text-sm\",\n        children: [\"\\uD83D\\uDCCB Active Grading Policy: \", policy.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1397,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-xs text-blue-700 mb-2\",\n        children: policy.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1400,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 md:grid-cols-4 gap-1 text-xs\",\n        children: (_policy$gradeScale = policy.gradeScale) === null || _policy$gradeScale === void 0 ? void 0 : _policy$gradeScale.slice(0, 4).map((grade, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white p-1 rounded border text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-bold text-blue-800\",\n            children: grade.letter\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1405,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-blue-600\",\n            children: [grade.minPercentage, \"%+\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1406,\n            columnNumber: 29\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1404,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1402,\n        columnNumber: 17\n      }, this), ((_policy$gradeScale2 = policy.gradeScale) === null || _policy$gradeScale2 === void 0 ? void 0 : _policy$gradeScale2.length) > 4 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-blue-600 mt-1\",\n        children: [\"...and \", policy.gradeScale.length - 4, \" more grades\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1412,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1396,\n      columnNumber: 13\n    }, this);\n  };\n\n  // Enhanced program type dropdown with policy support\n  const renderEnhancedProgramTypeDropdown = () => {\n    var _classList$courseMeta15;\n    const programTypes = gradingPolicyService.getSupportedProgramTypes();\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"programType\",\n        className: \"block text-sm font-bold text-gray-700\",\n        children: \"Program Type:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1426,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"programType\",\n        name: \"programType\",\n        value: ((_classList$courseMeta15 = classList.courseMetadata) === null || _classList$courseMeta15 === void 0 ? void 0 : _classList$courseMeta15.programType) || 'degree',\n        onChange: handleProgramTypeChange,\n        className: \"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\",\n        children: programTypes.map(type => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: type.value,\n          children: type.label\n        }, type.value, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1435,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1427,\n        columnNumber: 17\n      }, this), selectedPolicy && /*#__PURE__*/_jsxDEV(PolicyPreview, {\n        policy: selectedPolicy\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1442,\n        columnNumber: 36\n      }, this), (policiesLoading || gradeCalculation.isPending) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 text-blue-600 mt-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1447,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs\",\n          children: policiesLoading ? 'Loading grading policies...' : 'Calculating grade...'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1448,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1446,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1425,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-7xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gradient-to-r text-gray-800 p-6 rounded-t-lg shadow-lg\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-3xl font-bold mb-2\",\n              children: \"Class List Manager\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1464,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-600\",\n              children: \"Import, manage, and grade entire classes efficiently\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1465,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1463,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-4\",\n            children: [classList && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-right\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-2xl font-bold\",\n                children: classList.students.length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1472,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-gray-700\",\n                children: \"Students\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1475,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1471,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Users, {\n              size: 48,\n              className: \"text-gray-700\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1480,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1469,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1462,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1461,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-b-lg shadow-lg\",\n        children: [!classList && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid lg:grid-cols-3 gap-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lg:col-span-2\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-gradient-to-r from-blue-700 to-indigo-700 px-8 py-6 relative\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute inset-0 bg-black/20\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1497,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-3 relative z-10\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"bg-white/30 rounded-lg p-3 backdrop-blur-sm\",\n                      children: /*#__PURE__*/_jsxDEV(FileSpreadsheet, {\n                        size: 32,\n                        className: \"text-white\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1501,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1500,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                        className: \"text-3xl font-bold text-white drop-shadow-lg\",\n                        children: \"Import Student List\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1504,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: \"text-gray-100 font-semibold text-lg drop-shadow-md\",\n                        children: \"Upload your Excel file to get started\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1505,\n                        columnNumber: 53\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1503,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1499,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1495,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"p-8\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative border-2 border-dashed border-gray-300 hover:border-blue-400 hover:bg-gray-50 rounded-xl p-12 text-center transition-all duration-300\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"file\",\n                      accept: \".xls,.xlsx\",\n                      onChange: handleFileUpload,\n                      className: \"hidden\",\n                      id: \"excel-upload\",\n                      ref: fileInputRef\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1513,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-4\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mx-auto w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center\",\n                        children: /*#__PURE__*/_jsxDEV(Upload, {\n                          size: 32,\n                          className: \"text-gray-400\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1524,\n                          columnNumber: 57\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1523,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                          className: \"text-xl font-semibold text-gray-900 mb-2\",\n                          children: \"Drop your Excel file here\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1528,\n                          columnNumber: 57\n                        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                          className: \"text-gray-600 mb-6\",\n                          children: \"or click to browse and select your student roster\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1531,\n                          columnNumber: 57\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1527,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => {\n                          var _fileInputRef$current;\n                          return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n                        },\n                        className: \"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg transition-colors duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5\",\n                        children: \"Choose Excel File\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1536,\n                        columnNumber: 53\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1522,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1512,\n                    columnNumber: 45\n                  }, this), importStatus === 'loading' && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-6 flex items-center space-x-3 p-4 bg-blue-50 border border-blue-200 rounded-lg\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1548,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-blue-800 font-medium\",\n                      children: \"\\uD83D\\uDCCA Processing Excel file...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1549,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1547,\n                    columnNumber: 49\n                  }, this), importStatus === 'success' && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-6 flex items-center space-x-3 p-4 bg-green-50 border border-green-200 rounded-lg\",\n                    children: [/*#__PURE__*/_jsxDEV(CheckCircle2, {\n                      size: 20,\n                      className: \"text-green-600\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1557,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-green-800 font-medium\",\n                      children: \"\\u2705 Excel file imported successfully!\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1558,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1556,\n                    columnNumber: 49\n                  }, this), importStatus === 'error' && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-6 flex items-center space-x-3 p-4 bg-red-50 border border-red-200 rounded-lg\",\n                    children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n                      size: 20,\n                      className: \"text-red-600\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1566,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-red-800 font-medium\",\n                      children: \"\\u2717 Error importing Excel file. Please check format and try again.\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1567,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1565,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1511,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1493,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1492,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-gray-50 px-6 py-4 border-b border-gray-100\",\n                  children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"text-lg font-semibold text-gray-900 flex items-center\",\n                    children: [/*#__PURE__*/_jsxDEV(FileText, {\n                      size: 20,\n                      className: \"mr-2 text-blue-600\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1583,\n                      columnNumber: 49\n                    }, this), \"Excel Format Requirements\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1582,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1581,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"p-6 space-y-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                      className: \"font-medium text-gray-900 mb-2\",\n                      children: \"Required Columns\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1590,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-1\",\n                      children: ['ID', 'Name', 'Email'].map(col => /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center space-x-2\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"w-2 h-2 bg-red-400 rounded-full\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1594,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"text-sm text-gray-700\",\n                          children: col\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1595,\n                          columnNumber: 61\n                        }, this)]\n                      }, col, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1593,\n                        columnNumber: 57\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1591,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1589,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                      className: \"font-medium text-gray-900 mb-2\",\n                      children: \"Optional Columns\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1602,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-1\",\n                      children: ['Program', 'Campus', 'Level', 'Status'].map(col => /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center space-x-2\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"w-2 h-2 bg-gray-400 rounded-full\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1606,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"text-sm text-gray-700\",\n                          children: col\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1607,\n                          columnNumber: 61\n                        }, this)]\n                      }, col, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1605,\n                        columnNumber: 57\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1603,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1601,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"pt-4 border-t border-gray-100\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"space-y-2 text-sm text-gray-600\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-start space-x-2\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"font-medium\",\n                          children: \"File types:\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1616,\n                          columnNumber: 57\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: \".xls or .xlsx\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1617,\n                          columnNumber: 57\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1615,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-start space-x-2\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"font-medium\",\n                          children: \"Headers:\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1620,\n                          columnNumber: 57\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: \"First row should contain column names\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1621,\n                          columnNumber: 57\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1619,\n                        columnNumber: 53\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1614,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1613,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1588,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1580,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-blue-900 mb-3 flex items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(BookOpen, {\n                    size: 20,\n                    className: \"mr-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1631,\n                    columnNumber: 45\n                  }, this), \"Pro Tips\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1630,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                  className: \"space-y-2 text-sm text-blue-800\",\n                  children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                    className: \"flex items-start space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"w-1.5 h-1.5 bg-blue-600 rounded-full mt-2 flex-shrink-0\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1636,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"Include all required columns for best results\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1637,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1635,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                    className: \"flex items-start space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"w-1.5 h-1.5 bg-blue-600 rounded-full mt-2 flex-shrink-0\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1640,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"Ensure email addresses are properly formatted\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1641,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1639,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                    className: \"flex items-start space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"w-1.5 h-1.5 bg-blue-600 rounded-full mt-2 flex-shrink-0\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1644,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"Remove any empty rows or columns\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1645,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1643,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1634,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1629,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-white rounded-xl shadow-lg border border-gray-100 p-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-gray-900 mb-3 flex items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(Download, {\n                    size: 20,\n                    className: \"mr-2 text-green-600\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1653,\n                    columnNumber: 45\n                  }, this), \"Need Help?\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1652,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600 mb-4\",\n                  children: \"Download our sample template to ensure your Excel file is formatted correctly.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1656,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    const link = document.createElement('a');\n                    link.href = '/Example-Class-List.xlsx';\n                    link.download = 'Example-Class-List.xlsx';\n                    link.click();\n                  },\n                  className: \"w-full bg-green-100 hover:bg-green-200 text-green-800 font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Download, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1668,\n                    columnNumber: 45\n                  }, this), \"Download Sample Template\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1659,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1651,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1577,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1489,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1488,\n          columnNumber: 25\n        }, this), classList && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(BookOpen, {\n                  className: \"text-blue-600\",\n                  size: 24\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1685,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-blue-800\",\n                  children: \"Course Information\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1686,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1684,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2 text-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Code:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1692,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta16 = classList.courseMetadata) === null || _classList$courseMeta16 === void 0 ? void 0 : _classList$courseMeta16.courseCode) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1691,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Name:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1696,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta17 = classList.courseMetadata) === null || _classList$courseMeta17 === void 0 ? void 0 : _classList$courseMeta17.courseName) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1695,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Section:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1700,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta18 = classList.courseMetadata) === null || _classList$courseMeta18 === void 0 ? void 0 : _classList$courseMeta18.section) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1699,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Professor:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1704,\n                    columnNumber: 45\n                  }, this), ' ', ((_classList$courseMeta19 = classList.courseMetadata) === null || _classList$courseMeta19 === void 0 ? void 0 : _classList$courseMeta19.instructor) || 'N/A']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1703,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-3\",\n                  children: renderEnhancedProgramTypeDropdown()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1709,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1690,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1683,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(GraduationCap, {\n                  className: \"text-green-600\",\n                  size: 24\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1718,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-green-800\",\n                  children: \"Grading Progress\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1719,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1717,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2 text-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Total Students:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1725,\n                    columnNumber: 45\n                  }, this), \" \", classList.students.length]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1724,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Final Grades:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1728,\n                    columnNumber: 45\n                  }, this), ' ', getGradingProgress().final]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1727,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Draft Grades:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1732,\n                    columnNumber: 45\n                  }, this), ' ', getGradingProgress().draft]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1731,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Completion:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1736,\n                    columnNumber: 45\n                  }, this), ' ', getGradingProgress().percentage, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1735,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1723,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1716,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(Play, {\n                  className: \"text-purple-600\",\n                  size: 24\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1745,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold text-purple-800\",\n                  children: \"Batch Grading Session\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1746,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1744,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-3\",\n                children: !(gradingSession !== null && gradingSession !== void 0 && gradingSession.active) ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-purple-600 mb-2\",\n                    children: (gradingSession === null || gradingSession === void 0 ? void 0 : gradingSession.currentStudentIndex) > 0 ? `Paused at student ${gradingSession.currentStudentIndex + 1} of ${classList.students.length}` : 'Ready to start batch grading'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1753,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex gap-2\",\n                    children: [(gradingSession === null || gradingSession === void 0 ? void 0 : gradingSession.currentStudentIndex) > 0 ? /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: resumeGradingSession,\n                      className: \"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors\",\n                      children: [/*#__PURE__*/_jsxDEV(Play, {\n                        size: 16\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1765,\n                        columnNumber: 61\n                      }, this), \"Resume Session\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1761,\n                      columnNumber: 57\n                    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: startGradingSession,\n                      disabled: !sharedRubric,\n                      className: \"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n                      children: [/*#__PURE__*/_jsxDEV(Play, {\n                        size: 16\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1774,\n                        columnNumber: 61\n                      }, this), \"Start Batch Grading\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1769,\n                      columnNumber: 57\n                    }, this), !sharedRubric && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-xs text-purple-600 mt-1\",\n                      children: \"Load a rubric first\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1779,\n                      columnNumber: 57\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1759,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1752,\n                  columnNumber: 45\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-green-600 font-medium mb-2\",\n                    children: [\"\\u2713 Session Active - Student \", gradingSession.currentStudentIndex + 1, \" of \", classList.students.length]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1787,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: pauseGradingSession,\n                    className: \"flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors\",\n                    children: [/*#__PURE__*/_jsxDEV(Clock, {\n                      size: 16\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1794,\n                      columnNumber: 53\n                    }, this), \"Pause Session\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1790,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1786,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1750,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1743,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1681,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white border border-gray-200 rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"px-6 py-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-semibold text-gray-800\",\n                children: \"Student Roster\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1807,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: async () => {\n                    console.log('🔄 Starting CSV export...');\n                    await exportClassGradesCSV();\n                  },\n                  className: \"px-2 py-1 rounded text-xs font-medium text-white bg-green-500 hover:bg-green-700 focus:ring-2 focus:ring-green-500 transition-colors duration-150\",\n                  children: [/*#__PURE__*/_jsxDEV(Download, {\n                    size: 14\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1818,\n                    columnNumber: 45\n                  }, this), \"CSV\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1811,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: async () => {\n                    console.log('🔄 Starting HTML export...');\n                    await exportClassGradesHTML();\n                  },\n                  className: \"flex items-center gap-1 px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(FileText, {\n                    size: 14\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1828,\n                    columnNumber: 45\n                  }, this), \"HTML\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1821,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: async () => {\n                    console.log('🔄 Starting PDF export...');\n                    await exportClassGradesPortraitPDF();\n                  },\n                  className: \"flex items-center gap-1 px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-medium transition-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(FileText, {\n                    size: 14\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1838,\n                    columnNumber: 45\n                  }, this), \"PDF\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1831,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1810,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1806,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"overflow-x-auto\",\n              children: /*#__PURE__*/_jsxDEV(\"table\", {\n                className: \"table-auto w-max mx-auto\",\n                children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                  className: \"bg-gray-50\",\n                  children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"#\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1848,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Status\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1851,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Student ID\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1854,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Name\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1857,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Email\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1860,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Program\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1863,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                      className: \"w-48 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                      children: \"Actions\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1866,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1847,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1846,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                  className: \"bg-white divide-y divide-gray-200\",\n                  children: classList.students.map((student, index) => {\n                    const progress = classList.gradingProgress[index];\n                    const isCurrentStudent = gradingSession.active && index === gradingSession.currentStudentIndex;\n                    const gradeStatus = getGradeStatus(student.id);\n                    return /*#__PURE__*/_jsxDEV(\"tr\", {\n                      className: `${isCurrentStudent ? 'bg-blue-50 border-l-4 border-blue-500' : 'hover:bg-gray-50'} transition-colors`,\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\",\n                        children: index + 1\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1885,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-6 py-4 whitespace-nowrap\",\n                        children: getStatusDisplay(progress, student.id)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1888,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\",\n                        children: student.id\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1891,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\",\n                        children: student.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1894,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-4 py-2 whitespace-normal break-words text-sm text-gray-500 max-w-xs\",\n                        children: student.email\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1897,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",\n                        children: student.program\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1900,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"w-48 px-4 py-2 text-sm whitespace-normal\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"flex flex-wrap items-center gap-2\",\n                          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => loadStudentForGrading(student),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-blue-500 hover:bg-blue-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-blue-500 duration-150\",\n                            children: gradeStatus === 'final' ? 'View' : 'Edit'\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1907,\n                            columnNumber: 65\n                          }, this), gradeStatus === 'draft' && /*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => finalizeGrade(student.id),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-green-500 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-green-500 duration-150\",\n                            children: \"Finalize\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1916,\n                            columnNumber: 69\n                          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => exportStudentGrade(student.id),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-purple-500 hover:bg-purple-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-purple-500 duration-150\",\n                            children: [/*#__PURE__*/_jsxDEV(ExternalLink, {\n                              size: 14\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1929,\n                              columnNumber: 69\n                            }, this), \"Export Grade\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1925,\n                            columnNumber: 65\n                          }, this), gradeStatus === 'final' && /*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => unlockGrade(student.id),\n                            className: \"flex items-center gap-1 px-3 py-1 bg-orange-500 hover:bg-orange-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-orange-500 duration-150\",\n                            children: [/*#__PURE__*/_jsxDEV(Unlock, {\n                              size: 14\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1939,\n                              columnNumber: 73\n                            }, this), \"Unlock\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1935,\n                            columnNumber: 69\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1905,\n                          columnNumber: 61\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1904,\n                        columnNumber: 57\n                      }, this)]\n                    }, student.id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1878,\n                      columnNumber: 53\n                    }, this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1871,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1845,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1844,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1804,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-8 bg-gray-50 rounded-lg p-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-semibold text-gray-800 mb-4\",\n              children: \"Import Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1955,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"File:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1958,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: classList.fileName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1959,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1957,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Import Date:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1962,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: new Date(classList.importTime).toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1963,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1961,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Data Quality:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1968,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: [((_classList$validation = classList.validation) === null || _classList$validation === void 0 ? void 0 : _classList$validation.validationScore) || 0, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1969,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1967,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-gray-600\",\n                  children: \"Total Students:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1974,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: classList.students.length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1975,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1973,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1956,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1954,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1679,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1485,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1459,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1458,\n    columnNumber: 9\n  }, this);\n};\n_s(ClassListManager, \"QGMVSOWGXdPvhhdUnHwB0ctg8dg=\", false, function () {\n  return [useGradingPolicies, useGradingPolicyForProgram, useGradeCalculation, useGradingPolicyManager, useAssessment];\n});\n_c = ClassListManager;\nexport default ClassListManager;\nvar _c;\n$RefreshReg$(_c, \"ClassListManager\");","map":{"version":3,"names":["React","useRef","useState","useEffect","useMemo","Upload","Users","BookOpen","GraduationCap","Play","Download","CheckCircle","Clock","AlertCircle","Unlock","FileText","ExternalLink","FileSpreadsheet","CheckCircle2","Settings","useAssessment","DEFAULT_LATE_POLICY","parseExcelFile","validateStudentData","getSchoolLogo","generateReportHeader","getReportStyles","hasSchoolLogo","gradingPolicyService","useGradingPolicies","useGradingPolicyForProgram","useGradeCalculation","useGradingPolicyManager","percentageToLetterGrade","jsxDEV","_jsxDEV","getLetterGrade","percentage","programType","customProgramId","selectedPolicy","result","calculateGrade","id","success","data","letter","error","console","warn","scales","degree","min","grade","diploma","certificate","graduateCertificate","scale","entry","find","e","ClassListManager","_s","_classList$courseMeta2","_classList$courseMeta16","_classList$courseMeta17","_classList$courseMeta18","_classList$courseMeta19","_classList$validation","fileInputRef","importStatus","setImportStatus","availablePolicies","isLoading","policiesLoading","isActive","currentProgramType","setCurrentProgramType","gradeCalculation","prefetchPolicyForProgram","classList","setClassList","gradingSession","setGradingSession","initializeGradingSession","setActiveTab","setCurrentStudent","hasDraft","getGradeStatus","saveFinalGrade","loadDraft","saveDraft","drafts","sharedRubric","updateStudentInfo","updateAssignmentInfo","updateCourseInfo","loadFinalGrade","finalGrades","rubricFormData","currentLatePolicy","_classList$courseMeta","courseMetadata","programTypes","forEach","type","handleProgramTypeChange","newType","target","value","prev","getStatusDisplay","progress","studentId","gradeStatus","className","children","fileName","_jsxFileName","lineNumber","columnNumber","status","finalizeGrade","log","draftData","studentIndex","students","findIndex","s","updatedProgress","gradingProgress","previousProgress","lastModified","Date","toISOString","gradeType","before","after","unlockGrade","loadFinalGradeData","calculateStudentGrade","_sharedRubric$assignm2","_student$program","_classList$courseMeta3","_classList$courseMeta4","gradeData","criteria","_sharedRubric$assignm","score","maxPossible","assignmentInfo","totalPoints","letterGrade","totalScore","maxScore","rubricGrading","criterion","selectedLevel","level","rubricLevels","l","maxPoints","multiplier","activeLevels","levels","finalScore","latePolicy","latePolicyLevel","none","Math","round","student","program","toLowerCase","_classList$courseMeta5","_gradeResult$data","gradeResult","getLetterGradeFallback","gradingScales","loadStudentForGrading","name","email","_sharedRubric$assignm3","_sharedRubric$assignm4","title","finalData","getGradingProgress","completed","total","final","draft","length","exportClassGradesCSV","_classList$courseMeta6","studentGrades","Promise","all","map","index","gradeInfo","lm","toLocaleDateString","rows","quote","cell","String","trim","replace","csvContent","row","join","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","courseCode","slice","click","revokeObjectURL","getClassGradesHTMLWithLogo","_classList$courseMeta7","_classList$courseMeta8","_classList$courseMeta9","_sharedRubric$assignm5","now","currentDate","currentTime","toLocaleTimeString","studentRows","idx","_classList$gradingPro","_classList$gradingPro2","_classList$gradingPro3","info","gradeDisplay","rowsHtml","reportData","courseName","section","rubricTitle","exportClassGradesHTML","_classList$courseMeta0","htmlContent","style","display","body","appendChild","removeChild","getPortraitClassReportHTMLWithLogo","_sharedRubric$assignm6","_classList$courseMeta1","_classList$courseMeta10","_classList$courseMeta11","rubricName","num","parseFloat","rowClass","studentRowsHtml","maxHeight","exportClassGradesPortraitPDF","printWin","window","open","write","close","focus","onload","print","exportStudentGrade","alert","getSafeLatePolicy","calculateTotalScore","rawScore","penaltyApplied","totalPossible","points","_gradeData$latePolicy","generateStudentReportHTML","_gradeData$attachment","_gradeData$videoLinks","_classList$courseMeta12","_gradeData$course","_classList$courseMeta13","_gradeData$course2","_classList$courseMeta14","_sharedRubric$assignm7","_gradeData$assignment","_gradeData$latePolicy2","_gradeData$latePolicy3","_gradeData$latePolicy4","_sharedRubric$assignm8","scoreCalculation","toFixed","attachmentsHTML","attachments","att","base64Data","size","videoLinksHTML","videoLinks","rubricTableHTML","_gradeData$rubricGrad","_criterion$levels","_criterion$levels$sel","levelDescription","description","additionalComments","customComments","color","passingThreshold","course","code","assignment","headerHtml","Object","entries","feedback","filter","key","text","charAt","toUpperCase","JSON","stringify","_sharedRubric$assignm9","_sharedRubric$assignm0","htmlBlob","handleFileUpload","event","file","files","_result$courseMetadat","_result$courseMetadat2","_result$courseMetadat3","_result$courseMetadat4","_result$courseMetadat5","_result$courseMetadat6","_result$courseMetadat7","_result$courseMetadat8","_result$courseMetadat9","_result$courseMetadat0","_result$courseMetadat1","_result$courseMetadat10","Error","validation","classListData","fileSize","importTime","professors","instructor","term","hours","gradeScale","department","campus","totalStudents","validationScore","issues","courseInfo","field","setTimeout","startGradingSession","_sharedRubric$assignm1","studentCount","_sharedRubric$assignm10","_classList$students$","pauseGradingSession","active","resumeGradingSession","PolicyPreview","policy","_policy$gradeScale","_policy$gradeScale2","minPercentage","renderEnhancedProgramTypeDropdown","_classList$courseMeta15","getSupportedProgramTypes","htmlFor","onChange","label","isPending","accept","ref","onClick","_fileInputRef$current","current","col","currentStudentIndex","disabled","isCurrentStudent","_c","$RefreshReg$"],"sources":["C:/local clones/rubric-creation-app/src/components/ClassListManager.js"],"sourcesContent":["import React, { useRef, useState, useEffect, useMemo } from 'react';\r\nimport {\r\n    Upload,\r\n    Users,\r\n    BookOpen,\r\n    GraduationCap,\r\n    Play,\r\n    Download,\r\n    CheckCircle,\r\n    Clock,\r\n    AlertCircle,\r\n    Unlock,\r\n    FileText,\r\n    ExternalLink,\r\n    FileSpreadsheet,\r\n    CheckCircle2,\r\n    Settings\r\n} from 'lucide-react';\r\nimport { useAssessment, DEFAULT_LATE_POLICY } from './SharedContext';\r\nimport { parseExcelFile, validateStudentData } from '../utils/excelParser';\r\nimport { getSchoolLogo, generateReportHeader, getReportStyles, hasSchoolLogo } from './logoIntegrationUtility';\r\n\r\n// Add new imports for grading policy management\r\nimport gradingPolicyService from '../services/gradingPolicyService';\r\nimport {\r\n    useGradingPolicies,\r\n    useGradingPolicyForProgram,\r\n    useGradeCalculation,\r\n    useGradingPolicyManager\r\n} from '../hooks/useGradingPolicies';\r\n// Add gradebook utilities import for letter grade calculation\r\nimport { percentageToLetterGrade } from '../utils/gradebookUtilis';\r\n/**\r\n * Enhanced getLetterGrade function with dynamic policy support\r\n * Falls back to original hardcoded scales if policy service fails\r\n */\r\nconst getLetterGrade = async (percentage, programType, customProgramId = null, selectedPolicy = null) => {\r\n    // Try dynamic policy calculation first\r\n    try {\r\n        const result = await gradingPolicyService.calculateGrade(\r\n            percentage,\r\n            selectedPolicy?.id,\r\n            programType,\r\n            customProgramId\r\n        );\r\n\r\n        if (result.success) {\r\n            return result.data.letter;\r\n        }\r\n    } catch (error) {\r\n        console.warn('Dynamic grading failed, using legacy fallback:', error);\r\n    }\r\n\r\n    // Legacy fallback - your original hardcoded scales (preserved exactly)\r\n    const scales = {\r\n        degree: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ],\r\n        diploma: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ],\r\n        certificate: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ],\r\n        graduateCertificate: [\r\n            { min: 90, grade: 'A+' },\r\n            { min: 80, grade: 'A' },\r\n            { min: 75, grade: 'B+' },\r\n            { min: 70, grade: 'B' },\r\n            { min: 65, grade: 'C+' },\r\n            { min: 60, grade: 'C' },\r\n            { min: 0, grade: 'F' }\r\n        ]\r\n    };\r\n\r\n    // Pick the right scale (default to degree if missing)\r\n    const scale = scales[programType] || scales.degree;\r\n\r\n    // Find the first entry where percentage ≥ min\r\n    const entry = scale.find(e => percentage >= e.min);\r\n\r\n    return entry ? entry.grade : 'N/A';\r\n};\r\n\r\nconst ClassListManager = () => {\r\n    const fileInputRef = useRef(null);\r\n    const [importStatus, setImportStatus] = useState('');\r\n\r\n    // Add new grading policy state management using TanStack Query hooks\r\n    const { data: availablePolicies = [], isLoading: policiesLoading } = useGradingPolicies({ isActive: true });\r\n    const [currentProgramType, setCurrentProgramType] = useState('degree');\r\n    const { data: selectedPolicy } = useGradingPolicyForProgram(currentProgramType);\r\n    const gradeCalculation = useGradeCalculation();\r\n    const { prefetchPolicyForProgram } = useGradingPolicyManager();\r\n\r\n    const {\r\n        classList,\r\n        setClassList,\r\n        gradingSession,\r\n        setGradingSession,\r\n        initializeGradingSession,\r\n        setActiveTab,\r\n        setCurrentStudent,\r\n        hasDraft,\r\n        getGradeStatus,\r\n        saveFinalGrade,\r\n        loadDraft,\r\n        saveDraft,\r\n        drafts,\r\n        sharedRubric,\r\n        updateStudentInfo,\r\n        updateAssignmentInfo,\r\n        updateCourseInfo, // FIXED: Added updateCourseInfo from the context\r\n        loadFinalGrade,\r\n        finalGrades,\r\n        rubricFormData,\r\n        currentLatePolicy,\r\n    } = useAssessment();\r\n\r\n    \r\n\r\n    // Load current program type from class metadata and update policy\r\n    useEffect(() => {\r\n        if (classList?.courseMetadata?.programType) {\r\n            setCurrentProgramType(classList.courseMetadata.programType);\r\n        }\r\n    }, [classList?.courseMetadata?.programType]);\r\n\r\n    // Prefetch policies for better UX\r\n    useEffect(() => {\r\n        const programTypes = ['degree', 'diploma', 'certificate', 'graduateCertificate', 'apprenticeship', 'healthScience', 'gasTechnician'];\r\n        programTypes.forEach(type => {\r\n            if (type !== currentProgramType) {\r\n                prefetchPolicyForProgram(type);\r\n            }\r\n        });\r\n    }, [currentProgramType, prefetchPolicyForProgram]);\r\n\r\n    // Enhanced handler to change the program type for grading with policy loading\r\n    const handleProgramTypeChange = (e) => {\r\n        const newType = e.target.value;\r\n        setCurrentProgramType(newType);\r\n        setClassList(prev => ({\r\n            ...prev,\r\n            courseMetadata: {\r\n                ...prev.courseMetadata,\r\n                programType: newType,\r\n            },\r\n        }));\r\n    };\r\n\r\n    // Helper function for status display (preserved exactly from original)\r\n    const getStatusDisplay = (progress, studentId) => {\r\n        const gradeStatus = getGradeStatus(studentId);\r\n\r\n        if (gradeStatus === 'final') {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <CheckCircle className=\"w-4 h-4 text-green-600\" />\r\n                    <span className=\"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium\">\r\n                        Final\r\n                    </span>\r\n                </div>\r\n            );\r\n        } else if (gradeStatus === 'draft') {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <Clock className=\"w-4 h-4 text-yellow-600\" />\r\n                    <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-medium\">\r\n                        Draft\r\n                    </span>\r\n                </div>\r\n            );\r\n        } else if (progress?.status === 'in-progress') {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-medium\">\r\n                        In Progress\r\n                    </span>\r\n                </div>\r\n            );\r\n        } else {\r\n            return (\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-4 h-4 bg-gray-300 rounded-full\"></div>\r\n                    <span className=\"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full\">\r\n                        Not Started\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n    };\r\n\r\n    // Helper function to finalize a draft grade (preserved exactly from original)\r\n    const finalizeGrade = (studentId) => {\r\n        console.log('🔧 Finalizing grade for student:', studentId);\r\n\r\n        const draftData = drafts[studentId];\r\n        if (draftData) {\r\n            // Save the final grade\r\n            saveFinalGrade(studentId, draftData);\r\n\r\n            // Update class list progress with better logging\r\n            const studentIndex = classList.students.findIndex(s => s.id === studentId);\r\n            console.log('📍 Found student at index:', studentIndex);\r\n\r\n            if (studentIndex >= 0) {\r\n                const updatedProgress = [...classList.gradingProgress];\r\n                const previousProgress = updatedProgress[studentIndex];\r\n\r\n                updatedProgress[studentIndex] = {\r\n                    ...updatedProgress[studentIndex],\r\n                    status: 'completed_final',\r\n                    lastModified: new Date().toISOString(),\r\n                    gradeType: 'final'\r\n                };\r\n\r\n                console.log('📊 Progress update:', {\r\n                    studentId,\r\n                    before: previousProgress,\r\n                    after: updatedProgress[studentIndex]\r\n                });\r\n\r\n                setClassList(prev => ({\r\n                    ...prev,\r\n                    gradingProgress: updatedProgress\r\n                }));\r\n\r\n                console.log('✅ Class list updated successfully');\r\n            } else {\r\n                console.error('❌ Student not found in class list:', studentId);\r\n            }\r\n        } else {\r\n            console.error('❌ No draft data found for student:', studentId);\r\n        }\r\n    };\r\n\r\n    // Helper function to unlock a final grade (preserved exactly from original)\r\n    const unlockGrade = (studentId) => {\r\n        // For now, we'll implement this by updating the class list progress\r\n        // The actual unlocking logic should be implemented in SharedContext\r\n        const studentIndex = classList.students.findIndex(s => s.id === studentId);\r\n        if (studentIndex >= 0) {\r\n            const updatedProgress = [...classList.gradingProgress];\r\n            updatedProgress[studentIndex] = {\r\n                ...updatedProgress[studentIndex],\r\n                status: 'completed_draft',\r\n                lastModified: new Date().toISOString(),\r\n                gradeType: 'draft'\r\n            };\r\n            setClassList(prev => ({\r\n                ...prev,\r\n                gradingProgress: updatedProgress\r\n            }));\r\n        }\r\n\r\n        // Note: Full unlock functionality requires additional implementation in SharedContext\r\n        console.log('Unlock grade for student:', studentId);\r\n    };\r\n\r\n    // Helper function to load final grade data (preserved exactly from original)\r\n    const loadFinalGradeData = (studentId) => {\r\n        // Use loadFinalGrade if available, otherwise fallback to checking finalGrades directly\r\n        if (typeof loadFinalGrade === 'function') {\r\n            return loadFinalGrade(studentId);\r\n        }\r\n        // Fallback: check finalGrades directly if available\r\n        if (finalGrades && finalGrades[studentId]) {\r\n            return finalGrades[studentId];\r\n        }\r\n        // Last resort: check drafts (this maintains current behavior)\r\n        return drafts[studentId] || null;\r\n    };\r\n\r\n    // **ENHANCED**: This function now uses dynamic grading with fallback to legacy calculation\r\n    // ENHANCED calculateStudentGrade function for ClassListManager.js\r\n    // Replace the existing calculateStudentGrade function (around lines 200-280)\r\n\r\n    const calculateStudentGrade = async (studentId) => {\r\n        const gradeStatus = getGradeStatus(studentId);\r\n        let gradeData = null;\r\n\r\n        if (gradeStatus === 'final') {\r\n            gradeData = loadFinalGradeData(studentId);\r\n        } else if (gradeStatus === 'draft') {\r\n            gradeData = loadDraft(studentId);\r\n        }\r\n\r\n        // If no grade data, return empty result\r\n        if (!gradeData || !sharedRubric || !sharedRubric.criteria) {\r\n            return {\r\n                score: 'N/A',\r\n                maxPossible: sharedRubric?.assignmentInfo?.totalPoints || 100,\r\n                percentage: 'N/A',\r\n                letterGrade: 'N/A'\r\n            };\r\n        }\r\n\r\n        // Calculate raw score from rubric grading\r\n        let totalScore = 0;\r\n        let maxScore = sharedRubric.assignmentInfo?.totalPoints || 0;\r\n\r\n        if (gradeData.rubricGrading) {\r\n            sharedRubric.criteria.forEach(criterion => {\r\n                const rubricGrading = gradeData.rubricGrading[criterion.id];\r\n                if (rubricGrading && rubricGrading.selectedLevel) {\r\n                    const level = sharedRubric.rubricLevels.find(l => l.level === rubricGrading.selectedLevel);\r\n                    if (level) {\r\n                        totalScore += criterion.maxPoints * level.multiplier;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // Apply late policy if applicable\r\n        const activeLevels = currentLatePolicy?.levels || DEFAULT_LATE_POLICY.levels;\r\n        let finalScore = totalScore;\r\n\r\n        if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\r\n            const latePolicyLevel = activeLevels[gradeData.latePolicy.level] || activeLevels.none;\r\n            finalScore = totalScore * latePolicyLevel.multiplier;\r\n        }\r\n\r\n        // Calculate percentage\r\n        const percentage = maxScore > 0 ? Math.round((finalScore / maxScore) * 100) : 0;\r\n\r\n        // ENHANCED: Determine program type from student and class data\r\n        const student = classList.students.find(s => s.id === studentId);\r\n        const programType = student?.program?.toLowerCase() ||\r\n            classList.courseMetadata?.programType?.toLowerCase() ||\r\n            'degree'; // default fallback\r\n\r\n        // ENHANCED: Use dynamic letter grade calculation with proper program type detection\r\n        let letterGrade = 'N/A';\r\n\r\n        try {\r\n            // First try using the grading policy service\r\n            if (gradingPolicyService) {\r\n                const gradeResult = await gradingPolicyService.calculateGrade(\r\n                    percentage,\r\n                    null, // policyId - let it auto-select\r\n                    programType,\r\n                    classList.courseMetadata?.customProgramId\r\n                );\r\n\r\n                if (gradeResult.success && gradeResult.data?.letter) {\r\n                    letterGrade = gradeResult.data.letter;\r\n                }\r\n            }\r\n\r\n            // Fallback to gradebook utilities if grading service fails\r\n            if (letterGrade === 'N/A') {\r\n                // Import the utility function if not already imported from '../utils/gradebookUtilis'\r\n                if (typeof percentageToLetterGrade === 'function') {\r\n                    letterGrade = percentageToLetterGrade(percentage, programType);\r\n                } else {\r\n                    // Manual fallback calculation\r\n                    letterGrade = getLetterGradeFallback(percentage, programType);\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.warn('Error calculating letter grade, using fallback:', error);\r\n            letterGrade = getLetterGradeFallback(percentage, programType);\r\n        }\r\n\r\n        return {\r\n            score: Math.round(finalScore * 10) / 10,\r\n            maxPossible: maxScore,\r\n            percentage,\r\n            letterGrade\r\n        };\r\n    };\r\n\r\n    // ENHANCED: Fallback letter grade calculation function\r\n    const getLetterGradeFallback = (percentage, programType = 'degree') => {\r\n        // Define grading scales for different program types\r\n        const gradingScales = {\r\n            degree: [\r\n                { min: 90, grade: 'A+' },\r\n                { min: 85, grade: 'A' },\r\n                { min: 80, grade: 'A-' },\r\n                { min: 77, grade: 'B+' },\r\n                { min: 73, grade: 'B' },\r\n                { min: 70, grade: 'B-' },\r\n                { min: 67, grade: 'C+' },\r\n                { min: 63, grade: 'C' },\r\n                { min: 60, grade: 'C-' },\r\n                { min: 50, grade: 'D' },\r\n                { min: 0, grade: 'F' }\r\n            ],\r\n            diploma: [\r\n                { min: 90, grade: 'A+' },\r\n                { min: 80, grade: 'A' },\r\n                { min: 75, grade: 'B+' },\r\n                { min: 70, grade: 'B' },\r\n                { min: 65, grade: 'C+' },\r\n                { min: 60, grade: 'C' },\r\n                { min: 50, grade: 'D' },\r\n                { min: 0, grade: 'F' }\r\n            ],\r\n            certificate: [\r\n                { min: 80, grade: 'A' },\r\n                { min: 70, grade: 'B' },\r\n                { min: 60, grade: 'C' },\r\n                { min: 0, grade: 'F' }\r\n            ]\r\n        };\r\n\r\n        const scale = gradingScales[programType] || gradingScales.degree;\r\n\r\n        for (const { min, grade } of scale) {\r\n            if (percentage >= min) {\r\n                return grade;\r\n            }\r\n        }\r\n\r\n        return 'F';\r\n    };\r\n\r\n    // Helper function to load student for grading (preserved exactly from original)\r\n    const loadStudentForGrading = (student) => {\r\n        const gradeStatus = getGradeStatus(student.id);\r\n\r\n        // Set the current student first\r\n        setCurrentStudent(student);\r\n\r\n        // Load the student info into the grading form\r\n        updateStudentInfo('name', student.name || '');\r\n        updateStudentInfo('id', student.id || '');\r\n        updateStudentInfo('email', student.email || '');\r\n\r\n        // Load rubric assignment info if available\r\n        if (sharedRubric) {\r\n            updateAssignmentInfo({\r\n                name: sharedRubric.assignmentInfo?.title || '',\r\n                maxPoints: sharedRubric.assignmentInfo?.totalPoints || 100\r\n            });\r\n        }\r\n\r\n        // Provide user feedback and load appropriate data\r\n        if (gradeStatus === 'final') {\r\n            const finalData = loadFinalGradeData(student.id);\r\n            console.log(`Loading final grade for ${student.name}:`, finalData ? 'Found' : 'Not found');\r\n        } else if (gradeStatus === 'draft') {\r\n            const draftData = loadDraft(student.id);\r\n            console.log(`Loading draft for ${student.name}:`, draftData ? 'Found' : 'Not found');\r\n        } else {\r\n            console.log(`Starting new grade for ${student.name}`);\r\n        }\r\n\r\n        // Switch to grading tool - the GradingTemplate useEffect will handle loading the data\r\n        setActiveTab('grading-tool');\r\n\r\n        // Note: The actual data loading happens in GradingTemplate's useEffect for currentStudent\r\n    };\r\n\r\n    // Helper function to get grading progress statistics (preserved exactly from original)\r\n    const getGradingProgress = () => {\r\n        if (!classList) return { completed: 0, total: 0, percentage: 0, final: 0, draft: 0 };\r\n\r\n        let final = 0;\r\n        let draft = 0;\r\n\r\n        // Use actual grade status instead of stored progress data\r\n        classList.students.forEach(student => {\r\n            const gradeStatus = getGradeStatus(student.id);\r\n\r\n            if (gradeStatus === 'final') {\r\n                final++;\r\n            } else if (gradeStatus === 'draft') {\r\n                draft++;\r\n            }\r\n        });\r\n\r\n        const completed = final + draft;\r\n        const total = classList.students.length;\r\n        const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\r\n\r\n        return { completed, total, percentage, final, draft };\r\n    };\r\n\r\n    // FIXED: Export class grades as CSV with async/await properly handled\r\n    const exportClassGradesCSV = async () => {\r\n        if (!classList) return;\r\n\r\n        console.log('🔄 Starting CSV export with async grade calculations...');\r\n\r\n        // 1) Calculate grades for all students asynchronously\r\n        const studentGrades = await Promise.all(\r\n            classList.students.map(async (student, index) => {\r\n                const progress = classList.gradingProgress[index] || {};\r\n                const gradeStatus = getGradeStatus(student.id); // Use consistent status check\r\n                const gradeInfo = await calculateStudentGrade(student.id);\r\n                const lm = progress.lastModified\r\n                    ? new Date(progress.lastModified).toLocaleDateString()\r\n                    : 'Never';\r\n\r\n                return [\r\n                    index + 1,                            // # column\r\n                    student.id,\r\n                    student.name,\r\n                    student.email,\r\n                    student.program || 'N/A',\r\n                    progress.status || 'pending',\r\n                    progress.gradeType || 'none',\r\n                    gradeInfo.score !== 'N/A'\r\n                        ? `${gradeInfo.score}/${gradeInfo.maxPossible}`\r\n                        : 'N/A',\r\n                    gradeInfo.letterGrade || 'N/A',\r\n                    gradeInfo.percentage !== 'N/A'\r\n                        ? `${gradeInfo.percentage}%`\r\n                        : 'N/A',\r\n                    lm\r\n                ];\r\n            })\r\n        );\r\n\r\n        // 2) Build the complete data array with headers\r\n        const rows = [\r\n            ['#', 'Student ID', 'Student Name', 'Email', 'Program', 'Status', 'Grade Type', 'Numeric Grade', 'Letter Grade', 'Percentage', 'Last Modified'],\r\n            ...studentGrades\r\n        ];\r\n\r\n        // 3) Quote each cell and create CSV\r\n        const quote = cell => `\"${String(cell).trim().replace(/\"/g, '\"\"')}\"`;\r\n        const csvContent = rows\r\n            .map(row => row.map(quote).join(','))\r\n            .join('\\r\\n');\r\n\r\n        // 4) Trigger download\r\n        const blob = new Blob([csvContent], { type: 'text/csv' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = `${classList.courseMetadata?.courseCode || 'class'}_grades_${new Date().toISOString().slice(0, 10)}.csv`;\r\n        link.click();\r\n        URL.revokeObjectURL(url);\r\n\r\n        console.log('✅ CSV export completed with letter grades');\r\n    };\r\n\r\n    // Enhanced version of your existing getClassGradesHTML function\r\n    const getClassGradesHTMLWithLogo = async () => {\r\n        const now = new Date();\r\n        const currentDate = now.toLocaleDateString('en-CA');\r\n        const currentTime = now.toLocaleTimeString('en-CA');\r\n\r\n        console.log('🔄 Generating class grades HTML with logo...');\r\n\r\n        // Calculate grades for all students asynchronously (your existing logic)\r\n        const studentRows = await Promise.all(\r\n            classList.students.map(async (student, idx) => {\r\n                const info = await calculateStudentGrade(student.id);\r\n                const gradeDisplay = info.score !== 'N/A' ? `${info.score}%` : 'N/A';\r\n                const letterGrade = info.letterGrade || 'N/A';\r\n                const percentage = info.score !== 'N/A' ? `${info.score}%` : 'N/A';\r\n                const lastModified = classList.gradingProgress[idx]?.lastModified\r\n                    ? new Date(classList.gradingProgress[idx].lastModified).toLocaleDateString('en-CA')\r\n                    : 'Not graded';\r\n\r\n                return `\r\n        <tr>\r\n          <td>${idx + 1}</td>\r\n          <td>${student.id}</td>\r\n          <td>${student.name}</td>\r\n          <td>${student.email}</td>\r\n          <td>${student.program}</td>\r\n          <td>${classList.gradingProgress[idx]?.status || 'pending'}</td>\r\n          <td>${classList.gradingProgress[idx]?.gradeType || 'N/A'}</td>\r\n          <td>${gradeDisplay}</td>\r\n          <td>${letterGrade}</td>\r\n          <td>${percentage}</td>\r\n          <td>${lastModified}</td>\r\n        </tr>\r\n      `;\r\n            })\r\n        );\r\n\r\n        const rowsHtml = studentRows.join('');\r\n\r\n        // Use the logo utility to generate header\r\n        const reportData = {\r\n            title: '📊 Class Grade Report',  // ← FIXED: Correct title for class report\r\n            courseCode: classList.courseMetadata?.courseCode || '',\r\n            courseName: classList.courseMetadata?.courseName || '',\r\n            section: classList.courseMetadata?.section || '',\r\n            rubricTitle: sharedRubric?.assignmentInfo?.title || 'Unnamed Rubric'\r\n        };\r\n\r\n        return `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <title>Class Grade Report</title>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  ${getReportStyles()}\r\n</head>\r\n<body>\r\n  ${generateReportHeader(reportData)}\r\n\r\n  <div class=\"table-container\">\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th>#</th><th>Student ID</th><th>Name</th><th>Email</th>\r\n          <th>Program</th><th>Status</th><th>Grade Type</th>\r\n          <th>Final Grade</th><th>Letter Grade</th><th>Percentage</th><th>Last Modified</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${rowsHtml}\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <div class=\"footer\">\r\n    Imported from: ${classList.fileName}\r\n  </div>\r\n</body>\r\n</html>`;\r\n    };\r\n\r\n    // FIXED: Export class grades as HTML with async/await properly handled\r\n    const exportClassGradesHTML = async () => {\r\n        if (!classList) return;\r\n\r\n        console.log('🔄 Exporting HTML with async grade calculations...');\r\n\r\n        // Use the logo-enhanced version\r\n        const htmlContent = await getClassGradesHTMLWithLogo();\r\n        const blob = new Blob([htmlContent], { type: 'text/html' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n\r\n        link.href = url;\r\n        link.download = `${classList.courseMetadata?.courseCode || 'Class'}_grades.html`;\r\n        link.style.display = 'none';\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n\r\n        URL.revokeObjectURL(url);\r\n\r\n        console.log('✅ HTML export completed with letter grades and logo');\r\n    };\r\n\r\n    // Enhanced version of your existing getPortraitClassReportHTML function\r\n    const getPortraitClassReportHTMLWithLogo = async () => {\r\n        const now = new Date();\r\n        const currentDate = now.toLocaleDateString('en-CA');\r\n        const currentTime = now.toLocaleTimeString('en-CA');\r\n        const rubricName = sharedRubric?.assignmentInfo?.title || 'Unnamed Rubric';\r\n\r\n        console.log('🔄 Generating portrait report with logo and async grade calculations...');\r\n\r\n        // Calculate grades for all students asynchronously (your existing logic)\r\n        const studentRows = await Promise.all(\r\n            classList.students.map(async (student, idx) => {\r\n                const info = await calculateStudentGrade(student.id);\r\n                const num = info.score !== 'N/A'\r\n                    ? parseFloat(info.score)\r\n                    : null;\r\n\r\n                const rowClass = num !== null\r\n                    ? (num >= 80 ? 'high-grade' : num >= 60 ? 'medium-grade' : 'low-grade')\r\n                    : 'no-grade';\r\n\r\n                return `\r\n        <tr class=\"${rowClass}\">\r\n          <td style=\"text-align:center\">${idx + 1}</td>\r\n          <td>${student.id}</td>\r\n          <td><strong>${student.name}</strong></td>\r\n          <td>${student.email}</td>\r\n          <td>${student.program}</td>\r\n          <td style=\"text-align:center\">${info.score !== 'N/A' ? `${info.score}%` : 'N/A'}</td>\r\n          <td style=\"text-align:center; font-weight:bold\">${info.letterGrade || 'N/A'}</td>\r\n        </tr>\r\n      `;\r\n            })\r\n        );\r\n\r\n        const studentRowsHtml = studentRows.join('');\r\n\r\n        // Use the logo utility to generate header\r\n        const reportData = {\r\n            title: '📊 Class Grade Report (Portrait)',\r\n            courseCode: classList.courseMetadata?.courseCode || '',\r\n            courseName: classList.courseMetadata?.courseName || '',\r\n            section: classList.courseMetadata?.section || '',\r\n            rubricTitle: rubricName\r\n        };\r\n\r\n        return `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <title>Class Grade Report</title>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  ${getReportStyles()}\r\n  <style>\r\n    .high-grade { background-color: #d4edda !important; }\r\n    .medium-grade { background-color: #fff3cd !important; }\r\n    .low-grade { background-color: #f8d7da !important; }\r\n    .no-grade { background-color: #f8f9fa !important; }\r\n    \r\n    @page {\r\n      size: A4 portrait;\r\n      margin: 15mm;\r\n    }\r\n    \r\n    @media print {\r\n      body { \r\n        font-size: 10pt; \r\n        background: white;\r\n      }\r\n      .school-logo, .report-logo { \r\n        max-height: 50px !important; \r\n      }\r\n      table { \r\n        page-break-inside: auto; \r\n      }\r\n      tr { \r\n        page-break-inside: avoid; \r\n        page-break-after: auto; \r\n      }\r\n      thead { \r\n        display: table-header-group; \r\n      }\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  ${generateReportHeader(reportData, { maxHeight: 60 })}\r\n\r\n  <div class=\"table-container\">\r\n    <table>\r\n      <thead>\r\n        <tr style=\"background-color: #2563eb; color: white;\">\r\n          <th style=\"text-align:center\">#</th>\r\n          <th>Student ID</th>\r\n          <th>Name</th>\r\n          <th>Email</th>\r\n          <th>Program</th>\r\n          <th style=\"text-align:center\">Grade</th>\r\n          <th style=\"text-align:center\">Letter</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${studentRowsHtml}\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <div class=\"footer\">\r\n    <div style=\"margin-top: 20px; text-align: center; font-size: 12px; color: #666;\">\r\n      <strong>Grade Distribution Summary</strong><br>\r\n      Report generated on ${currentDate} at ${currentTime}<br>\r\n      Total Students: ${classList.students.length} | Rubric: ${rubricName}\r\n    </div>\r\n  </div>\r\n</body>\r\n</html>`;\r\n    };\r\n\r\n    // FIXED: Export portrait PDF with async/await properly handled\r\n    const exportClassGradesPortraitPDF = async () => {\r\n        if (!classList) return;\r\n\r\n        console.log('🔄 Generating PDF with async grade calculations and logo...');\r\n\r\n        // Use the logo-enhanced version\r\n        const htmlContent = await getPortraitClassReportHTMLWithLogo();\r\n        const printWin = window.open('', '_blank', 'width=800,height=600');\r\n        printWin.document.write(htmlContent);\r\n        printWin.document.close();\r\n        printWin.focus();\r\n\r\n        printWin.onload = () => {\r\n            printWin.print();\r\n        };\r\n\r\n        console.log('✅ PDF generation completed with letter grades and logo');\r\n    };\r\n\r\n    // Complete exportStudentGrade function for ClassListManager.js (preserved exactly from original)\r\n    const exportStudentGrade = (studentId) => {\r\n        // 1. Make sure we have a classList and sharedRubric\r\n        if (!classList || !sharedRubric) {\r\n            alert('No class list or rubric available. Please ensure both are loaded.');\r\n            return;\r\n        }\r\n\r\n        // 2. Find the student in the class list\r\n        const student = classList.students.find(s => s.id === studentId);\r\n        if (!student) {\r\n            alert('Student not found in class list.');\r\n            return;\r\n        }\r\n\r\n        // 3. Load the student's grade data\r\n        const gradeStatus = getGradeStatus(studentId);\r\n        let gradeData = null;\r\n\r\n        if (gradeStatus === 'final') {\r\n            gradeData = loadFinalGradeData(studentId);\r\n        } else if (gradeStatus === 'draft') {\r\n            gradeData = loadDraft(studentId);\r\n        } else {\r\n            alert('No grade data found for this student. Please grade the student first.');\r\n            return;\r\n        }\r\n\r\n        if (!gradeData) {\r\n            alert('Unable to load grade data for this student.');\r\n            return;\r\n        }\r\n\r\n        // 4. Access active late policy levels\r\n        const activeLevels = currentLatePolicy?.levels || DEFAULT_LATE_POLICY.levels;\r\n        const getSafeLatePolicy = (level) => {\r\n            if (!level || typeof level !== \"string\" || !activeLevels[level]) {\r\n                return activeLevels.none;\r\n            }\r\n            return activeLevels[level];\r\n        };\r\n\r\n        // 5. Calculate scores (replicated from GradingTemplate.js)\r\n        const calculateTotalScore = () => {\r\n            if (!sharedRubric || !gradeData.rubricGrading) {\r\n                return { finalScore: 0, rawScore: 0, penaltyApplied: false };\r\n            }\r\n\r\n            let totalScore = 0;\r\n            const totalPossible = sharedRubric.assignmentInfo.totalPoints;\r\n\r\n            sharedRubric.criteria.forEach(criterion => {\r\n                const rubricGrading = gradeData.rubricGrading[criterion.id];\r\n                if (rubricGrading && rubricGrading.selectedLevel) {\r\n                    const level = sharedRubric.rubricLevels.find(l => l.level === rubricGrading.selectedLevel);\r\n                    if (level) {\r\n                        const points = criterion.maxPoints * level.multiplier;\r\n                        totalScore += points;\r\n                    }\r\n                }\r\n            });\r\n\r\n            const rawScore = totalScore;\r\n            let finalScore = totalScore;\r\n            let penaltyApplied = false;\r\n\r\n            // Apply late penalty if applicable\r\n            if (gradeData.latePolicy && gradeData.latePolicy.level !== 'none') {\r\n                const latePolicyLevel = getSafeLatePolicy(gradeData.latePolicy?.level);\r\n                if (latePolicyLevel) {\r\n                    finalScore = totalScore * latePolicyLevel.multiplier;\r\n                    penaltyApplied = true;\r\n                }\r\n            }\r\n\r\n            return { finalScore, rawScore, penaltyApplied };\r\n        };\r\n\r\n        // 6. Generate HTML report (based on GradingTemplate.js generateStudentReportHTML)\r\n        // 6. Generate HTML report with logo integration (UPDATED VERSION)\r\n        const generateStudentReportHTML = () => {\r\n            const scoreCalculation = calculateTotalScore();\r\n            const totalScore = scoreCalculation.finalScore;\r\n            const rawScore = scoreCalculation.rawScore;\r\n            const maxPoints = sharedRubric.assignmentInfo.totalPoints;\r\n            const percentage = ((totalScore / (maxPoints || 1)) * 100).toFixed(1);\r\n            const penaltyApplied = scoreCalculation.penaltyApplied;\r\n\r\n            // Generate attachments HTML (UNCHANGED)\r\n            const attachmentsHTML = gradeData.attachments?.map((att, index) => {\r\n                if (att.base64Data) {\r\n                    return `<div class=\"attachment-item\"><img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"clickable-image\" data-index=\"${index}\" style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" /><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div><div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div></div>`;\r\n                } else {\r\n                    return `<div class=\"attachment-item\"><div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">📄</div><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div></div>`;\r\n                }\r\n            }).join('') || '';\r\n\r\n            // Generate video links HTML (UNCHANGED)\r\n            const videoLinksHTML = gradeData.videoLinks?.map(link =>\r\n                `<div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\"><div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\"><span style=\"font-size: 1.25rem;\">🎥</span><strong style=\"color: #495057;\">${link.title}</strong></div><a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">${link.url}</a></div>`\r\n            ).join('') || '';\r\n\r\n            // Generate rubric table HTML (UNCHANGED)\r\n            const rubricTableHTML = sharedRubric ? `\r\n    <div style=\"margin: 30px 0;\">\r\n        <h3>📊 Detailed Rubric Assessment</h3>\r\n        <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9rem;\">\r\n            <thead>\r\n                <tr style=\"background: #f8f9fa;\">\r\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th>\r\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 120px;\">Level Achieved</th>\r\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: center; width: 80px;\">Points</th>\r\n                    <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Details & Comments</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                ${sharedRubric.criteria.map(criterion => {\r\n                const rubricGrading = gradeData.rubricGrading?.[criterion.id];\r\n                const selectedLevel = rubricGrading?.selectedLevel;\r\n                const level = selectedLevel ? sharedRubric.rubricLevels.find(l => l.level === selectedLevel) : null;\r\n                const points = level ? Math.round(criterion.maxPoints * level.multiplier * 10) / 10 : 0;\r\n                const levelDescription = level && criterion.levels?.[selectedLevel]?.description ? criterion.levels[selectedLevel].description : '';\r\n                const additionalComments = rubricGrading?.customComments || '';\r\n\r\n                return `<tr>\r\n                            <td style=\"border: 1px solid #ddd; padding: 12px; vertical-align: top;\">\r\n                                <strong>${criterion.name}</strong><br>\r\n                                <small style=\"color: #666;\">${criterion.description || ''}</small><br>\r\n                                <small style=\"color: #888;\">Max Points: ${criterion.maxPoints}</small>\r\n                            </td>\r\n                            <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; vertical-align: top;\">\r\n                                <span style=\"display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; background: ${level?.color || '#f0f0f0'}; color: white;\">\r\n                                    ${level?.name || 'Not Assessed'}\r\n                                </span>\r\n                            </td>\r\n                            <td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td>\r\n                            <td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">\r\n                                ${levelDescription ? `<div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\"><strong style=\"color: ${level.color};\">Level Description:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span></div>` : ''}\r\n                                ${additionalComments ? `<div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\"><strong style=\"color: #856404;\">Additional Comments:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span></div>` : ''}\r\n                                ${(!levelDescription && !additionalComments) ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}\r\n                            </td>\r\n                        </tr>`;\r\n            }).join('')}\r\n            </tbody>\r\n        </table>\r\n        <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\">\r\n            <h4 style=\"color: #2e7d32; margin-bottom: 10px;\">📊 Rubric Score Summary</h4>\r\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\">\r\n                <div><strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br><strong>Percentage:</strong> ${percentage}%</div>\r\n                <div><strong>Grade Status:</strong><span style=\"color: ${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">${percentage >= sharedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}</span></div>\r\n                ${penaltyApplied ? `<div style=\"color: #ff9800;\"><strong>Late Penalty Applied:</strong><br>Raw Score: ${Math.round(rawScore * 10) / 10}</div>` : ''}\r\n            </div>\r\n        </div>\r\n    </div>` : '';\r\n\r\n            // NEW: Generate header with logo using utility\r\n            const reportData = {\r\n                title: `📄 Individual Grade Report: ${student.name}`,\r\n                courseCode: classList.courseMetadata?.courseCode || gradeData.course?.code || '',\r\n                courseName: classList.courseMetadata?.courseName || gradeData.course?.name || '',\r\n                section: classList.courseMetadata?.section || '',\r\n                rubricTitle: sharedRubric?.assignmentInfo?.title || gradeData.assignment?.name || 'Unnamed Rubric'\r\n            };\r\n\r\n            const headerHtml = generateReportHeader(reportData, { maxHeight: 60 });\r\n\r\n            // Complete HTML document with logo integration\r\n            const htmlContent = `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Grade Report - ${student.name}</title>\r\n    ${getReportStyles()}\r\n    <style>\r\n        /* Additional styles specific to individual reports */\r\n        .score-summary { \r\n            background: #e8f5e8; \r\n            border: 2px solid #4caf50; \r\n            border-radius: 8px; \r\n            padding: 20px; \r\n            margin: 20px 0; \r\n            text-align: center; \r\n        }\r\n        .late-policy-section { \r\n            margin: 30px 0; \r\n            background: #fff5f5; \r\n            border: 1px solid #f87171; \r\n            border-radius: 8px; \r\n            padding: 20px; \r\n        }\r\n        .feedback-section { \r\n            margin: 20px 0; \r\n            padding: 15px; \r\n            background: #f9f9f9; \r\n            border-radius: 8px; \r\n        }\r\n        .attachments { \r\n            margin: 30px 0; \r\n        }\r\n        .attachment-item { \r\n            display: inline-block; \r\n            text-align: center; \r\n            margin: 1rem; \r\n            padding: 1rem; \r\n            background: #fff; \r\n            border: 1px solid #ddd; \r\n            border-radius: 8px; \r\n            box-shadow: 0 2px 4px rgba(0,0,0,.1); \r\n            max-width: 250px; \r\n            vertical-align: top; \r\n        }\r\n        .clickable-image { \r\n            cursor: pointer; \r\n            transition: all .3s ease; \r\n            position: relative; \r\n        }\r\n        .clickable-image:hover { \r\n            transform: scale(1.05); \r\n            box-shadow: 0 4px 8px rgba(0,0,0,.2); \r\n        }\r\n        .video-links { \r\n            margin: 30px 0; \r\n        }\r\n        .video-link-item { \r\n            margin-bottom: 1rem; \r\n        }\r\n        .video-link-item a { \r\n            color: #007bff; \r\n            text-decoration: none; \r\n        }\r\n        .video-link-item a:hover { \r\n            text-decoration: underline; \r\n        }\r\n        .image-modal { \r\n            display: none; \r\n            position: fixed; \r\n            z-index: 1000; \r\n            left: 0; \r\n            top: 0; \r\n            width: 100%; \r\n            height: 100%; \r\n            background-color: rgba(0,0,0,.9); \r\n            animation: fadeIn .3s ease; \r\n        }\r\n        .image-modal.show { \r\n            display: flex; \r\n            align-items: center; \r\n            justify-content: center; \r\n        }\r\n        .modal-content { \r\n            max-width: 95%; \r\n            max-height: 95%; \r\n            object-fit: contain; \r\n            border-radius: 8px; \r\n            box-shadow: 0 4px 20px rgba(0,0,0,.5); \r\n            animation: zoomIn .3s ease; \r\n        }\r\n        .close-modal { \r\n            position: absolute; \r\n            top: 20px; \r\n            right: 30px; \r\n            color: #fff; \r\n            font-size: 40px; \r\n            font-weight: 700; \r\n            cursor: pointer; \r\n            z-index: 1001; \r\n            background: rgba(0,0,0,.5); \r\n            border-radius: 50%; \r\n            width: 50px; \r\n            height: 50px; \r\n            display: flex; \r\n            align-items: center; \r\n            justify-content: center; \r\n            line-height: 1; \r\n        }\r\n        .close-modal:hover { \r\n            background: rgba(0,0,0,.8); \r\n        }\r\n        .modal-caption { \r\n            position: absolute; \r\n            bottom: 20px; \r\n            left: 50%; \r\n            transform: translateX(-50%); \r\n            color: #fff; \r\n            background: rgba(0,0,0,.7); \r\n            padding: 10px 20px; \r\n            border-radius: 6px; \r\n            text-align: center; \r\n            max-width: 80%; \r\n        }\r\n        @keyframes fadeIn { \r\n            from { opacity: 0; } \r\n            to { opacity: 1; } \r\n        }\r\n        @keyframes zoomIn { \r\n            from { transform: scale(.5); opacity: 0; } \r\n            to { transform: scale(1); opacity: 1; } \r\n        }\r\n        @media print { \r\n            .attachment-item, .video-link-item { \r\n                break-inside: avoid; \r\n            } \r\n            .image-modal { \r\n                display: none!important; \r\n            } \r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    ${headerHtml}\r\n\r\n    <div class=\"score-summary\">\r\n        <h2>📊 Final Score</h2>\r\n        <div style=\"font-size: 2rem; font-weight: 700; color: #2e7d32; margin: 15px 0;\">\r\n            ${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)\r\n        </div>\r\n        <p style=\"margin: 10px 0; color: #555;\">\r\n            ${sharedRubric ? `Rubric: ${sharedRubric.assignmentInfo.title}` : \"\"}\r\n            ${penaltyApplied ? ` | Late Policy: ${getSafeLatePolicy(gradeData.latePolicy?.level).name}` : \"\"}\r\n        </p>\r\n    </div>\r\n\r\n    ${penaltyApplied ? `\r\n        <div class=\"late-policy-section\">\r\n            <h3 style=\"color: #dc2626;\">📅 Late Submission Policy Applied</h3>\r\n            <p><strong>Policy Status:</strong> ${getSafeLatePolicy(gradeData.latePolicy?.level).name}</p>\r\n            <p>${getSafeLatePolicy(gradeData.latePolicy?.level).description}</p>\r\n            <p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} → <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p>\r\n        </div>\r\n    ` : \"\"}\r\n\r\n    ${rubricTableHTML}\r\n\r\n    ${Object.entries(gradeData.feedback || {}).filter(([key, text]) => text).map(([key, text]) => `\r\n        <div class=\"feedback-section\">\r\n            <h3>${key.charAt(0).toUpperCase() + key.slice(1)} Feedback</h3>\r\n            <p>${text.replace(/\\n/g, \"<br>\")}</p>\r\n        </div>\r\n    `).join(\"\")}\r\n\r\n    ${attachmentsHTML ? `\r\n        <div class=\"attachments\">\r\n            <h3>📎 File Attachments</h3>\r\n            <div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">\r\n                ${attachmentsHTML}\r\n            </div>\r\n        </div>\r\n    ` : \"\"}\r\n\r\n    ${videoLinksHTML ? `\r\n        <div class=\"video-links\">\r\n            <h3>🎥 Video Review Links</h3>\r\n            ${videoLinksHTML}\r\n        </div>\r\n    ` : \"\"}\r\n\r\n    <div class=\"footer\">\r\n        <div style=\"margin-top: 40px; text-align: center; font-size: 12px; color: #666;\">\r\n            <strong>Individual Grade Report</strong><br>\r\n            Report generated on ${new Date().toLocaleDateString('en-CA')} at ${new Date().toLocaleTimeString('en-CA')}<br>\r\n            Student: ${student.name} | Assignment: ${sharedRubric?.assignmentInfo?.title || 'Unnamed Assignment'}\r\n            ${hasSchoolLogo() ? '<br>Generated with institutional branding' : ''}\r\n        </div>\r\n    </div>\r\n\r\n    <div id=\"imageModal\" class=\"image-modal\">\r\n        <span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span>\r\n        <img class=\"modal-content\" id=\"modalImage\">\r\n        <div class=\"modal-caption\" id=\"modalCaption\"></div>\r\n    </div>\r\n\r\n    <script>\r\n        const attachmentData = ${JSON.stringify(gradeData.attachments || [])};\r\n        \r\n        function openImageModal(src, caption) {\r\n            const modal = document.getElementById(\"imageModal\");\r\n            const modalImg = document.getElementById(\"modalImage\");\r\n            const modalCaption = document.getElementById(\"modalCaption\");\r\n            modal.classList.add(\"show\");\r\n            modalImg.src = src;\r\n            modalCaption.textContent = caption;\r\n            document.body.style.overflow = \"hidden\";\r\n        }\r\n        \r\n        function closeImageModal() {\r\n            document.getElementById(\"imageModal\").classList.remove(\"show\");\r\n            document.body.style.overflow = \"auto\";\r\n        }\r\n        \r\n        document.addEventListener(\"DOMContentLoaded\", function() {\r\n            document.querySelectorAll(\".clickable-image\").forEach(img => {\r\n                img.addEventListener(\"click\", function() {\r\n                    const index = parseInt(this.getAttribute(\"data-index\"));\r\n                    const attachment = attachmentData[index];\r\n                    if (attachment && attachment.base64Data) {\r\n                        openImageModal(attachment.base64Data, attachment.name);\r\n                    }\r\n                });\r\n            });\r\n            \r\n            document.getElementById(\"imageModal\").addEventListener(\"click\", function(e) {\r\n                if (e.target === this) {\r\n                    closeImageModal();\r\n                }\r\n            });\r\n            \r\n            document.addEventListener(\"keydown\", function(e) {\r\n                if (e.key === \"Escape\") {\r\n                    closeImageModal();\r\n                }\r\n            });\r\n        });\r\n    </script>\r\n</body>\r\n</html>`;\r\n\r\n            return htmlContent;\r\n        };\r\n\r\n        // 7. Generate and export the HTML file\r\n        try {\r\n            const htmlContent = generateStudentReportHTML();\r\n            const htmlBlob = new Blob([htmlContent], { type: 'text/html' });\r\n            const url = URL.createObjectURL(htmlBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `grade_report_${student.name.replace(/[^a-zA-Z0-9]/g, '_')}_${sharedRubric.assignmentInfo?.title?.replace(/[^a-zA-Z0-9]/g, '_') || 'assignment'}.html`;\r\n            link.click();\r\n            URL.revokeObjectURL(url);\r\n\r\n            console.log(`✅ Individual grade report exported for student: ${student.name}`);\r\n        } catch (error) {\r\n            console.error('Error generating individual grade report:', error);\r\n            alert('Error generating grade report. Please check the console for details.');\r\n        }\r\n    };\r\n\r\n    // File upload handling (preserved exactly from original)\r\n    // COMPLETE ENHANCED handleFileUpload function - replaces lines ~600-650 in ClassListManager.js\r\n    const handleFileUpload = async (event) => {\r\n        const file = event.target.files[0];\r\n        if (!file) return;\r\n\r\n        setImportStatus('processing');\r\n\r\n        try {\r\n            // Use Excel parser instead of manual CSV parsing\r\n            const result = await parseExcelFile(file);\r\n\r\n            if (!result.success) {\r\n                throw new Error(result.error || 'Failed to parse Excel file');\r\n            }\r\n\r\n            // Validate the parsed student data\r\n            const validation = validateStudentData(result.students);\r\n\r\n            if (result.students.length === 0) {\r\n                throw new Error('No valid student records found in Excel file');\r\n            }\r\n\r\n            // Create grading progress tracking for each student\r\n            const gradingProgress = result.students.map(() => ({\r\n                status: 'pending',\r\n                lastModified: null,\r\n                gradeType: null\r\n            }));\r\n\r\n            // ENHANCED: Create the class list data structure with proper field mapping\r\n            const classListData = {\r\n                students: result.students,\r\n                gradingProgress,\r\n                fileName: file.name,\r\n                fileSize: file.size,\r\n                importTime: new Date().toISOString(),\r\n                courseMetadata: {\r\n                    courseCode: result.courseMetadata?.courseCode || 'IMPORTED',\r\n                    courseName: result.courseMetadata?.courseName || 'Excel Import',\r\n                    section: result.courseMetadata?.section || 'DEFAULT',\r\n                    programType: result.courseMetadata?.programType || 'degree',\r\n                    // ENHANCED: Handle both instructor and professors fields\r\n                    professors: result.courseMetadata?.professors || 'TBD',\r\n                    instructor: result.courseMetadata?.instructor || result.courseMetadata?.professors || 'TBD',\r\n                    term: result.courseMetadata?.term || 'TBD',\r\n                    hours: result.courseMetadata?.hours || '',\r\n                    gradeScale: result.courseMetadata?.gradeScale || '',\r\n                    department: result.courseMetadata?.department || '',\r\n                    campus: result.courseMetadata?.campus || '',\r\n                    totalStudents: result.students.length\r\n                },\r\n                validation: {\r\n                    validationScore: validation.validationScore || 100,\r\n                    issues: validation.issues || []\r\n                }\r\n            };\r\n\r\n            setClassList(classListData);\r\n            setImportStatus('success');\r\n\r\n            // ENHANCED: Auto-populate course information using corrected field mapping\r\n            if (result.courseMetadata) {\r\n                const courseInfo = {\r\n                    code: result.courseMetadata.courseCode || '',\r\n                    name: result.courseMetadata.courseName || '',\r\n                    instructor: result.courseMetadata.instructor || result.courseMetadata.professors || '',\r\n                    term: result.courseMetadata.term || ''\r\n                };\r\n\r\n                console.log('📊 Auto-populating course info from Excel:', courseInfo);\r\n                // Note: updateCourseInfo should be available from useAssessment hook\r\n                if (typeof updateCourseInfo === 'function') {\r\n                    Object.entries(courseInfo).forEach(([field, value]) => {\r\n                        updateCourseInfo(field, value);\r\n                    });\r\n                }\r\n            }\r\n\r\n            console.log('✅ Excel import completed successfully:', {\r\n                students: result.students.length,\r\n                courseMetadata: classListData.courseMetadata\r\n            });\r\n\r\n            setTimeout(() => setImportStatus(''), 3000);\r\n        } catch (error) {\r\n            console.error('Excel import error:', error);\r\n            setImportStatus('error');\r\n            setTimeout(() => setImportStatus(''), 3000);\r\n        }\r\n    };\r\n\r\n    // ENHANCED startGradingSession function - replaces lines ~670-690 in ClassListManager.js\r\n    const startGradingSession = () => {\r\n        if (!classList || classList.students.length === 0) {\r\n            alert('No students available for grading.');\r\n            return;\r\n        }\r\n\r\n        if (!sharedRubric) {\r\n            alert('Please load a rubric before starting batch grading.');\r\n            return;\r\n        }\r\n\r\n        console.log('🚀 Starting grading session with class data:', {\r\n            studentCount: classList.students.length,\r\n            courseMetadata: classList.courseMetadata,\r\n            rubricTitle: sharedRubric.assignmentInfo?.title\r\n        });\r\n\r\n        // Initialize the grading session with enhanced data\r\n        const success = initializeGradingSession(classList);\r\n\r\n        if (success) {\r\n            setActiveTab('grading-tool');\r\n\r\n            // Show enhanced success message with course info confirmation\r\n            const courseInfo = classList.courseMetadata;\r\n            alert(\r\n                `🎯 Batch Grading Started!\\n\\n` +\r\n                `Rubric: ${sharedRubric.assignmentInfo?.title || 'Untitled'}\\n` +\r\n                `Students: ${classList.students.length}\\n` +\r\n                `Course: ${courseInfo?.courseCode || 'N/A'} - ${courseInfo?.courseName || 'N/A'}\\n` +\r\n                `Instructor: ${courseInfo?.instructor || courseInfo?.professors || 'N/A'}\\n` +\r\n                `Term: ${courseInfo?.term || 'N/A'}\\n\\n` +\r\n                `Starting with: ${classList.students[0]?.name || 'First Student'}`\r\n            );\r\n        } else {\r\n            alert('Failed to initialize grading session. Please check the console for details.');\r\n        }\r\n    };\r\n\r\n    // Pause the grading session\r\n    const pauseGradingSession = () => {\r\n        setGradingSession(prev => ({\r\n            ...prev,\r\n            active: false\r\n        }));\r\n    };\r\n\r\n    // Resume the grading session\r\n    const resumeGradingSession = () => {\r\n        setGradingSession(prev => ({\r\n            ...prev,\r\n            active: true\r\n        }));\r\n        setActiveTab('grading-tool');\r\n    };\r\n\r\n    // NEW: Policy Preview Component\r\n    const PolicyPreview = ({ policy }) => {\r\n        if (!policy) return null;\r\n\r\n        return (\r\n            <div className=\"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200\">\r\n                <h4 className=\"font-semibold text-blue-800 mb-2 text-sm\">\r\n                    📋 Active Grading Policy: {policy.name}\r\n                </h4>\r\n                <p className=\"text-xs text-blue-700 mb-2\">{policy.description}</p>\r\n\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-1 text-xs\">\r\n                    {policy.gradeScale?.slice(0, 4).map((grade, index) => (\r\n                        <div key={index} className=\"bg-white p-1 rounded border text-center\">\r\n                            <div className=\"font-bold text-blue-800\">{grade.letter}</div>\r\n                            <div className=\"text-blue-600\">{grade.minPercentage}%+</div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {policy.gradeScale?.length > 4 && (\r\n                    <div className=\"text-xs text-blue-600 mt-1\">\r\n                        ...and {policy.gradeScale.length - 4} more grades\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    // Enhanced program type dropdown with policy support\r\n    const renderEnhancedProgramTypeDropdown = () => {\r\n        const programTypes = gradingPolicyService.getSupportedProgramTypes();\r\n\r\n        return (\r\n            <div>\r\n                <label htmlFor=\"programType\" className=\"block text-sm font-bold text-gray-700\">Program Type:</label>\r\n                <select\r\n                    id=\"programType\"\r\n                    name=\"programType\"\r\n                    value={classList.courseMetadata?.programType || 'degree'}\r\n                    onChange={handleProgramTypeChange}\r\n                    className=\"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\r\n                >\r\n                    {programTypes.map(type => (\r\n                        <option key={type.value} value={type.value}>\r\n                            {type.label}\r\n                        </option>\r\n                    ))}\r\n                </select>\r\n\r\n                {/* Policy Preview */}\r\n                {selectedPolicy && <PolicyPreview policy={selectedPolicy} />}\r\n\r\n                {/* Policy Loading Indicator */}\r\n                {(policiesLoading || gradeCalculation.isPending) && (\r\n                    <div className=\"flex items-center gap-2 text-blue-600 mt-2\">\r\n                        <div className=\"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\r\n                        <span className=\"text-xs\">\r\n                            {policiesLoading ? 'Loading grading policies...' : 'Calculating grade...'}\r\n                        </span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50\">\r\n            <div className=\"max-w-7xl mx-auto\">\r\n                {/* Header (preserved exactly from original) */}\r\n                <div className=\"bg-gradient-to-r text-gray-800 p-6 rounded-t-lg shadow-lg\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                        <div>\r\n                            <h1 className=\"text-3xl font-bold mb-2\">Class List Manager</h1>\r\n                            <p className=\"text-gray-600\">\r\n                                Import, manage, and grade entire classes efficiently\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-4\">\r\n                            {classList && (\r\n                                <div className=\"text-right\">\r\n                                    <div className=\"text-2xl font-bold\">\r\n                                        {classList.students.length}\r\n                                    </div>\r\n                                    <div className=\"text-sm text-gray-700\">\r\n                                        Students\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                            <Users size={48} className=\"text-gray-700\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white rounded-b-lg shadow-lg\">\r\n                    {/* Import Section (preserved exactly from original) */}\r\n                    {!classList && (\r\n                        <div className=\"p-8\">\r\n                            <div className=\"grid lg:grid-cols-3 gap-8\">\r\n\r\n                                {/* Left Column - Upload Area */}\r\n                                <div className=\"lg:col-span-2\">\r\n                                    <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden\">\r\n                                        {/* Upload Header */}\r\n                                        <div className=\"bg-gradient-to-r from-blue-700 to-indigo-700 px-8 py-6 relative\">\r\n                                            {/* Semi-transparent overlay for better text contrast */}\r\n                                            <div className=\"absolute inset-0 bg-black/20\"></div>\r\n\r\n                                            <div className=\"flex items-center space-x-3 relative z-10\">\r\n                                                <div className=\"bg-white/30 rounded-lg p-3 backdrop-blur-sm\">\r\n                                                    <FileSpreadsheet size={32} className=\"text-white\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h2 className=\"text-3xl font-bold text-white drop-shadow-lg\">Import Student List</h2>\r\n                                                    <p className=\"text-gray-100 font-semibold text-lg drop-shadow-md\">Upload your Excel file to get started</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Drag and Drop Area */}\r\n                                        <div className=\"p-8\">\r\n                                            <div className=\"relative border-2 border-dashed border-gray-300 hover:border-blue-400 hover:bg-gray-50 rounded-xl p-12 text-center transition-all duration-300\">\r\n                                                <input\r\n                                                    type=\"file\"\r\n                                                    accept=\".xls,.xlsx\"\r\n                                                    onChange={handleFileUpload}\r\n                                                    className=\"hidden\"\r\n                                                    id=\"excel-upload\"\r\n                                                    ref={fileInputRef}\r\n                                                />\r\n\r\n                                                <div className=\"space-y-4\">\r\n                                                    <div className=\"mx-auto w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center\">\r\n                                                        <Upload size={32} className=\"text-gray-400\" />\r\n                                                    </div>\r\n\r\n                                                    <div>\r\n                                                        <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n                                                            Drop your Excel file here\r\n                                                        </h3>\r\n                                                        <p className=\"text-gray-600 mb-6\">\r\n                                                            or click to browse and select your student roster\r\n                                                        </p>\r\n                                                    </div>\r\n\r\n                                                    <button\r\n                                                        onClick={() => fileInputRef.current?.click()}\r\n                                                        className=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg transition-colors duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5\"\r\n                                                    >\r\n                                                        Choose Excel File\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            {/* Status Messages */}\r\n                                            {importStatus === 'loading' && (\r\n                                                <div className=\"mt-6 flex items-center space-x-3 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                                                    <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\r\n                                                    <span className=\"text-blue-800 font-medium\">\r\n                                                        📊 Processing Excel file...\r\n                                                    </span>\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {importStatus === 'success' && (\r\n                                                <div className=\"mt-6 flex items-center space-x-3 p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n                                                    <CheckCircle2 size={20} className=\"text-green-600\" />\r\n                                                    <span className=\"text-green-800 font-medium\">\r\n                                                        ✅ Excel file imported successfully!\r\n                                                    </span>\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {importStatus === 'error' && (\r\n                                                <div className=\"mt-6 flex items-center space-x-3 p-4 bg-red-50 border border-red-200 rounded-lg\">\r\n                                                    <AlertCircle size={20} className=\"text-red-600\" />\r\n                                                    <span className=\"text-red-800 font-medium\">\r\n                                                        ✗ Error importing Excel file. Please check format and try again.\r\n                                                    </span>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Right Column - Format Requirements */}\r\n                                <div className=\"space-y-6\">\r\n\r\n                                    {/* Format Requirements Card */}\r\n                                    <div className=\"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden\">\r\n                                        <div className=\"bg-gray-50 px-6 py-4 border-b border-gray-100\">\r\n                                            <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\r\n                                                <FileText size={20} className=\"mr-2 text-blue-600\" />\r\n                                                Excel Format Requirements\r\n                                            </h3>\r\n                                        </div>\r\n\r\n                                        <div className=\"p-6 space-y-4\">\r\n                                            <div>\r\n                                                <h4 className=\"font-medium text-gray-900 mb-2\">Required Columns</h4>\r\n                                                <div className=\"space-y-1\">\r\n                                                    {['ID', 'Name', 'Email'].map((col) => (\r\n                                                        <div key={col} className=\"flex items-center space-x-2\">\r\n                                                            <div className=\"w-2 h-2 bg-red-400 rounded-full\"></div>\r\n                                                            <span className=\"text-sm text-gray-700\">{col}</span>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div>\r\n                                                <h4 className=\"font-medium text-gray-900 mb-2\">Optional Columns</h4>\r\n                                                <div className=\"space-y-1\">\r\n                                                    {['Program', 'Campus', 'Level', 'Status'].map((col) => (\r\n                                                        <div key={col} className=\"flex items-center space-x-2\">\r\n                                                            <div className=\"w-2 h-2 bg-gray-400 rounded-full\"></div>\r\n                                                            <span className=\"text-sm text-gray-700\">{col}</span>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"pt-4 border-t border-gray-100\">\r\n                                                <div className=\"space-y-2 text-sm text-gray-600\">\r\n                                                    <div className=\"flex items-start space-x-2\">\r\n                                                        <span className=\"font-medium\">File types:</span>\r\n                                                        <span>.xls or .xlsx</span>\r\n                                                    </div>\r\n                                                    <div className=\"flex items-start space-x-2\">\r\n                                                        <span className=\"font-medium\">Headers:</span>\r\n                                                        <span>First row should contain column names</span>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Tips Card */}\r\n                                    <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100\">\r\n                                        <h3 className=\"text-lg font-semibold text-blue-900 mb-3 flex items-center\">\r\n                                            <BookOpen size={20} className=\"mr-2\" />\r\n                                            Pro Tips\r\n                                        </h3>\r\n                                        <ul className=\"space-y-2 text-sm text-blue-800\">\r\n                                            <li className=\"flex items-start space-x-2\">\r\n                                                <span className=\"w-1.5 h-1.5 bg-blue-600 rounded-full mt-2 flex-shrink-0\"></span>\r\n                                                <span>Include all required columns for best results</span>\r\n                                            </li>\r\n                                            <li className=\"flex items-start space-x-2\">\r\n                                                <span className=\"w-1.5 h-1.5 bg-blue-600 rounded-full mt-2 flex-shrink-0\"></span>\r\n                                                <span>Ensure email addresses are properly formatted</span>\r\n                                            </li>\r\n                                            <li className=\"flex items-start space-x-2\">\r\n                                                <span className=\"w-1.5 h-1.5 bg-blue-600 rounded-full mt-2 flex-shrink-0\"></span>\r\n                                                <span>Remove any empty rows or columns</span>\r\n                                            </li>\r\n                                        </ul>\r\n                                    </div>\r\n\r\n                                    {/* Sample Template Download */}\r\n                                    <div className=\"bg-white rounded-xl shadow-lg border border-gray-100 p-6\">\r\n                                        <h3 className=\"text-lg font-semibold text-gray-900 mb-3 flex items-center\">\r\n                                            <Download size={20} className=\"mr-2 text-green-600\" />\r\n                                            Need Help?\r\n                                        </h3>\r\n                                        <p className=\"text-sm text-gray-600 mb-4\">\r\n                                            Download our sample template to ensure your Excel file is formatted correctly.\r\n                                        </p>\r\n                                        <button\r\n                                            onClick={() => {\r\n                                                const link = document.createElement('a');\r\n                                                link.href = '/Example-Class-List.xlsx';\r\n                                                link.download = 'Example-Class-List.xlsx';\r\n                                                link.click();\r\n                                            }}\r\n                                            className=\"w-full bg-green-100 hover:bg-green-200 text-green-800 font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2\"\r\n                                        >\r\n                                            <Download size={16} />\r\n                                            Download Sample Template\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Management Dashboard (preserved with enhanced program type dropdown) */}\r\n                    {classList && (\r\n                        <div className=\"p-6\">\r\n                            {/* Overview Cards */}\r\n                            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8\">\r\n                                {/* Course Info with Enhanced Program Type Dropdown */}\r\n                                <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\">\r\n                                    <div className=\"flex items-center gap-3 mb-4\">\r\n                                        <BookOpen className=\"text-blue-600\" size={24} />\r\n                                        <h3 className=\"text-lg font-semibold text-blue-800\">\r\n                                            Course Information\r\n                                        </h3>\r\n                                    </div>\r\n                                    <div className=\"space-y-2 text-sm\">\r\n                                        <div>\r\n                                            <strong>Code:</strong>{' '}\r\n                                            {classList.courseMetadata?.courseCode || 'N/A'}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Name:</strong>{' '}\r\n                                            {classList.courseMetadata?.courseName || 'N/A'}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Section:</strong>{' '}\r\n                                            {classList.courseMetadata?.section || 'N/A'}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Professor:</strong>{' '}\r\n                                            {classList.courseMetadata?.instructor || 'N/A'}\r\n                                        </div>\r\n\r\n                                        {/* ENHANCED: Program type selector with policy preview */}\r\n                                        <div className=\"mt-3\">\r\n                                            {renderEnhancedProgramTypeDropdown()}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Progress Stats (preserved exactly from original) */}\r\n                                <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6\">\r\n                                    <div className=\"flex items-center gap-3 mb-4\">\r\n                                        <GraduationCap className=\"text-green-600\" size={24} />\r\n                                        <h3 className=\"text-lg font-semibold text-green-800\">\r\n                                            Grading Progress\r\n                                        </h3>\r\n                                    </div>\r\n                                    <div className=\"space-y-2 text-sm\">\r\n                                        <div>\r\n                                            <strong>Total Students:</strong> {classList.students.length}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Final Grades:</strong>{' '}\r\n                                            {getGradingProgress().final}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Draft Grades:</strong>{' '}\r\n                                            {getGradingProgress().draft}\r\n                                        </div>\r\n                                        <div>\r\n                                            <strong>Completion:</strong>{' '}\r\n                                            {getGradingProgress().percentage}%\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Session Control (preserved exactly from original) */}\r\n                                <div className=\"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-6\">\r\n                                    <div className=\"flex items-center gap-3 mb-4\">\r\n                                        <Play className=\"text-purple-600\" size={24} />\r\n                                        <h3 className=\"text-lg font-semibold text-purple-800\">\r\n                                            Batch Grading Session\r\n                                        </h3>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        {!gradingSession?.active ? (\r\n                                            <div>\r\n                                                <div className=\"text-sm text-purple-600 mb-2\">\r\n                                                    {gradingSession?.currentStudentIndex > 0\r\n                                                        ? `Paused at student ${gradingSession.currentStudentIndex + 1} of ${classList.students.length}`\r\n                                                        : 'Ready to start batch grading'\r\n                                                    }\r\n                                                </div>\r\n                                                <div className=\"flex gap-2\">\r\n                                                    {gradingSession?.currentStudentIndex > 0 ? (\r\n                                                        <button\r\n                                                            onClick={resumeGradingSession}\r\n                                                            className=\"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors\"\r\n                                                        >\r\n                                                            <Play size={16} />\r\n                                                            Resume Session\r\n                                                        </button>\r\n                                                    ) : (\r\n                                                        <button\r\n                                                            onClick={startGradingSession}\r\n                                                            disabled={!sharedRubric}\r\n                                                            className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                                        >\r\n                                                            <Play size={16} />\r\n                                                            Start Batch Grading\r\n                                                        </button>\r\n                                                    )}\r\n                                                    {!sharedRubric && (\r\n                                                        <div className=\"text-xs text-purple-600 mt-1\">\r\n                                                            Load a rubric first\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div>\r\n                                                <div className=\"text-sm text-green-600 font-medium mb-2\">\r\n                                                    ✓ Session Active - Student {gradingSession.currentStudentIndex + 1} of {classList.students.length}\r\n                                                </div>\r\n                                                <button\r\n                                                    onClick={pauseGradingSession}\r\n                                                    className=\"flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors\"\r\n                                                >\r\n                                                    <Clock size={16} />\r\n                                                    Pause Session\r\n                                                </button>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Student Table (preserved exactly from original) */}\r\n                            <div className=\"bg-white border border-gray-200 rounded-lg\">\r\n                                {/* FIXED: Export button handlers that properly handle async functions */}\r\n                                <div className=\"px-6 py-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center\">\r\n                                    <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                                        Student Roster\r\n                                    </h3>\r\n                                    <div className=\"flex gap-2\">\r\n                                        <button\r\n                                            onClick={async () => {\r\n                                                console.log('🔄 Starting CSV export...');\r\n                                                await exportClassGradesCSV();\r\n                                            }}\r\n                                            className=\"px-2 py-1 rounded text-xs font-medium text-white bg-green-500 hover:bg-green-700 focus:ring-2 focus:ring-green-500 transition-colors duration-150\"\r\n                                        >\r\n                                            <Download size={14} />\r\n                                            CSV\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={async () => {\r\n                                                console.log('🔄 Starting HTML export...');\r\n                                                await exportClassGradesHTML();\r\n                                            }}\r\n                                            className=\"flex items-center gap-1 px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors\"\r\n                                        >\r\n                                            <FileText size={14} />\r\n                                            HTML\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={async () => {\r\n                                                console.log('🔄 Starting PDF export...');\r\n                                                await exportClassGradesPortraitPDF();\r\n                                            }}\r\n                                            className=\"flex items-center gap-1 px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm font-medium transition-colors\"\r\n                                        >\r\n                                            <FileText size={14} />\r\n                                            PDF\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"overflow-x-auto\">\r\n                                    <table className=\"table-auto w-max mx-auto\">\r\n                                        <thead className=\"bg-gray-50\">\r\n                                            <tr>\r\n                                                <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    #\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Status\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Student ID\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Name\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Email\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Program\r\n                                                </th>\r\n                                                <th className=\"w-48 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                                                    Actions\r\n                                                </th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                                            {classList.students.map((student, index) => {\r\n                                                const progress = classList.gradingProgress[index];\r\n                                                const isCurrentStudent = gradingSession.active && index === gradingSession.currentStudentIndex;\r\n                                                const gradeStatus = getGradeStatus(student.id);\r\n\r\n                                                return (\r\n                                                    <tr\r\n                                                        key={student.id}\r\n                                                        className={`${isCurrentStudent\r\n                                                            ? 'bg-blue-50 border-l-4 border-blue-500'\r\n                                                            : 'hover:bg-gray-50'\r\n                                                            } transition-colors`}\r\n                                                    >\r\n                                                        <td className=\"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\">\r\n                                                            {index + 1}\r\n                                                        </td>\r\n                                                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                            {getStatusDisplay(progress, student.id)}\r\n                                                        </td>\r\n                                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\r\n                                                            {student.id}\r\n                                                        </td>\r\n                                                        <td className=\"px-4 py-2 whitespace-normal break-words text-sm text-gray-900 max-w-xs\">\r\n                                                            {student.name}\r\n                                                        </td>\r\n                                                        <td className=\"px-4 py-2 whitespace-normal break-words text-sm text-gray-500 max-w-xs\">\r\n                                                            {student.email}\r\n                                                        </td>\r\n                                                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                                                            {student.program}\r\n                                                        </td>\r\n\r\n                                                        <td className=\"w-48 px-4 py-2 text-sm whitespace-normal\">\r\n                                                            <div className=\"flex flex-wrap items-center gap-2\">\r\n                                                                {/* View or Edit */}\r\n                                                                <button\r\n                                                                    onClick={() => loadStudentForGrading(student)}\r\n                                                                    className=\"flex items-center gap-1 px-3 py-1 bg-blue-500 hover:bg-blue-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-blue-500 duration-150\"\r\n                                                                >\r\n                                                                    {gradeStatus === 'final' ? 'View' : 'Edit'}\r\n                                                                </button>\r\n\r\n                                                                {/* Finalize draft */}\r\n                                                                {gradeStatus === 'draft' && (\r\n                                                                    <button\r\n                                                                        onClick={() => finalizeGrade(student.id)}\r\n                                                                        className=\"flex items-center gap-1 px-3 py-1 bg-green-500 hover:bg-green-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-green-500 duration-150\"\r\n                                                                    >\r\n                                                                        Finalize\r\n                                                                    </button>\r\n                                                                )}\r\n\r\n                                                                {/* Export Grade (always visible) */}\r\n                                                                <button\r\n                                                                    onClick={() => exportStudentGrade(student.id)}\r\n                                                                    className=\"flex items-center gap-1 px-3 py-1 bg-purple-500 hover:bg-purple-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-purple-500 duration-150\"\r\n                                                                >\r\n                                                                    <ExternalLink size={14} />\r\n                                                                    Export Grade\r\n                                                                </button>\r\n\r\n                                                                {/* Unlock (only for final) */}\r\n                                                                {gradeStatus === 'final' && (\r\n                                                                    <button\r\n                                                                        onClick={() => unlockGrade(student.id)}\r\n                                                                        className=\"flex items-center gap-1 px-3 py-1 bg-orange-500 hover:bg-orange-700 text-white rounded text-sm font-medium transition-colors focus:ring-2 focus:ring-orange-500 duration-150\"\r\n                                                                    >\r\n                                                                        <Unlock size={14} />\r\n                                                                        Unlock\r\n                                                                    </button>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                );\r\n                                            })}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Import Summary (preserved exactly from original) */}\r\n                            <div className=\"mt-8 bg-gray-50 rounded-lg p-6\">\r\n                                <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Import Summary</h3>\r\n                                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">File:</span>\r\n                                        <div className=\"font-medium\">{classList.fileName}</div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">Import Date:</span>\r\n                                        <div className=\"font-medium\">\r\n                                            {new Date(classList.importTime).toLocaleDateString()}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">Data Quality:</span>\r\n                                        <div className=\"font-medium\">\r\n                                            {classList.validation?.validationScore || 0}%\r\n                                        </div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"text-gray-600\">Total Students:</span>\r\n                                        <div className=\"font-medium\">{classList.students.length}</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n    );\r\n};\r\n\r\nexport default ClassListManager;"],"mappings":"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AU,cAAA1B,qBAAA,uBAApBA,qBAAA,CAAsBhH,IAAI,KAAI;MACtF,CAAC;MAED,MAAM2I,UAAU,GAAGtS,oBAAoB,CAACyN,UAAU,EAAE;QAAEsB,SAAS,EAAE;MAAG,CAAC,CAAC;;MAEtE;MACA,MAAMhB,WAAW,GAAG;AAChC;AACA;AACA;AACA;AACA,4BAA4B7E,OAAO,CAACS,IAAI;AACxC,MAAM1J,eAAe,CAAC,CAAC;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMqS,UAAU;AAChB;AACA;AACA;AACA;AACA,cAActK,UAAU,CAACiJ,OAAO,CAAC,CAAC,CAAC,MAAMzI,SAAS,KAAK5H,UAAU;AACjE;AACA;AACA,cAAcwD,YAAY,GAAG,WAAWA,YAAY,CAACyD,cAAc,CAACkC,KAAK,EAAE,GAAG,EAAE;AAChF,cAAc+F,cAAc,GAAG,mBAAmBH,iBAAiB,EAAAiB,sBAAA,GAACpJ,SAAS,CAACqB,UAAU,cAAA+H,s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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}