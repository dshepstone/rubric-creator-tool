{"ast":null,"code":"var _jsxFileName = \"C:\\\\local clones\\\\rubric-creation-app\\\\src\\\\components\\\\GradingTemplate.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Download, Upload, FileText, Video, Plus, X, Save, FileDown, Bot, ChevronDown, ChevronUp, ArrowLeft, ArrowRight, Users, PlayCircle, CheckCircle, Clock, SkipForward, SkipBack, Pause, RotateCcw, AlertTriangle } from 'lucide-react';\nimport { useAssessment, DEFAULT_LATE_POLICY } from './SharedContext';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst GradingTemplate = () => {\n  _s();\n  var _classList$students, _gradingData$course6, _gradingData$course7, _gradingData$course8, _gradingData$course9, _gradingData$student, _gradingData$student2, _gradingData$student3, _gradingData$latePoli6;\n  // Get shared context\n  const {\n    sharedRubric,\n    sharedCourseDetails,\n    setSharedCourseDetails,\n    gradingData: sharedGradingData,\n    setGradingData: setSharedGradingData,\n    updateStudentInfo,\n    updateCourseInfo,\n    updateAssignmentInfo,\n    clearGradingFormData,\n    classList,\n    setClassList,\n    setCurrentStudent,\n    gradingSession,\n    setGradingSession,\n    nextStudentInSession,\n    previousStudentInSession,\n    updateGradingSession,\n    initializeGradingSession,\n    setActiveTab,\n    currentStudent,\n    saveDraft,\n    loadDraft,\n    saveFinalGrade,\n    loadFinalGrade,\n    finalGrades,\n    getGradeStatus,\n    currentLatePolicy,\n    customLatePolicies\n  } = useAssessment();\n\n  // Helper function to convert HTML content to readable text format\n  const renderFormattedContent = htmlContent => {\n    if (!htmlContent) return '';\n    let textContent = htmlContent.replace(/<br\\s*\\/?>/gi, '\\n').replace(/<\\/p>/gi, '\\n').replace(/<p[^>]*>/gi, '').replace(/<strong[^>]*>(.*?)<\\/strong>/gi, '**$1**').replace(/<b[^>]*>(.*?)<\\/b>/gi, '**$1**').replace(/<em[^>]*>(.*?)<\\/em>/gi, '*$1*').replace(/<i[^>]*>(.*?)<\\/i>/gi, '*$1*').replace(/<u[^>]*>(.*?)<\\/u>/gi, '_$1_').replace(/<h3[^>]*>(.*?)<\\/h3>/gi, '### $1\\n').replace(/<li[^>]*>(.*?)<\\/li>/gi, '• $1\\n').replace(/<\\/ul>/gi, '\\n').replace(/<ul[^>]*>/gi, '').replace(/<\\/ol>/gi, '\\n').replace(/<ol[^>]*>/gi, '').replace(/<[^>]*>/g, '').replace(/\\n\\s*\\n/g, '\\n').trim();\n    return textContent;\n  };\n\n  // State for all grading data\n  const [localGradingData, setLocalGradingData] = useState(() => {\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      const draft = loadDraft(currentStudent.id);\n      if (draft) return draft;\n    }\n    if (sharedGradingData) {\n      return {\n        ...sharedGradingData,\n        student: currentStudent || sharedGradingData.student || {\n          name: '',\n          id: '',\n          email: ''\n        }\n      };\n    }\n    return {\n      student: currentStudent || {\n        name: '',\n        id: '',\n        email: ''\n      },\n      course: (sharedCourseDetails === null || sharedCourseDetails === void 0 ? void 0 : sharedCourseDetails.course) || {\n        code: '',\n        name: '',\n        instructor: '',\n        term: ''\n      },\n      assignment: (sharedCourseDetails === null || sharedCourseDetails === void 0 ? void 0 : sharedCourseDetails.assignment) || {\n        name: '',\n        dueDate: '',\n        maxPoints: 100\n      },\n      feedback: {\n        general: '',\n        strengths: '',\n        improvements: ''\n      },\n      attachments: [],\n      videoLinks: [],\n      latePolicy: {\n        level: 'none',\n        penaltyApplied: false\n      },\n      metadata: {\n        gradedBy: '',\n        gradedDate: '',\n        aiAssisted: false,\n        rubricIntegrated: false\n      },\n      rubricGrading: {}\n    };\n  });\n  const gradingData = localGradingData;\n  const setGradingData = setLocalGradingData;\n\n  // Rubric state - **MODIFIED: No default rubric**\n  const [loadedRubric, setLoadedRubric] = useState(() => sharedRubric || null);\n  const [showRubricComments, setShowRubricComments] = useState({});\n  const fileInputRef = useRef(null);\n  const rubricInputRef = useRef(null);\n  const [videoLinkInput, setVideoLinkInput] = useState('');\n  const [videoTitle, setVideoTitle] = useState('');\n\n  // Sync with shared context\n  useEffect(() => {\n    if (sharedRubric && sharedRubric !== loadedRubric) {\n      setLoadedRubric(sharedRubric);\n    }\n  }, [sharedRubric, loadedRubric]);\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      setSharedGradingData(gradingData);\n      setSharedCourseDetails({\n        student: gradingData.student,\n        course: gradingData.course,\n        assignment: gradingData.assignment\n      });\n    }, 1000);\n    return () => clearTimeout(timeoutId);\n  }, [gradingData, setSharedGradingData, setSharedCourseDetails]);\n  useEffect(() => {\n    if (!(currentStudent !== null && currentStudent !== void 0 && currentStudent.id)) return;\n    const status = getGradeStatus(currentStudent.id);\n    let saved = status === 'final' && loadFinalGrade ? loadFinalGrade(currentStudent.id) : status === 'draft' ? loadDraft(currentStudent.id) : null;\n    if (saved) {\n      setLocalGradingData(prev => ({\n        ...saved,\n        student: currentStudent,\n        course: prev.course,\n        assignment: prev.assignment,\n        metadata: prev.metadata\n      }));\n    } else {\n      resetGradingForm();\n    }\n  }, [currentStudent, getGradeStatus, loadDraft, loadFinalGrade]);\n\n  // Safely access late policy levels\n  const getPolicyById = policyId => {\n    if (!policyId) return null;\n    if (policyId === DEFAULT_LATE_POLICY.id) return DEFAULT_LATE_POLICY;\n    return customLatePolicies.find(p => p.id === policyId) || null;\n  };\n  const getSafeLatePolicy = (level, policyId) => {\n    const policy = getPolicyById(policyId) || currentLatePolicy || DEFAULT_LATE_POLICY;\n    const activeLevels = policy.levels || DEFAULT_LATE_POLICY.levels;\n    if (!level || typeof level !== \"string\" || !activeLevels[level]) {\n      return activeLevels.none;\n    }\n    return activeLevels[level];\n  };\n\n  // Calculate total score\n  const calculateTotalScore = () => {\n    var _gradingData$latePoli, _gradingData$latePoli2;\n    let rawScore = 0;\n    // ✅ FIX: Check for loadedRubric and its criteria before calculating\n    if (loadedRubric && loadedRubric.criteria && gradingData.rubricGrading) {\n      rawScore = Object.values(gradingData.rubricGrading).reduce((total, grading) => {\n        const criterion = loadedRubric.criteria.find(c => c.id === grading.criterionId);\n        if (criterion && grading.selectedLevel) {\n          const level = loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel);\n          if (level) {\n            return total + criterion.maxPoints * level.multiplier;\n          }\n        }\n        return total;\n      }, 0);\n    }\n    const policyId = (_gradingData$latePoli = gradingData.latePolicy) === null || _gradingData$latePoli === void 0 ? void 0 : _gradingData$latePoli.policyId;\n    const latePolicyLevel = getSafeLatePolicy((_gradingData$latePoli2 = gradingData.latePolicy) === null || _gradingData$latePoli2 === void 0 ? void 0 : _gradingData$latePoli2.level, policyId);\n    const finalScore = rawScore * latePolicyLevel.multiplier;\n    return {\n      rawScore,\n      finalScore,\n      penaltyApplied: gradingData.latePolicy.level !== 'none',\n      latePolicyDescription: latePolicyLevel.description\n    };\n  };\n  const [scoreSummary, setScoreSummary] = useState(calculateTotalScore());\n  useEffect(() => {\n    setScoreSummary(calculateTotalScore());\n  }, [gradingData.rubricGrading, gradingData.latePolicy, currentLatePolicy, customLatePolicies, loadedRubric]);\n\n  // Update rubric grading\n  const updateRubricGrading = (criterionId, level, comments = null) => {\n    setLocalGradingData(prevData => {\n      var _prevData$rubricGradi;\n      return {\n        ...prevData,\n        rubricGrading: {\n          ...prevData.rubricGrading,\n          [criterionId]: {\n            criterionId,\n            selectedLevel: level,\n            customComments: comments !== null ? comments : ((_prevData$rubricGradi = prevData.rubricGrading[criterionId]) === null || _prevData$rubricGradi === void 0 ? void 0 : _prevData$rubricGradi.customComments) || ''\n          }\n        }\n      };\n    });\n  };\n  const addCriterionFeedback = (criterionId, comment) => {\n    setLocalGradingData(prevData => {\n      const currentGrading = prevData.rubricGrading[criterionId];\n      const currentComments = (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.customComments) || '';\n      const newComments = currentComments ? `${currentComments}\\n• ${comment}` : `• ${comment}`;\n      const newRubricState = {\n        ...prevData.rubricGrading,\n        [criterionId]: {\n          ...currentGrading,\n          criterionId,\n          selectedLevel: (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel) || null,\n          customComments: newComments\n        }\n      };\n      return {\n        ...prevData,\n        rubricGrading: newRubricState\n      };\n    });\n  };\n\n  // Other handlers... (addVideoLink, removeVideoLink, etc.)\n  const addVideoLink = () => {\n    if (videoLinkInput.trim()) {\n      setGradingData(prevData => ({\n        ...prevData,\n        videoLinks: [...prevData.videoLinks, {\n          id: Date.now(),\n          url: videoLinkInput.trim(),\n          title: videoTitle.trim() || 'Video Link'\n        }]\n      }));\n      setVideoLinkInput('');\n      setVideoTitle('');\n    }\n  };\n  const removeVideoLink = id => {\n    setGradingData(prevData => ({\n      ...prevData,\n      videoLinks: prevData.videoLinks.filter(link => link.id !== id)\n    }));\n  };\n  const handleFileUpload = files => {\n    const newAttachments = Array.from(files).map(file => ({\n      id: Date.now() + Math.random(),\n      name: file.name,\n      size: file.size,\n      type: file.type,\n      file: file\n    }));\n    Promise.all(newAttachments.map(attachment => {\n      return new Promise(resolve => {\n        if (attachment.type.startsWith('image/')) {\n          const reader = new FileReader();\n          reader.onload = e => {\n            attachment.base64Data = e.target.result;\n            resolve(attachment);\n          };\n          reader.readAsDataURL(attachment.file);\n        } else {\n          resolve(attachment);\n        }\n      });\n    })).then(processedAttachments => {\n      setGradingData(prevData => ({\n        ...prevData,\n        attachments: [...prevData.attachments, ...processedAttachments]\n      }));\n    });\n  };\n  const removeAttachment = id => {\n    setGradingData(prevData => ({\n      ...prevData,\n      attachments: prevData.attachments.filter(att => att.id !== id)\n    }));\n  };\n\n  // RUBRIC LOADING LOGIC from the new file\n  const handleRubricUpload = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        const rubricData = JSON.parse(e.target.result);\n        if (!rubricData.assignmentInfo || !rubricData.criteria || !rubricData.rubricLevels) {\n          alert('Invalid rubric format.');\n          return;\n        }\n        setLoadedRubric(rubricData);\n        alert(`Rubric \"${rubricData.assignmentInfo.title}\" loaded successfully!`);\n        setGradingData(prevData => ({\n          ...prevData,\n          rubricGrading: {}\n        }));\n      } catch (error) {\n        alert('Error loading rubric: Invalid JSON format');\n      }\n    };\n    reader.readAsText(file);\n  };\n\n  // All other functions (resetGradingForm, handleNextStudent, generateStudentReportHTML, etc.) are kept the same\n  // ...\n\n  const resetGradingForm = () => {\n    const initialRubricGrading = {};\n    if (loadedRubric && loadedRubric.criteria) {\n      // ✅ FIX: Added safety check\n      loadedRubric.criteria.forEach(criterion => {\n        initialRubricGrading[criterion.id] = {\n          criterionId: criterion.id,\n          selectedLevel: null,\n          customComments: ''\n        };\n      });\n    }\n    setLocalGradingData(prev => {\n      var _sharedCourseDetails$, _sharedCourseDetails$2;\n      return {\n        ...prev,\n        course: (_sharedCourseDetails$ = sharedCourseDetails === null || sharedCourseDetails === void 0 ? void 0 : sharedCourseDetails.course) !== null && _sharedCourseDetails$ !== void 0 ? _sharedCourseDetails$ : prev.course,\n        assignment: (_sharedCourseDetails$2 = sharedCourseDetails === null || sharedCourseDetails === void 0 ? void 0 : sharedCourseDetails.assignment) !== null && _sharedCourseDetails$2 !== void 0 ? _sharedCourseDetails$2 : prev.assignment,\n        feedback: {\n          general: '',\n          strengths: '',\n          improvements: ''\n        },\n        attachments: [],\n        videoLinks: [],\n        latePolicy: {\n          level: 'none',\n          penaltyApplied: false\n        },\n        rubricGrading: initialRubricGrading\n      };\n    });\n  };\n  const handleNextStudent = () => {\n    handleNextStudentAsDraft();\n  };\n  const handleNextStudentAsDraft = () => {\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      saveDraft(currentStudent.id, localGradingData);\n    }\n    const success = nextStudentInSession('draft');\n    if (!success) {\n      alert('Grading session completed!');\n      setActiveTab('class-manager');\n    } else {\n      resetGradingForm();\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    }\n  };\n  const handleNextStudentAsFinal = () => {\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      saveFinalGrade(currentStudent.id, localGradingData);\n    }\n    const success = nextStudentInSession('final');\n    if (!success) {\n      alert('Grading session completed!');\n      setActiveTab('class-manager');\n    } else {\n      resetGradingForm();\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    }\n  };\n  const handlePreviousStudent = () => {\n    if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n      saveDraft(currentStudent.id, localGradingData);\n    }\n    previousStudentInSession();\n  };\n  const getCurrentStudentInfo = () => {\n    if (!classList || !(gradingSession !== null && gradingSession !== void 0 && gradingSession.active) || !gradingSession.currentStudent) {\n      return null;\n    }\n    const currentIndex = gradingSession.currentStudentIndex;\n    const totalStudents = classList.students.length;\n    const student = gradingSession.currentStudent;\n    return {\n      student,\n      position: currentIndex + 1,\n      total: totalStudents,\n      isFirst: currentIndex === 0,\n      isLast: currentIndex === totalStudents - 1\n    };\n  };\n  const currentStudentInfo = getCurrentStudentInfo();\n\n  // Helper function to generate the student report HTML. This avoids code duplication.\n  const generateStudentReportHTML = () => {\n    var _gradingData$course$c, _gradingData$course, _gradingData$course$n, _gradingData$course2, _gradingData$course$i, _gradingData$course3, _gradingData$course$t, _gradingData$course4, _gradingData$latePoli3, _gradingData$latePoli4, _gradingData$latePoli5;\n    const totalScore = scoreSummary.finalScore;\n    const rawScore = scoreSummary.rawScore;\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\n    const percentage = (totalScore / (maxPoints || 1) * 100).toFixed(1);\n    const penaltyApplied = scoreSummary.penaltyApplied;\n    const attachmentsHTML = gradingData.attachments.map((att, index) => {\n      if (att.base64Data) {\n        return `<div class=\"attachment-item\"><img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"clickable-image\" data-index=\"${index}\" style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" /><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div><div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div></div>`;\n      } else {\n        return `<div class=\"attachment-item\"><div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">📄</div><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div></div>`;\n      }\n    }).join('');\n    const videoLinksHTML = gradingData.videoLinks.map(link => `<div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\"><div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\"><span style=\"font-size: 1.25rem;\">🎥</span><strong style=\"color: #495057;\">${link.title}</strong></div><a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">${link.url}</a></div>`).join('');\n    const rubricTableHTML = loadedRubric && loadedRubric.criteria ? `\n      <div class=\"rubric-section\" style=\"margin-top: 30px;\">\n          <h3>📋 Detailed Rubric Assessment</h3>\n          <div style=\"background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;\">\n              <strong>Assignment:</strong> ${loadedRubric.assignmentInfo.title}<br>\n              <strong>Description:</strong> ${renderFormattedContent(loadedRubric.assignmentInfo.description)}<br>\n              <strong>Weight:</strong> ${loadedRubric.assignmentInfo.weight}% of Final Grade<br>\n              <strong>Passing Threshold:</strong> ${loadedRubric.assignmentInfo.passingThreshold}%  \n          </div>\n          <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 0.9rem;\">\n              <thead><tr style=\"background: #2c3e50; color: white;\"><th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Max Points</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Level Achieved</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Points Earned</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Assessment & Comments</th></tr></thead>\n              <tbody>\n                  ${loadedRubric.criteria.map(criterion => {\n      const grading = gradingData.rubricGrading[criterion.id];\n      const level = grading !== null && grading !== void 0 && grading.selectedLevel ? loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel) : null;\n      const points = level ? (criterion.maxPoints * level.multiplier).toFixed(1) : '0';\n      const levelDescription = level && criterion.levels[level.level] ? renderFormattedContent(criterion.levels[level.level].description) : '';\n      const additionalComments = (grading === null || grading === void 0 ? void 0 : grading.customComments) || '';\n      return `<tr><td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\"><strong style=\"color: #2c3e50;\">${criterion.name}</strong><br><small style=\"color: #666; font-style: italic;\">${renderFormattedContent(criterion.description)}</small></td><td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold;\">${criterion.maxPoints}</td><td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; ${level ? `background-color: ${level.color}15; color: ${level.color}; font-weight: bold;` : ''}\">${level ? level.name : 'Not Assessed'}</td><td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td><td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">${levelDescription ? `<div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\"><strong style=\"color: ${level.color};\">Level Description:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span></div>` : ''}${additionalComments ? `<div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\"><strong style=\"color: #856404;\">Additional Comments:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span></div>` : ''}${!levelDescription && !additionalComments ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}</td></tr>`;\n    }).join('')}\n              </tbody>\n          </table>\n          <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\"><h4 style=\"color: #2e7d32; margin-bottom: 10px;\">📊 Rubric Score Summary</h4><div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\"><div><strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br><strong>Percentage:</strong> ${percentage}%</div><div><strong>Grade Status:</strong><span style=\"color: ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}</span></div>${penaltyApplied ? `<div style=\"color: #ff9800;\"><strong>Late Penalty Applied:</strong><br>Raw Score: ${Math.round(rawScore * 10) / 10}</div>` : ''}</div></div>\n      </div>` : '';\n    const htmlContent = `<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Grade Report - ${gradingData.student.name}</title><style>body{font-family:Arial,sans-serif;max-width:800px;margin:20px auto;padding:20px;line-height:1.6}.header{background:#f8f9fa;padding:20px;border-radius:8px;margin-bottom:30px}.score-summary{background:#e8f5e8;border:2px solid #4caf50;border-radius:8px;padding:20px;margin:20px 0;text-align:center}.late-policy-section{margin:30px 0;background:#fff5f5;border:1px solid #f87171;border-radius:8px;padding:20px}.feedback-section{margin:20px 0;padding:15px;background:#f9f9f9;border-radius:8px}.attachments{margin:30px 0}.attachment-item{display:inline-block;text-align:center;margin:1rem;padding:1rem;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);max-width:250px;vertical-align:top}.clickable-image{cursor:pointer;transition:all .3s ease;position:relative}.clickable-image:hover{transform:scale(1.05);box-shadow:0 4px 8px rgba(0,0,0,.2)}.video-links{margin:30px 0}.video-link-item{margin-bottom:1rem}.video-link-item a{color:#007bff;text-decoration:none}.video-link-item a:hover{text-decoration:underline}h1,h2,h3{color:#333}.image-modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.9);animation:fadeIn .3s ease}.image-modal.show{display:flex;align-items:center;justify-content:center}.modal-content{max-width:95%;max-height:95%;object-fit:contain;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.5);animation:zoomIn .3s ease}.close-modal{position:absolute;top:20px;right:30px;color:#fff;font-size:40px;font-weight:700;cursor:pointer;z-index:1001;background:rgba(0,0,0,.5);border-radius:50%;width:50px;height:50px;display:flex;align-items:center;justify-content:center;line-height:1}.close-modal:hover{background:rgba(0,0,0,.8)}.modal-caption{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:#fff;background:rgba(0,0,0,.7);padding:10px 20px;border-radius:6px;text-align:center;max-width:80%}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes zoomIn{from{transform:scale(.5);opacity:0}to{transform:scale(1);opacity:1}}@media print{.attachment-item,.video-link-item{break-inside:avoid}.image-modal{display:none!important}}</style></head><body><div class=\"header\"><h1>📋 Grade Report</h1><p><strong>Student:</strong> ${gradingData.student.name} (${gradingData.student.id})</p><p><strong>Course:</strong> ${(_gradingData$course$c = (_gradingData$course = gradingData.course) === null || _gradingData$course === void 0 ? void 0 : _gradingData$course.code) !== null && _gradingData$course$c !== void 0 ? _gradingData$course$c : ''} - ${(_gradingData$course$n = (_gradingData$course2 = gradingData.course) === null || _gradingData$course2 === void 0 ? void 0 : _gradingData$course2.name) !== null && _gradingData$course$n !== void 0 ? _gradingData$course$n : ''}</p><p><strong>Assignment:</strong> ${gradingData.assignment.name}</p><p><strong>Instructor:</strong> ${(_gradingData$course$i = (_gradingData$course3 = gradingData.course) === null || _gradingData$course3 === void 0 ? void 0 : _gradingData$course3.instructor) !== null && _gradingData$course$i !== void 0 ? _gradingData$course$i : ''}</p><p><strong>Term:</strong> ${(_gradingData$course$t = (_gradingData$course4 = gradingData.course) === null || _gradingData$course4 === void 0 ? void 0 : _gradingData$course4.term) !== null && _gradingData$course$t !== void 0 ? _gradingData$course$t : ''}</p></div><div class=\"score-summary\"><h2>📊 Final Score</h2><div style=\"font-size:2rem;font-weight:700;color:#2e7d32;margin:15px 0\">${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)</div><p style=\"margin:10px 0;color:#555\">${loadedRubric ? `Rubric: ${loadedRubric.assignmentInfo.title}` : \"\"}${penaltyApplied ? ` | Late Policy: ${getSafeLatePolicy((_gradingData$latePoli3 = gradingData.latePolicy) === null || _gradingData$latePoli3 === void 0 ? void 0 : _gradingData$latePoli3.level).name}` : \"\"}</p></div>${penaltyApplied ? `<div class=\"late-policy-section\"><h3 style=\"color:#dc2626\">📅 Late Submission Policy Applied</h3><p><strong>Policy Status:</strong> ${getSafeLatePolicy((_gradingData$latePoli4 = gradingData.latePolicy) === null || _gradingData$latePoli4 === void 0 ? void 0 : _gradingData$latePoli4.level).name}</p><p>${getSafeLatePolicy((_gradingData$latePoli5 = gradingData.latePolicy) === null || _gradingData$latePoli5 === void 0 ? void 0 : _gradingData$latePoli5.level).description}</p><p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} → <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p></div>` : \"\"}${rubricTableHTML}${Object.entries(gradingData.feedback).filter(([e, t]) => t).map(([e, t]) => `<div class=\"feedback-section\"><h3>${e.charAt(0).toUpperCase() + e.slice(1)} Feedback</h3><p>${t.replace(/\\n/g, \"<br>\")}</p></div>`).join(\"\")}${attachmentsHTML ? `<div class=\"attachments\"><h3>📎 File Attachments</h3><div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">${attachmentsHTML}</div></div>` : \"\"}${videoLinksHTML ? `<div class=\"video-links\"><h3>🎥 Video Review Links</h3>${videoLinksHTML}</div>` : \"\"}<p style=\"margin-top:40px;text-align:center;color:#666;font-size:.9rem\">Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p><div id=\"imageModal\" class=\"image-modal\"><span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span><img class=\"modal-content\" id=\"modalImage\"><div class=\"modal-caption\" id=\"modalCaption\"></div></div><script>const attachmentData=${JSON.stringify(gradingData.attachments)};function openImageModal(e,t){const n=document.getElementById(\"imageModal\"),o=document.getElementById(\"modalImage\"),a=document.getElementById(\"modalCaption\");n.classList.add(\"show\"),o.src=e,a.textContent=t,document.body.style.overflow=\"hidden\"}function closeImageModal(){document.getElementById(\"imageModal\").classList.remove(\"show\"),document.body.style.overflow=\"auto\"}document.addEventListener(\"DOMContentLoaded\",function(){document.querySelectorAll(\".clickable-image\").forEach(e=>{e.addEventListener(\"click\",function(){const e=parseInt(this.getAttribute(\"data-index\")),t=attachmentData[e];t&&t.base64Data&&openImageModal(t.base64Data,t.name)})}),document.getElementById(\"imageModal\").addEventListener(\"click\",function(e){e.target===this&&closeImageModal()}),document.addEventListener(\"keydown\",function(e){\"Escape\"===e.key&&closeImageModal()})})</script></body></html>`;\n    return htmlContent;\n  };\n  const getLetterGrade = percentage => {\n    if (percentage >= 97) return 'A+';\n    if (percentage >= 93) return 'A';\n    if (percentage >= 90) return 'A-';\n    if (percentage >= 87) return 'B+';\n    if (percentage >= 83) return 'B';\n    if (percentage >= 80) return 'B-';\n    if (percentage >= 77) return 'C+';\n    if (percentage >= 73) return 'C';\n    if (percentage >= 70) return 'C-';\n    if (percentage >= 67) return 'D+';\n    if (percentage >= 63) return 'D';\n    if (percentage >= 60) return 'D-';\n    return 'F';\n  };\n\n  // Function to export student grade data for AI feedback generation\n  const exportAIFeedbackData = () => {\n    var _localGradingData$stu, _loadedRubric$assignm, _loadedRubric$assignm2, _loadedRubric$assignm3, _loadedRubric$assignm4, _loadedRubric$assignm5;\n    if (!((_localGradingData$stu = localGradingData.student) !== null && _localGradingData$stu !== void 0 && _localGradingData$stu.name)) {\n      alert('Please ensure student information is loaded before exporting for AI feedback.');\n      return;\n    }\n\n    // Calculate scores\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\n    const percentage = maxPoints > 0 ? Math.round(scoreSummary.finalScore / maxPoints * 100) : 0;\n\n    // Build criteria performance data\n    const criteriaPerformance = [];\n    if (loadedRubric && loadedRubric.criteria && localGradingData.rubricGrading) {\n      // ✅ FIX: Added safety check\n      loadedRubric.criteria.forEach(criterion => {\n        const grading = localGradingData.rubricGrading[criterion.id];\n        if (grading && grading.selectedLevel) {\n          const level = loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel);\n          const earnedPoints = criterion.maxPoints * ((level === null || level === void 0 ? void 0 : level.multiplier) || 0);\n          const criterionPercentage = Math.round(earnedPoints / criterion.maxPoints * 100);\n          criteriaPerformance.push({\n            name: criterion.name,\n            description: criterion.description,\n            maxPoints: criterion.maxPoints,\n            earnedPoints: Math.round(earnedPoints * 10) / 10,\n            level: grading.selectedLevel,\n            levelName: (level === null || level === void 0 ? void 0 : level.name) || 'Unknown',\n            levelDescription: (level === null || level === void 0 ? void 0 : level.description) || '',\n            percentage: criterionPercentage,\n            customComments: grading.customComments || ''\n          });\n        }\n      });\n    }\n\n    // Create the structured data for AI\n    const aiGradeData = {\n      student: {\n        firstName: localGradingData.student.name.split(' ')[0] || localGradingData.student.name,\n        lastName: localGradingData.student.name.split(' ').slice(1).join(' ') || '',\n        fullName: localGradingData.student.name,\n        id: localGradingData.student.id,\n        email: localGradingData.student.email\n      },\n      course: {\n        code: localGradingData.course.code,\n        name: localGradingData.course.name,\n        instructor: localGradingData.course.instructor,\n        term: localGradingData.course.term\n      },\n      assignment: {\n        title: localGradingData.assignment.name || (loadedRubric === null || loadedRubric === void 0 ? void 0 : (_loadedRubric$assignm = loadedRubric.assignmentInfo) === null || _loadedRubric$assignm === void 0 ? void 0 : _loadedRubric$assignm.title),\n        description: (loadedRubric === null || loadedRubric === void 0 ? void 0 : (_loadedRubric$assignm2 = loadedRubric.assignmentInfo) === null || _loadedRubric$assignm2 === void 0 ? void 0 : _loadedRubric$assignm2.description) || '',\n        totalPoints: maxPoints,\n        passingThreshold: (loadedRubric === null || loadedRubric === void 0 ? void 0 : (_loadedRubric$assignm3 = loadedRubric.assignmentInfo) === null || _loadedRubric$assignm3 === void 0 ? void 0 : _loadedRubric$assignm3.passingThreshold) || 60,\n        dueDate: localGradingData.assignment.dueDate\n      },\n      gradeData: {\n        overallScore: Math.round(scoreSummary.finalScore * 10) / 10,\n        rawScore: Math.round(scoreSummary.rawScore * 10) / 10,\n        overallPercentage: percentage,\n        letterGrade: getLetterGrade(percentage),\n        passed: percentage >= ((loadedRubric === null || loadedRubric === void 0 ? void 0 : (_loadedRubric$assignm4 = loadedRubric.assignmentInfo) === null || _loadedRubric$assignm4 === void 0 ? void 0 : _loadedRubric$assignm4.passingThreshold) || 60),\n        latePenaltyApplied: scoreSummary.penaltyApplied,\n        latePolicyDescription: scoreSummary.latePolicyDescription,\n        criteria: criteriaPerformance\n      },\n      existingFeedback: {\n        general: localGradingData.feedback.general || '',\n        strengths: localGradingData.feedback.strengths || '',\n        improvements: localGradingData.feedback.improvements || ''\n      },\n      metadata: {\n        gradedDate: new Date().toISOString(),\n        rubricUsed: (loadedRubric === null || loadedRubric === void 0 ? void 0 : (_loadedRubric$assignm5 = loadedRubric.assignmentInfo) === null || _loadedRubric$assignm5 === void 0 ? void 0 : _loadedRubric$assignm5.title) || 'Custom Rubric',\n        totalCriteria: criteriaPerformance.length,\n        exportedForAI: true\n      }\n    };\n\n    // Export as JSON file\n    const dataStr = JSON.stringify(aiGradeData, null, 2);\n    const dataBlob = new Blob([dataStr], {\n      type: 'application/json'\n    });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `AI_Feedback_Data_${localGradingData.student.name.replace(/\\s+/g, '_')}_${new Date().toISOString().slice(0, 10)}.json`;\n    link.click();\n    URL.revokeObjectURL(url);\n    return aiGradeData;\n  };\n\n  // Updated function to generate concise AI feedback prompt\n  const generateAIFeedbackPrompt = () => {\n    const gradeData = exportAIFeedbackData();\n    if (!gradeData) return;\n    const studentFirstName = gradeData.student.firstName;\n    const courseName = gradeData.course.name || 'this course';\n    const assignmentTitle = gradeData.assignment.title || 'assignment';\n\n    // Determine student level context\n    const getStudentLevel = () => {\n      const courseCode = gradeData.course.code.toUpperCase();\n      if (courseCode.includes('100') || courseCode.includes('1')) return 'first-year undergraduate';\n      if (courseCode.includes('200') || courseCode.includes('2')) return 'second-year undergraduate';\n      if (courseCode.includes('300') || courseCode.includes('3')) return 'third-year undergraduate';\n      if (courseCode.includes('400') || courseCode.includes('4')) return 'senior undergraduate';\n      if (courseCode.includes('500') || courseCode.includes('6') || courseCode.includes('8')) return 'graduate';\n      return 'undergraduate';\n    };\n    const prompt = `You are an experienced instructor writing concise, personal feedback for a student. Write feedback that sounds natural and conversational, but keep it brief and focused.\n\nSTUDENT GRADE DATA:\n${JSON.stringify(gradeData, null, 2)}\n\nWrite feedback in this exact structure:\n\n**Opening Paragraph:** Start with \"${studentFirstName}\" and write 2-3 sentences giving your overall impression of their ${assignmentTitle}. Mention their ${gradeData.gradeData.overallPercentage}% (${gradeData.gradeData.letterGrade}) performance and whether they ${gradeData.gradeData.passed ? 'met' : 'did not meet'} course standards. ${gradeData.gradeData.latePenaltyApplied ? 'Briefly acknowledge the late submission but focus on work quality.' : ''} Keep it warm but honest, appropriate for a ${getStudentLevel()} student.\n\n**Key Observations:**\nWrite 3-5 concise bullet points (use actual bullet points •) covering:\n• Their strongest performance area (mention specific criteria that scored highest)\n• One area showing good progress or solid competency  \n• One specific area for improvement with a concrete suggestion\n• ${gradeData.gradeData.latePenaltyApplied ? 'A brief note about time management for future assignments' : 'An encouragement about their overall skill development'}\n• One forward-looking suggestion for growth in ${courseName}\n\n**Conclusion:**\nWrite 1-2 sentences encouraging ${studentFirstName}'s continued development and expressing confidence in their potential.\n\n**Final Note:**\nAdd: \"Your complete grade report with detailed rubric assessment is attached for download.\"\n\n**WRITING STYLE:**\n- Conversational and personal, like speaking directly to ${studentFirstName}\n- Specific to their actual performance levels and criteria\n- Encouraging but honest\n- Professional yet warm\n- Use their actual criterion names and performance levels from the data\n- Keep each bullet point to 1-2 sentences maximum\n\n**Context:**\n- Student: ${gradeData.student.fullName}\n- Course: ${gradeData.course.code} - ${gradeData.course.name}\n- Assignment: ${assignmentTitle}\n- Instructor: ${gradeData.course.instructor}\n\nWrite the feedback now, making it sound personal and genuine while keeping it concise and well-structured.`;\n\n    // Export prompt as text file\n    const promptBlob = new Blob([prompt], {\n      type: 'text/plain'\n    });\n    const url = URL.createObjectURL(promptBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `AI_Feedback_Prompt_${gradeData.student.firstName}_${new Date().toISOString().slice(0, 10)}.txt`;\n    link.click();\n    URL.revokeObjectURL(url);\n    console.log('AI Feedback Prompt Generated:', prompt);\n    return prompt;\n  };\n\n  // Combined function to export both files at once\n  const exportForAIFeedback = () => {\n    try {\n      // First export the grade data\n      const gradeData = exportAIFeedbackData();\n      if (!gradeData) return;\n\n      // Then generate and export the prompt\n      setTimeout(() => {\n        generateAIFeedbackPrompt();\n        alert(`AI feedback files exported successfully for ${gradeData.student.fullName}!\\n\\nFiles created:\\n1. Grade data JSON\\n2. AI prompt text file\\n\\nUse these files with your preferred AI service to generate personalized feedback.`);\n      }, 500); // Small delay to ensure first download completes\n    } catch (error) {\n      console.error('Error exporting AI feedback data:', error);\n      alert('Error exporting AI feedback data. Please check the console for details.');\n    }\n  };\n  const exportToHTML = () => {\n    const htmlContent = generateStudentReportHTML();\n    const htmlBlob = new Blob([htmlContent], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(htmlBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `grade_report_${gradingData.student.name || 'student'}_${gradingData.assignment.name || 'assignment'}.html`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n  const exportToPDF = () => {\n    const html = generateStudentReportHTML();\n    const printWindow = window.open('', '_blank');\n    printWindow.document.open();\n    printWindow.document.write(html);\n    printWindow.document.close();\n    printWindow.focus();\n    printWindow.print();\n  };\n  const getEffectiveCourseData = () => {\n    const course = (gradingData === null || gradingData === void 0 ? void 0 : gradingData.course) || {};\n    const metadata = classList === null || classList === void 0 ? void 0 : classList.courseMetadata;\n    return {\n      code: course.code || (metadata === null || metadata === void 0 ? void 0 : metadata.courseCode) || '',\n      name: course.name || (metadata === null || metadata === void 0 ? void 0 : metadata.courseName) || '',\n      instructor: course.instructor || (metadata === null || metadata === void 0 ? void 0 : metadata.instructor) || (metadata === null || metadata === void 0 ? void 0 : metadata.professors) || '',\n      term: course.term || (metadata === null || metadata === void 0 ? void 0 : metadata.term) || ''\n    };\n  };\n  const pullCourseDataFromClassList = () => {\n    if (!(classList !== null && classList !== void 0 && classList.courseMetadata)) {\n      alert('No class list course metadata available to pull from.');\n      return;\n    }\n    const courseMetadata = classList.courseMetadata;\n    const newCourseInfo = {\n      code: courseMetadata.courseCode || '',\n      name: courseMetadata.courseName || '',\n      instructor: courseMetadata.instructor || courseMetadata.professors || '',\n      term: courseMetadata.term || ''\n    };\n\n    // Update both local and shared state\n    setGradingData(prevData => ({\n      ...prevData,\n      course: newCourseInfo\n    }));\n    Object.entries(newCourseInfo).forEach(([field, value]) => {\n      updateCourseInfo(field, value);\n    });\n    console.log('📥 Pulled course data from class list:', newCourseInfo);\n    alert(`Course information updated!\\n\\nCode: ${newCourseInfo.code}\\nName: ${newCourseInfo.name}\\nInstructor: ${newCourseInfo.instructor}\\nTerm: ${newCourseInfo.term}`);\n  };\n  const isCourseDataMissing = () => {\n    const course = (gradingData === null || gradingData === void 0 ? void 0 : gradingData.course) || {};\n    return !course.code && !course.name && !course.instructor && !course.term;\n  };\n  const updateLatePolicy = level => {\n    setGradingData(prevData => ({\n      ...prevData,\n      latePolicy: {\n        level: level,\n        penaltyApplied: level !== 'none',\n        policyId: (currentLatePolicy === null || currentLatePolicy === void 0 ? void 0 : currentLatePolicy.id) || DEFAULT_LATE_POLICY.id\n      }\n    }));\n  };\n  const toggleRubricComments = criterionId => {\n    setShowRubricComments(prev => ({\n      ...prev,\n      [criterionId]: !prev[criterionId]\n    }));\n  };\n\n  // UI Component for when no rubric is loaded\n  const NoRubricUI = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      minHeight: '60vh',\n      background: 'linear-gradient(135deg, #fef3c7 0%, #fed7aa 50%, #fde68a 100%)',\n      borderRadius: '1rem',\n      border: '2px dashed #f59e0b',\n      padding: '3rem',\n      margin: '2rem 0',\n      textAlign: 'center'\n    },\n    children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n      size: 80,\n      style: {\n        color: '#d97706',\n        marginBottom: '1.5rem',\n        filter: 'drop-shadow(0 2px 4px rgba(217, 119, 6, 0.3))'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 732,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        fontSize: '2rem',\n        fontWeight: '700',\n        color: '#92400e',\n        marginBottom: '1rem',\n        textShadow: '0 1px 2px rgba(146, 64, 14, 0.1)'\n      },\n      children: \"No Rubric Loaded\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 733,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        fontSize: '1.1rem',\n        color: '#a16207',\n        marginBottom: '2rem',\n        maxWidth: '600px',\n        lineHeight: '1.6'\n      },\n      children: \"A rubric is required to begin grading. Please create a new rubric or load an existing one.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 736,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: '1rem',\n        justifyContent: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setActiveTab('rubric-creator'),\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          gap: '0.5rem',\n          padding: '1rem 2rem',\n          background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\n          color: 'white',\n          border: 'none',\n          borderRadius: '0.75rem',\n          fontSize: '1rem',\n          fontWeight: '600',\n          cursor: 'pointer',\n          boxShadow: '0 4px 12px rgba(16, 185, 129, 0.4)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(FileText, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 744,\n          columnNumber: 11\n        }, this), \" Create New Rubric\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 740,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          var _rubricInputRef$curre;\n          return (_rubricInputRef$curre = rubricInputRef.current) === null || _rubricInputRef$curre === void 0 ? void 0 : _rubricInputRef$curre.click();\n        },\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          gap: '0.5rem',\n          padding: '1rem 2rem',\n          background: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)',\n          color: 'white',\n          border: 'none',\n          borderRadius: '0.75rem',\n          fontSize: '1rem',\n          fontWeight: '600',\n          cursor: 'pointer',\n          boxShadow: '0 4px 12px rgba(59, 130, 246, 0.4)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Upload, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 750,\n          columnNumber: 11\n        }, this), \" Load Existing Rubric\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 746,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 739,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      ref: rubricInputRef,\n      type: \"file\",\n      accept: \".json\",\n      style: {\n        display: 'none'\n      },\n      onChange: handleRubricUpload\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 753,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 727,\n    columnNumber: 5\n  }, this);\n  if (!loadedRubric) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        minHeight: '100vh',\n        background: '#f9fafb',\n        padding: '1.5rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          maxWidth: '80rem',\n          margin: '0 auto'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: 'linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%)',\n            color: 'white',\n            padding: '1.5rem',\n            borderRadius: '0.5rem 0.5rem 0 0',\n            boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            style: {\n              fontSize: '1.875rem',\n              fontWeight: '700',\n              margin: '0 0 0.5rem 0'\n            },\n            children: \"\\uD83D\\uDCCB Professional Grading Interface\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 768,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 761,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: 'white',\n            borderRadius: '0 0 0.5rem 0.5rem',\n            boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)',\n            padding: '1.5rem'\n          },\n          children: /*#__PURE__*/_jsxDEV(NoRubricUI, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 773,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 772,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 760,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 759,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      minHeight: '100vh',\n      background: '#f9fafb',\n      padding: '1.5rem'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        maxWidth: '80rem',\n        margin: '0 auto'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: 'linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%)',\n          color: 'white',\n          padding: '1.5rem',\n          borderRadius: '0.5rem 0.5rem 0 0',\n          boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              style: {\n                fontSize: '1.875rem',\n                fontWeight: '700',\n                margin: '0 0 0.5rem 0'\n              },\n              children: \"\\uD83D\\uDCCB Professional Grading Interface\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 793,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                color: '#bfdbfe',\n                margin: 0\n              },\n              children: loadedRubric ? 'Comprehensive rubric-based assessment' : 'Streamlined grading with flexible assessment options'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 796,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 792,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '0.75rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportToHTML,\n              style: {\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                background: '#16a34a',\n                color: 'white',\n                padding: '0.5rem 1rem',\n                borderRadius: '0.5rem',\n                border: 'none',\n                cursor: 'pointer',\n                fontSize: '0.875rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(FileDown, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 816,\n                columnNumber: 17\n              }, this), \"Export HTML\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 801,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: exportToPDF,\n              style: {\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                backgroundColor: '#dc2626',\n                color: '#ffffff',\n                padding: '0.5rem 1rem',\n                borderRadius: '0.5rem',\n                border: 'none',\n                cursor: 'pointer',\n                fontSize: '0.875rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(FileText, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 835,\n                columnNumber: 17\n              }, this), \"Export PDF\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 819,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportForAIFeedback,\n              style: {\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                background: '#7c3aed',\n                color: 'white',\n                padding: '0.5rem 1rem',\n                borderRadius: '0.5rem',\n                border: 'none',\n                cursor: 'pointer',\n                fontSize: '0.875rem'\n              },\n              title: \"Export grade data and AI prompt for generating personalized feedback\",\n              children: [/*#__PURE__*/_jsxDEV(Bot, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 855,\n                columnNumber: 17\n              }, this), \"Export for AI Feedback\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 839,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 800,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 791,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 784,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: 'white',\n          borderRadius: '0 0 0.5rem 0.5rem',\n          boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '1.5rem'\n          },\n          children: [currentStudentInfo && gradingSession && gradingSession.students && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: 'linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)',\n              border: '1px solid #0284c7',\n              borderRadius: '0.75rem',\n              padding: '1.5rem',\n              marginBottom: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                marginBottom: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '1rem'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '40px',\n                    height: '40px',\n                    background: '#0284c7',\n                    borderRadius: '50%',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    color: 'white',\n                    fontSize: '1.2rem',\n                    fontWeight: 'bold'\n                  },\n                  children: currentStudentInfo.position\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 876,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                    style: {\n                      margin: 0,\n                      fontSize: '1.5rem',\n                      fontWeight: '700',\n                      color: '#0c4a6e'\n                    },\n                    children: currentStudentInfo.student.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 891,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    style: {\n                      margin: 0,\n                      color: '#0369a1',\n                      fontSize: '0.875rem'\n                    },\n                    children: [\"Student ID: \", currentStudentInfo.student.id, \" | Email: \", currentStudentInfo.student.email]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 894,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 890,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 875,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '1rem'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    textAlign: 'center',\n                    color: '#0369a1'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '1.25rem',\n                      fontWeight: 'bold'\n                    },\n                    children: [currentStudentInfo.position, \"/\", currentStudentInfo.total]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 902,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: '0.75rem'\n                    },\n                    children: \"Progress\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 905,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 901,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    gap: '0.5rem'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handlePreviousStudent,\n                    disabled: currentStudentInfo.isFirst,\n                    style: {\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.5rem',\n                      background: currentStudentInfo.isFirst ? '#94a3b8' : '#3b82f6',\n                      color: 'white',\n                      padding: '0.75rem 1rem',\n                      borderRadius: '0.5rem',\n                      border: 'none',\n                      cursor: currentStudentInfo.isFirst ? 'not-allowed' : 'pointer',\n                      fontSize: '0.875rem',\n                      fontWeight: '500'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n                      size: 16\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 926,\n                      columnNumber: 25\n                    }, this), \"Previous\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 909,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => {\n                      updateGradingSession({\n                        active: false\n                      });\n                      setActiveTab('class-manager');\n                    },\n                    style: {\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.5rem',\n                      background: '#f59e0b',\n                      color: 'white',\n                      padding: '0.75rem 1rem',\n                      borderRadius: '0.5rem',\n                      border: 'none',\n                      cursor: 'pointer',\n                      fontSize: '0.875rem',\n                      fontWeight: '500'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(Pause, {\n                      size: 16\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 949,\n                      columnNumber: 25\n                    }, this), \"Pause Session\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 930,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handleNextStudent,\n                    disabled: currentStudentInfo.isLast,\n                    style: {\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.5rem',\n                      background: currentStudentInfo.isLast ? '#94a3b8' : '#10b981',\n                      color: 'white',\n                      padding: '0.75rem 1rem',\n                      borderRadius: '0.5rem',\n                      border: 'none',\n                      cursor: currentStudentInfo.isLast ? 'not-allowed' : 'pointer',\n                      fontSize: '0.875rem',\n                      fontWeight: '500'\n                    },\n                    children: currentStudentInfo.isLast ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                      children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n                        size: 16\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 972,\n                        columnNumber: 29\n                      }, this), \"Complete Session\"]\n                    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                      children: [\"Next\", /*#__PURE__*/_jsxDEV(ArrowRight, {\n                        size: 16\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 978,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 953,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 908,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 900,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 874,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: '100%',\n                background: '#e0f2fe',\n                borderRadius: '0.5rem',\n                height: '8px',\n                overflow: 'hidden'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  width: `${currentStudentInfo.position / currentStudentInfo.total * 100}%`,\n                  background: 'linear-gradient(90deg, #0284c7 0%, #0ea5e9 100%)',\n                  height: '100%',\n                  transition: 'width 0.5s ease'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 994,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 987,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 867,\n            columnNumber: 15\n          }, this), sharedGradingData && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\n              border: '1px solid #bbf7d0',\n              borderRadius: '0.5rem',\n              padding: '0.75rem',\n              marginBottom: '1.5rem'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                color: '#15803d'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  width: '8px',\n                  height: '8px',\n                  background: '#16a34a',\n                  borderRadius: '50%'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1015,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: '0.875rem',\n                  fontWeight: '500'\n                },\n                children: \"Auto-saved - Work preserved across tabs\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1016,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1014,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1007,\n            columnNumber: 15\n          }, this), !currentStudentInfo && classList && ((_classList$students = classList.students) === null || _classList$students === void 0 ? void 0 : _classList$students.length) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\n              border: '1px solid #fbbf24',\n              borderRadius: '0.5rem',\n              padding: '1rem',\n              marginBottom: '1.5rem'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  style: {\n                    margin: '0 0 0.5rem 0',\n                    color: '#92400e',\n                    fontSize: '1.125rem',\n                    fontWeight: '600'\n                  },\n                  children: \"Class List Available\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1033,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    margin: 0,\n                    color: '#b45309',\n                    fontSize: '0.875rem'\n                  },\n                  children: [classList.students.length, \" students ready for grading. Start a batch session to grade efficiently.\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1036,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1032,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  initializeGradingSession(classList);\n                  setActiveTab('grading-tool');\n                },\n                style: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '0.5rem',\n                  background: '#d97706',\n                  color: 'white',\n                  padding: '0.75rem 1.5rem',\n                  borderRadius: '0.5rem',\n                  border: 'none',\n                  cursor: 'pointer',\n                  fontSize: '0.875rem',\n                  fontWeight: '500'\n                },\n                children: [/*#__PURE__*/_jsxDEV(PlayCircle, {\n                  size: 16\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1059,\n                  columnNumber: 21\n                }, this), \"Start Batch Grading\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1040,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1031,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1024,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                marginBottom: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                style: {\n                  fontSize: '1.25rem',\n                  fontWeight: '600',\n                  color: '#374151'\n                },\n                children: \"Course Information\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1069,\n                columnNumber: 17\n              }, this), isCourseDataMissing() && (classList === null || classList === void 0 ? void 0 : classList.courseMetadata) && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: pullCourseDataFromClassList,\n                style: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '0.5rem',\n                  background: '#3b82f6',\n                  color: 'white',\n                  padding: '0.5rem 1rem',\n                  borderRadius: '0.5rem',\n                  border: 'none',\n                  cursor: 'pointer',\n                  fontSize: '0.875rem',\n                  fontWeight: '500'\n                },\n                title: \"Pull course information from imported class list\",\n                children: [/*#__PURE__*/_jsxDEV(Download, {\n                  size: 16\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1092,\n                  columnNumber: 21\n                }, this), \"Pull Course Data\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1075,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1068,\n              columnNumber: 15\n            }, this), (() => {\n              const effectiveData = getEffectiveCourseData();\n              if (effectiveData.code || effectiveData.name) {\n                var _gradingData$course5;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    background: '#f0f9ff',\n                    border: '1px solid #0ea5e9',\n                    borderRadius: '0.5rem',\n                    padding: '0.75rem',\n                    marginBottom: '1rem',\n                    fontSize: '0.875rem',\n                    color: '#0369a1'\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.5rem'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n                      size: 16\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1113,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: [\"Course information loaded \", (_gradingData$course5 = gradingData.course) !== null && _gradingData$course5 !== void 0 && _gradingData$course5.code ? 'from grading session' : 'from class list metadata']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1114,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1112,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1103,\n                  columnNumber: 21\n                }, this);\n              }\n              return null;\n            })(), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\n                gap: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Course Code (e.g., ART101)\",\n                value: getEffectiveCourseData().code,\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    course: {\n                      ...prevData.course,\n                      code: newValue\n                    }\n                  }));\n                  updateCourseInfo('code', newValue);\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  backgroundColor: getEffectiveCourseData().code && !((_gradingData$course6 = gradingData.course) !== null && _gradingData$course6 !== void 0 && _gradingData$course6.code) ? '#f9fafb' : 'white'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1123,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Course Name\",\n                value: getEffectiveCourseData().name,\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    course: {\n                      ...prevData.course,\n                      name: newValue\n                    }\n                  }));\n                  updateCourseInfo('name', newValue);\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  backgroundColor: getEffectiveCourseData().name && !((_gradingData$course7 = gradingData.course) !== null && _gradingData$course7 !== void 0 && _gradingData$course7.name) ? '#f9fafb' : 'white'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1144,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Instructor Name\",\n                value: getEffectiveCourseData().instructor,\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    course: {\n                      ...prevData.course,\n                      instructor: newValue\n                    }\n                  }));\n                  updateCourseInfo('instructor', newValue);\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  backgroundColor: getEffectiveCourseData().instructor && !((_gradingData$course8 = gradingData.course) !== null && _gradingData$course8 !== void 0 && _gradingData$course8.instructor) ? '#f9fafb' : 'white'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1165,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Term (e.g., Fall 2024)\",\n                value: getEffectiveCourseData().term,\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    course: {\n                      ...prevData.course,\n                      term: newValue\n                    }\n                  }));\n                  updateCourseInfo('term', newValue);\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  backgroundColor: getEffectiveCourseData().term && !((_gradingData$course9 = gradingData.course) !== null && _gradingData$course9 !== void 0 && _gradingData$course9.term) ? '#f9fafb' : 'white'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1186,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1122,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1067,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                fontSize: '1.125rem',\n                fontWeight: '600',\n                marginBottom: '0.75rem',\n                color: '#374151'\n              },\n              children: \"Student Information\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1212,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\n                gap: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Student Name\",\n                value: (currentStudent === null || currentStudent === void 0 ? void 0 : currentStudent.name) || ((_gradingData$student = gradingData.student) === null || _gradingData$student === void 0 ? void 0 : _gradingData$student.name) || '',\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    student: {\n                      ...prevData.student,\n                      name: newValue\n                    }\n                  }));\n                  updateStudentInfo('name', newValue);\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  background: currentStudentInfo ? '#f3f4f6' : 'white'\n                },\n                readOnly: !!currentStudentInfo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1216,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Student ID\",\n                value: (currentStudent === null || currentStudent === void 0 ? void 0 : currentStudent.id) || ((_gradingData$student2 = gradingData.student) === null || _gradingData$student2 === void 0 ? void 0 : _gradingData$student2.id) || '',\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    student: {\n                      ...prevData.student,\n                      id: newValue\n                    }\n                  }));\n                  updateStudentInfo('id', newValue);\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  background: currentStudentInfo ? '#f3f4f6' : 'white'\n                },\n                readOnly: !!currentStudentInfo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1238,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"email\",\n                placeholder: \"Student Email\",\n                value: (currentStudent === null || currentStudent === void 0 ? void 0 : currentStudent.email) || ((_gradingData$student3 = gradingData.student) === null || _gradingData$student3 === void 0 ? void 0 : _gradingData$student3.email) || '',\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    student: {\n                      ...prevData.student,\n                      email: newValue\n                    }\n                  }));\n                  updateStudentInfo('email', newValue);\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem',\n                  background: currentStudentInfo ? '#f3f4f6' : 'white'\n                },\n                readOnly: !!currentStudentInfo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1260,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1215,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1211,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                fontSize: '1.125rem',\n                fontWeight: '600',\n                marginBottom: '0.75rem',\n                color: '#374151'\n              },\n              children: \"Assignment Details\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1287,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\n                gap: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Assignment Name\",\n                value: gradingData.assignment.name,\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    assignment: {\n                      ...prevData.assignment,\n                      name: newValue\n                    }\n                  }));\n                  updateAssignmentInfo({\n                    name: newValue\n                  });\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1291,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                placeholder: \"Due Date\",\n                value: gradingData.assignment.dueDate,\n                onChange: e => {\n                  const newValue = e.target.value;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    assignment: {\n                      ...prevData.assignment,\n                      dueDate: newValue\n                    }\n                  }));\n                  updateAssignmentInfo({\n                    dueDate: newValue\n                  });\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1311,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                placeholder: \"Max Points\",\n                value: gradingData.assignment.maxPoints,\n                onChange: e => {\n                  const newValue = parseInt(e.target.value) || 0;\n                  setGradingData(prevData => ({\n                    ...prevData,\n                    assignment: {\n                      ...prevData.assignment,\n                      maxPoints: newValue\n                    }\n                  }));\n                  updateAssignmentInfo({\n                    maxPoints: newValue\n                  });\n                },\n                style: {\n                  width: '100%',\n                  padding: '0.75rem',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '0.5rem',\n                  fontSize: '0.875rem'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1331,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1290,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1286,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: 'linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)',\n              border: '1px solid #fed7aa',\n              borderRadius: '0.75rem',\n              padding: '1.5rem',\n              marginBottom: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                fontSize: '1.125rem',\n                fontWeight: '600',\n                marginBottom: '1rem',\n                color: '#9a3412'\n              },\n              children: \"\\uD83D\\uDCC5 Late Submission Policy\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1362,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                background: 'white',\n                border: '1px solid #fed7aa',\n                borderRadius: '0.5rem',\n                padding: '1rem',\n                marginBottom: '1.25rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                style: {\n                  fontWeight: '600',\n                  marginBottom: '0.5rem',\n                  color: '#9a3412'\n                },\n                children: [\"Active Policy: \", currentLatePolicy.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1372,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                style: {\n                  fontSize: '0.875rem',\n                  color: '#7c2d12',\n                  margin: 0\n                },\n                children: currentLatePolicy.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1375,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1365,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                style: {\n                  fontWeight: '500',\n                  marginBottom: '0.75rem',\n                  color: '#9a3412'\n                },\n                children: \"Select submission status:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1381,\n                columnNumber: 17\n              }, this), Object.entries(currentLatePolicy.levels).map(([levelKey, policy]) => /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: () => updateLatePolicy(levelKey),\n                style: {\n                  background: 'white',\n                  border: `2px solid ${gradingData.latePolicy.level === levelKey ? policy.color : '#d1d5db'}`,\n                  borderRadius: '0.75rem',\n                  padding: '1rem',\n                  marginBottom: '0.75rem',\n                  cursor: 'pointer',\n                  transition: 'all 0.3s ease',\n                  transform: gradingData.latePolicy.level === levelKey ? 'translateY(-2px)' : 'none',\n                  boxShadow: gradingData.latePolicy.level === levelKey ? '0 8px 25px rgba(0, 0, 0, 0.15)' : '0 1px 3px rgba(0, 0, 0, 0.1)',\n                  backgroundColor: gradingData.latePolicy.level === levelKey ? `linear-gradient(135deg, ${policy.color}15 0%, ${policy.color}25 100%)` : 'white'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '0.75rem',\n                    marginBottom: '0.75rem'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      width: '16px',\n                      height: '16px',\n                      borderRadius: '50%',\n                      backgroundColor: policy.color,\n                      flexShrink: 0\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1403,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                    style: {\n                      fontWeight: '600',\n                      fontSize: '1.1rem',\n                      margin: 0,\n                      flex: 1,\n                      color: policy.color\n                    },\n                    children: policy.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1410,\n                    columnNumber: 23\n                  }, this), levelKey !== 'none' && /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      fontSize: '0.9rem',\n                      opacity: 0.8,\n                      fontWeight: '500',\n                      color: policy.color\n                    },\n                    children: [\"(\\xD7\", policy.multiplier === 0 ? '0' : policy.multiplier, \")\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1420,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1402,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    fontSize: '0.9rem',\n                    lineHeight: 1.5,\n                    margin: 0,\n                    color: '#6b7280'\n                  },\n                  children: policy.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1430,\n                  columnNumber: 21\n                }, this)]\n              }, levelKey, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1386,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1380,\n              columnNumber: 15\n            }, this), scoreSummary.penaltyApplied && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                background: '#fef2f2',\n                border: '1px solid #fecaca',\n                borderRadius: '0.5rem',\n                padding: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                style: {\n                  fontWeight: '500',\n                  color: '#991b1b',\n                  marginBottom: '0.5rem'\n                },\n                children: \"\\u26A0\\uFE0F Late Penalty Calculation\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1449,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.875rem',\n                  color: '#7f1d1d'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    marginBottom: '0.25rem'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Raw Score:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1454,\n                    columnNumber: 23\n                  }, this), \" \", Math.round(scoreSummary.rawScore * 10) / 10, \" / \", loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1453,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    marginBottom: '0.25rem'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Late Penalty:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1457,\n                    columnNumber: 23\n                  }, this), \" \\xD7\", getSafeLatePolicy((_gradingData$latePoli6 = gradingData.latePolicy) === null || _gradingData$latePoli6 === void 0 ? void 0 : _gradingData$latePoli6.level).multiplier]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1456,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    margin: 0\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Final Score:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1460,\n                    columnNumber: 23\n                  }, this), \" \", Math.round(scoreSummary.finalScore * 10) / 10, \" / \", loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1459,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1452,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1443,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1355,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center',\n              background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\n              border: '1px solid #bbf7d0',\n              borderRadius: '0.75rem',\n              padding: '1.5rem',\n              marginBottom: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              style: {\n                fontSize: '1.5rem',\n                fontWeight: '700',\n                color: '#15803d',\n                marginBottom: '1rem'\n              },\n              children: \"\\uD83D\\uDCCA Final Score\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1476,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '3rem',\n                fontWeight: '700',\n                color: '#16a34a',\n                marginBottom: '1rem'\n              },\n              children: [Math.round(scoreSummary.finalScore * 10) / 10, /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: '1.5rem',\n                  color: '#6b7280'\n                },\n                children: [\"/ \", loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1481,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1479,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '1.25rem',\n                color: '#6b7280',\n                marginBottom: '1rem'\n              },\n              children: [\"(\", Math.round(scoreSummary.finalScore / (loadedRubric ? loadedRubric.assignmentInfo.totalPoints || 1 : gradingData.assignment.maxPoints || 1) * 1000) / 10, \"%)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1485,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'center',\n                gap: '1rem',\n                flexWrap: 'wrap'\n              },\n              children: [loadedRubric && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.875rem',\n                  background: '#dcfce7',\n                  color: '#15803d',\n                  padding: '0.25rem 0.75rem',\n                  borderRadius: '1rem'\n                },\n                children: \"\\uD83D\\uDCCB Rubric Assessment Active\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1490,\n                columnNumber: 19\n              }, this), scoreSummary.penaltyApplied && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.875rem',\n                  background: '#fee2e2',\n                  color: '#dc2626',\n                  padding: '0.25rem 0.75rem',\n                  borderRadius: '1rem'\n                },\n                children: \"\\u23F0 Late Penalty Applied\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1501,\n                columnNumber: 19\n              }, this), currentStudentInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '0.875rem',\n                  background: '#dbeafe',\n                  color: '#2563eb',\n                  padding: '0.25rem 0.75rem',\n                  borderRadius: '1rem'\n                },\n                children: \"\\uD83D\\uDC65 Batch Session Active\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1512,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1488,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1468,\n            columnNumber: 13\n          }, this), currentStudentInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\n              border: '1px solid #f59e0b',\n              borderRadius: '0.75rem',\n              padding: '1.5rem',\n              marginBottom: '2rem',\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                fontSize: '1.125rem',\n                fontWeight: '600',\n                color: '#92400e',\n                marginBottom: '0.75rem'\n              },\n              children: \"\\uD83D\\uDCBE Save Your Progress\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1535,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                color: '#a16207',\n                marginBottom: '1.5rem',\n                fontSize: '0.875rem'\n              },\n              children: \"Save your current grading progress as a draft. You can return to complete it later.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1538,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n                  saveDraft(currentStudent.id, localGradingData);\n                  // Show success feedback\n                  const button = document.activeElement;\n                  const originalText = button.innerHTML;\n                  const originalBg = button.style.background;\n                  button.innerHTML = '<span style=\"display: flex; align-items: center; gap: 0.5rem;\"><svg width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\"><path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/></svg>Draft Saved!</span>';\n                  button.style.background = 'linear-gradient(135deg, #059669 0%, #047857 100%)';\n                  setTimeout(() => {\n                    button.innerHTML = originalText;\n                    button.style.background = originalBg;\n                  }, 2000);\n                }\n              },\n              disabled: !(currentStudent !== null && currentStudent !== void 0 && currentStudent.id),\n              style: {\n                display: 'inline-flex',\n                alignItems: 'center',\n                gap: '0.75rem',\n                background: currentStudent !== null && currentStudent !== void 0 && currentStudent.id ? 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)' : '#9ca3af',\n                color: 'white',\n                padding: '1rem 2rem',\n                borderRadius: '0.75rem',\n                border: 'none',\n                cursor: currentStudent !== null && currentStudent !== void 0 && currentStudent.id ? 'pointer' : 'not-allowed',\n                fontSize: '1rem',\n                fontWeight: '600',\n                boxShadow: currentStudent !== null && currentStudent !== void 0 && currentStudent.id ? '0 4px 12px rgba(245, 158, 11, 0.4)' : 'none',\n                transform: 'translateY(0)',\n                transition: 'all 0.2s ease'\n              },\n              onMouseOver: e => {\n                if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n                  e.currentTarget.style.transform = 'translateY(-2px)';\n                  e.currentTarget.style.boxShadow = '0 8px 20px rgba(245, 158, 11, 0.5)';\n                }\n              },\n              onMouseOut: e => {\n                if (currentStudent !== null && currentStudent !== void 0 && currentStudent.id) {\n                  e.currentTarget.style.transform = 'translateY(0)';\n                  e.currentTarget.style.boxShadow = '0 4px 12px rgba(245, 158, 11, 0.4)';\n                }\n              },\n              title: currentStudent !== null && currentStudent !== void 0 && currentStudent.id ? 'Save current grading progress' : 'No student selected to save',\n              children: [/*#__PURE__*/_jsxDEV(Save, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1588,\n                columnNumber: 19\n              }, this), \"Save Draft\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1541,\n              columnNumber: 17\n            }, this), !(currentStudent !== null && currentStudent !== void 0 && currentStudent.id) && /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                marginTop: '0.75rem',\n                fontSize: '0.75rem',\n                color: '#6b7280'\n              },\n              children: \"Select a student from the Class Manager to enable draft saving\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1592,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1527,\n            columnNumber: 15\n          }, this), loadedRubric && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\n              border: '1px solid #bbf7d0',\n              borderRadius: '0.75rem',\n              padding: '1.5rem',\n              marginBottom: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'flex-start',\n                marginBottom: '1rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  style: {\n                    fontSize: '1.25rem',\n                    fontWeight: '700',\n                    color: '#15803d',\n                    marginBottom: '0.5rem'\n                  },\n                  children: \"\\uD83D\\uDCCB Active Assignment Rubric\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1610,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    color: '#16a34a',\n                    fontWeight: '600',\n                    fontSize: '1.1rem'\n                  },\n                  children: loadedRubric.assignmentInfo.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1613,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    fontSize: '0.875rem',\n                    color: '#059669'\n                  },\n                  children: renderFormattedContent(loadedRubric.assignmentInfo.description)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1616,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1609,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  textAlign: 'right'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: '0.875rem',\n                    color: '#059669'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    style: {\n                      margin: '0.25rem 0'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Weight:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1623,\n                      columnNumber: 25\n                    }, this), \" \", loadedRubric.assignmentInfo.weight, \"% of Final Grade\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1622,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    style: {\n                      margin: '0.25rem 0'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Passing:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1626,\n                      columnNumber: 25\n                    }, this), \" \", loadedRubric.assignmentInfo.passingThreshold, \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1625,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    style: {\n                      margin: '0.25rem 0'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Total Points:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1629,\n                      columnNumber: 25\n                    }, this), \" \", loadedRubric.assignmentInfo.totalPoints]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1628,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1621,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1620,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1608,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '1.5rem'\n              },\n              children: loadedRubric.criteria && loadedRubric.criteria.map(criterion => {\n                var _loadedRubric$rubricL, _criterion$levels$cur, _criterion$levels$cur2;\n                const currentGrading = gradingData.rubricGrading && gradingData.rubricGrading[criterion.id];\n                const showComments = showRubricComments[criterion.id];\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    background: 'white',\n                    border: '1px solid #d1d5db',\n                    borderRadius: '0.5rem',\n                    padding: '1.25rem',\n                    boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'flex-start',\n                      marginBottom: '1rem'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        flex: 1\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                        style: {\n                          fontSize: '1.125rem',\n                          fontWeight: '600',\n                          color: '#374151'\n                        },\n                        children: [criterion.name, /*#__PURE__*/_jsxDEV(\"span\", {\n                          style: {\n                            color: '#3b82f6',\n                            marginLeft: '0.5rem'\n                          },\n                          children: [\"(\", criterion.maxPoints, \" pts)\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1654,\n                          columnNumber: 31\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1652,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        style: {\n                          fontSize: '0.875rem',\n                          color: '#6b7280',\n                          marginTop: '0.25rem'\n                        },\n                        children: renderFormattedContent(criterion.description)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1658,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1651,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => toggleRubricComments(criterion.id),\n                      style: {\n                        color: '#3b82f6',\n                        background: 'none',\n                        border: 'none',\n                        fontSize: '0.875rem',\n                        textDecoration: 'underline',\n                        cursor: 'pointer',\n                        marginLeft: '1rem'\n                      },\n                      children: [showComments ? 'Hide' : 'Show', \" Level Details\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1662,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1650,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'grid',\n                      gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\n                      gap: '0.5rem',\n                      marginBottom: '1rem'\n                    },\n                    children: loadedRubric.rubricLevels.map(level => {\n                      const isSelected = (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel) === level.level;\n                      const points = Math.round(criterion.maxPoints * level.multiplier);\n                      return /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => updateRubricGrading(criterion.id, level.level),\n                        style: {\n                          padding: '0.75rem',\n                          borderRadius: '0.5rem',\n                          border: `2px solid ${isSelected ? level.color : '#d1d5db'}`,\n                          fontSize: '0.875rem',\n                          fontWeight: '500',\n                          cursor: 'pointer',\n                          transition: 'all 0.2s ease',\n                          backgroundColor: isSelected ? level.color : 'white',\n                          color: isSelected ? 'white' : '#374151',\n                          transform: isSelected ? 'scale(1.05)' : 'none',\n                          textAlign: 'center'\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            fontWeight: '600'\n                          },\n                          children: level.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1707,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            fontSize: '0.75rem',\n                            marginTop: '0.25rem'\n                          },\n                          children: [level.level === 'incomplete' ? '0' : points, \" pts\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1708,\n                          columnNumber: 33\n                        }, this)]\n                      }, level.level, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1690,\n                        columnNumber: 31\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1679,\n                    columnNumber: 25\n                  }, this), showComments && /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      background: '#f9fafb',\n                      borderRadius: '0.5rem',\n                      padding: '1rem',\n                      marginBottom: '1rem'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                      style: {\n                        fontWeight: '600',\n                        color: '#374151',\n                        marginBottom: '0.75rem'\n                      },\n                      children: \"Level Descriptions:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1724,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        display: 'grid',\n                        gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\n                        gap: '0.75rem'\n                      },\n                      children: loadedRubric.rubricLevels.map(level => {\n                        var _criterion$levels$lev, _criterion$levels$lev2;\n                        return /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            background: 'white',\n                            borderRadius: '0.25rem',\n                            border: '1px solid #d1d5db',\n                            borderLeft: `4px solid ${level.color}`,\n                            padding: '0.75rem'\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            style: {\n                              fontWeight: '500',\n                              fontSize: '0.875rem',\n                              color: level.color\n                            },\n                            children: level.name\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1743,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            style: {\n                              fontSize: '0.75rem',\n                              color: '#6b7280',\n                              marginBottom: '0.5rem'\n                            },\n                            children: [(_criterion$levels$lev = criterion.levels[level.level]) === null || _criterion$levels$lev === void 0 ? void 0 : _criterion$levels$lev.pointRange, \" pts\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1746,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            style: {\n                              fontSize: '0.75rem',\n                              color: '#374151'\n                            },\n                            children: renderFormattedContent((_criterion$levels$lev2 = criterion.levels[level.level]) === null || _criterion$levels$lev2 === void 0 ? void 0 : _criterion$levels$lev2.description)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1749,\n                            columnNumber: 35\n                          }, this)]\n                        }, level.level, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1733,\n                          columnNumber: 33\n                        }, this);\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1727,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1718,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      style: {\n                        display: 'block',\n                        fontSize: '0.875rem',\n                        fontWeight: '500',\n                        color: '#374151',\n                        marginBottom: '0.5rem'\n                      },\n                      children: \"Additional Comments:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1760,\n                      columnNumber: 27\n                    }, this), criterion.feedbackLibrary && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        display: 'flex',\n                        gap: '0.5rem',\n                        marginBottom: '0.75rem',\n                        flexWrap: 'wrap'\n                      },\n                      children: Object.entries(criterion.feedbackLibrary).map(([category, comments]) => /*#__PURE__*/_jsxDEV(\"select\", {\n                        onChange: e => {\n                          if (e.target.value) {\n                            addCriterionFeedback(criterion.id, e.target.value);\n                            e.target.value = '';\n                          }\n                        },\n                        defaultValue: \"\",\n                        style: {\n                          padding: '0.5rem',\n                          border: '1px solid #d1d5db',\n                          borderRadius: '0.25rem',\n                          fontSize: '0.75rem',\n                          cursor: 'pointer'\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"\",\n                          children: [\"Add \", category, \"...\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1791,\n                          columnNumber: 35\n                        }, this), comments.map((comment, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: comment,\n                          children: renderFormattedContent(comment)\n                        }, idx, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1793,\n                          columnNumber: 37\n                        }, this))]\n                      }, category, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1774,\n                        columnNumber: 33\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1772,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      value: (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.customComments) || '',\n                      onChange: e => updateRubricGrading(criterion.id, currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel, e.target.value),\n                      style: {\n                        width: '100%',\n                        padding: '0.75rem',\n                        border: '1px solid #d1d5db',\n                        borderRadius: '0.5rem',\n                        fontSize: '0.875rem',\n                        resize: 'none',\n                        minHeight: '80px'\n                      },\n                      rows: \"3\",\n                      placeholder: \"Add specific feedback for this criterion...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1800,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1759,\n                    columnNumber: 25\n                  }, this), (currentGrading === null || currentGrading === void 0 ? void 0 : currentGrading.selectedLevel) && /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginTop: '0.75rem',\n                      padding: '0.75rem',\n                      background: '#eff6ff',\n                      borderRadius: '0.25rem',\n                      border: '1px solid #bfdbfe'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontSize: '0.875rem'\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Selected Level:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1827,\n                        columnNumber: 31\n                      }, this), \" \", (_loadedRubric$rubricL = loadedRubric.rubricLevels.find(l => l.level === currentGrading.selectedLevel)) === null || _loadedRubric$rubricL === void 0 ? void 0 : _loadedRubric$rubricL.name, ' ', \"(\", (_criterion$levels$cur = criterion.levels[currentGrading.selectedLevel]) === null || _criterion$levels$cur === void 0 ? void 0 : _criterion$levels$cur.pointRange, \" pts)\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1826,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontSize: '0.875rem',\n                        color: '#374151',\n                        marginTop: '0.25rem'\n                      },\n                      children: renderFormattedContent((_criterion$levels$cur2 = criterion.levels[currentGrading.selectedLevel]) === null || _criterion$levels$cur2 === void 0 ? void 0 : _criterion$levels$cur2.description)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1830,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1819,\n                    columnNumber: 27\n                  }, this)]\n                }, criterion.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1643,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1636,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1601,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 863,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 862,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 782,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 781,\n    columnNumber: 5\n  }, this);\n};\n_s(GradingTemplate, \"jVwUZx8lQlw1Nmc8tlJ1Jf7s9bw=\", false, function () {\n  return [useAssessment];\n});\n_c = GradingTemplate;\nexport default GradingTemplate;\nvar _c;\n$RefreshReg$(_c, \"GradingTemplate\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Download","Upload","FileText","Video","Plus","X","Save","FileDown","Bot","ChevronDown","ChevronUp","ArrowLeft","ArrowRight","Users","PlayCircle","CheckCircle","Clock","SkipForward","SkipBack","Pause","RotateCcw","AlertTriangle","useAssessment","DEFAULT_LATE_POLICY","jsxDEV","_jsxDEV","Fragment","_Fragment","GradingTemplate","_s","_classList$students","_gradingData$course6","_gradingData$course7","_gradingData$course8","_gradingData$course9","_gradingData$student","_gradingData$student2","_gradingData$student3","_gradingData$latePoli6","sharedRubric","sharedCourseDetails","setSharedCourseDetails","gradingData","sharedGradingData","setGradingData","setSharedGradingData","updateStudentInfo","updateCourseInfo","updateAssignmentInfo","clearGradingFormData","classList","setClassList","setCurrentStudent","gradingSession","setGradingSession","nextStudentInSession","previousStudentInSession","updateGradingSession","initializeGradingSession","setActiveTab","currentStudent","saveDraft","loadDraft","saveFinalGrade","loadFinalGrade","finalGrades","getGradeStatus","currentLatePolicy","customLatePolicies","renderFormattedContent","htmlContent","textContent","replace","trim","localGradingData","setLocalGradingData","id","draft","student","name","email","course","code","instructor","term","assignment","dueDate","maxPoints","feedback","general","strengths","improvements","attachments","videoLinks","latePolicy","level","penaltyApplied","metadata","gradedBy","gradedDate","aiAssisted","rubricIntegrated","rubricGrading","loadedRubric","setLoadedRubric","showRubricComments","setShowRubricComments","fileInputRef","rubricInputRef","videoLinkInput","setVideoLinkInput","videoTitle","setVideoTitle","timeoutId","setTimeout","clearTimeout","status","saved","prev","resetGradingForm","getPolicyById","policyId","find","p","getSafeLatePolicy","policy","activeLevels","levels","none","calculateTotalScore","_gradingData$latePoli","_gradingData$latePoli2","rawScore","criteria","Object","values","reduce","total","grading","criterion","c","criterionId","selectedLevel","rubricLevels","l","multiplier","latePolicyLevel","finalScore","latePolicyDescription","description","scoreSummary","setScoreSummary","updateRubricGrading","comments","prevData","_prevData$rubricGradi","customComments","addCriterionFeedback","comment","currentGrading","currentComments","newComments","newRubricState","addVideoLink","Date","now","url","title","removeVideoLink","filter","link","handleFileUpload","files","newAttachments","Array","from","map","file","Math","random","size","type","Promise","all","attachment","resolve","startsWith","reader","FileReader","onload","e","base64Data","target","result","readAsDataURL","then","processedAttachments","removeAttachment","att","handleRubricUpload","event","rubricData","JSON","parse","assignmentInfo","alert","error","readAsText","initialRubricGrading","forEach","_sharedCourseDetails$","_sharedCourseDetails$2","handleNextStudent","handleNextStudentAsDraft","success","window","scrollTo","top","behavior","handleNextStudentAsFinal","handlePreviousStudent","getCurrentStudentInfo","active","currentIndex","currentStudentIndex","totalStudents","students","length","position","isFirst","isLast","currentStudentInfo","generateStudentReportHTML","_gradingData$course$c","_gradingData$course","_gradingData$course$n","_gradingData$course2","_gradingData$course$i","_gradingData$course3","_gradingData$course$t","_gradingData$course4","_gradingData$latePoli3","_gradingData$latePoli4","_gradingData$latePoli5","totalScore","totalPoints","percentage","toFixed","attachmentsHTML","index","join","videoLinksHTML","rubricTableHTML","weight","passingThreshold","points","levelDescription","additionalComments","color","round","entries","t","charAt","toUpperCase","slice","toLocaleDateString","toLocaleTimeString","stringify","getLetterGrade","exportAIFeedbackData","_localGradingData$stu","_loadedRubric$assignm","_loadedRubric$assignm2","_loadedRubric$assignm3","_loadedRubric$assignm4","_loadedRubric$assignm5","criteriaPerformance","earnedPoints","criterionPercentage","push","levelName","aiGradeData","firstName","split","lastName","fullName","gradeData","overallScore","overallPercentage","letterGrade","passed","latePenaltyApplied","existingFeedback","toISOString","rubricUsed","totalCriteria","exportedForAI","dataStr","dataBlob","Blob","URL","createObjectURL","document","createElement","href","download","click","revokeObjectURL","generateAIFeedbackPrompt","studentFirstName","courseName","assignmentTitle","getStudentLevel","courseCode","includes","prompt","promptBlob","console","log","exportForAIFeedback","exportToHTML","htmlBlob","exportToPDF","html","printWindow","open","write","close","focus","print","getEffectiveCourseData","courseMetadata","professors","pullCourseDataFromClassList","newCourseInfo","field","value","isCourseDataMissing","updateLatePolicy","toggleRubricComments","NoRubricUI","style","display","flexDirection","alignItems","justifyContent","minHeight","background","borderRadius","border","padding","margin","textAlign","children","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","fontSize","fontWeight","textShadow","maxWidth","lineHeight","gap","onClick","cursor","boxShadow","_rubricInputRef$curre","current","ref","accept","onChange","backgroundColor","width","height","disabled","overflow","transition","effectiveData","_gradingData$course5","gridTemplateColumns","placeholder","newValue","readOnly","parseInt","levelKey","transform","flexShrink","flex","opacity","flexWrap","button","activeElement","originalText","innerHTML","originalBg","onMouseOver","currentTarget","onMouseOut","marginTop","_loadedRubric$rubricL","_criterion$levels$cur","_criterion$levels$cur2","showComments","marginLeft","textDecoration","isSelected","_criterion$levels$lev","_criterion$levels$lev2","borderLeft","pointRange","feedbackLibrary","category","defaultValue","idx","resize","rows","_c","$RefreshReg$"],"sources":["C:/local clones/rubric-creation-app/src/components/GradingTemplate.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport {\r\n  Download, Upload, FileText, Video, Plus, X, Save, FileDown, Bot,\r\n  ChevronDown, ChevronUp, ArrowLeft, ArrowRight, Users, PlayCircle,\r\n  CheckCircle, Clock, SkipForward, SkipBack, Pause, RotateCcw, AlertTriangle\r\n} from 'lucide-react';\r\nimport { useAssessment, DEFAULT_LATE_POLICY } from './SharedContext';\r\n\r\nconst GradingTemplate = () => {\r\n  // Get shared context\r\n  const {\r\n    sharedRubric,\r\n    sharedCourseDetails,\r\n    setSharedCourseDetails,\r\n    gradingData: sharedGradingData,\r\n    setGradingData: setSharedGradingData,\r\n    updateStudentInfo,\r\n    updateCourseInfo,\r\n    updateAssignmentInfo,\r\n    clearGradingFormData,\r\n    classList,\r\n    setClassList,\r\n    setCurrentStudent,\r\n    gradingSession,\r\n    setGradingSession,\r\n    nextStudentInSession,\r\n    previousStudentInSession,\r\n    updateGradingSession,\r\n    initializeGradingSession,\r\n    setActiveTab,\r\n    currentStudent,\r\n    saveDraft,\r\n    loadDraft,\r\n    saveFinalGrade,\r\n    loadFinalGrade,\r\n    finalGrades,\r\n    getGradeStatus,\r\n    currentLatePolicy,\r\n    customLatePolicies\r\n  } = useAssessment();\r\n\r\n  // Helper function to convert HTML content to readable text format\r\n  const renderFormattedContent = (htmlContent) => {\r\n    if (!htmlContent) return '';\r\n    let textContent = htmlContent\r\n      .replace(/<br\\s*\\/?>/gi, '\\n')\r\n      .replace(/<\\/p>/gi, '\\n')\r\n      .replace(/<p[^>]*>/gi, '')\r\n      .replace(/<strong[^>]*>(.*?)<\\/strong>/gi, '**$1**')\r\n      .replace(/<b[^>]*>(.*?)<\\/b>/gi, '**$1**')\r\n      .replace(/<em[^>]*>(.*?)<\\/em>/gi, '*$1*')\r\n      .replace(/<i[^>]*>(.*?)<\\/i>/gi, '*$1*')\r\n      .replace(/<u[^>]*>(.*?)<\\/u>/gi, '_$1_')\r\n      .replace(/<h3[^>]*>(.*?)<\\/h3>/gi, '### $1\\n')\r\n      .replace(/<li[^>]*>(.*?)<\\/li>/gi, '• $1\\n')\r\n      .replace(/<\\/ul>/gi, '\\n')\r\n      .replace(/<ul[^>]*>/gi, '')\r\n      .replace(/<\\/ol>/gi, '\\n')\r\n      .replace(/<ol[^>]*>/gi, '')\r\n      .replace(/<[^>]*>/g, '')\r\n      .replace(/\\n\\s*\\n/g, '\\n')\r\n      .trim();\r\n    return textContent;\r\n  };\r\n\r\n  // State for all grading data\r\n  const [localGradingData, setLocalGradingData] = useState(() => {\r\n    if (currentStudent?.id) {\r\n      const draft = loadDraft(currentStudent.id);\r\n      if (draft) return draft;\r\n    }\r\n    if (sharedGradingData) {\r\n      return {\r\n        ...sharedGradingData,\r\n        student: currentStudent || sharedGradingData.student || { name: '', id: '', email: '' }\r\n      };\r\n    }\r\n    return {\r\n      student: currentStudent || { name: '', id: '', email: '' },\r\n      course: sharedCourseDetails?.course || { code: '', name: '', instructor: '', term: '' },\r\n      assignment: sharedCourseDetails?.assignment || { name: '', dueDate: '', maxPoints: 100 },\r\n      feedback: { general: '', strengths: '', improvements: '' },\r\n      attachments: [],\r\n      videoLinks: [],\r\n      latePolicy: { level: 'none', penaltyApplied: false },\r\n      metadata: { gradedBy: '', gradedDate: '', aiAssisted: false, rubricIntegrated: false },\r\n      rubricGrading: {}\r\n    };\r\n  });\r\n\r\n  const gradingData = localGradingData;\r\n  const setGradingData = setLocalGradingData;\r\n\r\n  // Rubric state - **MODIFIED: No default rubric**\r\n  const [loadedRubric, setLoadedRubric] = useState(() => sharedRubric || null);\r\n  const [showRubricComments, setShowRubricComments] = useState({});\r\n\r\n  const fileInputRef = useRef(null);\r\n  const rubricInputRef = useRef(null);\r\n  const [videoLinkInput, setVideoLinkInput] = useState('');\r\n  const [videoTitle, setVideoTitle] = useState('');\r\n\r\n  // Sync with shared context\r\n  useEffect(() => {\r\n    if (sharedRubric && sharedRubric !== loadedRubric) {\r\n      setLoadedRubric(sharedRubric);\r\n    }\r\n  }, [sharedRubric, loadedRubric]);\r\n\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      setSharedGradingData(gradingData);\r\n      setSharedCourseDetails({\r\n        student: gradingData.student,\r\n        course: gradingData.course,\r\n        assignment: gradingData.assignment\r\n      });\r\n    }, 1000);\r\n    return () => clearTimeout(timeoutId);\r\n  }, [gradingData, setSharedGradingData, setSharedCourseDetails]);\r\n\r\n  useEffect(() => {\r\n    if (!currentStudent?.id) return;\r\n    const status = getGradeStatus(currentStudent.id);\r\n    let saved = (status === 'final' && loadFinalGrade) ? loadFinalGrade(currentStudent.id) : (status === 'draft' ? loadDraft(currentStudent.id) : null);\r\n    if (saved) {\r\n      setLocalGradingData(prev => ({\r\n        ...saved,\r\n        student: currentStudent,\r\n        course: prev.course,\r\n        assignment: prev.assignment,\r\n        metadata: prev.metadata\r\n      }));\r\n    } else {\r\n      resetGradingForm();\r\n    }\r\n  }, [currentStudent, getGradeStatus, loadDraft, loadFinalGrade]);\r\n\r\n  // Safely access late policy levels\r\n  const getPolicyById = (policyId) => {\r\n    if (!policyId) return null;\r\n    if (policyId === DEFAULT_LATE_POLICY.id) return DEFAULT_LATE_POLICY;\r\n    return customLatePolicies.find(p => p.id === policyId) || null;\r\n  };\r\n\r\n  const getSafeLatePolicy = (level, policyId) => {\r\n    const policy = getPolicyById(policyId) || currentLatePolicy || DEFAULT_LATE_POLICY;\r\n    const activeLevels = policy.levels || DEFAULT_LATE_POLICY.levels;\r\n    if (!level || typeof level !== \"string\" || !activeLevels[level]) {\r\n      return activeLevels.none;\r\n    }\r\n    return activeLevels[level];\r\n  };\r\n\r\n\r\n  // Calculate total score\r\n  const calculateTotalScore = () => {\r\n    let rawScore = 0;\r\n    // ✅ FIX: Check for loadedRubric and its criteria before calculating\r\n    if (loadedRubric && loadedRubric.criteria && gradingData.rubricGrading) {\r\n      rawScore = Object.values(gradingData.rubricGrading).reduce((total, grading) => {\r\n        const criterion = loadedRubric.criteria.find(c => c.id === grading.criterionId);\r\n        if (criterion && grading.selectedLevel) {\r\n          const level = loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel);\r\n          if (level) {\r\n            return total + (criterion.maxPoints * level.multiplier);\r\n          }\r\n        }\r\n        return total;\r\n      }, 0);\r\n    }\r\n    const policyId = gradingData.latePolicy?.policyId;\r\n    const latePolicyLevel = getSafeLatePolicy(gradingData.latePolicy?.level, policyId);\r\n\r\n    const finalScore = rawScore * latePolicyLevel.multiplier;\r\n    return {\r\n      rawScore,\r\n      finalScore,\r\n      penaltyApplied: gradingData.latePolicy.level !== 'none',\r\n      latePolicyDescription: latePolicyLevel.description\r\n    };\r\n  };\r\n\r\n  const [scoreSummary, setScoreSummary] = useState(calculateTotalScore());\r\n\r\n  useEffect(() => {\r\n    setScoreSummary(calculateTotalScore());\r\n  }, [gradingData.rubricGrading, gradingData.latePolicy, currentLatePolicy, customLatePolicies, loadedRubric]);\r\n\r\n  // Update rubric grading\r\n  const updateRubricGrading = (criterionId, level, comments = null) => {\r\n    setLocalGradingData(prevData => ({\r\n      ...prevData,\r\n      rubricGrading: {\r\n        ...prevData.rubricGrading,\r\n        [criterionId]: {\r\n          criterionId,\r\n          selectedLevel: level,\r\n          customComments: comments !== null ? comments : (prevData.rubricGrading[criterionId]?.customComments || '')\r\n        }\r\n      }\r\n    }));\r\n  };\r\n\r\n  const addCriterionFeedback = (criterionId, comment) => {\r\n    setLocalGradingData(prevData => {\r\n      const currentGrading = prevData.rubricGrading[criterionId];\r\n      const currentComments = currentGrading?.customComments || '';\r\n      const newComments = currentComments ? `${currentComments}\\n• ${comment}` : `• ${comment}`;\r\n      const newRubricState = {\r\n        ...prevData.rubricGrading,\r\n        [criterionId]: {\r\n          ...currentGrading,\r\n          criterionId,\r\n          selectedLevel: currentGrading?.selectedLevel || null,\r\n          customComments: newComments\r\n        }\r\n      };\r\n      return {\r\n        ...prevData,\r\n        rubricGrading: newRubricState\r\n      };\r\n    });\r\n  };\r\n\r\n  // Other handlers... (addVideoLink, removeVideoLink, etc.)\r\n  const addVideoLink = () => {\r\n    if (videoLinkInput.trim()) {\r\n      setGradingData(prevData => ({\r\n        ...prevData,\r\n        videoLinks: [...prevData.videoLinks, {\r\n          id: Date.now(),\r\n          url: videoLinkInput.trim(),\r\n          title: videoTitle.trim() || 'Video Link'\r\n        }]\r\n      }));\r\n      setVideoLinkInput('');\r\n      setVideoTitle('');\r\n    }\r\n  };\r\n\r\n  const removeVideoLink = (id) => {\r\n    setGradingData(prevData => ({\r\n      ...prevData,\r\n      videoLinks: prevData.videoLinks.filter(link => link.id !== id)\r\n    }));\r\n  };\r\n\r\n  const handleFileUpload = (files) => {\r\n    const newAttachments = Array.from(files).map(file => ({\r\n      id: Date.now() + Math.random(),\r\n      name: file.name,\r\n      size: file.size,\r\n      type: file.type,\r\n      file: file\r\n    }));\r\n\r\n    Promise.all(newAttachments.map(attachment => {\r\n      return new Promise((resolve) => {\r\n        if (attachment.type.startsWith('image/')) {\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => {\r\n            attachment.base64Data = e.target.result;\r\n            resolve(attachment);\r\n          };\r\n          reader.readAsDataURL(attachment.file);\r\n        } else {\r\n          resolve(attachment);\r\n        }\r\n      });\r\n    })).then(processedAttachments => {\r\n      setGradingData(prevData => ({\r\n        ...prevData,\r\n        attachments: [...prevData.attachments, ...processedAttachments]\r\n      }));\r\n    });\r\n  };\r\n\r\n  const removeAttachment = (id) => {\r\n    setGradingData(prevData => ({\r\n      ...prevData,\r\n      attachments: prevData.attachments.filter(att => att.id !== id)\r\n    }));\r\n  };\r\n\r\n  // RUBRIC LOADING LOGIC from the new file\r\n  const handleRubricUpload = (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      try {\r\n        const rubricData = JSON.parse(e.target.result);\r\n        if (!rubricData.assignmentInfo || !rubricData.criteria || !rubricData.rubricLevels) {\r\n          alert('Invalid rubric format.');\r\n          return;\r\n        }\r\n        setLoadedRubric(rubricData);\r\n        alert(`Rubric \"${rubricData.assignmentInfo.title}\" loaded successfully!`);\r\n        setGradingData(prevData => ({ ...prevData, rubricGrading: {} }));\r\n      } catch (error) {\r\n        alert('Error loading rubric: Invalid JSON format');\r\n      }\r\n    };\r\n    reader.readAsText(file);\r\n  };\r\n\r\n  // All other functions (resetGradingForm, handleNextStudent, generateStudentReportHTML, etc.) are kept the same\r\n  // ...\r\n\r\n  const resetGradingForm = () => {\r\n    const initialRubricGrading = {};\r\n    if (loadedRubric && loadedRubric.criteria) { // ✅ FIX: Added safety check\r\n      loadedRubric.criteria.forEach(criterion => {\r\n        initialRubricGrading[criterion.id] = {\r\n          criterionId: criterion.id,\r\n          selectedLevel: null,\r\n          customComments: ''\r\n        };\r\n      });\r\n    }\r\n    setLocalGradingData(prev => ({\r\n      ...prev,\r\n      course: sharedCourseDetails?.course ?? prev.course,\r\n      assignment: sharedCourseDetails?.assignment ?? prev.assignment,\r\n      feedback: { general: '', strengths: '', improvements: '' },\r\n      attachments: [],\r\n      videoLinks: [],\r\n      latePolicy: { level: 'none', penaltyApplied: false },\r\n      rubricGrading: initialRubricGrading\r\n    }));\r\n  };\r\n\r\n  const handleNextStudent = () => {\r\n    handleNextStudentAsDraft();\r\n  };\r\n\r\n  const handleNextStudentAsDraft = () => {\r\n    if (currentStudent?.id) {\r\n      saveDraft(currentStudent.id, localGradingData);\r\n    }\r\n    const success = nextStudentInSession('draft');\r\n    if (!success) {\r\n      alert('Grading session completed!');\r\n      setActiveTab('class-manager');\r\n    } else {\r\n      resetGradingForm();\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const handleNextStudentAsFinal = () => {\r\n    if (currentStudent?.id) {\r\n      saveFinalGrade(currentStudent.id, localGradingData);\r\n    }\r\n    const success = nextStudentInSession('final');\r\n    if (!success) {\r\n      alert('Grading session completed!');\r\n      setActiveTab('class-manager');\r\n    } else {\r\n      resetGradingForm();\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const handlePreviousStudent = () => {\r\n    if (currentStudent?.id) {\r\n      saveDraft(currentStudent.id, localGradingData);\r\n    }\r\n    previousStudentInSession();\r\n  };\r\n\r\n  const getCurrentStudentInfo = () => {\r\n    if (!classList || !gradingSession?.active || !gradingSession.currentStudent) {\r\n      return null;\r\n    }\r\n    const currentIndex = gradingSession.currentStudentIndex;\r\n    const totalStudents = classList.students.length;\r\n    const student = gradingSession.currentStudent;\r\n    return {\r\n      student,\r\n      position: currentIndex + 1,\r\n      total: totalStudents,\r\n      isFirst: currentIndex === 0,\r\n      isLast: currentIndex === totalStudents - 1\r\n    };\r\n  };\r\n\r\n  const currentStudentInfo = getCurrentStudentInfo();\r\n\r\n  // Helper function to generate the student report HTML. This avoids code duplication.\r\n  const generateStudentReportHTML = () => {\r\n    const totalScore = scoreSummary.finalScore;\r\n    const rawScore = scoreSummary.rawScore;\r\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\r\n    const percentage = ((totalScore / (maxPoints || 1)) * 100).toFixed(1);\r\n    const penaltyApplied = scoreSummary.penaltyApplied;\r\n\r\n    const attachmentsHTML = gradingData.attachments.map((att, index) => {\r\n      if (att.base64Data) {\r\n        return `<div class=\"attachment-item\"><img src=\"${att.base64Data}\" alt=\"${att.name}\" class=\"clickable-image\" data-index=\"${index}\" style=\"max-width: 200px; max-height: 200px; object-fit: contain; display: block; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px;\" /><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div><div style=\"font-size: 0.75rem; color: #007bff; margin-top: 4px;\">Click to enlarge</div></div>`;\r\n      } else {\r\n        return `<div class=\"attachment-item\"><div style=\"width: 40px; height: 40px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto;\">📄</div><div style=\"font-size: 0.875rem; font-weight: 500; word-break: break-word;\">${att.name}</div><div style=\"font-size: 0.75rem; color: #666;\">${(att.size / 1024).toFixed(1)} KB</div></div>`;\r\n      }\r\n    }).join('');\r\n\r\n    const videoLinksHTML = gradingData.videoLinks.map(link => `<div class=\"video-link-item\" style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;\"><div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\"><span style=\"font-size: 1.25rem;\">🎥</span><strong style=\"color: #495057;\">${link.title}</strong></div><a href=\"${link.url}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #007bff; text-decoration: none; word-break: break-all;\">${link.url}</a></div>`).join('');\r\n\r\n    const rubricTableHTML = (loadedRubric && loadedRubric.criteria) ? `\r\n      <div class=\"rubric-section\" style=\"margin-top: 30px;\">\r\n          <h3>📋 Detailed Rubric Assessment</h3>\r\n          <div style=\"background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;\">\r\n              <strong>Assignment:</strong> ${loadedRubric.assignmentInfo.title}<br>\r\n              <strong>Description:</strong> ${renderFormattedContent(loadedRubric.assignmentInfo.description)}<br>\r\n              <strong>Weight:</strong> ${loadedRubric.assignmentInfo.weight}% of Final Grade<br>\r\n              <strong>Passing Threshold:</strong> ${loadedRubric.assignmentInfo.passingThreshold}%  \r\n          </div>\r\n          <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 30px; font-size: 0.9rem;\">\r\n              <thead><tr style=\"background: #2c3e50; color: white;\"><th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Criterion</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Max Points</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Level Achieved</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: center;\">Points Earned</th><th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Assessment & Comments</th></tr></thead>\r\n              <tbody>\r\n                  ${loadedRubric.criteria.map(criterion => {\r\n      const grading = gradingData.rubricGrading[criterion.id];\r\n      const level = grading?.selectedLevel ? loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel) : null;\r\n      const points = level ? (criterion.maxPoints * level.multiplier).toFixed(1) : '0';\r\n      const levelDescription = level && criterion.levels[level.level] ? renderFormattedContent(criterion.levels[level.level].description) : '';\r\n      const additionalComments = grading?.customComments || '';\r\n      return `<tr><td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\"><strong style=\"color: #2c3e50;\">${criterion.name}</strong><br><small style=\"color: #666; font-style: italic;\">${renderFormattedContent(criterion.description)}</small></td><td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold;\">${criterion.maxPoints}</td><td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; ${level ? `background-color: ${level.color}15; color: ${level.color}; font-weight: bold;` : ''}\">${level ? level.name : 'Not Assessed'}</td><td style=\"border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold; font-size: 1.1em; color: #2c3e50;\">${points}</td><td style=\"border: 1px solid #ddd; padding: 8px; vertical-align: top;\">${levelDescription ? `<div style=\"margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-left: 4px solid ${level.color}; border-radius: 4px;\"><strong style=\"color: ${level.color};\">Level Description:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4;\">${levelDescription}</span></div>` : ''}${additionalComments ? `<div style=\"margin-top: 8px; padding: 8px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px;\"><strong style=\"color: #856404;\">Additional Comments:</strong><br><span style=\"font-size: 0.85em; line-height: 1.4; white-space: pre-wrap;\">${additionalComments}</span></div>` : ''}${(!levelDescription && !additionalComments) ? '<em style=\"color: #999;\">No assessment provided</em>' : ''}</td></tr>`;\r\n    }).join('')}\r\n              </tbody>\r\n          </table>\r\n          <div style=\"background: #e8f5e8; border: 1px solid #4caf50; border-radius: 8px; padding: 15px; margin-top: 20px;\"><h4 style=\"color: #2e7d32; margin-bottom: 10px;\">📊 Rubric Score Summary</h4><div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;\"><div><strong>Total Score:</strong> ${Math.round(totalScore * 10) / 10} / ${maxPoints}<br><strong>Percentage:</strong> ${percentage}%</div><div><strong>Grade Status:</strong><span style=\"color: ${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '#4caf50' : '#f44336'}; font-weight: bold;\">${percentage >= loadedRubric.assignmentInfo.passingThreshold ? '✓ PASSING' : '✗ NEEDS IMPROVEMENT'}</span></div>${penaltyApplied ? `<div style=\"color: #ff9800;\"><strong>Late Penalty Applied:</strong><br>Raw Score: ${Math.round(rawScore * 10) / 10}</div>` : ''}</div></div>\r\n      </div>` : '';\r\n\r\n    const htmlContent = `<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Grade Report - ${gradingData.student.name}</title><style>body{font-family:Arial,sans-serif;max-width:800px;margin:20px auto;padding:20px;line-height:1.6}.header{background:#f8f9fa;padding:20px;border-radius:8px;margin-bottom:30px}.score-summary{background:#e8f5e8;border:2px solid #4caf50;border-radius:8px;padding:20px;margin:20px 0;text-align:center}.late-policy-section{margin:30px 0;background:#fff5f5;border:1px solid #f87171;border-radius:8px;padding:20px}.feedback-section{margin:20px 0;padding:15px;background:#f9f9f9;border-radius:8px}.attachments{margin:30px 0}.attachment-item{display:inline-block;text-align:center;margin:1rem;padding:1rem;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);max-width:250px;vertical-align:top}.clickable-image{cursor:pointer;transition:all .3s ease;position:relative}.clickable-image:hover{transform:scale(1.05);box-shadow:0 4px 8px rgba(0,0,0,.2)}.video-links{margin:30px 0}.video-link-item{margin-bottom:1rem}.video-link-item a{color:#007bff;text-decoration:none}.video-link-item a:hover{text-decoration:underline}h1,h2,h3{color:#333}.image-modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.9);animation:fadeIn .3s ease}.image-modal.show{display:flex;align-items:center;justify-content:center}.modal-content{max-width:95%;max-height:95%;object-fit:contain;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.5);animation:zoomIn .3s ease}.close-modal{position:absolute;top:20px;right:30px;color:#fff;font-size:40px;font-weight:700;cursor:pointer;z-index:1001;background:rgba(0,0,0,.5);border-radius:50%;width:50px;height:50px;display:flex;align-items:center;justify-content:center;line-height:1}.close-modal:hover{background:rgba(0,0,0,.8)}.modal-caption{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:#fff;background:rgba(0,0,0,.7);padding:10px 20px;border-radius:6px;text-align:center;max-width:80%}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes zoomIn{from{transform:scale(.5);opacity:0}to{transform:scale(1);opacity:1}}@media print{.attachment-item,.video-link-item{break-inside:avoid}.image-modal{display:none!important}}</style></head><body><div class=\"header\"><h1>📋 Grade Report</h1><p><strong>Student:</strong> ${gradingData.student.name} (${gradingData.student.id})</p><p><strong>Course:</strong> ${gradingData.course?.code ?? ''} - ${gradingData.course?.name ?? ''}</p><p><strong>Assignment:</strong> ${gradingData.assignment.name}</p><p><strong>Instructor:</strong> ${gradingData.course?.instructor ?? ''}</p><p><strong>Term:</strong> ${gradingData.course?.term ?? ''}</p></div><div class=\"score-summary\"><h2>📊 Final Score</h2><div style=\"font-size:2rem;font-weight:700;color:#2e7d32;margin:15px 0\">${totalScore.toFixed(1)} / ${maxPoints} (${percentage}%)</div><p style=\"margin:10px 0;color:#555\">${loadedRubric ? `Rubric: ${loadedRubric.assignmentInfo.title}` : \"\"}${penaltyApplied ? ` | Late Policy: ${getSafeLatePolicy(gradingData.latePolicy?.level).name}` : \"\"}</p></div>${penaltyApplied ? `<div class=\"late-policy-section\"><h3 style=\"color:#dc2626\">📅 Late Submission Policy Applied</h3><p><strong>Policy Status:</strong> ${getSafeLatePolicy(gradingData.latePolicy?.level).name}</p><p>${getSafeLatePolicy(gradingData.latePolicy?.level).description}</p><p><strong>Raw Score:</strong> ${Math.round(rawScore * 10) / 10}/${maxPoints} → <strong>Final Score:</strong> ${Math.round(totalScore * 10) / 10}/${maxPoints}</p></div>` : \"\"}${rubricTableHTML}${Object.entries(gradingData.feedback).filter(([e, t]) => t).map(([e, t]) => `<div class=\"feedback-section\"><h3>${e.charAt(0).toUpperCase() + e.slice(1)} Feedback</h3><p>${t.replace(/\\n/g, \"<br>\")}</p></div>`).join(\"\")}${attachmentsHTML ? `<div class=\"attachments\"><h3>📎 File Attachments</h3><div style=\"display: flex; flex-wrap: wrap; justify-content: flex-start;\">${attachmentsHTML}</div></div>` : \"\"}${videoLinksHTML ? `<div class=\"video-links\"><h3>🎥 Video Review Links</h3>${videoLinksHTML}</div>` : \"\"}<p style=\"margin-top:40px;text-align:center;color:#666;font-size:.9rem\">Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p><div id=\"imageModal\" class=\"image-modal\"><span class=\"close-modal\" onclick=\"closeImageModal()\">&times;</span><img class=\"modal-content\" id=\"modalImage\"><div class=\"modal-caption\" id=\"modalCaption\"></div></div><script>const attachmentData=${JSON.stringify(gradingData.attachments)};function openImageModal(e,t){const n=document.getElementById(\"imageModal\"),o=document.getElementById(\"modalImage\"),a=document.getElementById(\"modalCaption\");n.classList.add(\"show\"),o.src=e,a.textContent=t,document.body.style.overflow=\"hidden\"}function closeImageModal(){document.getElementById(\"imageModal\").classList.remove(\"show\"),document.body.style.overflow=\"auto\"}document.addEventListener(\"DOMContentLoaded\",function(){document.querySelectorAll(\".clickable-image\").forEach(e=>{e.addEventListener(\"click\",function(){const e=parseInt(this.getAttribute(\"data-index\")),t=attachmentData[e];t&&t.base64Data&&openImageModal(t.base64Data,t.name)})}),document.getElementById(\"imageModal\").addEventListener(\"click\",function(e){e.target===this&&closeImageModal()}),document.addEventListener(\"keydown\",function(e){\"Escape\"===e.key&&closeImageModal()})})</script></body></html>`;\r\n\r\n    return htmlContent;\r\n  };\r\n\r\n  const getLetterGrade = (percentage) => {\r\n    if (percentage >= 97) return 'A+';\r\n    if (percentage >= 93) return 'A';\r\n    if (percentage >= 90) return 'A-';\r\n    if (percentage >= 87) return 'B+';\r\n    if (percentage >= 83) return 'B';\r\n    if (percentage >= 80) return 'B-';\r\n    if (percentage >= 77) return 'C+';\r\n    if (percentage >= 73) return 'C';\r\n    if (percentage >= 70) return 'C-';\r\n    if (percentage >= 67) return 'D+';\r\n    if (percentage >= 63) return 'D';\r\n    if (percentage >= 60) return 'D-';\r\n    return 'F';\r\n  };\r\n\r\n  // Function to export student grade data for AI feedback generation\r\n  const exportAIFeedbackData = () => {\r\n    if (!localGradingData.student?.name) {\r\n      alert('Please ensure student information is loaded before exporting for AI feedback.');\r\n      return;\r\n    }\r\n\r\n    // Calculate scores\r\n    const maxPoints = loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints;\r\n    const percentage = maxPoints > 0 ? Math.round((scoreSummary.finalScore / maxPoints) * 100) : 0;\r\n\r\n    // Build criteria performance data\r\n    const criteriaPerformance = [];\r\n    if (loadedRubric && loadedRubric.criteria && localGradingData.rubricGrading) { // ✅ FIX: Added safety check\r\n      loadedRubric.criteria.forEach(criterion => {\r\n        const grading = localGradingData.rubricGrading[criterion.id];\r\n        if (grading && grading.selectedLevel) {\r\n          const level = loadedRubric.rubricLevels.find(l => l.level === grading.selectedLevel);\r\n          const earnedPoints = criterion.maxPoints * (level?.multiplier || 0);\r\n          const criterionPercentage = Math.round((earnedPoints / criterion.maxPoints) * 100);\r\n\r\n          criteriaPerformance.push({\r\n            name: criterion.name,\r\n            description: criterion.description,\r\n            maxPoints: criterion.maxPoints,\r\n            earnedPoints: Math.round(earnedPoints * 10) / 10,\r\n            level: grading.selectedLevel,\r\n            levelName: level?.name || 'Unknown',\r\n            levelDescription: level?.description || '',\r\n            percentage: criterionPercentage,\r\n            customComments: grading.customComments || ''\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    // Create the structured data for AI\r\n    const aiGradeData = {\r\n      student: {\r\n        firstName: localGradingData.student.name.split(' ')[0] || localGradingData.student.name,\r\n        lastName: localGradingData.student.name.split(' ').slice(1).join(' ') || '',\r\n        fullName: localGradingData.student.name,\r\n        id: localGradingData.student.id,\r\n        email: localGradingData.student.email\r\n      },\r\n      course: {\r\n        code: localGradingData.course.code,\r\n        name: localGradingData.course.name,\r\n        instructor: localGradingData.course.instructor,\r\n        term: localGradingData.course.term\r\n      },\r\n      assignment: {\r\n        title: localGradingData.assignment.name || (loadedRubric?.assignmentInfo?.title),\r\n        description: loadedRubric?.assignmentInfo?.description || '',\r\n        totalPoints: maxPoints,\r\n        passingThreshold: loadedRubric?.assignmentInfo?.passingThreshold || 60,\r\n        dueDate: localGradingData.assignment.dueDate\r\n      },\r\n      gradeData: {\r\n        overallScore: Math.round(scoreSummary.finalScore * 10) / 10,\r\n        rawScore: Math.round(scoreSummary.rawScore * 10) / 10,\r\n        overallPercentage: percentage,\r\n        letterGrade: getLetterGrade(percentage),\r\n        passed: percentage >= (loadedRubric?.assignmentInfo?.passingThreshold || 60),\r\n        latePenaltyApplied: scoreSummary.penaltyApplied,\r\n        latePolicyDescription: scoreSummary.latePolicyDescription,\r\n        criteria: criteriaPerformance\r\n      },\r\n      existingFeedback: {\r\n        general: localGradingData.feedback.general || '',\r\n        strengths: localGradingData.feedback.strengths || '',\r\n        improvements: localGradingData.feedback.improvements || ''\r\n      },\r\n      metadata: {\r\n        gradedDate: new Date().toISOString(),\r\n        rubricUsed: loadedRubric?.assignmentInfo?.title || 'Custom Rubric',\r\n        totalCriteria: criteriaPerformance.length,\r\n        exportedForAI: true\r\n      }\r\n    };\r\n\r\n    // Export as JSON file\r\n    const dataStr = JSON.stringify(aiGradeData, null, 2);\r\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\r\n    const url = URL.createObjectURL(dataBlob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `AI_Feedback_Data_${localGradingData.student.name.replace(/\\s+/g, '_')}_${new Date().toISOString().slice(0, 10)}.json`;\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n\r\n    return aiGradeData;\r\n  };\r\n\r\n  // Updated function to generate concise AI feedback prompt\r\n  const generateAIFeedbackPrompt = () => {\r\n    const gradeData = exportAIFeedbackData();\r\n    if (!gradeData) return;\r\n\r\n    const studentFirstName = gradeData.student.firstName;\r\n    const courseName = gradeData.course.name || 'this course';\r\n    const assignmentTitle = gradeData.assignment.title || 'assignment';\r\n\r\n    // Determine student level context\r\n    const getStudentLevel = () => {\r\n      const courseCode = gradeData.course.code.toUpperCase();\r\n      if (courseCode.includes('100') || courseCode.includes('1')) return 'first-year undergraduate';\r\n      if (courseCode.includes('200') || courseCode.includes('2')) return 'second-year undergraduate';\r\n      if (courseCode.includes('300') || courseCode.includes('3')) return 'third-year undergraduate';\r\n      if (courseCode.includes('400') || courseCode.includes('4')) return 'senior undergraduate';\r\n      if (courseCode.includes('500') || courseCode.includes('6') || courseCode.includes('8')) return 'graduate';\r\n      return 'undergraduate';\r\n    };\r\n\r\n    const prompt = `You are an experienced instructor writing concise, personal feedback for a student. Write feedback that sounds natural and conversational, but keep it brief and focused.\r\n\r\nSTUDENT GRADE DATA:\r\n${JSON.stringify(gradeData, null, 2)}\r\n\r\nWrite feedback in this exact structure:\r\n\r\n**Opening Paragraph:** Start with \"${studentFirstName}\" and write 2-3 sentences giving your overall impression of their ${assignmentTitle}. Mention their ${gradeData.gradeData.overallPercentage}% (${gradeData.gradeData.letterGrade}) performance and whether they ${gradeData.gradeData.passed ? 'met' : 'did not meet'} course standards. ${gradeData.gradeData.latePenaltyApplied ? 'Briefly acknowledge the late submission but focus on work quality.' : ''} Keep it warm but honest, appropriate for a ${getStudentLevel()} student.\r\n\r\n**Key Observations:**\r\nWrite 3-5 concise bullet points (use actual bullet points •) covering:\r\n• Their strongest performance area (mention specific criteria that scored highest)\r\n• One area showing good progress or solid competency  \r\n• One specific area for improvement with a concrete suggestion\r\n• ${gradeData.gradeData.latePenaltyApplied ? 'A brief note about time management for future assignments' : 'An encouragement about their overall skill development'}\r\n• One forward-looking suggestion for growth in ${courseName}\r\n\r\n**Conclusion:**\r\nWrite 1-2 sentences encouraging ${studentFirstName}'s continued development and expressing confidence in their potential.\r\n\r\n**Final Note:**\r\nAdd: \"Your complete grade report with detailed rubric assessment is attached for download.\"\r\n\r\n**WRITING STYLE:**\r\n- Conversational and personal, like speaking directly to ${studentFirstName}\r\n- Specific to their actual performance levels and criteria\r\n- Encouraging but honest\r\n- Professional yet warm\r\n- Use their actual criterion names and performance levels from the data\r\n- Keep each bullet point to 1-2 sentences maximum\r\n\r\n**Context:**\r\n- Student: ${gradeData.student.fullName}\r\n- Course: ${gradeData.course.code} - ${gradeData.course.name}\r\n- Assignment: ${assignmentTitle}\r\n- Instructor: ${gradeData.course.instructor}\r\n\r\nWrite the feedback now, making it sound personal and genuine while keeping it concise and well-structured.`;\r\n\r\n    // Export prompt as text file\r\n    const promptBlob = new Blob([prompt], { type: 'text/plain' });\r\n    const url = URL.createObjectURL(promptBlob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `AI_Feedback_Prompt_${gradeData.student.firstName}_${new Date().toISOString().slice(0, 10)}.txt`;\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n\r\n    console.log('AI Feedback Prompt Generated:', prompt);\r\n    return prompt;\r\n  };\r\n\r\n  // Combined function to export both files at once\r\n  const exportForAIFeedback = () => {\r\n    try {\r\n      // First export the grade data\r\n      const gradeData = exportAIFeedbackData();\r\n      if (!gradeData) return;\r\n\r\n      // Then generate and export the prompt\r\n      setTimeout(() => {\r\n        generateAIFeedbackPrompt();\r\n        alert(`AI feedback files exported successfully for ${gradeData.student.fullName}!\\n\\nFiles created:\\n1. Grade data JSON\\n2. AI prompt text file\\n\\nUse these files with your preferred AI service to generate personalized feedback.`);\r\n      }, 500); // Small delay to ensure first download completes\r\n\r\n    } catch (error) {\r\n      console.error('Error exporting AI feedback data:', error);\r\n      alert('Error exporting AI feedback data. Please check the console for details.');\r\n    }\r\n  };\r\n\r\n  const exportToHTML = () => {\r\n    const htmlContent = generateStudentReportHTML();\r\n    const htmlBlob = new Blob([htmlContent], { type: 'text/html' });\r\n    const url = URL.createObjectURL(htmlBlob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `grade_report_${gradingData.student.name || 'student'}_${gradingData.assignment.name || 'assignment'}.html`;\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const exportToPDF = () => {\r\n    const html = generateStudentReportHTML();\r\n    const printWindow = window.open('', '_blank');\r\n    printWindow.document.open();\r\n    printWindow.document.write(html);\r\n    printWindow.document.close();\r\n    printWindow.focus();\r\n    printWindow.print();\r\n  };\r\n\r\n  const getEffectiveCourseData = () => {\r\n    const course = gradingData?.course || {};\r\n    const metadata = classList?.courseMetadata;\r\n\r\n    return {\r\n      code: course.code || metadata?.courseCode || '',\r\n      name: course.name || metadata?.courseName || '',\r\n      instructor: course.instructor || metadata?.instructor || metadata?.professors || '',\r\n      term: course.term || metadata?.term || ''\r\n    };\r\n  };\r\n\r\n  const pullCourseDataFromClassList = () => {\r\n    if (!classList?.courseMetadata) {\r\n      alert('No class list course metadata available to pull from.');\r\n      return;\r\n    }\r\n\r\n    const courseMetadata = classList.courseMetadata;\r\n    const newCourseInfo = {\r\n      code: courseMetadata.courseCode || '',\r\n      name: courseMetadata.courseName || '',\r\n      instructor: courseMetadata.instructor || courseMetadata.professors || '',\r\n      term: courseMetadata.term || ''\r\n    };\r\n\r\n    // Update both local and shared state\r\n    setGradingData(prevData => ({\r\n      ...prevData,\r\n      course: newCourseInfo\r\n    }));\r\n\r\n    Object.entries(newCourseInfo).forEach(([field, value]) => {\r\n      updateCourseInfo(field, value);\r\n    });\r\n\r\n    console.log('📥 Pulled course data from class list:', newCourseInfo);\r\n    alert(`Course information updated!\\n\\nCode: ${newCourseInfo.code}\\nName: ${newCourseInfo.name}\\nInstructor: ${newCourseInfo.instructor}\\nTerm: ${newCourseInfo.term}`);\r\n  };\r\n\r\n  const isCourseDataMissing = () => {\r\n    const course = gradingData?.course || {};\r\n    return !course.code && !course.name && !course.instructor && !course.term;\r\n  };\r\n\r\n  const updateLatePolicy = (level) => {\r\n    setGradingData(prevData => ({\r\n      ...prevData,\r\n      latePolicy: {\r\n        level: level,\r\n        penaltyApplied: level !== 'none',\r\n        policyId: currentLatePolicy?.id || DEFAULT_LATE_POLICY.id\r\n      }\r\n    }));\r\n  };\r\n\r\n  const toggleRubricComments = (criterionId) => {\r\n    setShowRubricComments(prev => ({\r\n      ...prev,\r\n      [criterionId]: !prev[criterionId]\r\n    }));\r\n  };\r\n\r\n  // UI Component for when no rubric is loaded\r\n  const NoRubricUI = () => (\r\n    <div style={{\r\n      display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center',\r\n      minHeight: '60vh', background: 'linear-gradient(135deg, #fef3c7 0%, #fed7aa 50%, #fde68a 100%)',\r\n      borderRadius: '1rem', border: '2px dashed #f59e0b', padding: '3rem', margin: '2rem 0', textAlign: 'center'\r\n    }}>\r\n      <AlertTriangle size={80} style={{ color: '#d97706', marginBottom: '1.5rem', filter: 'drop-shadow(0 2px 4px rgba(217, 119, 6, 0.3))' }} />\r\n      <h2 style={{ fontSize: '2rem', fontWeight: '700', color: '#92400e', marginBottom: '1rem', textShadow: '0 1px 2px rgba(146, 64, 14, 0.1)' }}>\r\n        No Rubric Loaded\r\n      </h2>\r\n      <p style={{ fontSize: '1.1rem', color: '#a16207', marginBottom: '2rem', maxWidth: '600px', lineHeight: '1.6' }}>\r\n        A rubric is required to begin grading. Please create a new rubric or load an existing one.\r\n      </p>\r\n      <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center' }}>\r\n        <button onClick={() => setActiveTab('rubric-creator')} style={{\r\n          display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '1rem 2rem', background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\r\n          color: 'white', border: 'none', borderRadius: '0.75rem', fontSize: '1rem', fontWeight: '600', cursor: 'pointer', boxShadow: '0 4px 12px rgba(16, 185, 129, 0.4)'\r\n        }}>\r\n          <FileText size={20} /> Create New Rubric\r\n        </button>\r\n        <button onClick={() => rubricInputRef.current?.click()} style={{\r\n          display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '1rem 2rem', background: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)',\r\n          color: 'white', border: 'none', borderRadius: '0.75rem', fontSize: '1rem', fontWeight: '600', cursor: 'pointer', boxShadow: '0 4px 12px rgba(59, 130, 246, 0.4)'\r\n        }}>\r\n          <Upload size={20} /> Load Existing Rubric\r\n        </button>\r\n      </div>\r\n      <input ref={rubricInputRef} type=\"file\" accept=\".json\" style={{ display: 'none' }} onChange={handleRubricUpload} />\r\n    </div>\r\n  );\r\n\r\n  if (!loadedRubric) {\r\n    return (\r\n      <div style={{ minHeight: '100vh', background: '#f9fafb', padding: '1.5rem' }}>\r\n        <div style={{ maxWidth: '80rem', margin: '0 auto' }}>\r\n          <div style={{\r\n            background: 'linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%)',\r\n            color: 'white',\r\n            padding: '1.5rem',\r\n            borderRadius: '0.5rem 0.5rem 0 0',\r\n            boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'\r\n          }}>\r\n            <h1 style={{ fontSize: '1.875rem', fontWeight: '700', margin: '0 0 0.5rem 0' }}>\r\n              📋 Professional Grading Interface\r\n            </h1>\r\n          </div>\r\n          <div style={{ background: 'white', borderRadius: '0 0 0.5rem 0.5rem', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)', padding: '1.5rem' }}>\r\n            <NoRubricUI />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{ minHeight: '100vh', background: '#f9fafb', padding: '1.5rem' }}>\r\n      <div style={{ maxWidth: '80rem', margin: '0 auto' }}>\r\n        {/* Header */}\r\n        <div style={{\r\n          background: 'linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%)',\r\n          color: 'white',\r\n          padding: '1.5rem',\r\n          borderRadius: '0.5rem 0.5rem 0 0',\r\n          boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'\r\n        }}>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n            <div>\r\n              <h1 style={{ fontSize: '1.875rem', fontWeight: '700', margin: '0 0 0.5rem 0' }}>\r\n                📋 Professional Grading Interface\r\n              </h1>\r\n              <p style={{ color: '#bfdbfe', margin: 0 }}>\r\n                {loadedRubric ? 'Comprehensive rubric-based assessment' : 'Streamlined grading with flexible assessment options'}\r\n              </p>\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '0.75rem' }}>\r\n              <button\r\n                onClick={exportToHTML}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  background: '#16a34a',\r\n                  color: 'white',\r\n                  padding: '0.5rem 1rem',\r\n                  borderRadius: '0.5rem',\r\n                  border: 'none',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem'\r\n                }}\r\n              >\r\n                <FileDown size={16} />\r\n                Export HTML\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={exportToPDF}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  backgroundColor: '#dc2626',\r\n                  color: '#ffffff',\r\n                  padding: '0.5rem 1rem',\r\n                  borderRadius: '0.5rem',\r\n                  border: 'none',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem'\r\n                }}\r\n              >\r\n                <FileText size={16} />\r\n                Export PDF\r\n              </button>\r\n\r\n              <button\r\n                onClick={exportForAIFeedback}\r\n                style={{\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '0.5rem',\r\n                  background: '#7c3aed',\r\n                  color: 'white',\r\n                  padding: '0.5rem 1rem',\r\n                  borderRadius: '0.5rem',\r\n                  border: 'none',\r\n                  cursor: 'pointer',\r\n                  fontSize: '0.875rem'\r\n                }}\r\n                title=\"Export grade data and AI prompt for generating personalized feedback\"\r\n              >\r\n                <Bot size={16} />\r\n                Export for AI Feedback\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ background: 'white', borderRadius: '0 0 0.5rem 0.5rem', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }}>\r\n          <div style={{ padding: '1.5rem' }}>\r\n            {/* Student Navigation Bar */}\r\n            {/* ✅ FIX: Safely check for gradingSession and students before rendering */}\r\n            {currentStudentInfo && gradingSession && gradingSession.students && (\r\n              <div style={{\r\n                background: 'linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)',\r\n                border: '1px solid #0284c7',\r\n                borderRadius: '0.75rem',\r\n                padding: '1.5rem',\r\n                marginBottom: '2rem'\r\n              }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n                    <div style={{\r\n                      width: '40px',\r\n                      height: '40px',\r\n                      background: '#0284c7',\r\n                      borderRadius: '50%',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      color: 'white',\r\n                      fontSize: '1.2rem',\r\n                      fontWeight: 'bold'\r\n                    }}>\r\n                      {currentStudentInfo.position}\r\n                    </div>\r\n                    <div>\r\n                      <h2 style={{ margin: 0, fontSize: '1.5rem', fontWeight: '700', color: '#0c4a6e' }}>\r\n                        {currentStudentInfo.student.name}\r\n                      </h2>\r\n                      <p style={{ margin: 0, color: '#0369a1', fontSize: '0.875rem' }}>\r\n                        Student ID: {currentStudentInfo.student.id} | Email: {currentStudentInfo.student.email}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n                    <div style={{ textAlign: 'center', color: '#0369a1' }}>\r\n                      <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>\r\n                        {currentStudentInfo.position}/{currentStudentInfo.total}\r\n                      </div>\r\n                      <div style={{ fontSize: '0.75rem' }}>Progress</div>\r\n                    </div>\r\n\r\n                    <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                      <button\r\n                        onClick={handlePreviousStudent}\r\n                        disabled={currentStudentInfo.isFirst}\r\n                        style={{\r\n                          display: 'flex',\r\n                          alignItems: 'center',\r\n                          gap: '0.5rem',\r\n                          background: currentStudentInfo.isFirst ? '#94a3b8' : '#3b82f6',\r\n                          color: 'white',\r\n                          padding: '0.75rem 1rem',\r\n                          borderRadius: '0.5rem',\r\n                          border: 'none',\r\n                          cursor: currentStudentInfo.isFirst ? 'not-allowed' : 'pointer',\r\n                          fontSize: '0.875rem',\r\n                          fontWeight: '500'\r\n                        }}\r\n                      >\r\n                        <ArrowLeft size={16} />\r\n                        Previous\r\n                      </button>\r\n\r\n                      <button\r\n                        onClick={() => {\r\n                          updateGradingSession({ active: false });\r\n                          setActiveTab('class-manager');\r\n                        }}\r\n                        style={{\r\n                          display: 'flex',\r\n                          alignItems: 'center',\r\n                          gap: '0.5rem',\r\n                          background: '#f59e0b',\r\n                          color: 'white',\r\n                          padding: '0.75rem 1rem',\r\n                          borderRadius: '0.5rem',\r\n                          border: 'none',\r\n                          cursor: 'pointer',\r\n                          fontSize: '0.875rem',\r\n                          fontWeight: '500'\r\n                        }}\r\n                      >\r\n                        <Pause size={16} />\r\n                        Pause Session\r\n                      </button>\r\n\r\n                      <button\r\n                        onClick={handleNextStudent}\r\n                        disabled={currentStudentInfo.isLast}\r\n                        style={{\r\n                          display: 'flex',\r\n                          alignItems: 'center',\r\n                          gap: '0.5rem',\r\n                          background: currentStudentInfo.isLast ? '#94a3b8' : '#10b981',\r\n                          color: 'white',\r\n                          padding: '0.75rem 1rem',\r\n                          borderRadius: '0.5rem',\r\n                          border: 'none',\r\n                          cursor: currentStudentInfo.isLast ? 'not-allowed' : 'pointer',\r\n                          fontSize: '0.875rem',\r\n                          fontWeight: '500'\r\n                        }}\r\n                      >\r\n                        {currentStudentInfo.isLast ? (\r\n                          <>\r\n                            <CheckCircle size={16} />\r\n                            Complete Session\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            Next\r\n                            <ArrowRight size={16} />\r\n                          </>\r\n                        )}\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Progress Bar */}\r\n                <div style={{\r\n                  width: '100%',\r\n                  background: '#e0f2fe',\r\n                  borderRadius: '0.5rem',\r\n                  height: '8px',\r\n                  overflow: 'hidden'\r\n                }}>\r\n                  <div style={{\r\n                    width: `${(currentStudentInfo.position / currentStudentInfo.total) * 100}%`,\r\n                    background: 'linear-gradient(90deg, #0284c7 0%, #0ea5e9 100%)',\r\n                    height: '100%',\r\n                    transition: 'width 0.5s ease'\r\n                  }}></div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* ... rest of the original UI JSX */}\r\n            {/* Auto-save Indicator */}\r\n            {sharedGradingData && (\r\n              <div style={{\r\n                background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\r\n                border: '1px solid #bbf7d0',\r\n                borderRadius: '0.5rem',\r\n                padding: '0.75rem',\r\n                marginBottom: '1.5rem'\r\n              }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', color: '#15803d' }}>\r\n                  <div style={{ width: '8px', height: '8px', background: '#16a34a', borderRadius: '50%' }}></div>\r\n                  <span style={{ fontSize: '0.875rem', fontWeight: '500' }}>Auto-saved - Work preserved across tabs</span>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Quick Actions for Class Management */}\r\n            {/* ✅ FIX: Safely check for students array and its length */}\r\n            {!currentStudentInfo && classList && classList.students?.length > 0 && (\r\n              <div style={{\r\n                background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\r\n                border: '1px solid #fbbf24',\r\n                borderRadius: '0.5rem',\r\n                padding: '1rem',\r\n                marginBottom: '1.5rem'\r\n              }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                  <div>\r\n                    <h3 style={{ margin: '0 0 0.5rem 0', color: '#92400e', fontSize: '1.125rem', fontWeight: '600' }}>\r\n                      Class List Available\r\n                    </h3>\r\n                    <p style={{ margin: 0, color: '#b45309', fontSize: '0.875rem' }}>\r\n                      {classList.students.length} students ready for grading. Start a batch session to grade efficiently.\r\n                    </p>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => {\r\n                      initializeGradingSession(classList);\r\n                      setActiveTab('grading-tool');\r\n                    }}\r\n                    style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      background: '#d97706',\r\n                      color: 'white',\r\n                      padding: '0.75rem 1.5rem',\r\n                      borderRadius: '0.5rem',\r\n                      border: 'none',\r\n                      cursor: 'pointer',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500'\r\n                    }}\r\n                  >\r\n                    <PlayCircle size={16} />\r\n                    Start Batch Grading\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* ENHANCED Course Information Section */}\r\n            <div style={{ marginBottom: '2rem' }}>\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n                <h2 style={{ fontSize: '1.25rem', fontWeight: '600', color: '#374151' }}>\r\n                  Course Information\r\n                </h2>\r\n\r\n                {/* Pull Course Data Button - show if data is missing and classList has metadata */}\r\n                {isCourseDataMissing() && classList?.courseMetadata && (\r\n                  <button\r\n                    onClick={pullCourseDataFromClassList}\r\n                    style={{\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '0.5rem',\r\n                      background: '#3b82f6',\r\n                      color: 'white',\r\n                      padding: '0.5rem 1rem',\r\n                      borderRadius: '0.5rem',\r\n                      border: 'none',\r\n                      cursor: 'pointer',\r\n                      fontSize: '0.875rem',\r\n                      fontWeight: '500'\r\n                    }}\r\n                    title=\"Pull course information from imported class list\"\r\n                  >\r\n                    <Download size={16} />\r\n                    Pull Course Data\r\n                  </button>\r\n                )}\r\n              </div>\r\n\r\n              {/* Data source indicator */}\r\n              {(() => {\r\n                const effectiveData = getEffectiveCourseData();\r\n                if (effectiveData.code || effectiveData.name) {\r\n                  return (\r\n                    <div style={{\r\n                      background: '#f0f9ff',\r\n                      border: '1px solid #0ea5e9',\r\n                      borderRadius: '0.5rem',\r\n                      padding: '0.75rem',\r\n                      marginBottom: '1rem',\r\n                      fontSize: '0.875rem',\r\n                      color: '#0369a1'\r\n                    }}>\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                        <CheckCircle size={16} />\r\n                        <span>Course information loaded {gradingData.course?.code ? 'from grading session' : 'from class list metadata'}</span>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                }\r\n                return null;\r\n              })()}\r\n\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1rem' }}>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Course Code (e.g., ART101)\"\r\n                  value={getEffectiveCourseData().code}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      course: { ...prevData.course, code: newValue }\r\n                    }));\r\n                    updateCourseInfo('code', newValue);\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem',\r\n                    backgroundColor: getEffectiveCourseData().code && !gradingData.course?.code ? '#f9fafb' : 'white'\r\n                  }}\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Course Name\"\r\n                  value={getEffectiveCourseData().name}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      course: { ...prevData.course, name: newValue }\r\n                    }));\r\n                    updateCourseInfo('name', newValue);\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem',\r\n                    backgroundColor: getEffectiveCourseData().name && !gradingData.course?.name ? '#f9fafb' : 'white'\r\n                  }}\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Instructor Name\"\r\n                  value={getEffectiveCourseData().instructor}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      course: { ...prevData.course, instructor: newValue }\r\n                    }));\r\n                    updateCourseInfo('instructor', newValue);\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem',\r\n                    backgroundColor: getEffectiveCourseData().instructor && !gradingData.course?.instructor ? '#f9fafb' : 'white'\r\n                  }}\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Term (e.g., Fall 2024)\"\r\n                  value={getEffectiveCourseData().term}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      course: { ...prevData.course, term: newValue }\r\n                    }));\r\n                    updateCourseInfo('term', newValue);\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem',\r\n                    backgroundColor: getEffectiveCourseData().term && !gradingData.course?.term ? '#f9fafb' : 'white'\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Student Information */}\r\n            <div style={{ marginBottom: '2rem' }}>\r\n              <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.75rem', color: '#374151' }}>\r\n                Student Information\r\n              </h3>\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Student Name\"\r\n                  value={currentStudent?.name || gradingData.student?.name || ''}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      student: { ...prevData.student, name: newValue }\r\n                    }));\r\n                    updateStudentInfo('name', newValue);\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem',\r\n                    background: currentStudentInfo ? '#f3f4f6' : 'white'\r\n                  }}\r\n                  readOnly={!!currentStudentInfo}\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Student ID\"\r\n                  value={currentStudent?.id || gradingData.student?.id || ''}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      student: { ...prevData.student, id: newValue }\r\n                    }));\r\n                    updateStudentInfo('id', newValue);\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem',\r\n                    background: currentStudentInfo ? '#f3f4f6' : 'white'\r\n                  }}\r\n                  readOnly={!!currentStudentInfo}\r\n                />\r\n                <input\r\n                  type=\"email\"\r\n                  placeholder=\"Student Email\"\r\n                  value={currentStudent?.email || gradingData.student?.email || ''}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      student: { ...prevData.student, email: newValue }\r\n                    }));\r\n                    updateStudentInfo('email', newValue);\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem',\r\n                    background: currentStudentInfo ? '#f3f4f6' : 'white'\r\n                  }}\r\n                  readOnly={!!currentStudentInfo}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Assignment Details */}\r\n            <div style={{ marginBottom: '2rem' }}>\r\n              <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.75rem', color: '#374151' }}>\r\n                Assignment Details\r\n              </h3>\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Assignment Name\"\r\n                  value={gradingData.assignment.name}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      assignment: { ...prevData.assignment, name: newValue }\r\n                    }));\r\n                    updateAssignmentInfo({ name: newValue });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem'\r\n                  }}\r\n                />\r\n                <input\r\n                  type=\"date\"\r\n                  placeholder=\"Due Date\"\r\n                  value={gradingData.assignment.dueDate}\r\n                  onChange={(e) => {\r\n                    const newValue = e.target.value;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      assignment: { ...prevData.assignment, dueDate: newValue }\r\n                    }));\r\n                    updateAssignmentInfo({ dueDate: newValue });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem'\r\n                  }}\r\n                />\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"Max Points\"\r\n                  value={gradingData.assignment.maxPoints}\r\n                  onChange={(e) => {\r\n                    const newValue = parseInt(e.target.value) || 0;\r\n                    setGradingData(prevData => ({\r\n                      ...prevData,\r\n                      assignment: { ...prevData.assignment, maxPoints: newValue }\r\n                    }));\r\n                    updateAssignmentInfo({ maxPoints: newValue });\r\n                  }}\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '0.75rem',\r\n                    border: '1px solid #d1d5db',\r\n                    borderRadius: '0.5rem',\r\n                    fontSize: '0.875rem'\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Late Policy Section */}\r\n            <div style={{\r\n              background: 'linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)',\r\n              border: '1px solid #fed7aa',\r\n              borderRadius: '0.75rem',\r\n              padding: '1.5rem',\r\n              marginBottom: '2rem'\r\n            }}>\r\n              <h3 style={{ fontSize: '1.125rem', fontWeight: '600', marginBottom: '1rem', color: '#9a3412' }}>\r\n                📅 Late Submission Policy\r\n              </h3>\r\n              <div style={{\r\n                background: 'white',\r\n                border: '1px solid #fed7aa',\r\n                borderRadius: '0.5rem',\r\n                padding: '1rem',\r\n                marginBottom: '1.25rem'\r\n              }}>\r\n                <h4 style={{ fontWeight: '600', marginBottom: '0.5rem', color: '#9a3412' }}>\r\n                  Active Policy: {currentLatePolicy.name}\r\n                </h4>\r\n                <p style={{ fontSize: '0.875rem', color: '#7c2d12', margin: 0 }}>\r\n                  {currentLatePolicy.description}\r\n                </p>\r\n              </div>\r\n\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <h4 style={{ fontWeight: '500', marginBottom: '0.75rem', color: '#9a3412' }}>\r\n                  Select submission status:\r\n                </h4>\r\n\r\n                {Object.entries(currentLatePolicy.levels).map(([levelKey, policy]) => (\r\n                  <div\r\n                    key={levelKey}\r\n                    onClick={() => updateLatePolicy(levelKey)}\r\n                    style={{\r\n                      background: 'white',\r\n                      border: `2px solid ${gradingData.latePolicy.level === levelKey ? policy.color : '#d1d5db'}`,\r\n                      borderRadius: '0.75rem',\r\n                      padding: '1rem',\r\n                      marginBottom: '0.75rem',\r\n                      cursor: 'pointer',\r\n                      transition: 'all 0.3s ease',\r\n                      transform: gradingData.latePolicy.level === levelKey ? 'translateY(-2px)' : 'none',\r\n                      boxShadow: gradingData.latePolicy.level === levelKey ? '0 8px 25px rgba(0, 0, 0, 0.15)' : '0 1px 3px rgba(0, 0, 0, 0.1)',\r\n                      backgroundColor: gradingData.latePolicy.level === levelKey ? `linear-gradient(135deg, ${policy.color}15 0%, ${policy.color}25 100%)` : 'white'\r\n                    }}\r\n                  >\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.75rem' }}>\r\n                      <div style={{\r\n                        width: '16px',\r\n                        height: '16px',\r\n                        borderRadius: '50%',\r\n                        backgroundColor: policy.color,\r\n                        flexShrink: 0\r\n                      }}></div>\r\n                      <h5 style={{\r\n                        fontWeight: '600',\r\n                        fontSize: '1.1rem',\r\n                        margin: 0,\r\n                        flex: 1,\r\n                        color: policy.color\r\n                      }}>\r\n                        {policy.name}\r\n                      </h5>\r\n                      {levelKey !== 'none' && (\r\n                        <span style={{\r\n                          fontSize: '0.9rem',\r\n                          opacity: 0.8,\r\n                          fontWeight: '500',\r\n                          color: policy.color\r\n                        }}>\r\n                          (×{policy.multiplier === 0 ? '0' : policy.multiplier})\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    <p style={{\r\n                      fontSize: '0.9rem',\r\n                      lineHeight: 1.5,\r\n                      margin: 0,\r\n                      color: '#6b7280'\r\n                    }}>\r\n                      {policy.description}\r\n                    </p>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {scoreSummary.penaltyApplied && (\r\n                <div style={{\r\n                  background: '#fef2f2',\r\n                  border: '1px solid #fecaca',\r\n                  borderRadius: '0.5rem',\r\n                  padding: '1rem'\r\n                }}>\r\n                  <h5 style={{ fontWeight: '500', color: '#991b1b', marginBottom: '0.5rem' }}>\r\n                    ⚠️ Late Penalty Calculation\r\n                  </h5>\r\n                  <div style={{ fontSize: '0.875rem', color: '#7f1d1d' }}>\r\n                    <p style={{ marginBottom: '0.25rem' }}>\r\n                      <strong>Raw Score:</strong> {Math.round(scoreSummary.rawScore * 10) / 10} / {loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints}\r\n                    </p>\r\n                    <p style={{ marginBottom: '0.25rem' }}>\r\n                      <strong>Late Penalty:</strong> ×{getSafeLatePolicy(gradingData.latePolicy?.level).multiplier}\r\n                    </p>\r\n                    <p style={{ margin: 0 }}>\r\n                      <strong>Final Score:</strong> {Math.round(scoreSummary.finalScore * 10) / 10} / {loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Score Summary */}\r\n            <div style={{\r\n              textAlign: 'center',\r\n              background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\r\n              border: '1px solid #bbf7d0',\r\n              borderRadius: '0.75rem',\r\n              padding: '1.5rem',\r\n              marginBottom: '2rem'\r\n            }}>\r\n              <h2 style={{ fontSize: '1.5rem', fontWeight: '700', color: '#15803d', marginBottom: '1rem' }}>\r\n                📊 Final Score\r\n              </h2>\r\n              <div style={{ fontSize: '3rem', fontWeight: '700', color: '#16a34a', marginBottom: '1rem' }}>\r\n                {Math.round(scoreSummary.finalScore * 10) / 10}\r\n                <span style={{ fontSize: '1.5rem', color: '#6b7280' }}>\r\n                  / {loadedRubric ? loadedRubric.assignmentInfo.totalPoints : gradingData.assignment.maxPoints}\r\n                </span>\r\n              </div>\r\n              <div style={{ fontSize: '1.25rem', color: '#6b7280', marginBottom: '1rem' }}>\r\n                ({Math.round((scoreSummary.finalScore / (loadedRubric ? (loadedRubric.assignmentInfo.totalPoints || 1) : (gradingData.assignment.maxPoints || 1))) * 1000) / 10}%)\r\n              </div>\r\n              <div style={{ display: 'flex', justifyContent: 'center', gap: '1rem', flexWrap: 'wrap' }}>\r\n                {loadedRubric && (\r\n                  <div style={{\r\n                    fontSize: '0.875rem',\r\n                    background: '#dcfce7',\r\n                    color: '#15803d',\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '1rem'\r\n                  }}>\r\n                    📋 Rubric Assessment Active\r\n                  </div>\r\n                )}\r\n                {scoreSummary.penaltyApplied && (\r\n                  <div style={{\r\n                    fontSize: '0.875rem',\r\n                    background: '#fee2e2',\r\n                    color: '#dc2626',\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '1rem'\r\n                  }}>\r\n                    ⏰ Late Penalty Applied\r\n                  </div>\r\n                )}\r\n                {currentStudentInfo && (\r\n                  <div style={{\r\n                    fontSize: '0.875rem',\r\n                    background: '#dbeafe',\r\n                    color: '#2563eb',\r\n                    padding: '0.25rem 0.75rem',\r\n                    borderRadius: '1rem'\r\n                  }}>\r\n                    👥 Batch Session Active\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Save Draft Section */}\r\n            {currentStudentInfo && (\r\n              <div style={{\r\n                background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\r\n                border: '1px solid #f59e0b',\r\n                borderRadius: '0.75rem',\r\n                padding: '1.5rem',\r\n                marginBottom: '2rem',\r\n                textAlign: 'center'\r\n              }}>\r\n                <h3 style={{ fontSize: '1.125rem', fontWeight: '600', color: '#92400e', marginBottom: '0.75rem' }}>\r\n                  💾 Save Your Progress\r\n                </h3>\r\n                <p style={{ color: '#a16207', marginBottom: '1.5rem', fontSize: '0.875rem' }}>\r\n                  Save your current grading progress as a draft. You can return to complete it later.\r\n                </p>\r\n                <button\r\n                  onClick={() => {\r\n                    if (currentStudent?.id) {\r\n                      saveDraft(currentStudent.id, localGradingData);\r\n                      // Show success feedback\r\n                      const button = document.activeElement;\r\n                      const originalText = button.innerHTML;\r\n                      const originalBg = button.style.background;\r\n                      button.innerHTML = '<span style=\"display: flex; align-items: center; gap: 0.5rem;\"><svg width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\"><path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/></svg>Draft Saved!</span>';\r\n                      button.style.background = 'linear-gradient(135deg, #059669 0%, #047857 100%)';\r\n                      setTimeout(() => {\r\n                        button.innerHTML = originalText;\r\n                        button.style.background = originalBg;\r\n                      }, 2000);\r\n                    }\r\n                  }}\r\n                  disabled={!currentStudent?.id}\r\n                  style={{\r\n                    display: 'inline-flex',\r\n                    alignItems: 'center',\r\n                    gap: '0.75rem',\r\n                    background: currentStudent?.id ? 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)' : '#9ca3af',\r\n                    color: 'white',\r\n                    padding: '1rem 2rem',\r\n                    borderRadius: '0.75rem',\r\n                    border: 'none',\r\n                    cursor: currentStudent?.id ? 'pointer' : 'not-allowed',\r\n                    fontSize: '1rem',\r\n                    fontWeight: '600',\r\n                    boxShadow: currentStudent?.id ? '0 4px 12px rgba(245, 158, 11, 0.4)' : 'none',\r\n                    transform: 'translateY(0)',\r\n                    transition: 'all 0.2s ease'\r\n                  }}\r\n                  onMouseOver={(e) => {\r\n                    if (currentStudent?.id) {\r\n                      e.currentTarget.style.transform = 'translateY(-2px)';\r\n                      e.currentTarget.style.boxShadow = '0 8px 20px rgba(245, 158, 11, 0.5)';\r\n                    }\r\n                  }}\r\n                  onMouseOut={(e) => {\r\n                    if (currentStudent?.id) {\r\n                      e.currentTarget.style.transform = 'translateY(0)';\r\n                      e.currentTarget.style.boxShadow = '0 4px 12px rgba(245, 158, 11, 0.4)';\r\n                    }\r\n                  }}\r\n                  title={currentStudent?.id ? 'Save current grading progress' : 'No student selected to save'}\r\n                >\r\n                  <Save size={20} />\r\n                  Save Draft\r\n                </button>\r\n                {!currentStudent?.id && (\r\n                  <p style={{ marginTop: '0.75rem', fontSize: '0.75rem', color: '#6b7280' }}>\r\n                    Select a student from the Class Manager to enable draft saving\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Loaded Rubric Section */}\r\n            {loadedRubric && (\r\n              <div style={{\r\n                background: 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)',\r\n                border: '1px solid #bbf7d0',\r\n                borderRadius: '0.75rem',\r\n                padding: '1.5rem',\r\n                marginBottom: '2rem'\r\n              }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n                  <div>\r\n                    <h3 style={{ fontSize: '1.25rem', fontWeight: '700', color: '#15803d', marginBottom: '0.5rem' }}>\r\n                      📋 Active Assignment Rubric\r\n                    </h3>\r\n                    <p style={{ color: '#16a34a', fontWeight: '600', fontSize: '1.1rem' }}>\r\n                      {loadedRubric.assignmentInfo.title}\r\n                    </p>\r\n                    <p style={{ fontSize: '0.875rem', color: '#059669' }}>\r\n                      {renderFormattedContent(loadedRubric.assignmentInfo.description)}\r\n                    </p>\r\n                  </div>\r\n                  <div style={{ textAlign: 'right' }}>\r\n                    <div style={{ fontSize: '0.875rem', color: '#059669' }}>\r\n                      <p style={{ margin: '0.25rem 0' }}>\r\n                        <strong>Weight:</strong> {loadedRubric.assignmentInfo.weight}% of Final Grade\r\n                      </p>\r\n                      <p style={{ margin: '0.25rem 0' }}>\r\n                        <strong>Passing:</strong> {loadedRubric.assignmentInfo.passingThreshold}%\r\n                      </p>\r\n                      <p style={{ margin: '0.25rem 0' }}>\r\n                        <strong>Total Points:</strong> {loadedRubric.assignmentInfo.totalPoints}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Rubric Grading Interface */}\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '1.5rem' }}>\r\n                  {/* ✅ FIX: Safely map over criteria only if it exists */}\r\n                  {loadedRubric.criteria && loadedRubric.criteria.map((criterion) => {\r\n                    const currentGrading = gradingData.rubricGrading && gradingData.rubricGrading[criterion.id];\r\n                    const showComments = showRubricComments[criterion.id];\r\n\r\n                    return (\r\n                      <div key={criterion.id} style={{\r\n                        background: 'white',\r\n                        border: '1px solid #d1d5db',\r\n                        borderRadius: '0.5rem',\r\n                        padding: '1.25rem',\r\n                        boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)'\r\n                      }}>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>\r\n                          <div style={{ flex: 1 }}>\r\n                            <h4 style={{ fontSize: '1.125rem', fontWeight: '600', color: '#374151' }}>\r\n                              {criterion.name}\r\n                              <span style={{ color: '#3b82f6', marginLeft: '0.5rem' }}>\r\n                                ({criterion.maxPoints} pts)\r\n                              </span>\r\n                            </h4>\r\n                            <p style={{ fontSize: '0.875rem', color: '#6b7280', marginTop: '0.25rem' }}>\r\n                              {renderFormattedContent(criterion.description)}\r\n                            </p>\r\n                          </div>\r\n                          <button\r\n                            onClick={() => toggleRubricComments(criterion.id)}\r\n                            style={{\r\n                              color: '#3b82f6',\r\n                              background: 'none',\r\n                              border: 'none',\r\n                              fontSize: '0.875rem',\r\n                              textDecoration: 'underline',\r\n                              cursor: 'pointer',\r\n                              marginLeft: '1rem'\r\n                            }}\r\n                          >\r\n                            {showComments ? 'Hide' : 'Show'} Level Details\r\n                          </button>\r\n                        </div>\r\n\r\n                        {/* Level Selection */}\r\n                        <div style={{\r\n                          display: 'grid',\r\n                          gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\r\n                          gap: '0.5rem',\r\n                          marginBottom: '1rem'\r\n                        }}>\r\n                          {loadedRubric.rubricLevels.map((level) => {\r\n                            const isSelected = currentGrading?.selectedLevel === level.level;\r\n                            const points = Math.round(criterion.maxPoints * level.multiplier);\r\n\r\n                            return (\r\n                              <button\r\n                                key={level.level}\r\n                                onClick={() => updateRubricGrading(criterion.id, level.level)}\r\n                                style={{\r\n                                  padding: '0.75rem',\r\n                                  borderRadius: '0.5rem',\r\n                                  border: `2px solid ${isSelected ? level.color : '#d1d5db'}`,\r\n                                  fontSize: '0.875rem',\r\n                                  fontWeight: '500',\r\n                                  cursor: 'pointer',\r\n                                  transition: 'all 0.2s ease',\r\n                                  backgroundColor: isSelected ? level.color : 'white',\r\n                                  color: isSelected ? 'white' : '#374151',\r\n                                  transform: isSelected ? 'scale(1.05)' : 'none',\r\n                                  textAlign: 'center'\r\n                                }}\r\n                              >\r\n                                <div style={{ fontWeight: '600' }}>{level.name}</div>\r\n                                <div style={{ fontSize: '0.75rem', marginTop: '0.25rem' }}>\r\n                                  {level.level === 'incomplete' ? '0' : points} pts\r\n                                </div>\r\n                              </button>\r\n                            );\r\n                          })}\r\n                        </div>\r\n\r\n                        {/* Level Descriptions */}\r\n                        {showComments && (\r\n                          <div style={{\r\n                            background: '#f9fafb',\r\n                            borderRadius: '0.5rem',\r\n                            padding: '1rem',\r\n                            marginBottom: '1rem'\r\n                          }}>\r\n                            <h5 style={{ fontWeight: '600', color: '#374151', marginBottom: '0.75rem' }}>\r\n                              Level Descriptions:\r\n                            </h5>\r\n                            <div style={{\r\n                              display: 'grid',\r\n                              gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\r\n                              gap: '0.75rem'\r\n                            }}>\r\n                              {loadedRubric.rubricLevels.map((level) => (\r\n                                <div\r\n                                  key={level.level}\r\n                                  style={{\r\n                                    background: 'white',\r\n                                    borderRadius: '0.25rem',\r\n                                    border: '1px solid #d1d5db',\r\n                                    borderLeft: `4px solid ${level.color}`,\r\n                                    padding: '0.75rem'\r\n                                  }}\r\n                                >\r\n                                  <div style={{ fontWeight: '500', fontSize: '0.875rem', color: level.color }}>\r\n                                    {level.name}\r\n                                  </div>\r\n                                  <div style={{ fontSize: '0.75rem', color: '#6b7280', marginBottom: '0.5rem' }}>\r\n                                    {criterion.levels[level.level]?.pointRange} pts\r\n                                  </div>\r\n                                  <div style={{ fontSize: '0.75rem', color: '#374151' }}>\r\n                                    {renderFormattedContent(criterion.levels[level.level]?.description)}\r\n                                  </div>\r\n                                </div>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Custom Comments */}\r\n                        <div>\r\n                          <label style={{\r\n                            display: 'block',\r\n                            fontSize: '0.875rem',\r\n                            fontWeight: '500',\r\n                            color: '#374151',\r\n                            marginBottom: '0.5rem'\r\n                          }}>\r\n                            Additional Comments:\r\n                          </label>\r\n\r\n                          {/* Quick Feedback Dropdowns */}\r\n                          {criterion.feedbackLibrary && (\r\n                            <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.75rem', flexWrap: 'wrap' }}>\r\n                              {Object.entries(criterion.feedbackLibrary).map(([category, comments]) => (\r\n                                <select\r\n                                  key={category}\r\n                                  onChange={(e) => {\r\n                                    if (e.target.value) {\r\n                                      addCriterionFeedback(criterion.id, e.target.value);\r\n                                      e.target.value = '';\r\n                                    }\r\n                                  }}\r\n                                  defaultValue=\"\"\r\n                                  style={{\r\n                                    padding: '0.5rem',\r\n                                    border: '1px solid #d1d5db',\r\n                                    borderRadius: '0.25rem',\r\n                                    fontSize: '0.75rem',\r\n                                    cursor: 'pointer'\r\n                                  }}\r\n                                >\r\n                                  <option value=\"\">Add {category}...</option>\r\n                                  {comments.map((comment, idx) => (\r\n                                    <option key={idx} value={comment}>{renderFormattedContent(comment)}</option>\r\n                                  ))}\r\n                                </select>\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n\r\n                          <textarea\r\n                            value={currentGrading?.customComments || ''}\r\n                            onChange={(e) => updateRubricGrading(criterion.id, currentGrading?.selectedLevel, e.target.value)}\r\n                            style={{\r\n                              width: '100%',\r\n                              padding: '0.75rem',\r\n                              border: '1px solid #d1d5db',\r\n                              borderRadius: '0.5rem',\r\n                              fontSize: '0.875rem',\r\n                              resize: 'none',\r\n                              minHeight: '80px'\r\n                            }}\r\n                            rows=\"3\"\r\n                            placeholder=\"Add specific feedback for this criterion...\"\r\n                          />\r\n                        </div>\r\n\r\n                        {/* Selected Level Feedback */}\r\n                        {currentGrading?.selectedLevel && (\r\n                          <div style={{\r\n                            marginTop: '0.75rem',\r\n                            padding: '0.75rem',\r\n                            background: '#eff6ff',\r\n                            borderRadius: '0.25rem',\r\n                            border: '1px solid #bfdbfe'\r\n                          }}>\r\n                            <div style={{ fontSize: '0.875rem' }}>\r\n                              <strong>Selected Level:</strong> {loadedRubric.rubricLevels.find(l => l.level === currentGrading.selectedLevel)?.name}\r\n                              {' '}({criterion.levels[currentGrading.selectedLevel]?.pointRange} pts)\r\n                            </div>\r\n                            <div style={{ fontSize: '0.875rem', color: '#374151', marginTop: '0.25rem' }}>\r\n                              {renderFormattedContent(criterion.levels[currentGrading.selectedLevel]?.description)}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* ... rest of the original UI JSX */}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GradingTemplate;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAC1D,SACEC,QAAQ,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,IAAI,EAAEC,CAAC,EAAEC,IAAI,EAAEC,QAAQ,EAAEC,GAAG,EAC/DC,WAAW,EAAEC,SAAS,EAAEC,SAAS,EAAEC,UAAU,EAAEC,KAAK,EAAEC,UAAU,EAChEC,WAAW,EAAEC,KAAK,EAAEC,WAAW,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,SAAS,EAAEC,aAAa,QACrE,cAAc;AACrB,SAASC,aAAa,EAAEC,mBAAmB,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAErE,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAAA,IAAAC,mBAAA,EAAAC,oBAAA,EAAAC,oBAAA,EAAAC,oBAAA,EAAAC,oBAAA,EAAAC,oBAAA,EAAAC,qBAAA,EAAAC,qBAAA,EAAAC,sBAAA;EAC5B;EACA,MAAM;IACJC,YAAY;IACZC,mBAAmB;IACnBC,sBAAsB;IACtBC,WAAW,EAAEC,iBAAiB;IAC9BC,cAAc,EAAEC,oBAAoB;IACpCC,iBAAiB;IACjBC,gBAAgB;IAChBC,oBAAoB;IACpBC,oBAAoB;IACpBC,SAAS;IACTC,YAAY;IACZC,iBAAiB;IACjBC,cAAc;IACdC,iBAAiB;IACjBC,oBAAoB;IACpBC,wBAAwB;IACxBC,oBAAoB;IACpBC,wBAAwB;IACxBC,YAAY;IACZC,cAAc;IACdC,SAAS;IACTC,SAAS;IACTC,cAAc;IACdC,cAAc;IACdC,WAAW;IACXC,cAAc;IACdC,iBAAiB;IACjBC;EACF,CAAC,GAAG9C,aAAa,CAAC,CAAC;;EAEnB;EACA,MAAM+C,sBAAsB,GAAIC,WAAW,IAAK;IAC9C,IAAI,CAACA,WAAW,EAAE,OAAO,EAAE;IAC3B,IAAIC,WAAW,GAAGD,WAAW,CAC1BE,OAAO,CAAC,cAAc,EAAE,IAAI,CAAC,CAC7BA,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,CACxBA,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CACzBA,OAAO,CAAC,gCAAgC,EAAE,QAAQ,CAAC,CACnDA,OAAO,CAAC,sBAAsB,EAAE,QAAQ,CAAC,CACzCA,OAAO,CAAC,wBAAwB,EAAE,MAAM,CAAC,CACzCA,OAAO,CAAC,sBAAsB,EAAE,MAAM,CAAC,CACvCA,OAAO,CAAC,sBAAsB,EAAE,MAAM,CAAC,CACvCA,OAAO,CAAC,wBAAwB,EAAE,UAAU,CAAC,CAC7CA,OAAO,CAAC,wBAAwB,EAAE,QAAQ,CAAC,CAC3CA,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,CACzBA,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAC1BA,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,CACzBA,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAC1BA,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CACvBA,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,CACzBC,IAAI,CAAC,CAAC;IACT,OAAOF,WAAW;EACpB,CAAC;;EAED;EACA,MAAM,CAACG,gBAAgB,EAAEC,mBAAmB,CAAC,GAAG9E,QAAQ,CAAC,MAAM;IAC7D,IAAI+D,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,EAAE;MACtB,MAAMC,KAAK,GAAGf,SAAS,CAACF,cAAc,CAACgB,EAAE,CAAC;MAC1C,IAAIC,KAAK,EAAE,OAAOA,KAAK;IACzB;IACA,IAAIlC,iBAAiB,EAAE;MACrB,OAAO;QACL,GAAGA,iBAAiB;QACpBmC,OAAO,EAAElB,cAAc,IAAIjB,iBAAiB,CAACmC,OAAO,IAAI;UAAEC,IAAI,EAAE,EAAE;UAAEH,EAAE,EAAE,EAAE;UAAEI,KAAK,EAAE;QAAG;MACxF,CAAC;IACH;IACA,OAAO;MACLF,OAAO,EAAElB,cAAc,IAAI;QAAEmB,IAAI,EAAE,EAAE;QAAEH,EAAE,EAAE,EAAE;QAAEI,KAAK,EAAE;MAAG,CAAC;MAC1DC,MAAM,EAAE,CAAAzC,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEyC,MAAM,KAAI;QAAEC,IAAI,EAAE,EAAE;QAAEH,IAAI,EAAE,EAAE;QAAEI,UAAU,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAG,CAAC;MACvFC,UAAU,EAAE,CAAA7C,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAE6C,UAAU,KAAI;QAAEN,IAAI,EAAE,EAAE;QAAEO,OAAO,EAAE,EAAE;QAAEC,SAAS,EAAE;MAAI,CAAC;MACxFC,QAAQ,EAAE;QAAEC,OAAO,EAAE,EAAE;QAAEC,SAAS,EAAE,EAAE;QAAEC,YAAY,EAAE;MAAG,CAAC;MAC1DC,WAAW,EAAE,EAAE;MACfC,UAAU,EAAE,EAAE;MACdC,UAAU,EAAE;QAAEC,KAAK,EAAE,MAAM;QAAEC,cAAc,EAAE;MAAM,CAAC;MACpDC,QAAQ,EAAE;QAAEC,QAAQ,EAAE,EAAE;QAAEC,UAAU,EAAE,EAAE;QAAEC,UAAU,EAAE,KAAK;QAAEC,gBAAgB,EAAE;MAAM,CAAC;MACtFC,aAAa,EAAE,CAAC;IAClB,CAAC;EACH,CAAC,CAAC;EAEF,MAAM5D,WAAW,GAAGgC,gBAAgB;EACpC,MAAM9B,cAAc,GAAG+B,mBAAmB;;EAE1C;EACA,MAAM,CAAC4B,YAAY,EAAEC,eAAe,CAAC,GAAG3G,QAAQ,CAAC,MAAM0C,YAAY,IAAI,IAAI,CAAC;EAC5E,MAAM,CAACkE,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG7G,QAAQ,CAAC,CAAC,CAAC,CAAC;EAEhE,MAAM8G,YAAY,GAAG7G,MAAM,CAAC,IAAI,CAAC;EACjC,MAAM8G,cAAc,GAAG9G,MAAM,CAAC,IAAI,CAAC;EACnC,MAAM,CAAC+G,cAAc,EAAEC,iBAAiB,CAAC,GAAGjH,QAAQ,CAAC,EAAE,CAAC;EACxD,MAAM,CAACkH,UAAU,EAAEC,aAAa,CAAC,GAAGnH,QAAQ,CAAC,EAAE,CAAC;;EAEhD;EACAE,SAAS,CAAC,MAAM;IACd,IAAIwC,YAAY,IAAIA,YAAY,KAAKgE,YAAY,EAAE;MACjDC,eAAe,CAACjE,YAAY,CAAC;IAC/B;EACF,CAAC,EAAE,CAACA,YAAY,EAAEgE,YAAY,CAAC,CAAC;EAEhCxG,SAAS,CAAC,MAAM;IACd,MAAMkH,SAAS,GAAGC,UAAU,CAAC,MAAM;MACjCrE,oBAAoB,CAACH,WAAW,CAAC;MACjCD,sBAAsB,CAAC;QACrBqC,OAAO,EAAEpC,WAAW,CAACoC,OAAO;QAC5BG,MAAM,EAAEvC,WAAW,CAACuC,MAAM;QAC1BI,UAAU,EAAE3C,WAAW,CAAC2C;MAC1B,CAAC,CAAC;IACJ,CAAC,EAAE,IAAI,CAAC;IACR,OAAO,MAAM8B,YAAY,CAACF,SAAS,CAAC;EACtC,CAAC,EAAE,CAACvE,WAAW,EAAEG,oBAAoB,EAAEJ,sBAAsB,CAAC,CAAC;EAE/D1C,SAAS,CAAC,MAAM;IACd,IAAI,EAAC6D,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,GAAE;IACzB,MAAMwC,MAAM,GAAGlD,cAAc,CAACN,cAAc,CAACgB,EAAE,CAAC;IAChD,IAAIyC,KAAK,GAAID,MAAM,KAAK,OAAO,IAAIpD,cAAc,GAAIA,cAAc,CAACJ,cAAc,CAACgB,EAAE,CAAC,GAAIwC,MAAM,KAAK,OAAO,GAAGtD,SAAS,CAACF,cAAc,CAACgB,EAAE,CAAC,GAAG,IAAK;IACnJ,IAAIyC,KAAK,EAAE;MACT1C,mBAAmB,CAAC2C,IAAI,KAAK;QAC3B,GAAGD,KAAK;QACRvC,OAAO,EAAElB,cAAc;QACvBqB,MAAM,EAAEqC,IAAI,CAACrC,MAAM;QACnBI,UAAU,EAAEiC,IAAI,CAACjC,UAAU;QAC3BY,QAAQ,EAAEqB,IAAI,CAACrB;MACjB,CAAC,CAAC,CAAC;IACL,CAAC,MAAM;MACLsB,gBAAgB,CAAC,CAAC;IACpB;EACF,CAAC,EAAE,CAAC3D,cAAc,EAAEM,cAAc,EAAEJ,SAAS,EAAEE,cAAc,CAAC,CAAC;;EAE/D;EACA,MAAMwD,aAAa,GAAIC,QAAQ,IAAK;IAClC,IAAI,CAACA,QAAQ,EAAE,OAAO,IAAI;IAC1B,IAAIA,QAAQ,KAAKlG,mBAAmB,CAACqD,EAAE,EAAE,OAAOrD,mBAAmB;IACnE,OAAO6C,kBAAkB,CAACsD,IAAI,CAACC,CAAC,IAAIA,CAAC,CAAC/C,EAAE,KAAK6C,QAAQ,CAAC,IAAI,IAAI;EAChE,CAAC;EAED,MAAMG,iBAAiB,GAAGA,CAAC7B,KAAK,EAAE0B,QAAQ,KAAK;IAC7C,MAAMI,MAAM,GAAGL,aAAa,CAACC,QAAQ,CAAC,IAAItD,iBAAiB,IAAI5C,mBAAmB;IAClF,MAAMuG,YAAY,GAAGD,MAAM,CAACE,MAAM,IAAIxG,mBAAmB,CAACwG,MAAM;IAChE,IAAI,CAAChC,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,CAAC+B,YAAY,CAAC/B,KAAK,CAAC,EAAE;MAC/D,OAAO+B,YAAY,CAACE,IAAI;IAC1B;IACA,OAAOF,YAAY,CAAC/B,KAAK,CAAC;EAC5B,CAAC;;EAGD;EACA,MAAMkC,mBAAmB,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA,EAAAC,sBAAA;IAChC,IAAIC,QAAQ,GAAG,CAAC;IAChB;IACA,IAAI7B,YAAY,IAAIA,YAAY,CAAC8B,QAAQ,IAAI3F,WAAW,CAAC4D,aAAa,EAAE;MACtE8B,QAAQ,GAAGE,MAAM,CAACC,MAAM,CAAC7F,WAAW,CAAC4D,aAAa,CAAC,CAACkC,MAAM,CAAC,CAACC,KAAK,EAAEC,OAAO,KAAK;QAC7E,MAAMC,SAAS,GAAGpC,YAAY,CAAC8B,QAAQ,CAACX,IAAI,CAACkB,CAAC,IAAIA,CAAC,CAAChE,EAAE,KAAK8D,OAAO,CAACG,WAAW,CAAC;QAC/E,IAAIF,SAAS,IAAID,OAAO,CAACI,aAAa,EAAE;UACtC,MAAM/C,KAAK,GAAGQ,YAAY,CAACwC,YAAY,CAACrB,IAAI,CAACsB,CAAC,IAAIA,CAAC,CAACjD,KAAK,KAAK2C,OAAO,CAACI,aAAa,CAAC;UACpF,IAAI/C,KAAK,EAAE;YACT,OAAO0C,KAAK,GAAIE,SAAS,CAACpD,SAAS,GAAGQ,KAAK,CAACkD,UAAW;UACzD;QACF;QACA,OAAOR,KAAK;MACd,CAAC,EAAE,CAAC,CAAC;IACP;IACA,MAAMhB,QAAQ,IAAAS,qBAAA,GAAGxF,WAAW,CAACoD,UAAU,cAAAoC,qBAAA,uBAAtBA,qBAAA,CAAwBT,QAAQ;IACjD,MAAMyB,eAAe,GAAGtB,iBAAiB,EAAAO,sBAAA,GAACzF,WAAW,CAACoD,UAAU,cAAAqC,sBAAA,uBAAtBA,sBAAA,CAAwBpC,KAAK,EAAE0B,QAAQ,CAAC;IAElF,MAAM0B,UAAU,GAAGf,QAAQ,GAAGc,eAAe,CAACD,UAAU;IACxD,OAAO;MACLb,QAAQ;MACRe,UAAU;MACVnD,cAAc,EAAEtD,WAAW,CAACoD,UAAU,CAACC,KAAK,KAAK,MAAM;MACvDqD,qBAAqB,EAAEF,eAAe,CAACG;IACzC,CAAC;EACH,CAAC;EAED,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAG1J,QAAQ,CAACoI,mBAAmB,CAAC,CAAC,CAAC;EAEvElI,SAAS,CAAC,MAAM;IACdwJ,eAAe,CAACtB,mBAAmB,CAAC,CAAC,CAAC;EACxC,CAAC,EAAE,CAACvF,WAAW,CAAC4D,aAAa,EAAE5D,WAAW,CAACoD,UAAU,EAAE3B,iBAAiB,EAAEC,kBAAkB,EAAEmC,YAAY,CAAC,CAAC;;EAE5G;EACA,MAAMiD,mBAAmB,GAAGA,CAACX,WAAW,EAAE9C,KAAK,EAAE0D,QAAQ,GAAG,IAAI,KAAK;IACnE9E,mBAAmB,CAAC+E,QAAQ;MAAA,IAAAC,qBAAA;MAAA,OAAK;QAC/B,GAAGD,QAAQ;QACXpD,aAAa,EAAE;UACb,GAAGoD,QAAQ,CAACpD,aAAa;UACzB,CAACuC,WAAW,GAAG;YACbA,WAAW;YACXC,aAAa,EAAE/C,KAAK;YACpB6D,cAAc,EAAEH,QAAQ,KAAK,IAAI,GAAGA,QAAQ,GAAI,EAAAE,qBAAA,GAAAD,QAAQ,CAACpD,aAAa,CAACuC,WAAW,CAAC,cAAAc,qBAAA,uBAAnCA,qBAAA,CAAqCC,cAAc,KAAI;UACzG;QACF;MACF,CAAC;IAAA,CAAC,CAAC;EACL,CAAC;EAED,MAAMC,oBAAoB,GAAGA,CAAChB,WAAW,EAAEiB,OAAO,KAAK;IACrDnF,mBAAmB,CAAC+E,QAAQ,IAAI;MAC9B,MAAMK,cAAc,GAAGL,QAAQ,CAACpD,aAAa,CAACuC,WAAW,CAAC;MAC1D,MAAMmB,eAAe,GAAG,CAAAD,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEH,cAAc,KAAI,EAAE;MAC5D,MAAMK,WAAW,GAAGD,eAAe,GAAG,GAAGA,eAAe,OAAOF,OAAO,EAAE,GAAG,KAAKA,OAAO,EAAE;MACzF,MAAMI,cAAc,GAAG;QACrB,GAAGR,QAAQ,CAACpD,aAAa;QACzB,CAACuC,WAAW,GAAG;UACb,GAAGkB,cAAc;UACjBlB,WAAW;UACXC,aAAa,EAAE,CAAAiB,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEjB,aAAa,KAAI,IAAI;UACpDc,cAAc,EAAEK;QAClB;MACF,CAAC;MACD,OAAO;QACL,GAAGP,QAAQ;QACXpD,aAAa,EAAE4D;MACjB,CAAC;IACH,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMC,YAAY,GAAGA,CAAA,KAAM;IACzB,IAAItD,cAAc,CAACpC,IAAI,CAAC,CAAC,EAAE;MACzB7B,cAAc,CAAC8G,QAAQ,KAAK;QAC1B,GAAGA,QAAQ;QACX7D,UAAU,EAAE,CAAC,GAAG6D,QAAQ,CAAC7D,UAAU,EAAE;UACnCjB,EAAE,EAAEwF,IAAI,CAACC,GAAG,CAAC,CAAC;UACdC,GAAG,EAAEzD,cAAc,CAACpC,IAAI,CAAC,CAAC;UAC1B8F,KAAK,EAAExD,UAAU,CAACtC,IAAI,CAAC,CAAC,IAAI;QAC9B,CAAC;MACH,CAAC,CAAC,CAAC;MACHqC,iBAAiB,CAAC,EAAE,CAAC;MACrBE,aAAa,CAAC,EAAE,CAAC;IACnB;EACF,CAAC;EAED,MAAMwD,eAAe,GAAI5F,EAAE,IAAK;IAC9BhC,cAAc,CAAC8G,QAAQ,KAAK;MAC1B,GAAGA,QAAQ;MACX7D,UAAU,EAAE6D,QAAQ,CAAC7D,UAAU,CAAC4E,MAAM,CAACC,IAAI,IAAIA,IAAI,CAAC9F,EAAE,KAAKA,EAAE;IAC/D,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAM+F,gBAAgB,GAAIC,KAAK,IAAK;IAClC,MAAMC,cAAc,GAAGC,KAAK,CAACC,IAAI,CAACH,KAAK,CAAC,CAACI,GAAG,CAACC,IAAI,KAAK;MACpDrG,EAAE,EAAEwF,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGa,IAAI,CAACC,MAAM,CAAC,CAAC;MAC9BpG,IAAI,EAAEkG,IAAI,CAAClG,IAAI;MACfqG,IAAI,EAAEH,IAAI,CAACG,IAAI;MACfC,IAAI,EAAEJ,IAAI,CAACI,IAAI;MACfJ,IAAI,EAAEA;IACR,CAAC,CAAC,CAAC;IAEHK,OAAO,CAACC,GAAG,CAACV,cAAc,CAACG,GAAG,CAACQ,UAAU,IAAI;MAC3C,OAAO,IAAIF,OAAO,CAAEG,OAAO,IAAK;QAC9B,IAAID,UAAU,CAACH,IAAI,CAACK,UAAU,CAAC,QAAQ,CAAC,EAAE;UACxC,MAAMC,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;UAC/BD,MAAM,CAACE,MAAM,GAAIC,CAAC,IAAK;YACrBN,UAAU,CAACO,UAAU,GAAGD,CAAC,CAACE,MAAM,CAACC,MAAM;YACvCR,OAAO,CAACD,UAAU,CAAC;UACrB,CAAC;UACDG,MAAM,CAACO,aAAa,CAACV,UAAU,CAACP,IAAI,CAAC;QACvC,CAAC,MAAM;UACLQ,OAAO,CAACD,UAAU,CAAC;QACrB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC,CAACW,IAAI,CAACC,oBAAoB,IAAI;MAC/BxJ,cAAc,CAAC8G,QAAQ,KAAK;QAC1B,GAAGA,QAAQ;QACX9D,WAAW,EAAE,CAAC,GAAG8D,QAAQ,CAAC9D,WAAW,EAAE,GAAGwG,oBAAoB;MAChE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC;EACJ,CAAC;EAED,MAAMC,gBAAgB,GAAIzH,EAAE,IAAK;IAC/BhC,cAAc,CAAC8G,QAAQ,KAAK;MAC1B,GAAGA,QAAQ;MACX9D,WAAW,EAAE8D,QAAQ,CAAC9D,WAAW,CAAC6E,MAAM,CAAC6B,GAAG,IAAIA,GAAG,CAAC1H,EAAE,KAAKA,EAAE;IAC/D,CAAC,CAAC,CAAC;EACL,CAAC;;EAED;EACA,MAAM2H,kBAAkB,GAAIC,KAAK,IAAK;IACpC,MAAMvB,IAAI,GAAGuB,KAAK,CAACR,MAAM,CAACpB,KAAK,CAAC,CAAC,CAAC;IAClC,IAAI,CAACK,IAAI,EAAE;IAEX,MAAMU,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,MAAM,GAAIC,CAAC,IAAK;MACrB,IAAI;QACF,MAAMW,UAAU,GAAGC,IAAI,CAACC,KAAK,CAACb,CAAC,CAACE,MAAM,CAACC,MAAM,CAAC;QAC9C,IAAI,CAACQ,UAAU,CAACG,cAAc,IAAI,CAACH,UAAU,CAACpE,QAAQ,IAAI,CAACoE,UAAU,CAAC1D,YAAY,EAAE;UAClF8D,KAAK,CAAC,wBAAwB,CAAC;UAC/B;QACF;QACArG,eAAe,CAACiG,UAAU,CAAC;QAC3BI,KAAK,CAAC,WAAWJ,UAAU,CAACG,cAAc,CAACrC,KAAK,wBAAwB,CAAC;QACzE3H,cAAc,CAAC8G,QAAQ,KAAK;UAAE,GAAGA,QAAQ;UAAEpD,aAAa,EAAE,CAAC;QAAE,CAAC,CAAC,CAAC;MAClE,CAAC,CAAC,OAAOwG,KAAK,EAAE;QACdD,KAAK,CAAC,2CAA2C,CAAC;MACpD;IACF,CAAC;IACDlB,MAAM,CAACoB,UAAU,CAAC9B,IAAI,CAAC;EACzB,CAAC;;EAED;EACA;;EAEA,MAAM1D,gBAAgB,GAAGA,CAAA,KAAM;IAC7B,MAAMyF,oBAAoB,GAAG,CAAC,CAAC;IAC/B,IAAIzG,YAAY,IAAIA,YAAY,CAAC8B,QAAQ,EAAE;MAAE;MAC3C9B,YAAY,CAAC8B,QAAQ,CAAC4E,OAAO,CAACtE,SAAS,IAAI;QACzCqE,oBAAoB,CAACrE,SAAS,CAAC/D,EAAE,CAAC,GAAG;UACnCiE,WAAW,EAAEF,SAAS,CAAC/D,EAAE;UACzBkE,aAAa,EAAE,IAAI;UACnBc,cAAc,EAAE;QAClB,CAAC;MACH,CAAC,CAAC;IACJ;IACAjF,mBAAmB,CAAC2C,IAAI;MAAA,IAAA4F,qBAAA,EAAAC,sBAAA;MAAA,OAAK;QAC3B,GAAG7F,IAAI;QACPrC,MAAM,GAAAiI,qBAAA,GAAE1K,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEyC,MAAM,cAAAiI,qBAAA,cAAAA,qBAAA,GAAI5F,IAAI,CAACrC,MAAM;QAClDI,UAAU,GAAA8H,sBAAA,GAAE3K,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAE6C,UAAU,cAAA8H,sBAAA,cAAAA,sBAAA,GAAI7F,IAAI,CAACjC,UAAU;QAC9DG,QAAQ,EAAE;UAAEC,OAAO,EAAE,EAAE;UAAEC,SAAS,EAAE,EAAE;UAAEC,YAAY,EAAE;QAAG,CAAC;QAC1DC,WAAW,EAAE,EAAE;QACfC,UAAU,EAAE,EAAE;QACdC,UAAU,EAAE;UAAEC,KAAK,EAAE,MAAM;UAAEC,cAAc,EAAE;QAAM,CAAC;QACpDM,aAAa,EAAE0G;MACjB,CAAC;IAAA,CAAC,CAAC;EACL,CAAC;EAED,MAAMI,iBAAiB,GAAGA,CAAA,KAAM;IAC9BC,wBAAwB,CAAC,CAAC;EAC5B,CAAC;EAED,MAAMA,wBAAwB,GAAGA,CAAA,KAAM;IACrC,IAAIzJ,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,EAAE;MACtBf,SAAS,CAACD,cAAc,CAACgB,EAAE,EAAEF,gBAAgB,CAAC;IAChD;IACA,MAAM4I,OAAO,GAAG/J,oBAAoB,CAAC,OAAO,CAAC;IAC7C,IAAI,CAAC+J,OAAO,EAAE;MACZT,KAAK,CAAC,4BAA4B,CAAC;MACnClJ,YAAY,CAAC,eAAe,CAAC;IAC/B,CAAC,MAAM;MACL4D,gBAAgB,CAAC,CAAC;MAClBgG,MAAM,CAACC,QAAQ,CAAC;QAAEC,GAAG,EAAE,CAAC;QAAEC,QAAQ,EAAE;MAAS,CAAC,CAAC;IACjD;EACF,CAAC;EAED,MAAMC,wBAAwB,GAAGA,CAAA,KAAM;IACrC,IAAI/J,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,EAAE;MACtBb,cAAc,CAACH,cAAc,CAACgB,EAAE,EAAEF,gBAAgB,CAAC;IACrD;IACA,MAAM4I,OAAO,GAAG/J,oBAAoB,CAAC,OAAO,CAAC;IAC7C,IAAI,CAAC+J,OAAO,EAAE;MACZT,KAAK,CAAC,4BAA4B,CAAC;MACnClJ,YAAY,CAAC,eAAe,CAAC;IAC/B,CAAC,MAAM;MACL4D,gBAAgB,CAAC,CAAC;MAClBgG,MAAM,CAACC,QAAQ,CAAC;QAAEC,GAAG,EAAE,CAAC;QAAEC,QAAQ,EAAE;MAAS,CAAC,CAAC;IACjD;EACF,CAAC;EAED,MAAME,qBAAqB,GAAGA,CAAA,KAAM;IAClC,IAAIhK,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,EAAE;MACtBf,SAAS,CAACD,cAAc,CAACgB,EAAE,EAAEF,gBAAgB,CAAC;IAChD;IACAlB,wBAAwB,CAAC,CAAC;EAC5B,CAAC;EAED,MAAMqK,qBAAqB,GAAGA,CAAA,KAAM;IAClC,IAAI,CAAC3K,SAAS,IAAI,EAACG,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEyK,MAAM,KAAI,CAACzK,cAAc,CAACO,cAAc,EAAE;MAC3E,OAAO,IAAI;IACb;IACA,MAAMmK,YAAY,GAAG1K,cAAc,CAAC2K,mBAAmB;IACvD,MAAMC,aAAa,GAAG/K,SAAS,CAACgL,QAAQ,CAACC,MAAM;IAC/C,MAAMrJ,OAAO,GAAGzB,cAAc,CAACO,cAAc;IAC7C,OAAO;MACLkB,OAAO;MACPsJ,QAAQ,EAAEL,YAAY,GAAG,CAAC;MAC1BtF,KAAK,EAAEwF,aAAa;MACpBI,OAAO,EAAEN,YAAY,KAAK,CAAC;MAC3BO,MAAM,EAAEP,YAAY,KAAKE,aAAa,GAAG;IAC3C,CAAC;EACH,CAAC;EAED,MAAMM,kBAAkB,GAAGV,qBAAqB,CAAC,CAAC;;EAElD;EACA,MAAMW,yBAAyB,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA,EAAAC,mBAAA,EAAAC,qBAAA,EAAAC,oBAAA,EAAAC,qBAAA,EAAAC,oBAAA,EAAAC,qBAAA,EAAAC,oBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA;IACtC,MAAMC,UAAU,GAAG9F,YAAY,CAACH,UAAU;IAC1C,MAAMf,QAAQ,GAAGkB,YAAY,CAAClB,QAAQ;IACtC,MAAM7C,SAAS,GAAGgB,YAAY,GAAGA,YAAY,CAACqG,cAAc,CAACyC,WAAW,GAAG3M,WAAW,CAAC2C,UAAU,CAACE,SAAS;IAC3G,MAAM+J,UAAU,GAAG,CAAEF,UAAU,IAAI7J,SAAS,IAAI,CAAC,CAAC,GAAI,GAAG,EAAEgK,OAAO,CAAC,CAAC,CAAC;IACrE,MAAMvJ,cAAc,GAAGsD,YAAY,CAACtD,cAAc;IAElD,MAAMwJ,eAAe,GAAG9M,WAAW,CAACkD,WAAW,CAACoF,GAAG,CAAC,CAACsB,GAAG,EAAEmD,KAAK,KAAK;MAClE,IAAInD,GAAG,CAACP,UAAU,EAAE;QAClB,OAAO,0CAA0CO,GAAG,CAACP,UAAU,UAAUO,GAAG,CAACvH,IAAI,yCAAyC0K,KAAK,wOAAwOnD,GAAG,CAACvH,IAAI,uDAAuD,CAACuH,GAAG,CAAClB,IAAI,GAAG,IAAI,EAAEmE,OAAO,CAAC,CAAC,CAAC,yGAAyG;MAC7iB,CAAC,MAAM;QACL,OAAO,8RAA8RjD,GAAG,CAACvH,IAAI,uDAAuD,CAACuH,GAAG,CAAClB,IAAI,GAAG,IAAI,EAAEmE,OAAO,CAAC,CAAC,CAAC,iBAAiB;MACnZ;IACF,CAAC,CAAC,CAACG,IAAI,CAAC,EAAE,CAAC;IAEX,MAAMC,cAAc,GAAGjN,WAAW,CAACmD,UAAU,CAACmF,GAAG,CAACN,IAAI,IAAI,gTAAgTA,IAAI,CAACH,KAAK,2BAA2BG,IAAI,CAACJ,GAAG,qHAAqHI,IAAI,CAACJ,GAAG,YAAY,CAAC,CAACoF,IAAI,CAAC,EAAE,CAAC;IAE1iB,MAAME,eAAe,GAAIrJ,YAAY,IAAIA,YAAY,CAAC8B,QAAQ,GAAI;AACtE;AACA;AACA;AACA,6CAA6C9B,YAAY,CAACqG,cAAc,CAACrC,KAAK;AAC9E,8CAA8ClG,sBAAsB,CAACkC,YAAY,CAACqG,cAAc,CAACvD,WAAW,CAAC;AAC7G,yCAAyC9C,YAAY,CAACqG,cAAc,CAACiD,MAAM;AAC3E,oDAAoDtJ,YAAY,CAACqG,cAAc,CAACkD,gBAAgB;AAChG;AACA;AACA;AACA;AACA,oBAAoBvJ,YAAY,CAAC8B,QAAQ,CAAC2C,GAAG,CAACrC,SAAS,IAAI;MACrD,MAAMD,OAAO,GAAGhG,WAAW,CAAC4D,aAAa,CAACqC,SAAS,CAAC/D,EAAE,CAAC;MACvD,MAAMmB,KAAK,GAAG2C,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEI,aAAa,GAAGvC,YAAY,CAACwC,YAAY,CAACrB,IAAI,CAACsB,CAAC,IAAIA,CAAC,CAACjD,KAAK,KAAK2C,OAAO,CAACI,aAAa,CAAC,GAAG,IAAI;MACpH,MAAMiH,MAAM,GAAGhK,KAAK,GAAG,CAAC4C,SAAS,CAACpD,SAAS,GAAGQ,KAAK,CAACkD,UAAU,EAAEsG,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG;MAChF,MAAMS,gBAAgB,GAAGjK,KAAK,IAAI4C,SAAS,CAACZ,MAAM,CAAChC,KAAK,CAACA,KAAK,CAAC,GAAG1B,sBAAsB,CAACsE,SAAS,CAACZ,MAAM,CAAChC,KAAK,CAACA,KAAK,CAAC,CAACsD,WAAW,CAAC,GAAG,EAAE;MACxI,MAAM4G,kBAAkB,GAAG,CAAAvH,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEkB,cAAc,KAAI,EAAE;MACxD,OAAO,8GAA8GjB,SAAS,CAAC5D,IAAI,gEAAgEV,sBAAsB,CAACsE,SAAS,CAACU,WAAW,CAAC,yGAAyGV,SAAS,CAACpD,SAAS,6EAA6EQ,KAAK,GAAG,qBAAqBA,KAAK,CAACmK,KAAK,cAAcnK,KAAK,CAACmK,KAAK,sBAAsB,GAAG,EAAE,KAAKnK,KAAK,GAAGA,KAAK,CAAChB,IAAI,GAAG,cAAc,mIAAmIgL,MAAM,+EAA+EC,gBAAgB,GAAG,8FAA8FjK,KAAK,CAACmK,KAAK,gDAAgDnK,KAAK,CAACmK,KAAK,wFAAwFF,gBAAgB,eAAe,GAAG,EAAE,GAAGC,kBAAkB,GAAG,8PAA8PA,kBAAkB,eAAe,GAAG,EAAE,GAAI,CAACD,gBAAgB,IAAI,CAACC,kBAAkB,GAAI,sDAAsD,GAAG,EAAE,YAAY;IAC7/C,CAAC,CAAC,CAACP,IAAI,CAAC,EAAE,CAAC;AACf;AACA;AACA,kVAAkVxE,IAAI,CAACiF,KAAK,CAACf,UAAU,GAAG,EAAE,CAAC,GAAG,EAAE,MAAM7J,SAAS,oCAAoC+J,UAAU,iEAAiEA,UAAU,IAAI/I,YAAY,CAACqG,cAAc,CAACkD,gBAAgB,GAAG,SAAS,GAAG,SAAS,yBAAyBR,UAAU,IAAI/I,YAAY,CAACqG,cAAc,CAACkD,gBAAgB,GAAG,WAAW,GAAG,qBAAqB,gBAAgB9J,cAAc,GAAG,qFAAqFkF,IAAI,CAACiF,KAAK,CAAC/H,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE,QAAQ,GAAG,EAAE;AAC51B,aAAa,GAAG,EAAE;IAEd,MAAM9D,WAAW,GAAG,0JAA0J5B,WAAW,CAACoC,OAAO,CAACC,IAAI,0tEAA0tErC,WAAW,CAACoC,OAAO,CAACC,IAAI,KAAKrC,WAAW,CAACoC,OAAO,CAACF,EAAE,qCAAA6J,qBAAA,IAAAC,mBAAA,GAAoChM,WAAW,CAACuC,MAAM,cAAAyJ,mBAAA,uBAAlBA,mBAAA,CAAoBxJ,IAAI,cAAAuJ,qBAAA,cAAAA,qBAAA,GAAI,EAAE,OAAAE,qBAAA,IAAAC,oBAAA,GAAMlM,WAAW,CAACuC,MAAM,cAAA2J,oBAAA,uBAAlBA,oBAAA,CAAoB7J,IAAI,cAAA4J,qBAAA,cAAAA,qBAAA,GAAI,EAAE,uCAAuCjM,WAAW,CAAC2C,UAAU,CAACN,IAAI,wCAAA8J,qBAAA,IAAAC,oBAAA,GAAuCpM,WAAW,CAACuC,MAAM,cAAA6J,oBAAA,uBAAlBA,oBAAA,CAAoB3J,UAAU,cAAA0J,qBAAA,cAAAA,qBAAA,GAAI,EAAE,kCAAAE,qBAAA,IAAAC,oBAAA,GAAiCtM,WAAW,CAACuC,MAAM,cAAA+J,oBAAA,uBAAlBA,oBAAA,CAAoB5J,IAAI,cAAA2J,qBAAA,cAAAA,qBAAA,GAAI,EAAE,uIAAuIK,UAAU,CAACG,OAAO,CAAC,CAAC,CAAC,MAAMhK,SAAS,KAAK+J,UAAU,+CAA+C/I,YAAY,GAAG,WAAWA,YAAY,CAACqG,cAAc,CAACrC,KAAK,EAAE,GAAG,EAAE,GAAGvE,cAAc,GAAG,mBAAmB4B,iBAAiB,EAAAqH,sBAAA,GAACvM,WAAW,CAACoD,UAAU,cAAAmJ,sBAAA,uBAAtBA,sBAAA,CAAwBlJ,KAAK,CAAC,CAAChB,IAAI,EAAE,GAAG,EAAE,aAAaiB,cAAc,GAAG,uIAAuI4B,iBAAiB,EAAAsH,sBAAA,GAACxM,WAAW,CAACoD,UAAU,cAAAoJ,sBAAA,uBAAtBA,sBAAA,CAAwBnJ,KAAK,CAAC,CAAChB,IAAI,UAAU6C,iBAAiB,EAAAuH,sBAAA,GAACzM,WAAW,CAACoD,UAAU,cAAAqJ,sBAAA,uBAAtBA,sBAAA,CAAwBpJ,KAAK,CAAC,CAACsD,WAAW,sCAAsC6B,IAAI,CAACiF,KAAK,CAAC/H,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE,IAAI7C,SAAS,oCAAoC2F,IAAI,CAACiF,KAAK,CAACf,UAAU,GAAG,EAAE,CAAC,GAAG,EAAE,IAAI7J,SAAS,YAAY,GAAG,EAAE,GAAGqK,eAAe,GAAGtH,MAAM,CAAC8H,OAAO,CAAC1N,WAAW,CAAC8C,QAAQ,CAAC,CAACiF,MAAM,CAAC,CAAC,CAACqB,CAAC,EAAEuE,CAAC,CAAC,KAAKA,CAAC,CAAC,CAACrF,GAAG,CAAC,CAAC,CAACc,CAAC,EAAEuE,CAAC,CAAC,KAAK,qCAAqCvE,CAAC,CAACwE,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAGzE,CAAC,CAAC0E,KAAK,CAAC,CAAC,CAAC,oBAAoBH,CAAC,CAAC7L,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,YAAY,CAAC,CAACkL,IAAI,CAAC,EAAE,CAAC,GAAGF,eAAe,GAAG,kIAAkIA,eAAe,cAAc,GAAG,EAAE,GAAGG,cAAc,GAAG,0DAA0DA,cAAc,QAAQ,GAAG,EAAE,wFAAwF,IAAIvF,IAAI,CAAC,CAAC,CAACqG,kBAAkB,CAAC,CAAC,OAAO,IAAIrG,IAAI,CAAC,CAAC,CAACsG,kBAAkB,CAAC,CAAC,qPAAqPhE,IAAI,CAACiE,SAAS,CAACjO,WAAW,CAACkD,WAAW,CAAC,y2BAAy2B;IAEv5K,OAAOtB,WAAW;EACpB,CAAC;EAED,MAAMsM,cAAc,GAAItB,UAAU,IAAK;IACrC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,GAAG;IAChC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,GAAG;IAChC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,GAAG;IAChC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,GAAG;IAChC,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI;IACjC,OAAO,GAAG;EACZ,CAAC;;EAED;EACA,MAAMuB,oBAAoB,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA,EAAAC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA;IACjC,IAAI,GAAAL,qBAAA,GAACpM,gBAAgB,CAACI,OAAO,cAAAgM,qBAAA,eAAxBA,qBAAA,CAA0B/L,IAAI,GAAE;MACnC8H,KAAK,CAAC,+EAA+E,CAAC;MACtF;IACF;;IAEA;IACA,MAAMtH,SAAS,GAAGgB,YAAY,GAAGA,YAAY,CAACqG,cAAc,CAACyC,WAAW,GAAG3M,WAAW,CAAC2C,UAAU,CAACE,SAAS;IAC3G,MAAM+J,UAAU,GAAG/J,SAAS,GAAG,CAAC,GAAG2F,IAAI,CAACiF,KAAK,CAAE7G,YAAY,CAACH,UAAU,GAAG5D,SAAS,GAAI,GAAG,CAAC,GAAG,CAAC;;IAE9F;IACA,MAAM6L,mBAAmB,GAAG,EAAE;IAC9B,IAAI7K,YAAY,IAAIA,YAAY,CAAC8B,QAAQ,IAAI3D,gBAAgB,CAAC4B,aAAa,EAAE;MAAE;MAC7EC,YAAY,CAAC8B,QAAQ,CAAC4E,OAAO,CAACtE,SAAS,IAAI;QACzC,MAAMD,OAAO,GAAGhE,gBAAgB,CAAC4B,aAAa,CAACqC,SAAS,CAAC/D,EAAE,CAAC;QAC5D,IAAI8D,OAAO,IAAIA,OAAO,CAACI,aAAa,EAAE;UACpC,MAAM/C,KAAK,GAAGQ,YAAY,CAACwC,YAAY,CAACrB,IAAI,CAACsB,CAAC,IAAIA,CAAC,CAACjD,KAAK,KAAK2C,OAAO,CAACI,aAAa,CAAC;UACpF,MAAMuI,YAAY,GAAG1I,SAAS,CAACpD,SAAS,IAAI,CAAAQ,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEkD,UAAU,KAAI,CAAC,CAAC;UACnE,MAAMqI,mBAAmB,GAAGpG,IAAI,CAACiF,KAAK,CAAEkB,YAAY,GAAG1I,SAAS,CAACpD,SAAS,GAAI,GAAG,CAAC;UAElF6L,mBAAmB,CAACG,IAAI,CAAC;YACvBxM,IAAI,EAAE4D,SAAS,CAAC5D,IAAI;YACpBsE,WAAW,EAAEV,SAAS,CAACU,WAAW;YAClC9D,SAAS,EAAEoD,SAAS,CAACpD,SAAS;YAC9B8L,YAAY,EAAEnG,IAAI,CAACiF,KAAK,CAACkB,YAAY,GAAG,EAAE,CAAC,GAAG,EAAE;YAChDtL,KAAK,EAAE2C,OAAO,CAACI,aAAa;YAC5B0I,SAAS,EAAE,CAAAzL,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEhB,IAAI,KAAI,SAAS;YACnCiL,gBAAgB,EAAE,CAAAjK,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEsD,WAAW,KAAI,EAAE;YAC1CiG,UAAU,EAAEgC,mBAAmB;YAC/B1H,cAAc,EAAElB,OAAO,CAACkB,cAAc,IAAI;UAC5C,CAAC,CAAC;QACJ;MACF,CAAC,CAAC;IACJ;;IAEA;IACA,MAAM6H,WAAW,GAAG;MAClB3M,OAAO,EAAE;QACP4M,SAAS,EAAEhN,gBAAgB,CAACI,OAAO,CAACC,IAAI,CAAC4M,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAIjN,gBAAgB,CAACI,OAAO,CAACC,IAAI;QACvF6M,QAAQ,EAAElN,gBAAgB,CAACI,OAAO,CAACC,IAAI,CAAC4M,KAAK,CAAC,GAAG,CAAC,CAACnB,KAAK,CAAC,CAAC,CAAC,CAACd,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;QAC3EmC,QAAQ,EAAEnN,gBAAgB,CAACI,OAAO,CAACC,IAAI;QACvCH,EAAE,EAAEF,gBAAgB,CAACI,OAAO,CAACF,EAAE;QAC/BI,KAAK,EAAEN,gBAAgB,CAACI,OAAO,CAACE;MAClC,CAAC;MACDC,MAAM,EAAE;QACNC,IAAI,EAAER,gBAAgB,CAACO,MAAM,CAACC,IAAI;QAClCH,IAAI,EAAEL,gBAAgB,CAACO,MAAM,CAACF,IAAI;QAClCI,UAAU,EAAET,gBAAgB,CAACO,MAAM,CAACE,UAAU;QAC9CC,IAAI,EAAEV,gBAAgB,CAACO,MAAM,CAACG;MAChC,CAAC;MACDC,UAAU,EAAE;QACVkF,KAAK,EAAE7F,gBAAgB,CAACW,UAAU,CAACN,IAAI,KAAKwB,YAAY,aAAZA,YAAY,wBAAAwK,qBAAA,GAAZxK,YAAY,CAAEqG,cAAc,cAAAmE,qBAAA,uBAA5BA,qBAAA,CAA8BxG,KAAK,CAAC;QAChFlB,WAAW,EAAE,CAAA9C,YAAY,aAAZA,YAAY,wBAAAyK,sBAAA,GAAZzK,YAAY,CAAEqG,cAAc,cAAAoE,sBAAA,uBAA5BA,sBAAA,CAA8B3H,WAAW,KAAI,EAAE;QAC5DgG,WAAW,EAAE9J,SAAS;QACtBuK,gBAAgB,EAAE,CAAAvJ,YAAY,aAAZA,YAAY,wBAAA0K,sBAAA,GAAZ1K,YAAY,CAAEqG,cAAc,cAAAqE,sBAAA,uBAA5BA,sBAAA,CAA8BnB,gBAAgB,KAAI,EAAE;QACtExK,OAAO,EAAEZ,gBAAgB,CAACW,UAAU,CAACC;MACvC,CAAC;MACDwM,SAAS,EAAE;QACTC,YAAY,EAAE7G,IAAI,CAACiF,KAAK,CAAC7G,YAAY,CAACH,UAAU,GAAG,EAAE,CAAC,GAAG,EAAE;QAC3Df,QAAQ,EAAE8C,IAAI,CAACiF,KAAK,CAAC7G,YAAY,CAAClB,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE;QACrD4J,iBAAiB,EAAE1C,UAAU;QAC7B2C,WAAW,EAAErB,cAAc,CAACtB,UAAU,CAAC;QACvC4C,MAAM,EAAE5C,UAAU,KAAK,CAAA/I,YAAY,aAAZA,YAAY,wBAAA2K,sBAAA,GAAZ3K,YAAY,CAAEqG,cAAc,cAAAsE,sBAAA,uBAA5BA,sBAAA,CAA8BpB,gBAAgB,KAAI,EAAE,CAAC;QAC5EqC,kBAAkB,EAAE7I,YAAY,CAACtD,cAAc;QAC/CoD,qBAAqB,EAAEE,YAAY,CAACF,qBAAqB;QACzDf,QAAQ,EAAE+I;MACZ,CAAC;MACDgB,gBAAgB,EAAE;QAChB3M,OAAO,EAAEf,gBAAgB,CAACc,QAAQ,CAACC,OAAO,IAAI,EAAE;QAChDC,SAAS,EAAEhB,gBAAgB,CAACc,QAAQ,CAACE,SAAS,IAAI,EAAE;QACpDC,YAAY,EAAEjB,gBAAgB,CAACc,QAAQ,CAACG,YAAY,IAAI;MAC1D,CAAC;MACDM,QAAQ,EAAE;QACRE,UAAU,EAAE,IAAIiE,IAAI,CAAC,CAAC,CAACiI,WAAW,CAAC,CAAC;QACpCC,UAAU,EAAE,CAAA/L,YAAY,aAAZA,YAAY,wBAAA4K,sBAAA,GAAZ5K,YAAY,CAAEqG,cAAc,cAAAuE,sBAAA,uBAA5BA,sBAAA,CAA8B5G,KAAK,KAAI,eAAe;QAClEgI,aAAa,EAAEnB,mBAAmB,CAACjD,MAAM;QACzCqE,aAAa,EAAE;MACjB;IACF,CAAC;;IAED;IACA,MAAMC,OAAO,GAAG/F,IAAI,CAACiE,SAAS,CAACc,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;IACpD,MAAMiB,QAAQ,GAAG,IAAIC,IAAI,CAAC,CAACF,OAAO,CAAC,EAAE;MAAEpH,IAAI,EAAE;IAAmB,CAAC,CAAC;IAClE,MAAMf,GAAG,GAAGsI,GAAG,CAACC,eAAe,CAACH,QAAQ,CAAC;IACzC,MAAMhI,IAAI,GAAGoI,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACxCrI,IAAI,CAACsI,IAAI,GAAG1I,GAAG;IACfI,IAAI,CAACuI,QAAQ,GAAG,oBAAoBvO,gBAAgB,CAACI,OAAO,CAACC,IAAI,CAACP,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,IAAI,IAAI4F,IAAI,CAAC,CAAC,CAACiI,WAAW,CAAC,CAAC,CAAC7B,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO;IACtI9F,IAAI,CAACwI,KAAK,CAAC,CAAC;IACZN,GAAG,CAACO,eAAe,CAAC7I,GAAG,CAAC;IAExB,OAAOmH,WAAW;EACpB,CAAC;;EAED;EACA,MAAM2B,wBAAwB,GAAGA,CAAA,KAAM;IACrC,MAAMtB,SAAS,GAAGjB,oBAAoB,CAAC,CAAC;IACxC,IAAI,CAACiB,SAAS,EAAE;IAEhB,MAAMuB,gBAAgB,GAAGvB,SAAS,CAAChN,OAAO,CAAC4M,SAAS;IACpD,MAAM4B,UAAU,GAAGxB,SAAS,CAAC7M,MAAM,CAACF,IAAI,IAAI,aAAa;IACzD,MAAMwO,eAAe,GAAGzB,SAAS,CAACzM,UAAU,CAACkF,KAAK,IAAI,YAAY;;IAElE;IACA,MAAMiJ,eAAe,GAAGA,CAAA,KAAM;MAC5B,MAAMC,UAAU,GAAG3B,SAAS,CAAC7M,MAAM,CAACC,IAAI,CAACqL,WAAW,CAAC,CAAC;MACtD,IAAIkD,UAAU,CAACC,QAAQ,CAAC,KAAK,CAAC,IAAID,UAAU,CAACC,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,0BAA0B;MAC7F,IAAID,UAAU,CAACC,QAAQ,CAAC,KAAK,CAAC,IAAID,UAAU,CAACC,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,2BAA2B;MAC9F,IAAID,UAAU,CAACC,QAAQ,CAAC,KAAK,CAAC,IAAID,UAAU,CAACC,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,0BAA0B;MAC7F,IAAID,UAAU,CAACC,QAAQ,CAAC,KAAK,CAAC,IAAID,UAAU,CAACC,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,sBAAsB;MACzF,IAAID,UAAU,CAACC,QAAQ,CAAC,KAAK,CAAC,IAAID,UAAU,CAACC,QAAQ,CAAC,GAAG,CAAC,IAAID,UAAU,CAACC,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,UAAU;MACzG,OAAO,eAAe;IACxB,CAAC;IAED,MAAMC,MAAM,GAAG;AACnB;AACA;AACA,EAAEjH,IAAI,CAACiE,SAAS,CAACmB,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;AACpC;AACA;AACA;AACA,qCAAqCuB,gBAAgB,qEAAqEE,eAAe,mBAAmBzB,SAAS,CAACA,SAAS,CAACE,iBAAiB,MAAMF,SAAS,CAACA,SAAS,CAACG,WAAW,kCAAkCH,SAAS,CAACA,SAAS,CAACI,MAAM,GAAG,KAAK,GAAG,cAAc,sBAAsBJ,SAAS,CAACA,SAAS,CAACK,kBAAkB,GAAG,oEAAoE,GAAG,EAAE,+CAA+CqB,eAAe,CAAC,CAAC;AACngB;AACA;AACA;AACA;AACA;AACA;AACA,IAAI1B,SAAS,CAACA,SAAS,CAACK,kBAAkB,GAAG,2DAA2D,GAAG,wDAAwD;AACnK,iDAAiDmB,UAAU;AAC3D;AACA;AACA,kCAAkCD,gBAAgB;AAClD;AACA;AACA;AACA;AACA;AACA,2DAA2DA,gBAAgB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAavB,SAAS,CAAChN,OAAO,CAAC+M,QAAQ;AACvC,YAAYC,SAAS,CAAC7M,MAAM,CAACC,IAAI,MAAM4M,SAAS,CAAC7M,MAAM,CAACF,IAAI;AAC5D,gBAAgBwO,eAAe;AAC/B,gBAAgBzB,SAAS,CAAC7M,MAAM,CAACE,UAAU;AAC3C;AACA,2GAA2G;;IAEvG;IACA,MAAMyO,UAAU,GAAG,IAAIjB,IAAI,CAAC,CAACgB,MAAM,CAAC,EAAE;MAAEtI,IAAI,EAAE;IAAa,CAAC,CAAC;IAC7D,MAAMf,GAAG,GAAGsI,GAAG,CAACC,eAAe,CAACe,UAAU,CAAC;IAC3C,MAAMlJ,IAAI,GAAGoI,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACxCrI,IAAI,CAACsI,IAAI,GAAG1I,GAAG;IACfI,IAAI,CAACuI,QAAQ,GAAG,sBAAsBnB,SAAS,CAAChN,OAAO,CAAC4M,SAAS,IAAI,IAAItH,IAAI,CAAC,CAAC,CAACiI,WAAW,CAAC,CAAC,CAAC7B,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM;IAChH9F,IAAI,CAACwI,KAAK,CAAC,CAAC;IACZN,GAAG,CAACO,eAAe,CAAC7I,GAAG,CAAC;IAExBuJ,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEH,MAAM,CAAC;IACpD,OAAOA,MAAM;EACf,CAAC;;EAED;EACA,MAAMI,mBAAmB,GAAGA,CAAA,KAAM;IAChC,IAAI;MACF;MACA,MAAMjC,SAAS,GAAGjB,oBAAoB,CAAC,CAAC;MACxC,IAAI,CAACiB,SAAS,EAAE;;MAEhB;MACA5K,UAAU,CAAC,MAAM;QACfkM,wBAAwB,CAAC,CAAC;QAC1BvG,KAAK,CAAC,+CAA+CiF,SAAS,CAAChN,OAAO,CAAC+M,QAAQ,sJAAsJ,CAAC;MACxO,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;IAEX,CAAC,CAAC,OAAO/E,KAAK,EAAE;MACd+G,OAAO,CAAC/G,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;MACzDD,KAAK,CAAC,yEAAyE,CAAC;IAClF;EACF,CAAC;EAED,MAAMmH,YAAY,GAAGA,CAAA,KAAM;IACzB,MAAM1P,WAAW,GAAGkK,yBAAyB,CAAC,CAAC;IAC/C,MAAMyF,QAAQ,GAAG,IAAItB,IAAI,CAAC,CAACrO,WAAW,CAAC,EAAE;MAAE+G,IAAI,EAAE;IAAY,CAAC,CAAC;IAC/D,MAAMf,GAAG,GAAGsI,GAAG,CAACC,eAAe,CAACoB,QAAQ,CAAC;IACzC,MAAMvJ,IAAI,GAAGoI,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACxCrI,IAAI,CAACsI,IAAI,GAAG1I,GAAG;IACfI,IAAI,CAACuI,QAAQ,GAAG,gBAAgBvQ,WAAW,CAACoC,OAAO,CAACC,IAAI,IAAI,SAAS,IAAIrC,WAAW,CAAC2C,UAAU,CAACN,IAAI,IAAI,YAAY,OAAO;IAC3H2F,IAAI,CAACwI,KAAK,CAAC,CAAC;IACZN,GAAG,CAACO,eAAe,CAAC7I,GAAG,CAAC;EAC1B,CAAC;EAED,MAAM4J,WAAW,GAAGA,CAAA,KAAM;IACxB,MAAMC,IAAI,GAAG3F,yBAAyB,CAAC,CAAC;IACxC,MAAM4F,WAAW,GAAG7G,MAAM,CAAC8G,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC7CD,WAAW,CAACtB,QAAQ,CAACuB,IAAI,CAAC,CAAC;IAC3BD,WAAW,CAACtB,QAAQ,CAACwB,KAAK,CAACH,IAAI,CAAC;IAChCC,WAAW,CAACtB,QAAQ,CAACyB,KAAK,CAAC,CAAC;IAC5BH,WAAW,CAACI,KAAK,CAAC,CAAC;IACnBJ,WAAW,CAACK,KAAK,CAAC,CAAC;EACrB,CAAC;EAED,MAAMC,sBAAsB,GAAGA,CAAA,KAAM;IACnC,MAAMzP,MAAM,GAAG,CAAAvC,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEuC,MAAM,KAAI,CAAC,CAAC;IACxC,MAAMgB,QAAQ,GAAG/C,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEyR,cAAc;IAE1C,OAAO;MACLzP,IAAI,EAAED,MAAM,CAACC,IAAI,KAAIe,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEwN,UAAU,KAAI,EAAE;MAC/C1O,IAAI,EAAEE,MAAM,CAACF,IAAI,KAAIkB,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEqN,UAAU,KAAI,EAAE;MAC/CnO,UAAU,EAAEF,MAAM,CAACE,UAAU,KAAIc,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEd,UAAU,MAAIc,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAE2O,UAAU,KAAI,EAAE;MACnFxP,IAAI,EAAEH,MAAM,CAACG,IAAI,KAAIa,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEb,IAAI,KAAI;IACzC,CAAC;EACH,CAAC;EAED,MAAMyP,2BAA2B,GAAGA,CAAA,KAAM;IACxC,IAAI,EAAC3R,SAAS,aAATA,SAAS,eAATA,SAAS,CAAEyR,cAAc,GAAE;MAC9B9H,KAAK,CAAC,uDAAuD,CAAC;MAC9D;IACF;IAEA,MAAM8H,cAAc,GAAGzR,SAAS,CAACyR,cAAc;IAC/C,MAAMG,aAAa,GAAG;MACpB5P,IAAI,EAAEyP,cAAc,CAAClB,UAAU,IAAI,EAAE;MACrC1O,IAAI,EAAE4P,cAAc,CAACrB,UAAU,IAAI,EAAE;MACrCnO,UAAU,EAAEwP,cAAc,CAACxP,UAAU,IAAIwP,cAAc,CAACC,UAAU,IAAI,EAAE;MACxExP,IAAI,EAAEuP,cAAc,CAACvP,IAAI,IAAI;IAC/B,CAAC;;IAED;IACAxC,cAAc,CAAC8G,QAAQ,KAAK;MAC1B,GAAGA,QAAQ;MACXzE,MAAM,EAAE6P;IACV,CAAC,CAAC,CAAC;IAEHxM,MAAM,CAAC8H,OAAO,CAAC0E,aAAa,CAAC,CAAC7H,OAAO,CAAC,CAAC,CAAC8H,KAAK,EAAEC,KAAK,CAAC,KAAK;MACxDjS,gBAAgB,CAACgS,KAAK,EAAEC,KAAK,CAAC;IAChC,CAAC,CAAC;IAEFnB,OAAO,CAACC,GAAG,CAAC,wCAAwC,EAAEgB,aAAa,CAAC;IACpEjI,KAAK,CAAC,wCAAwCiI,aAAa,CAAC5P,IAAI,WAAW4P,aAAa,CAAC/P,IAAI,iBAAiB+P,aAAa,CAAC3P,UAAU,WAAW2P,aAAa,CAAC1P,IAAI,EAAE,CAAC;EACxK,CAAC;EAED,MAAM6P,mBAAmB,GAAGA,CAAA,KAAM;IAChC,MAAMhQ,MAAM,GAAG,CAAAvC,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEuC,MAAM,KAAI,CAAC,CAAC;IACxC,OAAO,CAACA,MAAM,CAACC,IAAI,IAAI,CAACD,MAAM,CAACF,IAAI,IAAI,CAACE,MAAM,CAACE,UAAU,IAAI,CAACF,MAAM,CAACG,IAAI;EAC3E,CAAC;EAED,MAAM8P,gBAAgB,GAAInP,KAAK,IAAK;IAClCnD,cAAc,CAAC8G,QAAQ,KAAK;MAC1B,GAAGA,QAAQ;MACX5D,UAAU,EAAE;QACVC,KAAK,EAAEA,KAAK;QACZC,cAAc,EAAED,KAAK,KAAK,MAAM;QAChC0B,QAAQ,EAAE,CAAAtD,iBAAiB,aAAjBA,iBAAiB,uBAAjBA,iBAAiB,CAAES,EAAE,KAAIrD,mBAAmB,CAACqD;MACzD;IACF,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAMuQ,oBAAoB,GAAItM,WAAW,IAAK;IAC5CnC,qBAAqB,CAACY,IAAI,KAAK;MAC7B,GAAGA,IAAI;MACP,CAACuB,WAAW,GAAG,CAACvB,IAAI,CAACuB,WAAW;IAClC,CAAC,CAAC,CAAC;EACL,CAAC;;EAED;EACA,MAAMuM,UAAU,GAAGA,CAAA,kBACjB3T,OAAA;IAAK4T,KAAK,EAAE;MACVC,OAAO,EAAE,MAAM;MAAEC,aAAa,EAAE,QAAQ;MAAEC,UAAU,EAAE,QAAQ;MAAEC,cAAc,EAAE,QAAQ;MACxFC,SAAS,EAAE,MAAM;MAAEC,UAAU,EAAE,gEAAgE;MAC/FC,YAAY,EAAE,MAAM;MAAEC,MAAM,EAAE,oBAAoB;MAAEC,OAAO,EAAE,MAAM;MAAEC,MAAM,EAAE,QAAQ;MAAEC,SAAS,EAAE;IACpG,CAAE;IAAAC,QAAA,gBACAxU,OAAA,CAACJ,aAAa;MAAC+J,IAAI,EAAE,EAAG;MAACiK,KAAK,EAAE;QAAEnF,KAAK,EAAE,SAAS;QAAEgG,YAAY,EAAE,QAAQ;QAAEzL,MAAM,EAAE;MAAgD;IAAE;MAAA0L,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACzI7U,OAAA;MAAI4T,KAAK,EAAE;QAAEkB,QAAQ,EAAE,MAAM;QAAEC,UAAU,EAAE,KAAK;QAAEtG,KAAK,EAAE,SAAS;QAAEgG,YAAY,EAAE,MAAM;QAAEO,UAAU,EAAE;MAAmC,CAAE;MAAAR,QAAA,EAAC;IAE5I;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACL7U,OAAA;MAAG4T,KAAK,EAAE;QAAEkB,QAAQ,EAAE,QAAQ;QAAErG,KAAK,EAAE,SAAS;QAAEgG,YAAY,EAAE,MAAM;QAAEQ,QAAQ,EAAE,OAAO;QAAEC,UAAU,EAAE;MAAM,CAAE;MAAAV,QAAA,EAAC;IAEhH;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,eACJ7U,OAAA;MAAK4T,KAAK,EAAE;QAAEC,OAAO,EAAE,MAAM;QAAEsB,GAAG,EAAE,MAAM;QAAEnB,cAAc,EAAE;MAAS,CAAE;MAAAQ,QAAA,gBACrExU,OAAA;QAAQoV,OAAO,EAAEA,CAAA,KAAMlT,YAAY,CAAC,gBAAgB,CAAE;QAAC0R,KAAK,EAAE;UAC5DC,OAAO,EAAE,MAAM;UAAEE,UAAU,EAAE,QAAQ;UAAEoB,GAAG,EAAE,QAAQ;UAAEd,OAAO,EAAE,WAAW;UAAEH,UAAU,EAAE,mDAAmD;UAC3IzF,KAAK,EAAE,OAAO;UAAE2F,MAAM,EAAE,MAAM;UAAED,YAAY,EAAE,SAAS;UAAEW,QAAQ,EAAE,MAAM;UAAEC,UAAU,EAAE,KAAK;UAAEM,MAAM,EAAE,SAAS;UAAEC,SAAS,EAAE;QAC9H,CAAE;QAAAd,QAAA,gBACAxU,OAAA,CAACvB,QAAQ;UAACkL,IAAI,EAAE;QAAG;UAAA+K,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,sBACxB;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACT7U,OAAA;QAAQoV,OAAO,EAAEA,CAAA;UAAA,IAAAG,qBAAA;UAAA,QAAAA,qBAAA,GAAMpQ,cAAc,CAACqQ,OAAO,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAwB9D,KAAK,CAAC,CAAC;QAAA,CAAC;QAACmC,KAAK,EAAE;UAC7DC,OAAO,EAAE,MAAM;UAAEE,UAAU,EAAE,QAAQ;UAAEoB,GAAG,EAAE,QAAQ;UAAEd,OAAO,EAAE,WAAW;UAAEH,UAAU,EAAE,mDAAmD;UAC3IzF,KAAK,EAAE,OAAO;UAAE2F,MAAM,EAAE,MAAM;UAAED,YAAY,EAAE,SAAS;UAAEW,QAAQ,EAAE,MAAM;UAAEC,UAAU,EAAE,KAAK;UAAEM,MAAM,EAAE,SAAS;UAAEC,SAAS,EAAE;QAC9H,CAAE;QAAAd,QAAA,gBACAxU,OAAA,CAACxB,MAAM;UAACmL,IAAI,EAAE;QAAG;UAAA+K,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,yBACtB;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,eACN7U,OAAA;MAAOyV,GAAG,EAAEtQ,cAAe;MAACyE,IAAI,EAAC,MAAM;MAAC8L,MAAM,EAAC,OAAO;MAAC9B,KAAK,EAAE;QAAEC,OAAO,EAAE;MAAO,CAAE;MAAC8B,QAAQ,EAAE7K;IAAmB;MAAA4J,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAChH,CACN;EAED,IAAI,CAAC/P,YAAY,EAAE;IACjB,oBACE9E,OAAA;MAAK4T,KAAK,EAAE;QAAEK,SAAS,EAAE,OAAO;QAAEC,UAAU,EAAE,SAAS;QAAEG,OAAO,EAAE;MAAS,CAAE;MAAAG,QAAA,eAC3ExU,OAAA;QAAK4T,KAAK,EAAE;UAAEqB,QAAQ,EAAE,OAAO;UAAEX,MAAM,EAAE;QAAS,CAAE;QAAAE,QAAA,gBAClDxU,OAAA;UAAK4T,KAAK,EAAE;YACVM,UAAU,EAAE,mDAAmD;YAC/DzF,KAAK,EAAE,OAAO;YACd4F,OAAO,EAAE,QAAQ;YACjBF,YAAY,EAAE,mBAAmB;YACjCmB,SAAS,EAAE;UACb,CAAE;UAAAd,QAAA,eACAxU,OAAA;YAAI4T,KAAK,EAAE;cAAEkB,QAAQ,EAAE,UAAU;cAAEC,UAAU,EAAE,KAAK;cAAET,MAAM,EAAE;YAAe,CAAE;YAAAE,QAAA,EAAC;UAEhF;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACF,CAAC,eACN7U,OAAA;UAAK4T,KAAK,EAAE;YAAEM,UAAU,EAAE,OAAO;YAAEC,YAAY,EAAE,mBAAmB;YAAEmB,SAAS,EAAE,iCAAiC;YAAEjB,OAAO,EAAE;UAAS,CAAE;UAAAG,QAAA,eACtIxU,OAAA,CAAC2T,UAAU;YAAAe,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACX,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV;EAEA,oBACE7U,OAAA;IAAK4T,KAAK,EAAE;MAAEK,SAAS,EAAE,OAAO;MAAEC,UAAU,EAAE,SAAS;MAAEG,OAAO,EAAE;IAAS,CAAE;IAAAG,QAAA,eAC3ExU,OAAA;MAAK4T,KAAK,EAAE;QAAEqB,QAAQ,EAAE,OAAO;QAAEX,MAAM,EAAE;MAAS,CAAE;MAAAE,QAAA,gBAElDxU,OAAA;QAAK4T,KAAK,EAAE;UACVM,UAAU,EAAE,mDAAmD;UAC/DzF,KAAK,EAAE,OAAO;UACd4F,OAAO,EAAE,QAAQ;UACjBF,YAAY,EAAE,mBAAmB;UACjCmB,SAAS,EAAE;QACb,CAAE;QAAAd,QAAA,eACAxU,OAAA;UAAK4T,KAAK,EAAE;YAAEC,OAAO,EAAE,MAAM;YAAEG,cAAc,EAAE,eAAe;YAAED,UAAU,EAAE;UAAS,CAAE;UAAAS,QAAA,gBACrFxU,OAAA;YAAAwU,QAAA,gBACExU,OAAA;cAAI4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,UAAU;gBAAEC,UAAU,EAAE,KAAK;gBAAET,MAAM,EAAE;cAAe,CAAE;cAAAE,QAAA,EAAC;YAEhF;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL7U,OAAA;cAAG4T,KAAK,EAAE;gBAAEnF,KAAK,EAAE,SAAS;gBAAE6F,MAAM,EAAE;cAAE,CAAE;cAAAE,QAAA,EACvC1P,YAAY,GAAG,uCAAuC,GAAG;YAAsD;cAAA4P,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC/G,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD,CAAC,eACN7U,OAAA;YAAK4T,KAAK,EAAE;cAAEC,OAAO,EAAE,MAAM;cAAEsB,GAAG,EAAE;YAAU,CAAE;YAAAX,QAAA,gBAC9CxU,OAAA;cACEoV,OAAO,EAAE7C,YAAa;cACtBqB,KAAK,EAAE;gBACLC,OAAO,EAAE,MAAM;gBACfE,UAAU,EAAE,QAAQ;gBACpBoB,GAAG,EAAE,QAAQ;gBACbjB,UAAU,EAAE,SAAS;gBACrBzF,KAAK,EAAE,OAAO;gBACd4F,OAAO,EAAE,aAAa;gBACtBF,YAAY,EAAE,QAAQ;gBACtBC,MAAM,EAAE,MAAM;gBACdiB,MAAM,EAAE,SAAS;gBACjBP,QAAQ,EAAE;cACZ,CAAE;cAAAN,QAAA,gBAEFxU,OAAA,CAAClB,QAAQ;gBAAC6K,IAAI,EAAE;cAAG;gBAAA+K,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eAExB;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACT7U,OAAA;cACE4J,IAAI,EAAC,QAAQ;cACbwL,OAAO,EAAE3C,WAAY;cACrBmB,KAAK,EAAE;gBACLC,OAAO,EAAE,MAAM;gBACfE,UAAU,EAAE,QAAQ;gBACpBoB,GAAG,EAAE,QAAQ;gBACbS,eAAe,EAAE,SAAS;gBAC1BnH,KAAK,EAAE,SAAS;gBAChB4F,OAAO,EAAE,aAAa;gBACtBF,YAAY,EAAE,QAAQ;gBACtBC,MAAM,EAAE,MAAM;gBACdiB,MAAM,EAAE,SAAS;gBACjBP,QAAQ,EAAE;cACZ,CAAE;cAAAN,QAAA,gBAEFxU,OAAA,CAACvB,QAAQ;gBAACkL,IAAI,EAAE;cAAG;gBAAA+K,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,cAExB;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eAET7U,OAAA;cACEoV,OAAO,EAAE9C,mBAAoB;cAC7BsB,KAAK,EAAE;gBACLC,OAAO,EAAE,MAAM;gBACfE,UAAU,EAAE,QAAQ;gBACpBoB,GAAG,EAAE,QAAQ;gBACbjB,UAAU,EAAE,SAAS;gBACrBzF,KAAK,EAAE,OAAO;gBACd4F,OAAO,EAAE,aAAa;gBACtBF,YAAY,EAAE,QAAQ;gBACtBC,MAAM,EAAE,MAAM;gBACdiB,MAAM,EAAE,SAAS;gBACjBP,QAAQ,EAAE;cACZ,CAAE;cACFhM,KAAK,EAAC,sEAAsE;cAAA0L,QAAA,gBAE5ExU,OAAA,CAACjB,GAAG;gBAAC4K,IAAI,EAAE;cAAG;gBAAA+K,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,0BAEnB;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAEN7U,OAAA;QAAK4T,KAAK,EAAE;UAAEM,UAAU,EAAE,OAAO;UAAEC,YAAY,EAAE,mBAAmB;UAAEmB,SAAS,EAAE;QAAkC,CAAE;QAAAd,QAAA,eACnHxU,OAAA;UAAK4T,KAAK,EAAE;YAAES,OAAO,EAAE;UAAS,CAAE;UAAAG,QAAA,GAG/B1H,kBAAkB,IAAIlL,cAAc,IAAIA,cAAc,CAAC6K,QAAQ,iBAC9DzM,OAAA;YAAK4T,KAAK,EAAE;cACVM,UAAU,EAAE,mDAAmD;cAC/DE,MAAM,EAAE,mBAAmB;cAC3BD,YAAY,EAAE,SAAS;cACvBE,OAAO,EAAE,QAAQ;cACjBI,YAAY,EAAE;YAChB,CAAE;YAAAD,QAAA,gBACAxU,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEG,cAAc,EAAE,eAAe;gBAAED,UAAU,EAAE,QAAQ;gBAAEU,YAAY,EAAE;cAAO,CAAE;cAAAD,QAAA,gBAC3GxU,OAAA;gBAAK4T,KAAK,EAAE;kBAAEC,OAAO,EAAE,MAAM;kBAAEE,UAAU,EAAE,QAAQ;kBAAEoB,GAAG,EAAE;gBAAO,CAAE;gBAAAX,QAAA,gBACjExU,OAAA;kBAAK4T,KAAK,EAAE;oBACViC,KAAK,EAAE,MAAM;oBACbC,MAAM,EAAE,MAAM;oBACd5B,UAAU,EAAE,SAAS;oBACrBC,YAAY,EAAE,KAAK;oBACnBN,OAAO,EAAE,MAAM;oBACfE,UAAU,EAAE,QAAQ;oBACpBC,cAAc,EAAE,QAAQ;oBACxBvF,KAAK,EAAE,OAAO;oBACdqG,QAAQ,EAAE,QAAQ;oBAClBC,UAAU,EAAE;kBACd,CAAE;kBAAAP,QAAA,EACC1H,kBAAkB,CAACH;gBAAQ;kBAAA+H,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACzB,CAAC,eACN7U,OAAA;kBAAAwU,QAAA,gBACExU,OAAA;oBAAI4T,KAAK,EAAE;sBAAEU,MAAM,EAAE,CAAC;sBAAEQ,QAAQ,EAAE,QAAQ;sBAAEC,UAAU,EAAE,KAAK;sBAAEtG,KAAK,EAAE;oBAAU,CAAE;oBAAA+F,QAAA,EAC/E1H,kBAAkB,CAACzJ,OAAO,CAACC;kBAAI;oBAAAoR,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAC9B,CAAC,eACL7U,OAAA;oBAAG4T,KAAK,EAAE;sBAAEU,MAAM,EAAE,CAAC;sBAAE7F,KAAK,EAAE,SAAS;sBAAEqG,QAAQ,EAAE;oBAAW,CAAE;oBAAAN,QAAA,GAAC,cACnD,EAAC1H,kBAAkB,CAACzJ,OAAO,CAACF,EAAE,EAAC,YAAU,EAAC2J,kBAAkB,CAACzJ,OAAO,CAACE,KAAK;kBAAA;oBAAAmR,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACrF,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACD,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eAEN7U,OAAA;gBAAK4T,KAAK,EAAE;kBAAEC,OAAO,EAAE,MAAM;kBAAEE,UAAU,EAAE,QAAQ;kBAAEoB,GAAG,EAAE;gBAAO,CAAE;gBAAAX,QAAA,gBACjExU,OAAA;kBAAK4T,KAAK,EAAE;oBAAEW,SAAS,EAAE,QAAQ;oBAAE9F,KAAK,EAAE;kBAAU,CAAE;kBAAA+F,QAAA,gBACpDxU,OAAA;oBAAK4T,KAAK,EAAE;sBAAEkB,QAAQ,EAAE,SAAS;sBAAEC,UAAU,EAAE;oBAAO,CAAE;oBAAAP,QAAA,GACrD1H,kBAAkB,CAACH,QAAQ,EAAC,GAAC,EAACG,kBAAkB,CAAC9F,KAAK;kBAAA;oBAAA0N,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACpD,CAAC,eACN7U,OAAA;oBAAK4T,KAAK,EAAE;sBAAEkB,QAAQ,EAAE;oBAAU,CAAE;oBAAAN,QAAA,EAAC;kBAAQ;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAChD,CAAC,eAEN7U,OAAA;kBAAK4T,KAAK,EAAE;oBAAEC,OAAO,EAAE,MAAM;oBAAEsB,GAAG,EAAE;kBAAS,CAAE;kBAAAX,QAAA,gBAC7CxU,OAAA;oBACEoV,OAAO,EAAEjJ,qBAAsB;oBAC/B4J,QAAQ,EAAEjJ,kBAAkB,CAACF,OAAQ;oBACrCgH,KAAK,EAAE;sBACLC,OAAO,EAAE,MAAM;sBACfE,UAAU,EAAE,QAAQ;sBACpBoB,GAAG,EAAE,QAAQ;sBACbjB,UAAU,EAAEpH,kBAAkB,CAACF,OAAO,GAAG,SAAS,GAAG,SAAS;sBAC9D6B,KAAK,EAAE,OAAO;sBACd4F,OAAO,EAAE,cAAc;sBACvBF,YAAY,EAAE,QAAQ;sBACtBC,MAAM,EAAE,MAAM;sBACdiB,MAAM,EAAEvI,kBAAkB,CAACF,OAAO,GAAG,aAAa,GAAG,SAAS;sBAC9DkI,QAAQ,EAAE,UAAU;sBACpBC,UAAU,EAAE;oBACd,CAAE;oBAAAP,QAAA,gBAEFxU,OAAA,CAACd,SAAS;sBAACyK,IAAI,EAAE;oBAAG;sBAAA+K,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAE,CAAC,YAEzB;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,eAET7U,OAAA;oBACEoV,OAAO,EAAEA,CAAA,KAAM;sBACbpT,oBAAoB,CAAC;wBAAEqK,MAAM,EAAE;sBAAM,CAAC,CAAC;sBACvCnK,YAAY,CAAC,eAAe,CAAC;oBAC/B,CAAE;oBACF0R,KAAK,EAAE;sBACLC,OAAO,EAAE,MAAM;sBACfE,UAAU,EAAE,QAAQ;sBACpBoB,GAAG,EAAE,QAAQ;sBACbjB,UAAU,EAAE,SAAS;sBACrBzF,KAAK,EAAE,OAAO;sBACd4F,OAAO,EAAE,cAAc;sBACvBF,YAAY,EAAE,QAAQ;sBACtBC,MAAM,EAAE,MAAM;sBACdiB,MAAM,EAAE,SAAS;sBACjBP,QAAQ,EAAE,UAAU;sBACpBC,UAAU,EAAE;oBACd,CAAE;oBAAAP,QAAA,gBAEFxU,OAAA,CAACN,KAAK;sBAACiK,IAAI,EAAE;oBAAG;sBAAA+K,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAE,CAAC,iBAErB;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,eAET7U,OAAA;oBACEoV,OAAO,EAAEzJ,iBAAkB;oBAC3BoK,QAAQ,EAAEjJ,kBAAkB,CAACD,MAAO;oBACpC+G,KAAK,EAAE;sBACLC,OAAO,EAAE,MAAM;sBACfE,UAAU,EAAE,QAAQ;sBACpBoB,GAAG,EAAE,QAAQ;sBACbjB,UAAU,EAAEpH,kBAAkB,CAACD,MAAM,GAAG,SAAS,GAAG,SAAS;sBAC7D4B,KAAK,EAAE,OAAO;sBACd4F,OAAO,EAAE,cAAc;sBACvBF,YAAY,EAAE,QAAQ;sBACtBC,MAAM,EAAE,MAAM;sBACdiB,MAAM,EAAEvI,kBAAkB,CAACD,MAAM,GAAG,aAAa,GAAG,SAAS;sBAC7DiI,QAAQ,EAAE,UAAU;sBACpBC,UAAU,EAAE;oBACd,CAAE;oBAAAP,QAAA,EAED1H,kBAAkB,CAACD,MAAM,gBACxB7M,OAAA,CAAAE,SAAA;sBAAAsU,QAAA,gBACExU,OAAA,CAACV,WAAW;wBAACqK,IAAI,EAAE;sBAAG;wBAAA+K,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAE,CAAC,oBAE3B;oBAAA,eAAE,CAAC,gBAEH7U,OAAA,CAAAE,SAAA;sBAAAsU,QAAA,GAAE,MAEA,eAAAxU,OAAA,CAACb,UAAU;wBAACwK,IAAI,EAAE;sBAAG;wBAAA+K,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAE,CAAC;oBAAA,eACxB;kBACH;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACK,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACN,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eAGN7U,OAAA;cAAK4T,KAAK,EAAE;gBACViC,KAAK,EAAE,MAAM;gBACb3B,UAAU,EAAE,SAAS;gBACrBC,YAAY,EAAE,QAAQ;gBACtB2B,MAAM,EAAE,KAAK;gBACbE,QAAQ,EAAE;cACZ,CAAE;cAAAxB,QAAA,eACAxU,OAAA;gBAAK4T,KAAK,EAAE;kBACViC,KAAK,EAAE,GAAI/I,kBAAkB,CAACH,QAAQ,GAAGG,kBAAkB,CAAC9F,KAAK,GAAI,GAAG,GAAG;kBAC3EkN,UAAU,EAAE,kDAAkD;kBAC9D4B,MAAM,EAAE,MAAM;kBACdG,UAAU,EAAE;gBACd;cAAE;gBAAAvB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN,EAIA3T,iBAAiB,iBAChBlB,OAAA;YAAK4T,KAAK,EAAE;cACVM,UAAU,EAAE,mDAAmD;cAC/DE,MAAM,EAAE,mBAAmB;cAC3BD,YAAY,EAAE,QAAQ;cACtBE,OAAO,EAAE,SAAS;cAClBI,YAAY,EAAE;YAChB,CAAE;YAAAD,QAAA,eACAxU,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEE,UAAU,EAAE,QAAQ;gBAAEoB,GAAG,EAAE,QAAQ;gBAAE1G,KAAK,EAAE;cAAU,CAAE;cAAA+F,QAAA,gBACrFxU,OAAA;gBAAK4T,KAAK,EAAE;kBAAEiC,KAAK,EAAE,KAAK;kBAAEC,MAAM,EAAE,KAAK;kBAAE5B,UAAU,EAAE,SAAS;kBAAEC,YAAY,EAAE;gBAAM;cAAE;gBAAAO,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eAC/F7U,OAAA;gBAAM4T,KAAK,EAAE;kBAAEkB,QAAQ,EAAE,UAAU;kBAAEC,UAAU,EAAE;gBAAM,CAAE;gBAAAP,QAAA,EAAC;cAAuC;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrG;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN,EAIA,CAAC/H,kBAAkB,IAAIrL,SAAS,IAAI,EAAApB,mBAAA,GAAAoB,SAAS,CAACgL,QAAQ,cAAApM,mBAAA,uBAAlBA,mBAAA,CAAoBqM,MAAM,IAAG,CAAC,iBACjE1M,OAAA;YAAK4T,KAAK,EAAE;cACVM,UAAU,EAAE,mDAAmD;cAC/DE,MAAM,EAAE,mBAAmB;cAC3BD,YAAY,EAAE,QAAQ;cACtBE,OAAO,EAAE,MAAM;cACfI,YAAY,EAAE;YAChB,CAAE;YAAAD,QAAA,eACAxU,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEG,cAAc,EAAE,eAAe;gBAAED,UAAU,EAAE;cAAS,CAAE;cAAAS,QAAA,gBACrFxU,OAAA;gBAAAwU,QAAA,gBACExU,OAAA;kBAAI4T,KAAK,EAAE;oBAAEU,MAAM,EAAE,cAAc;oBAAE7F,KAAK,EAAE,SAAS;oBAAEqG,QAAQ,EAAE,UAAU;oBAAEC,UAAU,EAAE;kBAAM,CAAE;kBAAAP,QAAA,EAAC;gBAElG;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACL7U,OAAA;kBAAG4T,KAAK,EAAE;oBAAEU,MAAM,EAAE,CAAC;oBAAE7F,KAAK,EAAE,SAAS;oBAAEqG,QAAQ,EAAE;kBAAW,CAAE;kBAAAN,QAAA,GAC7D/S,SAAS,CAACgL,QAAQ,CAACC,MAAM,EAAC,0EAC7B;gBAAA;kBAAAgI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACD,CAAC,eACN7U,OAAA;gBACEoV,OAAO,EAAEA,CAAA,KAAM;kBACbnT,wBAAwB,CAACR,SAAS,CAAC;kBACnCS,YAAY,CAAC,cAAc,CAAC;gBAC9B,CAAE;gBACF0R,KAAK,EAAE;kBACLC,OAAO,EAAE,MAAM;kBACfE,UAAU,EAAE,QAAQ;kBACpBoB,GAAG,EAAE,QAAQ;kBACbjB,UAAU,EAAE,SAAS;kBACrBzF,KAAK,EAAE,OAAO;kBACd4F,OAAO,EAAE,gBAAgB;kBACzBF,YAAY,EAAE,QAAQ;kBACtBC,MAAM,EAAE,MAAM;kBACdiB,MAAM,EAAE,SAAS;kBACjBP,QAAQ,EAAE,UAAU;kBACpBC,UAAU,EAAE;gBACd,CAAE;gBAAAP,QAAA,gBAEFxU,OAAA,CAACX,UAAU;kBAACsK,IAAI,EAAE;gBAAG;kBAAA+K,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,uBAE1B;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN,eAGD7U,OAAA;YAAK4T,KAAK,EAAE;cAAEa,YAAY,EAAE;YAAO,CAAE;YAAAD,QAAA,gBACnCxU,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEG,cAAc,EAAE,eAAe;gBAAED,UAAU,EAAE,QAAQ;gBAAEU,YAAY,EAAE;cAAO,CAAE;cAAAD,QAAA,gBAC3GxU,OAAA;gBAAI4T,KAAK,EAAE;kBAAEkB,QAAQ,EAAE,SAAS;kBAAEC,UAAU,EAAE,KAAK;kBAAEtG,KAAK,EAAE;gBAAU,CAAE;gBAAA+F,QAAA,EAAC;cAEzE;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,EAGJrB,mBAAmB,CAAC,CAAC,KAAI/R,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEyR,cAAc,kBACjDlT,OAAA;gBACEoV,OAAO,EAAEhC,2BAA4B;gBACrCQ,KAAK,EAAE;kBACLC,OAAO,EAAE,MAAM;kBACfE,UAAU,EAAE,QAAQ;kBACpBoB,GAAG,EAAE,QAAQ;kBACbjB,UAAU,EAAE,SAAS;kBACrBzF,KAAK,EAAE,OAAO;kBACd4F,OAAO,EAAE,aAAa;kBACtBF,YAAY,EAAE,QAAQ;kBACtBC,MAAM,EAAE,MAAM;kBACdiB,MAAM,EAAE,SAAS;kBACjBP,QAAQ,EAAE,UAAU;kBACpBC,UAAU,EAAE;gBACd,CAAE;gBACFjM,KAAK,EAAC,kDAAkD;gBAAA0L,QAAA,gBAExDxU,OAAA,CAACzB,QAAQ;kBAACoL,IAAI,EAAE;gBAAG;kBAAA+K,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,oBAExB;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CACT;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC,EAGL,CAAC,MAAM;cACN,MAAMqB,aAAa,GAAGjD,sBAAsB,CAAC,CAAC;cAC9C,IAAIiD,aAAa,CAACzS,IAAI,IAAIyS,aAAa,CAAC5S,IAAI,EAAE;gBAAA,IAAA6S,oBAAA;gBAC5C,oBACEnW,OAAA;kBAAK4T,KAAK,EAAE;oBACVM,UAAU,EAAE,SAAS;oBACrBE,MAAM,EAAE,mBAAmB;oBAC3BD,YAAY,EAAE,QAAQ;oBACtBE,OAAO,EAAE,SAAS;oBAClBI,YAAY,EAAE,MAAM;oBACpBK,QAAQ,EAAE,UAAU;oBACpBrG,KAAK,EAAE;kBACT,CAAE;kBAAA+F,QAAA,eACAxU,OAAA;oBAAK4T,KAAK,EAAE;sBAAEC,OAAO,EAAE,MAAM;sBAAEE,UAAU,EAAE,QAAQ;sBAAEoB,GAAG,EAAE;oBAAS,CAAE;oBAAAX,QAAA,gBACnExU,OAAA,CAACV,WAAW;sBAACqK,IAAI,EAAE;oBAAG;sBAAA+K,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAE,CAAC,eACzB7U,OAAA;sBAAAwU,QAAA,GAAM,4BAA0B,EAAC,CAAA2B,oBAAA,GAAAlV,WAAW,CAACuC,MAAM,cAAA2S,oBAAA,eAAlBA,oBAAA,CAAoB1S,IAAI,GAAG,sBAAsB,GAAG,0BAA0B;oBAAA;sBAAAiR,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACpH;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACH,CAAC;cAEV;cACA,OAAO,IAAI;YACb,CAAC,EAAE,CAAC,eAEJ7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEuC,mBAAmB,EAAE,sCAAsC;gBAAEjB,GAAG,EAAE;cAAO,CAAE;cAAAX,QAAA,gBACxGxU,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,4BAA4B;gBACxC9C,KAAK,EAAEN,sBAAsB,CAAC,CAAC,CAACxP,IAAK;gBACrCkS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACXzE,MAAM,EAAE;sBAAE,GAAGyE,QAAQ,CAACzE,MAAM;sBAAEC,IAAI,EAAE6S;oBAAS;kBAC/C,CAAC,CAAC,CAAC;kBACHhV,gBAAgB,CAAC,MAAM,EAAEgV,QAAQ,CAAC;gBACpC,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE,UAAU;kBACpBc,eAAe,EAAE3C,sBAAsB,CAAC,CAAC,CAACxP,IAAI,IAAI,GAAAnD,oBAAA,GAACW,WAAW,CAACuC,MAAM,cAAAlD,oBAAA,eAAlBA,oBAAA,CAAoBmD,IAAI,IAAG,SAAS,GAAG;gBAC5F;cAAE;gBAAAiR,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACF7U,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,aAAa;gBACzB9C,KAAK,EAAEN,sBAAsB,CAAC,CAAC,CAAC3P,IAAK;gBACrCqS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACXzE,MAAM,EAAE;sBAAE,GAAGyE,QAAQ,CAACzE,MAAM;sBAAEF,IAAI,EAAEgT;oBAAS;kBAC/C,CAAC,CAAC,CAAC;kBACHhV,gBAAgB,CAAC,MAAM,EAAEgV,QAAQ,CAAC;gBACpC,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE,UAAU;kBACpBc,eAAe,EAAE3C,sBAAsB,CAAC,CAAC,CAAC3P,IAAI,IAAI,GAAA/C,oBAAA,GAACU,WAAW,CAACuC,MAAM,cAAAjD,oBAAA,eAAlBA,oBAAA,CAAoB+C,IAAI,IAAG,SAAS,GAAG;gBAC5F;cAAE;gBAAAoR,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACF7U,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,iBAAiB;gBAC7B9C,KAAK,EAAEN,sBAAsB,CAAC,CAAC,CAACvP,UAAW;gBAC3CiS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACXzE,MAAM,EAAE;sBAAE,GAAGyE,QAAQ,CAACzE,MAAM;sBAAEE,UAAU,EAAE4S;oBAAS;kBACrD,CAAC,CAAC,CAAC;kBACHhV,gBAAgB,CAAC,YAAY,EAAEgV,QAAQ,CAAC;gBAC1C,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE,UAAU;kBACpBc,eAAe,EAAE3C,sBAAsB,CAAC,CAAC,CAACvP,UAAU,IAAI,GAAAlD,oBAAA,GAACS,WAAW,CAACuC,MAAM,cAAAhD,oBAAA,eAAlBA,oBAAA,CAAoBkD,UAAU,IAAG,SAAS,GAAG;gBACxG;cAAE;gBAAAgR,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACF7U,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,wBAAwB;gBACpC9C,KAAK,EAAEN,sBAAsB,CAAC,CAAC,CAACtP,IAAK;gBACrCgS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACXzE,MAAM,EAAE;sBAAE,GAAGyE,QAAQ,CAACzE,MAAM;sBAAEG,IAAI,EAAE2S;oBAAS;kBAC/C,CAAC,CAAC,CAAC;kBACHhV,gBAAgB,CAAC,MAAM,EAAEgV,QAAQ,CAAC;gBACpC,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE,UAAU;kBACpBc,eAAe,EAAE3C,sBAAsB,CAAC,CAAC,CAACtP,IAAI,IAAI,GAAAlD,oBAAA,GAACQ,WAAW,CAACuC,MAAM,cAAA/C,oBAAA,eAAlBA,oBAAA,CAAoBkD,IAAI,IAAG,SAAS,GAAG;gBAC5F;cAAE;gBAAA+Q,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGN7U,OAAA;YAAK4T,KAAK,EAAE;cAAEa,YAAY,EAAE;YAAO,CAAE;YAAAD,QAAA,gBACnCxU,OAAA;cAAI4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,UAAU;gBAAEC,UAAU,EAAE,KAAK;gBAAEN,YAAY,EAAE,SAAS;gBAAEhG,KAAK,EAAE;cAAU,CAAE;cAAA+F,QAAA,EAAC;YAEnG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEuC,mBAAmB,EAAE,sCAAsC;gBAAEjB,GAAG,EAAE;cAAO,CAAE;cAAAX,QAAA,gBACxGxU,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,cAAc;gBAC1B9C,KAAK,EAAE,CAAApR,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEmB,IAAI,OAAA5C,oBAAA,GAAIO,WAAW,CAACoC,OAAO,cAAA3C,oBAAA,uBAAnBA,oBAAA,CAAqB4C,IAAI,KAAI,EAAG;gBAC/DqS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACX5E,OAAO,EAAE;sBAAE,GAAG4E,QAAQ,CAAC5E,OAAO;sBAAEC,IAAI,EAAEgT;oBAAS;kBACjD,CAAC,CAAC,CAAC;kBACHjV,iBAAiB,CAAC,MAAM,EAAEiV,QAAQ,CAAC;gBACrC,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE,UAAU;kBACpBZ,UAAU,EAAEpH,kBAAkB,GAAG,SAAS,GAAG;gBAC/C,CAAE;gBACFyJ,QAAQ,EAAE,CAAC,CAACzJ;cAAmB;gBAAA4H,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChC,CAAC,eACF7U,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,YAAY;gBACxB9C,KAAK,EAAE,CAAApR,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEgB,EAAE,OAAAxC,qBAAA,GAAIM,WAAW,CAACoC,OAAO,cAAA1C,qBAAA,uBAAnBA,qBAAA,CAAqBwC,EAAE,KAAI,EAAG;gBAC3DwS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACX5E,OAAO,EAAE;sBAAE,GAAG4E,QAAQ,CAAC5E,OAAO;sBAAEF,EAAE,EAAEmT;oBAAS;kBAC/C,CAAC,CAAC,CAAC;kBACHjV,iBAAiB,CAAC,IAAI,EAAEiV,QAAQ,CAAC;gBACnC,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE,UAAU;kBACpBZ,UAAU,EAAEpH,kBAAkB,GAAG,SAAS,GAAG;gBAC/C,CAAE;gBACFyJ,QAAQ,EAAE,CAAC,CAACzJ;cAAmB;gBAAA4H,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChC,CAAC,eACF7U,OAAA;gBACE4J,IAAI,EAAC,OAAO;gBACZyM,WAAW,EAAC,eAAe;gBAC3B9C,KAAK,EAAE,CAAApR,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEoB,KAAK,OAAA3C,qBAAA,GAAIK,WAAW,CAACoC,OAAO,cAAAzC,qBAAA,uBAAnBA,qBAAA,CAAqB2C,KAAK,KAAI,EAAG;gBACjEoS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACX5E,OAAO,EAAE;sBAAE,GAAG4E,QAAQ,CAAC5E,OAAO;sBAAEE,KAAK,EAAE+S;oBAAS;kBAClD,CAAC,CAAC,CAAC;kBACHjV,iBAAiB,CAAC,OAAO,EAAEiV,QAAQ,CAAC;gBACtC,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE,UAAU;kBACpBZ,UAAU,EAAEpH,kBAAkB,GAAG,SAAS,GAAG;gBAC/C,CAAE;gBACFyJ,QAAQ,EAAE,CAAC,CAACzJ;cAAmB;gBAAA4H,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChC,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGN7U,OAAA;YAAK4T,KAAK,EAAE;cAAEa,YAAY,EAAE;YAAO,CAAE;YAAAD,QAAA,gBACnCxU,OAAA;cAAI4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,UAAU;gBAAEC,UAAU,EAAE,KAAK;gBAAEN,YAAY,EAAE,SAAS;gBAAEhG,KAAK,EAAE;cAAU,CAAE;cAAA+F,QAAA,EAAC;YAEnG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEuC,mBAAmB,EAAE,sCAAsC;gBAAEjB,GAAG,EAAE;cAAO,CAAE;cAAAX,QAAA,gBACxGxU,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,iBAAiB;gBAC7B9C,KAAK,EAAEtS,WAAW,CAAC2C,UAAU,CAACN,IAAK;gBACnCqS,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACXrE,UAAU,EAAE;sBAAE,GAAGqE,QAAQ,CAACrE,UAAU;sBAAEN,IAAI,EAAEgT;oBAAS;kBACvD,CAAC,CAAC,CAAC;kBACH/U,oBAAoB,CAAC;oBAAE+B,IAAI,EAAEgT;kBAAS,CAAC,CAAC;gBAC1C,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE;gBACZ;cAAE;gBAAAJ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACF7U,OAAA;gBACE4J,IAAI,EAAC,MAAM;gBACXyM,WAAW,EAAC,UAAU;gBACtB9C,KAAK,EAAEtS,WAAW,CAAC2C,UAAU,CAACC,OAAQ;gBACtC8R,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGjM,CAAC,CAACE,MAAM,CAACgJ,KAAK;kBAC/BpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACXrE,UAAU,EAAE;sBAAE,GAAGqE,QAAQ,CAACrE,UAAU;sBAAEC,OAAO,EAAEyS;oBAAS;kBAC1D,CAAC,CAAC,CAAC;kBACH/U,oBAAoB,CAAC;oBAAEsC,OAAO,EAAEyS;kBAAS,CAAC,CAAC;gBAC7C,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE;gBACZ;cAAE;gBAAAJ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACF7U,OAAA;gBACE4J,IAAI,EAAC,QAAQ;gBACbyM,WAAW,EAAC,YAAY;gBACxB9C,KAAK,EAAEtS,WAAW,CAAC2C,UAAU,CAACE,SAAU;gBACxC6R,QAAQ,EAAGtL,CAAC,IAAK;kBACf,MAAMiM,QAAQ,GAAGE,QAAQ,CAACnM,CAAC,CAACE,MAAM,CAACgJ,KAAK,CAAC,IAAI,CAAC;kBAC9CpS,cAAc,CAAC8G,QAAQ,KAAK;oBAC1B,GAAGA,QAAQ;oBACXrE,UAAU,EAAE;sBAAE,GAAGqE,QAAQ,CAACrE,UAAU;sBAAEE,SAAS,EAAEwS;oBAAS;kBAC5D,CAAC,CAAC,CAAC;kBACH/U,oBAAoB,CAAC;oBAAEuC,SAAS,EAAEwS;kBAAS,CAAC,CAAC;gBAC/C,CAAE;gBACF1C,KAAK,EAAE;kBACLiC,KAAK,EAAE,MAAM;kBACbxB,OAAO,EAAE,SAAS;kBAClBD,MAAM,EAAE,mBAAmB;kBAC3BD,YAAY,EAAE,QAAQ;kBACtBW,QAAQ,EAAE;gBACZ;cAAE;gBAAAJ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGN7U,OAAA;YAAK4T,KAAK,EAAE;cACVM,UAAU,EAAE,mDAAmD;cAC/DE,MAAM,EAAE,mBAAmB;cAC3BD,YAAY,EAAE,SAAS;cACvBE,OAAO,EAAE,QAAQ;cACjBI,YAAY,EAAE;YAChB,CAAE;YAAAD,QAAA,gBACAxU,OAAA;cAAI4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,UAAU;gBAAEC,UAAU,EAAE,KAAK;gBAAEN,YAAY,EAAE,MAAM;gBAAEhG,KAAK,EAAE;cAAU,CAAE;cAAA+F,QAAA,EAAC;YAEhG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL7U,OAAA;cAAK4T,KAAK,EAAE;gBACVM,UAAU,EAAE,OAAO;gBACnBE,MAAM,EAAE,mBAAmB;gBAC3BD,YAAY,EAAE,QAAQ;gBACtBE,OAAO,EAAE,MAAM;gBACfI,YAAY,EAAE;cAChB,CAAE;cAAAD,QAAA,gBACAxU,OAAA;gBAAI4T,KAAK,EAAE;kBAAEmB,UAAU,EAAE,KAAK;kBAAEN,YAAY,EAAE,QAAQ;kBAAEhG,KAAK,EAAE;gBAAU,CAAE;gBAAA+F,QAAA,GAAC,iBAC3D,EAAC9R,iBAAiB,CAACY,IAAI;cAAA;gBAAAoR,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACpC,CAAC,eACL7U,OAAA;gBAAG4T,KAAK,EAAE;kBAAEkB,QAAQ,EAAE,UAAU;kBAAErG,KAAK,EAAE,SAAS;kBAAE6F,MAAM,EAAE;gBAAE,CAAE;gBAAAE,QAAA,EAC7D9R,iBAAiB,CAACkF;cAAW;gBAAA8M,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7B,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD,CAAC,eAEN7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEa,YAAY,EAAE;cAAO,CAAE;cAAAD,QAAA,gBACnCxU,OAAA;gBAAI4T,KAAK,EAAE;kBAAEmB,UAAU,EAAE,KAAK;kBAAEN,YAAY,EAAE,SAAS;kBAAEhG,KAAK,EAAE;gBAAU,CAAE;gBAAA+F,QAAA,EAAC;cAE7E;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,EAEJhO,MAAM,CAAC8H,OAAO,CAACjM,iBAAiB,CAAC4D,MAAM,CAAC,CAACiD,GAAG,CAAC,CAAC,CAACkN,QAAQ,EAAErQ,MAAM,CAAC,kBAC/DpG,OAAA;gBAEEoV,OAAO,EAAEA,CAAA,KAAM3B,gBAAgB,CAACgD,QAAQ,CAAE;gBAC1C7C,KAAK,EAAE;kBACLM,UAAU,EAAE,OAAO;kBACnBE,MAAM,EAAE,aAAanT,WAAW,CAACoD,UAAU,CAACC,KAAK,KAAKmS,QAAQ,GAAGrQ,MAAM,CAACqI,KAAK,GAAG,SAAS,EAAE;kBAC3F0F,YAAY,EAAE,SAAS;kBACvBE,OAAO,EAAE,MAAM;kBACfI,YAAY,EAAE,SAAS;kBACvBY,MAAM,EAAE,SAAS;kBACjBY,UAAU,EAAE,eAAe;kBAC3BS,SAAS,EAAEzV,WAAW,CAACoD,UAAU,CAACC,KAAK,KAAKmS,QAAQ,GAAG,kBAAkB,GAAG,MAAM;kBAClFnB,SAAS,EAAErU,WAAW,CAACoD,UAAU,CAACC,KAAK,KAAKmS,QAAQ,GAAG,gCAAgC,GAAG,8BAA8B;kBACxHb,eAAe,EAAE3U,WAAW,CAACoD,UAAU,CAACC,KAAK,KAAKmS,QAAQ,GAAG,2BAA2BrQ,MAAM,CAACqI,KAAK,UAAUrI,MAAM,CAACqI,KAAK,UAAU,GAAG;gBACzI,CAAE;gBAAA+F,QAAA,gBAEFxU,OAAA;kBAAK4T,KAAK,EAAE;oBAAEC,OAAO,EAAE,MAAM;oBAAEE,UAAU,EAAE,QAAQ;oBAAEoB,GAAG,EAAE,SAAS;oBAAEV,YAAY,EAAE;kBAAU,CAAE;kBAAAD,QAAA,gBAC7FxU,OAAA;oBAAK4T,KAAK,EAAE;sBACViC,KAAK,EAAE,MAAM;sBACbC,MAAM,EAAE,MAAM;sBACd3B,YAAY,EAAE,KAAK;sBACnByB,eAAe,EAAExP,MAAM,CAACqI,KAAK;sBAC7BkI,UAAU,EAAE;oBACd;kBAAE;oBAAAjC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC,eACT7U,OAAA;oBAAI4T,KAAK,EAAE;sBACTmB,UAAU,EAAE,KAAK;sBACjBD,QAAQ,EAAE,QAAQ;sBAClBR,MAAM,EAAE,CAAC;sBACTsC,IAAI,EAAE,CAAC;sBACPnI,KAAK,EAAErI,MAAM,CAACqI;oBAChB,CAAE;oBAAA+F,QAAA,EACCpO,MAAM,CAAC9C;kBAAI;oBAAAoR,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACV,CAAC,EACJ4B,QAAQ,KAAK,MAAM,iBAClBzW,OAAA;oBAAM4T,KAAK,EAAE;sBACXkB,QAAQ,EAAE,QAAQ;sBAClB+B,OAAO,EAAE,GAAG;sBACZ9B,UAAU,EAAE,KAAK;sBACjBtG,KAAK,EAAErI,MAAM,CAACqI;oBAChB,CAAE;oBAAA+F,QAAA,GAAC,OACC,EAACpO,MAAM,CAACoB,UAAU,KAAK,CAAC,GAAG,GAAG,GAAGpB,MAAM,CAACoB,UAAU,EAAC,GACvD;kBAAA;oBAAAkN,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CACP;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACE,CAAC,eACN7U,OAAA;kBAAG4T,KAAK,EAAE;oBACRkB,QAAQ,EAAE,QAAQ;oBAClBI,UAAU,EAAE,GAAG;oBACfZ,MAAM,EAAE,CAAC;oBACT7F,KAAK,EAAE;kBACT,CAAE;kBAAA+F,QAAA,EACCpO,MAAM,CAACwB;gBAAW;kBAAA8M,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAClB,CAAC;cAAA,GAlDC4B,QAAQ;gBAAA/B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAmDV,CACN,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC,EAELhN,YAAY,CAACtD,cAAc,iBAC1BvE,OAAA;cAAK4T,KAAK,EAAE;gBACVM,UAAU,EAAE,SAAS;gBACrBE,MAAM,EAAE,mBAAmB;gBAC3BD,YAAY,EAAE,QAAQ;gBACtBE,OAAO,EAAE;cACX,CAAE;cAAAG,QAAA,gBACAxU,OAAA;gBAAI4T,KAAK,EAAE;kBAAEmB,UAAU,EAAE,KAAK;kBAAEtG,KAAK,EAAE,SAAS;kBAAEgG,YAAY,EAAE;gBAAS,CAAE;gBAAAD,QAAA,EAAC;cAE5E;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACL7U,OAAA;gBAAK4T,KAAK,EAAE;kBAAEkB,QAAQ,EAAE,UAAU;kBAAErG,KAAK,EAAE;gBAAU,CAAE;gBAAA+F,QAAA,gBACrDxU,OAAA;kBAAG4T,KAAK,EAAE;oBAAEa,YAAY,EAAE;kBAAU,CAAE;kBAAAD,QAAA,gBACpCxU,OAAA;oBAAAwU,QAAA,EAAQ;kBAAU;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,KAAC,EAACpL,IAAI,CAACiF,KAAK,CAAC7G,YAAY,CAAClB,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE,EAAC,KAAG,EAAC7B,YAAY,GAAGA,YAAY,CAACqG,cAAc,CAACyC,WAAW,GAAG3M,WAAW,CAAC2C,UAAU,CAACE,SAAS;gBAAA;kBAAA4Q,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACrK,CAAC,eACJ7U,OAAA;kBAAG4T,KAAK,EAAE;oBAAEa,YAAY,EAAE;kBAAU,CAAE;kBAAAD,QAAA,gBACpCxU,OAAA;oBAAAwU,QAAA,EAAQ;kBAAa;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,SAAE,EAAC1O,iBAAiB,EAAAtF,sBAAA,GAACI,WAAW,CAACoD,UAAU,cAAAxD,sBAAA,uBAAtBA,sBAAA,CAAwByD,KAAK,CAAC,CAACkD,UAAU;gBAAA;kBAAAkN,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC3F,CAAC,eACJ7U,OAAA;kBAAG4T,KAAK,EAAE;oBAAEU,MAAM,EAAE;kBAAE,CAAE;kBAAAE,QAAA,gBACtBxU,OAAA;oBAAAwU,QAAA,EAAQ;kBAAY;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,KAAC,EAACpL,IAAI,CAACiF,KAAK,CAAC7G,YAAY,CAACH,UAAU,GAAG,EAAE,CAAC,GAAG,EAAE,EAAC,KAAG,EAAC5C,YAAY,GAAGA,YAAY,CAACqG,cAAc,CAACyC,WAAW,GAAG3M,WAAW,CAAC2C,UAAU,CAACE,SAAS;gBAAA;kBAAA4Q,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACzK,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACD,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CACN;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,eAGN7U,OAAA;YAAK4T,KAAK,EAAE;cACVW,SAAS,EAAE,QAAQ;cACnBL,UAAU,EAAE,mDAAmD;cAC/DE,MAAM,EAAE,mBAAmB;cAC3BD,YAAY,EAAE,SAAS;cACvBE,OAAO,EAAE,QAAQ;cACjBI,YAAY,EAAE;YAChB,CAAE;YAAAD,QAAA,gBACAxU,OAAA;cAAI4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,QAAQ;gBAAEC,UAAU,EAAE,KAAK;gBAAEtG,KAAK,EAAE,SAAS;gBAAEgG,YAAY,EAAE;cAAO,CAAE;cAAAD,QAAA,EAAC;YAE9F;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,MAAM;gBAAEC,UAAU,EAAE,KAAK;gBAAEtG,KAAK,EAAE,SAAS;gBAAEgG,YAAY,EAAE;cAAO,CAAE;cAAAD,QAAA,GACzF/K,IAAI,CAACiF,KAAK,CAAC7G,YAAY,CAACH,UAAU,GAAG,EAAE,CAAC,GAAG,EAAE,eAC9C1H,OAAA;gBAAM4T,KAAK,EAAE;kBAAEkB,QAAQ,EAAE,QAAQ;kBAAErG,KAAK,EAAE;gBAAU,CAAE;gBAAA+F,QAAA,GAAC,IACnD,EAAC1P,YAAY,GAAGA,YAAY,CAACqG,cAAc,CAACyC,WAAW,GAAG3M,WAAW,CAAC2C,UAAU,CAACE,SAAS;cAAA;gBAAA4Q,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACxF,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACJ,CAAC,eACN7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,SAAS;gBAAErG,KAAK,EAAE,SAAS;gBAAEgG,YAAY,EAAE;cAAO,CAAE;cAAAD,QAAA,GAAC,GAC1E,EAAC/K,IAAI,CAACiF,KAAK,CAAE7G,YAAY,CAACH,UAAU,IAAI5C,YAAY,GAAIA,YAAY,CAACqG,cAAc,CAACyC,WAAW,IAAI,CAAC,GAAK3M,WAAW,CAAC2C,UAAU,CAACE,SAAS,IAAI,CAAE,CAAC,GAAI,IAAI,CAAC,GAAG,EAAE,EAAC,IAClK;YAAA;cAAA4Q,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eACN7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEG,cAAc,EAAE,QAAQ;gBAAEmB,GAAG,EAAE,MAAM;gBAAE2B,QAAQ,EAAE;cAAO,CAAE;cAAAtC,QAAA,GACtF1P,YAAY,iBACX9E,OAAA;gBAAK4T,KAAK,EAAE;kBACVkB,QAAQ,EAAE,UAAU;kBACpBZ,UAAU,EAAE,SAAS;kBACrBzF,KAAK,EAAE,SAAS;kBAChB4F,OAAO,EAAE,iBAAiB;kBAC1BF,YAAY,EAAE;gBAChB,CAAE;gBAAAK,QAAA,EAAC;cAEH;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CACN,EACAhN,YAAY,CAACtD,cAAc,iBAC1BvE,OAAA;gBAAK4T,KAAK,EAAE;kBACVkB,QAAQ,EAAE,UAAU;kBACpBZ,UAAU,EAAE,SAAS;kBACrBzF,KAAK,EAAE,SAAS;kBAChB4F,OAAO,EAAE,iBAAiB;kBAC1BF,YAAY,EAAE;gBAChB,CAAE;gBAAAK,QAAA,EAAC;cAEH;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CACN,EACA/H,kBAAkB,iBACjB9M,OAAA;gBAAK4T,KAAK,EAAE;kBACVkB,QAAQ,EAAE,UAAU;kBACpBZ,UAAU,EAAE,SAAS;kBACrBzF,KAAK,EAAE,SAAS;kBAChB4F,OAAO,EAAE,iBAAiB;kBAC1BF,YAAY,EAAE;gBAChB,CAAE;gBAAAK,QAAA,EAAC;cAEH;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CACN;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,EAGL/H,kBAAkB,iBACjB9M,OAAA;YAAK4T,KAAK,EAAE;cACVM,UAAU,EAAE,mDAAmD;cAC/DE,MAAM,EAAE,mBAAmB;cAC3BD,YAAY,EAAE,SAAS;cACvBE,OAAO,EAAE,QAAQ;cACjBI,YAAY,EAAE,MAAM;cACpBF,SAAS,EAAE;YACb,CAAE;YAAAC,QAAA,gBACAxU,OAAA;cAAI4T,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,UAAU;gBAAEC,UAAU,EAAE,KAAK;gBAAEtG,KAAK,EAAE,SAAS;gBAAEgG,YAAY,EAAE;cAAU,CAAE;cAAAD,QAAA,EAAC;YAEnG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACL7U,OAAA;cAAG4T,KAAK,EAAE;gBAAEnF,KAAK,EAAE,SAAS;gBAAEgG,YAAY,EAAE,QAAQ;gBAAEK,QAAQ,EAAE;cAAW,CAAE;cAAAN,QAAA,EAAC;YAE9E;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eACJ7U,OAAA;cACEoV,OAAO,EAAEA,CAAA,KAAM;gBACb,IAAIjT,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,EAAE;kBACtBf,SAAS,CAACD,cAAc,CAACgB,EAAE,EAAEF,gBAAgB,CAAC;kBAC9C;kBACA,MAAM8T,MAAM,GAAG1F,QAAQ,CAAC2F,aAAa;kBACrC,MAAMC,YAAY,GAAGF,MAAM,CAACG,SAAS;kBACrC,MAAMC,UAAU,GAAGJ,MAAM,CAACnD,KAAK,CAACM,UAAU;kBAC1C6C,MAAM,CAACG,SAAS,GAAG,wSAAwS;kBAC3TH,MAAM,CAACnD,KAAK,CAACM,UAAU,GAAG,mDAAmD;kBAC7EzO,UAAU,CAAC,MAAM;oBACfsR,MAAM,CAACG,SAAS,GAAGD,YAAY;oBAC/BF,MAAM,CAACnD,KAAK,CAACM,UAAU,GAAGiD,UAAU;kBACtC,CAAC,EAAE,IAAI,CAAC;gBACV;cACF,CAAE;cACFpB,QAAQ,EAAE,EAAC5T,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,CAAC;cAC9ByQ,KAAK,EAAE;gBACLC,OAAO,EAAE,aAAa;gBACtBE,UAAU,EAAE,QAAQ;gBACpBoB,GAAG,EAAE,SAAS;gBACdjB,UAAU,EAAE/R,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,GAAG,mDAAmD,GAAG,SAAS;gBAChGsL,KAAK,EAAE,OAAO;gBACd4F,OAAO,EAAE,WAAW;gBACpBF,YAAY,EAAE,SAAS;gBACvBC,MAAM,EAAE,MAAM;gBACdiB,MAAM,EAAElT,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,GAAG,SAAS,GAAG,aAAa;gBACtD2R,QAAQ,EAAE,MAAM;gBAChBC,UAAU,EAAE,KAAK;gBACjBO,SAAS,EAAEnT,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,GAAG,oCAAoC,GAAG,MAAM;gBAC7EuT,SAAS,EAAE,eAAe;gBAC1BT,UAAU,EAAE;cACd,CAAE;cACFmB,WAAW,EAAG/M,CAAC,IAAK;gBAClB,IAAIlI,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,EAAE;kBACtBkH,CAAC,CAACgN,aAAa,CAACzD,KAAK,CAAC8C,SAAS,GAAG,kBAAkB;kBACpDrM,CAAC,CAACgN,aAAa,CAACzD,KAAK,CAAC0B,SAAS,GAAG,oCAAoC;gBACxE;cACF,CAAE;cACFgC,UAAU,EAAGjN,CAAC,IAAK;gBACjB,IAAIlI,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,EAAE;kBACtBkH,CAAC,CAACgN,aAAa,CAACzD,KAAK,CAAC8C,SAAS,GAAG,eAAe;kBACjDrM,CAAC,CAACgN,aAAa,CAACzD,KAAK,CAAC0B,SAAS,GAAG,oCAAoC;gBACxE;cACF,CAAE;cACFxM,KAAK,EAAE3G,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,GAAG,+BAA+B,GAAG,6BAA8B;cAAAqR,QAAA,gBAE5FxU,OAAA,CAACnB,IAAI;gBAAC8K,IAAI,EAAE;cAAG;gBAAA+K,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,cAEpB;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,EACR,EAAC1S,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEgB,EAAE,kBAClBnD,OAAA;cAAG4T,KAAK,EAAE;gBAAE2D,SAAS,EAAE,SAAS;gBAAEzC,QAAQ,EAAE,SAAS;gBAAErG,KAAK,EAAE;cAAU,CAAE;cAAA+F,QAAA,EAAC;YAE3E;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CACJ;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CACN,EAGA/P,YAAY,iBACX9E,OAAA;YAAK4T,KAAK,EAAE;cACVM,UAAU,EAAE,mDAAmD;cAC/DE,MAAM,EAAE,mBAAmB;cAC3BD,YAAY,EAAE,SAAS;cACvBE,OAAO,EAAE,QAAQ;cACjBI,YAAY,EAAE;YAChB,CAAE;YAAAD,QAAA,gBACAxU,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEG,cAAc,EAAE,eAAe;gBAAED,UAAU,EAAE,YAAY;gBAAEU,YAAY,EAAE;cAAO,CAAE;cAAAD,QAAA,gBAC/GxU,OAAA;gBAAAwU,QAAA,gBACExU,OAAA;kBAAI4T,KAAK,EAAE;oBAAEkB,QAAQ,EAAE,SAAS;oBAAEC,UAAU,EAAE,KAAK;oBAAEtG,KAAK,EAAE,SAAS;oBAAEgG,YAAY,EAAE;kBAAS,CAAE;kBAAAD,QAAA,EAAC;gBAEjG;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACL7U,OAAA;kBAAG4T,KAAK,EAAE;oBAAEnF,KAAK,EAAE,SAAS;oBAAEsG,UAAU,EAAE,KAAK;oBAAED,QAAQ,EAAE;kBAAS,CAAE;kBAAAN,QAAA,EACnE1P,YAAY,CAACqG,cAAc,CAACrC;gBAAK;kBAAA4L,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjC,CAAC,eACJ7U,OAAA;kBAAG4T,KAAK,EAAE;oBAAEkB,QAAQ,EAAE,UAAU;oBAAErG,KAAK,EAAE;kBAAU,CAAE;kBAAA+F,QAAA,EAClD5R,sBAAsB,CAACkC,YAAY,CAACqG,cAAc,CAACvD,WAAW;gBAAC;kBAAA8M,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC/D,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACD,CAAC,eACN7U,OAAA;gBAAK4T,KAAK,EAAE;kBAAEW,SAAS,EAAE;gBAAQ,CAAE;gBAAAC,QAAA,eACjCxU,OAAA;kBAAK4T,KAAK,EAAE;oBAAEkB,QAAQ,EAAE,UAAU;oBAAErG,KAAK,EAAE;kBAAU,CAAE;kBAAA+F,QAAA,gBACrDxU,OAAA;oBAAG4T,KAAK,EAAE;sBAAEU,MAAM,EAAE;oBAAY,CAAE;oBAAAE,QAAA,gBAChCxU,OAAA;sBAAAwU,QAAA,EAAQ;oBAAO;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,KAAC,EAAC/P,YAAY,CAACqG,cAAc,CAACiD,MAAM,EAAC,kBAC/D;kBAAA;oBAAAsG,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAG,CAAC,eACJ7U,OAAA;oBAAG4T,KAAK,EAAE;sBAAEU,MAAM,EAAE;oBAAY,CAAE;oBAAAE,QAAA,gBAChCxU,OAAA;sBAAAwU,QAAA,EAAQ;oBAAQ;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,KAAC,EAAC/P,YAAY,CAACqG,cAAc,CAACkD,gBAAgB,EAAC,GAC1E;kBAAA;oBAAAqG,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAG,CAAC,eACJ7U,OAAA;oBAAG4T,KAAK,EAAE;sBAAEU,MAAM,EAAE;oBAAY,CAAE;oBAAAE,QAAA,gBAChCxU,OAAA;sBAAAwU,QAAA,EAAQ;oBAAa;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,KAAC,EAAC/P,YAAY,CAACqG,cAAc,CAACyC,WAAW;kBAAA;oBAAA8G,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACtE,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACD;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eAGN7U,OAAA;cAAK4T,KAAK,EAAE;gBAAEC,OAAO,EAAE,MAAM;gBAAEC,aAAa,EAAE,QAAQ;gBAAEqB,GAAG,EAAE;cAAS,CAAE;cAAAX,QAAA,EAErE1P,YAAY,CAAC8B,QAAQ,IAAI9B,YAAY,CAAC8B,QAAQ,CAAC2C,GAAG,CAAErC,SAAS,IAAK;gBAAA,IAAAsQ,qBAAA,EAAAC,qBAAA,EAAAC,sBAAA;gBACjE,MAAMpP,cAAc,GAAGrH,WAAW,CAAC4D,aAAa,IAAI5D,WAAW,CAAC4D,aAAa,CAACqC,SAAS,CAAC/D,EAAE,CAAC;gBAC3F,MAAMwU,YAAY,GAAG3S,kBAAkB,CAACkC,SAAS,CAAC/D,EAAE,CAAC;gBAErD,oBACEnD,OAAA;kBAAwB4T,KAAK,EAAE;oBAC7BM,UAAU,EAAE,OAAO;oBACnBE,MAAM,EAAE,mBAAmB;oBAC3BD,YAAY,EAAE,QAAQ;oBACtBE,OAAO,EAAE,SAAS;oBAClBiB,SAAS,EAAE;kBACb,CAAE;kBAAAd,QAAA,gBACAxU,OAAA;oBAAK4T,KAAK,EAAE;sBAAEC,OAAO,EAAE,MAAM;sBAAEG,cAAc,EAAE,eAAe;sBAAED,UAAU,EAAE,YAAY;sBAAEU,YAAY,EAAE;oBAAO,CAAE;oBAAAD,QAAA,gBAC/GxU,OAAA;sBAAK4T,KAAK,EAAE;wBAAEgD,IAAI,EAAE;sBAAE,CAAE;sBAAApC,QAAA,gBACtBxU,OAAA;wBAAI4T,KAAK,EAAE;0BAAEkB,QAAQ,EAAE,UAAU;0BAAEC,UAAU,EAAE,KAAK;0BAAEtG,KAAK,EAAE;wBAAU,CAAE;wBAAA+F,QAAA,GACtEtN,SAAS,CAAC5D,IAAI,eACftD,OAAA;0BAAM4T,KAAK,EAAE;4BAAEnF,KAAK,EAAE,SAAS;4BAAEmJ,UAAU,EAAE;0BAAS,CAAE;0BAAApD,QAAA,GAAC,GACtD,EAACtN,SAAS,CAACpD,SAAS,EAAC,OACxB;wBAAA;0BAAA4Q,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAM,CAAC;sBAAA;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACL,CAAC,eACL7U,OAAA;wBAAG4T,KAAK,EAAE;0BAAEkB,QAAQ,EAAE,UAAU;0BAAErG,KAAK,EAAE,SAAS;0BAAE8I,SAAS,EAAE;wBAAU,CAAE;wBAAA/C,QAAA,EACxE5R,sBAAsB,CAACsE,SAAS,CAACU,WAAW;sBAAC;wBAAA8M,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAC7C,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACD,CAAC,eACN7U,OAAA;sBACEoV,OAAO,EAAEA,CAAA,KAAM1B,oBAAoB,CAACxM,SAAS,CAAC/D,EAAE,CAAE;sBAClDyQ,KAAK,EAAE;wBACLnF,KAAK,EAAE,SAAS;wBAChByF,UAAU,EAAE,MAAM;wBAClBE,MAAM,EAAE,MAAM;wBACdU,QAAQ,EAAE,UAAU;wBACpB+C,cAAc,EAAE,WAAW;wBAC3BxC,MAAM,EAAE,SAAS;wBACjBuC,UAAU,EAAE;sBACd,CAAE;sBAAApD,QAAA,GAEDmD,YAAY,GAAG,MAAM,GAAG,MAAM,EAAC,gBAClC;oBAAA;sBAAAjD,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACN,CAAC,eAGN7U,OAAA;oBAAK4T,KAAK,EAAE;sBACVC,OAAO,EAAE,MAAM;sBACfuC,mBAAmB,EAAE,sCAAsC;sBAC3DjB,GAAG,EAAE,QAAQ;sBACbV,YAAY,EAAE;oBAChB,CAAE;oBAAAD,QAAA,EACC1P,YAAY,CAACwC,YAAY,CAACiC,GAAG,CAAEjF,KAAK,IAAK;sBACxC,MAAMwT,UAAU,GAAG,CAAAxP,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEjB,aAAa,MAAK/C,KAAK,CAACA,KAAK;sBAChE,MAAMgK,MAAM,GAAG7E,IAAI,CAACiF,KAAK,CAACxH,SAAS,CAACpD,SAAS,GAAGQ,KAAK,CAACkD,UAAU,CAAC;sBAEjE,oBACExH,OAAA;wBAEEoV,OAAO,EAAEA,CAAA,KAAMrN,mBAAmB,CAACb,SAAS,CAAC/D,EAAE,EAAEmB,KAAK,CAACA,KAAK,CAAE;wBAC9DsP,KAAK,EAAE;0BACLS,OAAO,EAAE,SAAS;0BAClBF,YAAY,EAAE,QAAQ;0BACtBC,MAAM,EAAE,aAAa0D,UAAU,GAAGxT,KAAK,CAACmK,KAAK,GAAG,SAAS,EAAE;0BAC3DqG,QAAQ,EAAE,UAAU;0BACpBC,UAAU,EAAE,KAAK;0BACjBM,MAAM,EAAE,SAAS;0BACjBY,UAAU,EAAE,eAAe;0BAC3BL,eAAe,EAAEkC,UAAU,GAAGxT,KAAK,CAACmK,KAAK,GAAG,OAAO;0BACnDA,KAAK,EAAEqJ,UAAU,GAAG,OAAO,GAAG,SAAS;0BACvCpB,SAAS,EAAEoB,UAAU,GAAG,aAAa,GAAG,MAAM;0BAC9CvD,SAAS,EAAE;wBACb,CAAE;wBAAAC,QAAA,gBAEFxU,OAAA;0BAAK4T,KAAK,EAAE;4BAAEmB,UAAU,EAAE;0BAAM,CAAE;0BAAAP,QAAA,EAAElQ,KAAK,CAAChB;wBAAI;0BAAAoR,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAM,CAAC,eACrD7U,OAAA;0BAAK4T,KAAK,EAAE;4BAAEkB,QAAQ,EAAE,SAAS;4BAAEyC,SAAS,EAAE;0BAAU,CAAE;0BAAA/C,QAAA,GACvDlQ,KAAK,CAACA,KAAK,KAAK,YAAY,GAAG,GAAG,GAAGgK,MAAM,EAAC,MAC/C;wBAAA;0BAAAoG,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAK,CAAC;sBAAA,GAnBDvQ,KAAK,CAACA,KAAK;wBAAAoQ,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAoBV,CAAC;oBAEb,CAAC;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CAAC,EAGL8C,YAAY,iBACX3X,OAAA;oBAAK4T,KAAK,EAAE;sBACVM,UAAU,EAAE,SAAS;sBACrBC,YAAY,EAAE,QAAQ;sBACtBE,OAAO,EAAE,MAAM;sBACfI,YAAY,EAAE;oBAChB,CAAE;oBAAAD,QAAA,gBACAxU,OAAA;sBAAI4T,KAAK,EAAE;wBAAEmB,UAAU,EAAE,KAAK;wBAAEtG,KAAK,EAAE,SAAS;wBAAEgG,YAAY,EAAE;sBAAU,CAAE;sBAAAD,QAAA,EAAC;oBAE7E;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAI,CAAC,eACL7U,OAAA;sBAAK4T,KAAK,EAAE;wBACVC,OAAO,EAAE,MAAM;wBACfuC,mBAAmB,EAAE,sCAAsC;wBAC3DjB,GAAG,EAAE;sBACP,CAAE;sBAAAX,QAAA,EACC1P,YAAY,CAACwC,YAAY,CAACiC,GAAG,CAAEjF,KAAK;wBAAA,IAAAyT,qBAAA,EAAAC,sBAAA;wBAAA,oBACnChY,OAAA;0BAEE4T,KAAK,EAAE;4BACLM,UAAU,EAAE,OAAO;4BACnBC,YAAY,EAAE,SAAS;4BACvBC,MAAM,EAAE,mBAAmB;4BAC3B6D,UAAU,EAAE,aAAa3T,KAAK,CAACmK,KAAK,EAAE;4BACtC4F,OAAO,EAAE;0BACX,CAAE;0BAAAG,QAAA,gBAEFxU,OAAA;4BAAK4T,KAAK,EAAE;8BAAEmB,UAAU,EAAE,KAAK;8BAAED,QAAQ,EAAE,UAAU;8BAAErG,KAAK,EAAEnK,KAAK,CAACmK;4BAAM,CAAE;4BAAA+F,QAAA,EACzElQ,KAAK,CAAChB;0BAAI;4BAAAoR,QAAA,EAAAC,YAAA;4BAAAC,UAAA;4BAAAC,YAAA;0BAAA,OACR,CAAC,eACN7U,OAAA;4BAAK4T,KAAK,EAAE;8BAAEkB,QAAQ,EAAE,SAAS;8BAAErG,KAAK,EAAE,SAAS;8BAAEgG,YAAY,EAAE;4BAAS,CAAE;4BAAAD,QAAA,IAAAuD,qBAAA,GAC3E7Q,SAAS,CAACZ,MAAM,CAAChC,KAAK,CAACA,KAAK,CAAC,cAAAyT,qBAAA,uBAA7BA,qBAAA,CAA+BG,UAAU,EAAC,MAC7C;0BAAA;4BAAAxD,QAAA,EAAAC,YAAA;4BAAAC,UAAA;4BAAAC,YAAA;0BAAA,OAAK,CAAC,eACN7U,OAAA;4BAAK4T,KAAK,EAAE;8BAAEkB,QAAQ,EAAE,SAAS;8BAAErG,KAAK,EAAE;4BAAU,CAAE;4BAAA+F,QAAA,EACnD5R,sBAAsB,EAAAoV,sBAAA,GAAC9Q,SAAS,CAACZ,MAAM,CAAChC,KAAK,CAACA,KAAK,CAAC,cAAA0T,sBAAA,uBAA7BA,sBAAA,CAA+BpQ,WAAW;0BAAC;4BAAA8M,QAAA,EAAAC,YAAA;4BAAAC,UAAA;4BAAAC,YAAA;0BAAA,OAChE,CAAC;wBAAA,GAjBDvQ,KAAK,CAACA,KAAK;0BAAAoQ,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAkBb,CAAC;sBAAA,CACP;oBAAC;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACC,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACH,CACN,eAGD7U,OAAA;oBAAAwU,QAAA,gBACExU,OAAA;sBAAO4T,KAAK,EAAE;wBACZC,OAAO,EAAE,OAAO;wBAChBiB,QAAQ,EAAE,UAAU;wBACpBC,UAAU,EAAE,KAAK;wBACjBtG,KAAK,EAAE,SAAS;wBAChBgG,YAAY,EAAE;sBAChB,CAAE;sBAAAD,QAAA,EAAC;oBAEH;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC,EAGP3N,SAAS,CAACiR,eAAe,iBACxBnY,OAAA;sBAAK4T,KAAK,EAAE;wBAAEC,OAAO,EAAE,MAAM;wBAAEsB,GAAG,EAAE,QAAQ;wBAAEV,YAAY,EAAE,SAAS;wBAAEqC,QAAQ,EAAE;sBAAO,CAAE;sBAAAtC,QAAA,EACvF3N,MAAM,CAAC8H,OAAO,CAACzH,SAAS,CAACiR,eAAe,CAAC,CAAC5O,GAAG,CAAC,CAAC,CAAC6O,QAAQ,EAAEpQ,QAAQ,CAAC,kBAClEhI,OAAA;wBAEE2V,QAAQ,EAAGtL,CAAC,IAAK;0BACf,IAAIA,CAAC,CAACE,MAAM,CAACgJ,KAAK,EAAE;4BAClBnL,oBAAoB,CAAClB,SAAS,CAAC/D,EAAE,EAAEkH,CAAC,CAACE,MAAM,CAACgJ,KAAK,CAAC;4BAClDlJ,CAAC,CAACE,MAAM,CAACgJ,KAAK,GAAG,EAAE;0BACrB;wBACF,CAAE;wBACF8E,YAAY,EAAC,EAAE;wBACfzE,KAAK,EAAE;0BACLS,OAAO,EAAE,QAAQ;0BACjBD,MAAM,EAAE,mBAAmB;0BAC3BD,YAAY,EAAE,SAAS;0BACvBW,QAAQ,EAAE,SAAS;0BACnBO,MAAM,EAAE;wBACV,CAAE;wBAAAb,QAAA,gBAEFxU,OAAA;0BAAQuT,KAAK,EAAC,EAAE;0BAAAiB,QAAA,GAAC,MAAI,EAAC4D,QAAQ,EAAC,KAAG;wBAAA;0BAAA1D,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAQ,CAAC,EAC1C7M,QAAQ,CAACuB,GAAG,CAAC,CAAClB,OAAO,EAAEiQ,GAAG,kBACzBtY,OAAA;0BAAkBuT,KAAK,EAAElL,OAAQ;0BAAAmM,QAAA,EAAE5R,sBAAsB,CAACyF,OAAO;wBAAC,GAArDiQ,GAAG;0BAAA5D,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAA2D,CAC5E,CAAC;sBAAA,GAnBGuD,QAAQ;wBAAA1D,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAoBP,CACT;oBAAC;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACC,CACN,eAED7U,OAAA;sBACEuT,KAAK,EAAE,CAAAjL,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEH,cAAc,KAAI,EAAG;sBAC5CwN,QAAQ,EAAGtL,CAAC,IAAKtC,mBAAmB,CAACb,SAAS,CAAC/D,EAAE,EAAEmF,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEjB,aAAa,EAAEgD,CAAC,CAACE,MAAM,CAACgJ,KAAK,CAAE;sBAClGK,KAAK,EAAE;wBACLiC,KAAK,EAAE,MAAM;wBACbxB,OAAO,EAAE,SAAS;wBAClBD,MAAM,EAAE,mBAAmB;wBAC3BD,YAAY,EAAE,QAAQ;wBACtBW,QAAQ,EAAE,UAAU;wBACpByD,MAAM,EAAE,MAAM;wBACdtE,SAAS,EAAE;sBACb,CAAE;sBACFuE,IAAI,EAAC,GAAG;sBACRnC,WAAW,EAAC;oBAA6C;sBAAA3B,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAC1D,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CAAC,EAGL,CAAAvM,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEjB,aAAa,kBAC5BrH,OAAA;oBAAK4T,KAAK,EAAE;sBACV2D,SAAS,EAAE,SAAS;sBACpBlD,OAAO,EAAE,SAAS;sBAClBH,UAAU,EAAE,SAAS;sBACrBC,YAAY,EAAE,SAAS;sBACvBC,MAAM,EAAE;oBACV,CAAE;oBAAAI,QAAA,gBACAxU,OAAA;sBAAK4T,KAAK,EAAE;wBAAEkB,QAAQ,EAAE;sBAAW,CAAE;sBAAAN,QAAA,gBACnCxU,OAAA;wBAAAwU,QAAA,EAAQ;sBAAe;wBAAAE,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAQ,CAAC,KAAC,GAAA2C,qBAAA,GAAC1S,YAAY,CAACwC,YAAY,CAACrB,IAAI,CAACsB,CAAC,IAAIA,CAAC,CAACjD,KAAK,KAAKgE,cAAc,CAACjB,aAAa,CAAC,cAAAmQ,qBAAA,uBAA7EA,qBAAA,CAA+ElU,IAAI,EACpH,GAAG,EAAC,GAAC,GAAAmU,qBAAA,GAACvQ,SAAS,CAACZ,MAAM,CAACgC,cAAc,CAACjB,aAAa,CAAC,cAAAoQ,qBAAA,uBAA9CA,qBAAA,CAAgDS,UAAU,EAAC,OACpE;oBAAA;sBAAAxD,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eACN7U,OAAA;sBAAK4T,KAAK,EAAE;wBAAEkB,QAAQ,EAAE,UAAU;wBAAErG,KAAK,EAAE,SAAS;wBAAE8I,SAAS,EAAE;sBAAU,CAAE;sBAAA/C,QAAA,EAC1E5R,sBAAsB,EAAA8U,sBAAA,GAACxQ,SAAS,CAACZ,MAAM,CAACgC,cAAc,CAACjB,aAAa,CAAC,cAAAqQ,sBAAA,uBAA9CA,sBAAA,CAAgD9P,WAAW;oBAAC;sBAAA8M,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACjF,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACH,CACN;gBAAA,GA/LO3N,SAAS,CAAC/D,EAAE;kBAAAuR,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAgMjB,CAAC;cAEV,CAAC;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAGE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAACzU,EAAA,CA/yDID,eAAe;EAAA,QA+BfN,aAAa;AAAA;AAAA4Y,EAAA,GA/BbtY,eAAe;AAizDrB,eAAeA,eAAe;AAAC,IAAAsY,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}